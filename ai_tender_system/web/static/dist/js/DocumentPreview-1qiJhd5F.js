import{h as e,j as a,E as t,_ as l}from"./index.js";/* empty css                   */import{ax as o,am as s,an as n,ay as r,az as i,aA as u,aB as d,aC as m,aD as v,aE as c,aF as p,aG as f,aH as y,aI as _}from"./editor-6w6Zv5fp.js";import{v as h}from"./directive-CUw06O5E.js";/* empty css                                                                        */const w={"element-loading-text":"正在加载文档...",class:"preview-container"},C={key:1,class:"editor-preview-wrapper"},g=l(o({__name:"DocumentPreview",props:{modelValue:{type:Boolean,default:!1},fileUrl:{default:""},fileName:{default:"文档预览"},htmlContent:{default:""}},emits:["update:modelValue"],setup(l,{emit:o}){const g=l,j=o,V=s(!1),b=s(""),x=s(""),U=s(null),D=n({get:()=>g.modelValue,set:e=>j("update:modelValue",e)}),T=n(()=>`文档预览 - ${g.fileName||"未命名文档"}`),k=()=>{U.value&&x.value&&setTimeout(()=>{"function"==typeof U.value.setContent&&U.value.setContent(x.value)},300)},E=()=>{D.value=!1};return r(()=>g.modelValue,async e=>{e&&(g.fileUrl||g.htmlContent)?(await _(),(async()=>{if(g.htmlContent)x.value=g.htmlContent;else if(g.fileUrl){V.value=!0,b.value="";try{const e=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:g.fileUrl})}),a=await e.json();if(!a.success||!a.html_content)throw new Error(a.error||"Word转HTML失败");x.value=a.html_content}catch(e){b.value=`文档预览失败: ${e.message||"未知错误"}`,t.error("文档预览失败，请检查文件是否正确或尝试下载后查看")}finally{V.value=!1}}else b.value="文档地址不能为空"})()):(b.value="",x.value="")}),(t,l)=>{const o=e,s=a,n=h;return u(),i(s,{modelValue:D.value,"onUpdate:modelValue":l[0]||(l[0]=e=>D.value=e),title:T.value,width:"90%","before-close":E,"destroy-on-close":"",class:"document-preview-dialog"},{default:d(()=>[m((u(),v("div",w,[b.value?(u(),i(o,{key:0,type:"error",title:b.value,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["title"])):c("",!0),!b.value&&x.value?(u(),v("div",C,[p(f(y),{ref_key:"editorRef",ref:U,document:{readOnly:!0},onCreated:k},null,512)])):c("",!0)])),[[n,V.value]])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-62c282b6"]]);export{g as D};
