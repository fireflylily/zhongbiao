import{al as pe,a as oe,c as _e,p as ie,m as me,i as fe,a4 as ve,W as be,X as ge,am as ke,k as M,j as ye,q as he,o as xe,P as we,Q as je}from"./element-plus-IkZgpaz4.js";import{bT as ae,bt as h,bu as Fe,bG as ne,bU as o,bV as t,b$ as V,c7 as I,bY as s,c3 as f,c5 as l,c2 as K,c6 as d,c8 as n,c0 as i,cC as Q,gc as le,gd as Pe,gi as Ve,bv as P}from"./vendor-CdA3MjAt.js";import{L as ze}from"./Loading-CmykbBZp.js";/* empty css                                                                          */import{P as Ce}from"./PageHeader-DUEP1VLZ.js";import"./umo-editor-BmhDOXHm.js";/* empty css                                                                        */import{_ as re}from"./index.js";import{u as Ie}from"./useProjectDocuments-BId2nzjv.js";import{u as Me}from"./project-C4LB9E9r.js";import"./onnxruntime-DkHy2lK3.js";import"./mermaid-e-fO57px.js";import"./echarts-Cqw1j_Z-.js";import"./tender-2TSD_jRl.js";const De={class:"document-merge-panel"},$e={class:"merge-section"},Ee={class:"files-status"},Re={class:"status-icon"},Se={key:0,class:"bi bi-check-circle-fill text-success"},Ue={key:1,class:"bi bi-x-circle-fill text-danger"},Be={class:"file-info"},Te={class:"file-name"},qe={class:"file-meta"},Le={key:1,class:"text-muted"},Ne={key:0,class:"file-actions"},We={class:"status-icon"},Ae={key:0,class:"bi bi-check-circle-fill text-success"},Oe={key:1,class:"bi bi-dash-circle text-warning"},Je={class:"file-info"},Ge={class:"file-name"},He={class:"file-meta"},Ke={key:1,class:"text-muted"},Qe={key:0,class:"file-actions"},Xe={class:"status-icon"},Ye={key:0,class:"bi bi-check-circle-fill text-success"},Ze={key:1,class:"bi bi-x-circle-fill text-danger"},es={class:"file-info"},ss={class:"file-name"},ts={class:"file-meta"},ls={key:1,class:"text-muted"},os={key:0,class:"file-actions"},is={key:0},as={key:1},ns={key:0,class:"merge-section"},rs={class:"config-group"},us={class:"doc-order-list"},ds={class:"doc-order-item fixed"},cs={key:0,class:"doc-order-item"},ps={class:"doc-order-item"},_s={class:"order-number"},ms={class:"config-group"},fs={class:"options-list"},vs={class:"config-group"},bs={class:"index-template-preview"},gs={class:"score-items-preview"},ks={class:"config-group"},ys={key:1,class:"merge-section"},hs={key:0,class:"action-area"},xs={key:1,class:"merge-progress"},ws={class:"progress-message"},js={class:"progress-details"},Fs={key:0,class:"current"},Ps={key:2,class:"merge-result"},Vs={class:"result-info"},zs={class:"stats-list"},Cs={key:0},Is={key:1},Ms={key:2},Ds={class:"processing-details"},$s={key:0},Es={key:1},Rs={key:2},Ss={key:3},Us={class:"action-buttons"},Bs=ae({__name:"DocumentMergePanel",props:{projectId:{},currentDocuments:{}},setup(X){const z=X,D=h(!0),a=h({}),j=h({required:!1,type:"none"}),c=h({include_p2p:!0,doc_order:["business","p2p","tech"],generate_toc:!0,remove_blanks:!0,unify_styles:!0,add_section_breaks:!0,output_filename:""}),C=h(!1),R=h(!1),$=h(0),S=h(""),B=h(""),v=h(""),E=h([]),m=h(null),U=h(!0),k=Fe(()=>a.value.business&&a.value.tech),_=async()=>{var r,e,g,u,y,L;try{if(D.value=!0,z.currentDocuments){console.log("[DocumentMergePanel] 使用父组件传递的文档:",z.currentDocuments);const b=z.currentDocuments;a.value={},b.businessResponseFile&&(a.value.business={status:"ready",file_path:b.businessResponseFile.outputFile,file_name:((r=b.businessResponseFile.outputFile)==null?void 0:r.split("/").pop())||"商务应答文件.docx",file_size:((e=b.businessResponseFile.stats)==null?void 0:e.file_size)||0}),b.p2pResponseFile&&(a.value.p2p={status:"ready",file_path:b.p2pResponseFile.outputFile,file_name:((g=b.p2pResponseFile.outputFile)==null?void 0:g.split("/").pop())||"点对点应答文件.docx",file_size:((u=b.p2pResponseFile.stats)==null?void 0:u.file_size)||0}),b.techProposalFile&&(a.value.tech={status:"ready",file_path:b.techProposalFile.outputFile,file_name:((y=b.techProposalFile.outputFile)==null?void 0:y.split("/").pop())||"技术方案文件.docx",file_size:((L=b.techProposalFile.stats)==null?void 0:L.file_size)||0}),console.log("[DocumentMergePanel] 构建的文件信息:",a.value),c.value={include_p2p:!!a.value.p2p,doc_order:a.value.p2p?["business","p2p","tech"]:["business","tech"],generate_toc:!0,remove_blanks:!0,unify_styles:!0,add_section_breaks:!0,output_filename:`项目${z.projectId}_最终标书`},D.value=!1;return}const x=await le.get(`/api/projects/${z.projectId}/merge-config`);if(console.log("[DocumentMergePanel] API配置响应:",x.data),x.data.success){const b=x.data.data;a.value=b.files||{},j.value=b.index_requirement||{required:!1,type:"none"},b.default_config&&(c.value={...b.default_config})}}catch(x){console.error("[DocumentMergePanel] 加载整合配置失败:",x),M.error("加载配置失败")}finally{D.value=!1}},w=async()=>{var r,e;try{R.value=!0;const g={business:a.value.business.file_path,tech:a.value.tech.file_path};c.value.include_p2p&&a.value.p2p&&(g.p2p=a.value.p2p.file_path);const u=await le.post(`/api/projects/${z.projectId}/merge-documents`,{file_paths:g,config:{...c.value,index_config:j.value}});if(u.data.success){const y=u.data.task_id||z.projectId;console.log("[DocumentMergePanel] 整合任务已启动，task_id:",y),C.value=!0,R.value=!1,T(y)}}catch(g){console.error("启动整合失败:",g),M.error(((e=(r=g.response)==null?void 0:r.data)==null?void 0:e.error)||"启动整合失败"),R.value=!1}},T=r=>{const e=new EventSource(`/api/merge-status/${r}`);e.onmessage=g=>{try{const u=JSON.parse(g.data);if($.value=u.progress_percentage||0,B.value=u.current_step||"",u.current_step&&!E.value.includes(u.current_step)&&(v.value&&E.value.push(v.value),v.value=u.current_step),u.overall_status==="completed"){if(S.value="success",$.value=100,u.options){const y=typeof u.options=="string"?JSON.parse(u.options):u.options;m.value={filename:c.value.output_filename+".docx",file_path:y.merged_document_path,file_size:y.file_size||0,stats:y.stats,created_at:new Date().toLocaleString("zh-CN")}}C.value=!1,e.close(),M.success("文档整合完成！")}else u.overall_status==="failed"&&(S.value="exception",C.value=!1,e.close(),M.error("文档整合失败："+u.current_step))}catch(u){console.error("解析进度数据失败:",u)}},e.onerror=()=>{e.close(),C.value&&(M.error("进度监听中断"),C.value=!1)}},J=()=>{ye.confirm("确定要重新整合吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{m.value=null,$.value=0,S.value="",B.value="",v.value="",E.value=[]}).catch(()=>{})},q=r=>{if(!r)return"";if(r.startsWith("/api/"))return r;let e=r;const g="/Users/lvhe/Downloads/zhongbiao/zhongbiao/";return e.startsWith(g)&&(e=e.substring(g.length)),e.startsWith("ai_tender_system/data/")?e=e.substring(22):e.startsWith("data/")&&(e=e.substring(5)),`/api/files/serve/${e}`},G=()=>{var r;if((r=m.value)!=null&&r.file_path){const e=q(m.value.file_path)+"?download=true";console.log("[DocumentMergePanel] 下载URL:",e),window.open(e,"_blank")}},N=()=>{var r;if((r=m.value)!=null&&r.file_path){const e=q(m.value.file_path);console.log("[DocumentMergePanel] 预览URL:",e),window.open(e,"_blank")}},F=()=>{var r;(r=m.value)!=null&&r.file_path&&(M.success("正在打开编辑器..."),M.info("编辑功能开发中..."))},H=r=>{const e=a.value[r];if(e!=null&&e.file_path){const g=q(e.file_path);console.log("[DocumentMergePanel] 预览文件:",g),window.open(g,"_blank")}},W=r=>r?r<1024?r+" B":r<1024*1024?(r/1024).toFixed(2)+" KB":(r/(1024*1024)).toFixed(2)+" MB":"--";return ne(()=>{_()}),(r,e)=>{const g=pe,u=oe,y=_e,L=ie,x=me,b=fe,ue=ve,A=ge,de=be,ce=ke;return t(),o("div",De,[D.value?(t(),V(g,{key:0,rows:10,animated:""})):(t(),o(I,{key:1},[s("section",$e,[e[18]||(e[18]=s("div",{class:"section-header"},[s("h3",null,[s("i",{class:"bi bi-file-check"}),l(" 步骤 1/3：文件状态检查")])],-1)),s("div",Ee,[s("div",{class:K(["file-status-item",{"file-ready":a.value.business}])},[s("div",Re,[a.value.business?(t(),o("i",Se)):(t(),o("i",Ue))]),s("div",Be,[e[11]||(e[11]=s("h4",null,"商务应答文件",-1)),a.value.business?(t(),o(I,{key:0},[s("p",Te,d(a.value.business.file_name),1),s("p",qe,d(W(a.value.business.file_size)),1)],64)):(t(),o("p",Le,"未生成"))]),a.value.business?(t(),o("div",Ne,[n(u,{size:"small",onClick:e[0]||(e[0]=p=>H("business"))},{default:i(()=>[...e[12]||(e[12]=[s("i",{class:"bi bi-eye"},null,-1),l(" 预览 ",-1)])]),_:1})])):f("",!0)],2),s("div",{class:K(["file-status-item",{"file-ready":a.value.p2p}])},[s("div",We,[a.value.p2p?(t(),o("i",Ae)):(t(),o("i",Oe))]),s("div",Je,[e[13]||(e[13]=s("h4",null,"技术点对点应答",-1)),a.value.p2p?(t(),o(I,{key:0},[s("p",Ge,d(a.value.p2p.file_name),1),s("p",He,d(W(a.value.p2p.file_size)),1)],64)):(t(),o("p",Ke,"未生成（可选）"))]),a.value.p2p?(t(),o("div",Qe,[n(u,{size:"small",onClick:e[1]||(e[1]=p=>H("p2p"))},{default:i(()=>[...e[14]||(e[14]=[s("i",{class:"bi bi-eye"},null,-1),l(" 预览 ",-1)])]),_:1})])):f("",!0)],2),s("div",{class:K(["file-status-item",{"file-ready":a.value.tech}])},[s("div",Xe,[a.value.tech?(t(),o("i",Ye)):(t(),o("i",Ze))]),s("div",es,[e[15]||(e[15]=s("h4",null,"技术方案文件",-1)),a.value.tech?(t(),o(I,{key:0},[s("p",ss,d(a.value.tech.file_name),1),s("p",ts,d(W(a.value.tech.file_size)),1)],64)):(t(),o("p",ls,"未生成"))]),a.value.tech?(t(),o("div",os,[n(u,{size:"small",onClick:e[2]||(e[2]=p=>H("tech"))},{default:i(()=>[...e[16]||(e[16]=[s("i",{class:"bi bi-eye"},null,-1),l(" 预览 ",-1)])]),_:1})])):f("",!0)],2)]),k.value?f("",!0):(t(),V(y,{key:0,type:"warning",closable:!1,"show-icon":"",class:"mt-3"},{title:i(()=>[...e[17]||(e[17]=[l(" 无法整合：缺少必需的文件 ",-1)])]),default:i(()=>[a.value.business?f("",!0):(t(),o("p",is,"• 商务应答文件未生成，请先完成商务应答")),a.value.tech?f("",!0):(t(),o("p",as,"• 技术方案文件未生成，请先完成技术方案"))]),_:1}))]),k.value?(t(),o("section",ns,[e[42]||(e[42]=s("div",{class:"section-header"},[s("h3",null,[s("i",{class:"bi bi-sliders"}),l(" 步骤 2/3：整合配置")])],-1)),s("div",rs,[e[27]||(e[27]=s("h4",null,[s("i",{class:"bi bi-files"}),l(" 文档组成与顺序")],-1)),s("div",us,[s("div",ds,[e[20]||(e[20]=s("span",{class:"order-number"},"1",-1)),e[21]||(e[21]=s("span",{class:"doc-name"},"商务应答",-1)),n(L,{size:"small",type:"info"},{default:i(()=>[...e[19]||(e[19]=[l("固定第一部分",-1)])]),_:1})]),a.value.p2p?(t(),o("div",cs,[e[23]||(e[23]=s("span",{class:"order-number"},"2",-1)),e[24]||(e[24]=s("span",{class:"doc-name"},"点对点应答",-1)),n(x,{modelValue:c.value.include_p2p,"onUpdate:modelValue":e[3]||(e[3]=p=>c.value.include_p2p=p)},{default:i(()=>[...e[22]||(e[22]=[l("包含此部分",-1)])]),_:1},8,["modelValue"])])):f("",!0),s("div",ps,[s("span",_s,d(a.value.p2p?"3":"2"),1),e[26]||(e[26]=s("span",{class:"doc-name"},"技术方案",-1)),n(L,{size:"small",type:"success"},{default:i(()=>[...e[25]||(e[25]=[l("✓ 包含",-1)])]),_:1})])])]),s("div",ms,[e[32]||(e[32]=s("h4",null,[s("i",{class:"bi bi-palette"}),l(" 格式与目录选项")],-1)),s("div",fs,[n(x,{modelValue:c.value.generate_toc,"onUpdate:modelValue":e[4]||(e[4]=p=>c.value.generate_toc=p)},{default:i(()=>[...e[28]||(e[28]=[l(" 自动生成目录（基于1-3级标题，带页码） ",-1)])]),_:1},8,["modelValue"]),n(x,{modelValue:c.value.remove_blanks,"onUpdate:modelValue":e[5]||(e[5]=p=>c.value.remove_blanks=p)},{default:i(()=>[...e[29]||(e[29]=[l(" 删除空白页和空白段落 ",-1)])]),_:1},8,["modelValue"]),n(x,{modelValue:c.value.unify_styles,"onUpdate:modelValue":e[6]||(e[6]=p=>c.value.unify_styles=p)},{default:i(()=>[...e[30]||(e[30]=[l(" 统一页眉页脚格式 ",-1)])]),_:1},8,["modelValue"]),n(x,{modelValue:c.value.add_section_breaks,"onUpdate:modelValue":e[7]||(e[7]=p=>c.value.add_section_breaks=p)},{default:i(()=>[...e[31]||(e[31]=[l(" 每部分间添加分节符 ",-1)])]),_:1},8,["modelValue"])])]),s("div",vs,[e[39]||(e[39]=s("h4",null,[s("i",{class:"bi bi-list-ol"}),l(" 索引设置")],-1)),j.value.required?j.value.type==="fixed_format"?(t(),V(y,{key:1,type:"warning",closable:!1,"show-icon":""},{title:i(()=>[...e[34]||(e[34]=[l(" 招标文件要求提供固定格式索引 ",-1)])]),default:i(()=>[s("div",bs,[s("pre",null,d(j.value.template),1)]),n(x,{modelValue:U.value,"onUpdate:modelValue":e[8]||(e[8]=p=>U.value=p),disabled:"",checked:""},{default:i(()=>[...e[35]||(e[35]=[l(" 自动生成索引（必需） ",-1)])]),_:1},8,["modelValue"])]),_:1})):j.value.type==="score_based"?(t(),V(y,{key:2,type:"success",closable:!1,"show-icon":""},{title:i(()=>[...e[36]||(e[36]=[l(" 招标文件要求以评分标准建立索引 ",-1)])]),default:i(()=>[s("div",gs,[e[37]||(e[37]=s("p",null,"将基于以下评分项生成索引：",-1)),s("ul",null,[(t(!0),o(I,null,Q(j.value.score_items,p=>(t(),o("li",{key:p},d(p),1))),128))])]),n(x,{modelValue:U.value,"onUpdate:modelValue":e[9]||(e[9]=p=>U.value=p),disabled:"",checked:""},{default:i(()=>[...e[38]||(e[38]=[l(" 自动生成评分标准索引（必需） ",-1)])]),_:1},8,["modelValue"])]),_:1})):f("",!0):(t(),V(y,{key:0,type:"info",closable:!1,"show-icon":""},{title:i(()=>[...e[33]||(e[33]=[l(" 招标文件未要求提供索引，无需生成 ",-1)])]),_:1}))]),s("div",ks,[e[41]||(e[41]=s("h4",null,[s("i",{class:"bi bi-file-earmark-text"}),l(" 文档名称")],-1)),n(b,{modelValue:c.value.output_filename,"onUpdate:modelValue":e[10]||(e[10]=p=>c.value.output_filename=p),placeholder:"请输入最终标书文件名",maxlength:"100","show-word-limit":""},{suffix:i(()=>[...e[40]||(e[40]=[l(".docx",-1)])]),_:1},8,["modelValue"])])])):f("",!0),k.value?(t(),o("section",ys,[e[58]||(e[58]=s("div",{class:"section-header"},[s("h3",null,[s("i",{class:"bi bi-rocket-takeoff"}),l(" 步骤 3/3：开始整合")])],-1)),!C.value&&!m.value?(t(),o("div",hs,[n(u,{type:"primary",size:"large",loading:R.value,onClick:w},{default:i(()=>[...e[43]||(e[43]=[s("i",{class:"bi bi-play-fill"},null,-1),l(" 开始整合 ",-1)])]),_:1},8,["loading"])])):f("",!0),C.value?(t(),o("div",xs,[n(ue,{percentage:$.value,status:S.value},null,8,["percentage","status"]),s("p",ws,d(B.value),1),s("div",js,[e[46]||(e[46]=s("h5",null,"处理详情：",-1)),s("ul",null,[(t(!0),o(I,null,Q(E.value,(p,O)=>(t(),o("li",{key:O,class:"completed"},[e[44]||(e[44]=s("i",{class:"bi bi-check-circle-fill"},null,-1)),l(" "+d(p),1)]))),128)),v.value?(t(),o("li",Fs,[e[45]||(e[45]=s("i",{class:"bi bi-arrow-right-circle-fill"},null,-1)),l(" "+d(v.value),1)])):f("",!0)])])])):f("",!0),m.value?(t(),o("div",Ps,[n(ce,{icon:"success",title:"整合完成！","sub-title":"您的最终标书已生成"},{extra:i(()=>{var p,O,Y,Z,ee,se;return[s("div",Vs,[e[55]||(e[55]=s("h4",null,[s("i",{class:"bi bi-file-earmark-check"}),l(" 文件信息")],-1)),n(de,{column:2,border:""},{default:i(()=>[n(A,{label:"文件名"},{default:i(()=>[l(d(m.value.filename),1)]),_:1}),n(A,{label:"文件大小"},{default:i(()=>[l(d(W(m.value.file_size)),1)]),_:1}),n(A,{label:"总页数"},{default:i(()=>{var te;return[l(d(((te=m.value.stats)==null?void 0:te.total_pages)||"--")+" 页 ",1)]}),_:1}),n(A,{label:"生成时间"},{default:i(()=>[l(d(m.value.created_at),1)]),_:1})]),_:1}),e[56]||(e[56]=s("h4",{class:"mt-3"},[s("i",{class:"bi bi-bar-chart"}),l(" 文件组成统计")],-1)),s("ul",zs,[(p=m.value.stats)!=null&&p.toc_pages?(t(),o("li",Cs," 目录："+d(m.value.stats.toc_pages)+" 页 ",1)):f("",!0),s("li",null,"商务应答："+d(((O=m.value.stats)==null?void 0:O.business_pages)||"--")+" 页",1),c.value.include_p2p?(t(),o("li",Is," 点对点应答："+d(((Y=m.value.stats)==null?void 0:Y.p2p_pages)||"--")+" 页 ",1)):f("",!0),s("li",null,"技术方案："+d(((Z=m.value.stats)==null?void 0:Z.tech_pages)||"--")+" 页",1),(ee=m.value.stats)!=null&&ee.index_pages?(t(),o("li",Ms," 索引："+d(m.value.stats.index_pages)+" 页 ",1)):f("",!0)]),e[57]||(e[57]=s("h4",{class:"mt-3"},[s("i",{class:"bi bi-tools"}),l(" 处理详情")],-1)),s("ul",Ds,[(se=m.value.stats)!=null&&se.removed_blanks?(t(),o("li",$s,[e[47]||(e[47]=s("i",{class:"bi bi-check-circle text-success"},null,-1)),l(" 已删除 "+d(m.value.stats.removed_blanks)+" 个空白段落 ",1)])):f("",!0),c.value.generate_toc?(t(),o("li",Es,[...e[48]||(e[48]=[s("i",{class:"bi bi-check-circle text-success"},null,-1),l(" 已生成多级目录 ",-1)])])):f("",!0),j.value.required?(t(),o("li",Rs,[e[49]||(e[49]=s("i",{class:"bi bi-check-circle text-success"},null,-1)),l(" 已生成"+d(j.value.type==="score_based"?"评分标准":"固定格式")+"索引 ",1)])):f("",!0),c.value.unify_styles?(t(),o("li",Ss,[...e[50]||(e[50]=[s("i",{class:"bi bi-check-circle text-success"},null,-1),l(" 已统一页眉页脚 ",-1)])])):f("",!0)]),s("div",Us,[n(u,{type:"primary",size:"large",onClick:G},{default:i(()=>[...e[51]||(e[51]=[s("i",{class:"bi bi-download"},null,-1),l(" 下载Word版 ",-1)])]),_:1}),n(u,{type:"success",size:"large",onClick:N},{default:i(()=>[...e[52]||(e[52]=[s("i",{class:"bi bi-eye"},null,-1),l(" 在线预览 ",-1)])]),_:1}),n(u,{type:"warning",size:"large",onClick:F},{default:i(()=>[...e[53]||(e[53]=[s("i",{class:"bi bi-pencil-square"},null,-1),l(" 在线编辑 ",-1)])]),_:1}),n(u,{size:"large",onClick:J},{default:i(()=>[...e[54]||(e[54]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),l(" 重新整合 ",-1)])]),_:1})])])]}),_:1})])):f("",!0)])):f("",!0)],64))])}}}),Ts=re(Bs,[["__scopeId","data-v-4f5ce16e"]]),qs={class:"final-tender-page"},Ls={class:"selector-content"},Ns={class:"project-option"},Ws={class:"project-name"},As={class:"project-status"},Os={class:"project-info"},Js={class:"project-header"},Gs={class:"project-meta"},Hs=ae({__name:"FinalTender",setup(X){const z=Pe(),D=Ve();Me();const{projects:a,loading:j,selectedProject:c,currentDocuments:C,hasProjects:R,loadProjects:$,handleProjectChange:S,restoreProjectFromStore:B}=Ie(),v=h({projectId:null}),E=async()=>{await S(v.value.projectId,{onClear:()=>{console.log("[最终标书] 项目切换，清空状态")},onDocumentsLoaded:k=>{console.log("[最终标书] 项目文档已加载:",k);const _=!!k.businessResponseFile,w=!!k.techProposalFile;(!_||!w)&&M.warning("该项目缺少商务应答或技术方案文件，无法整合")}}),v.value.projectId&&D.replace({name:"FinalTender",query:{projectId:v.value.projectId.toString()}})},m=()=>{v.value.projectId=null,D.replace({name:"FinalTender"})},U=()=>{$()};return ne(async()=>{await $();const k=await B({onClear:()=>{console.log("[最终标书] Store恢复，清空状态")},onDocumentsLoaded:w=>{console.log("[最终标书] Store恢复，文档已加载:",w)}});k&&(v.value.projectId=k,console.log("✅ 已从Store恢复项目:",k));const _=z.query.projectId;if(_&&!k){const w=Number(_);a.value.some(T=>T.id===w)&&(v.value.projectId=w,await E())}}),(k,_)=>{const w=oe,T=ie,J=xe,q=he,G=we,N=je;return t(),o("div",qs,[n(P(Ce),{title:"最终标书","show-back":!1},{actions:i(()=>[n(w,{onClick:U},{default:i(()=>[..._[2]||(_[2]=[s("i",{class:"bi bi-arrow-clockwise"},null,-1),l(" 刷新 ",-1)])]),_:1})]),_:1}),P(j)?(t(),V(P(ze),{key:0,text:"加载项目列表..."})):(t(),o(I,{key:1},[v.value.projectId?f("",!0):(t(),V(N,{key:0,class:"project-selector-card",shadow:"never"},{default:i(()=>[s("div",Ls,[_[4]||(_[4]=s("div",{class:"selector-icon"},[s("i",{class:"bi bi-folder2-open"})],-1)),_[5]||(_[5]=s("h3",null,"请选择要整合的项目",-1)),_[6]||(_[6]=s("p",{class:"text-muted"}," 从下方列表中选择一个已完成商务应答和技术方案的项目 ",-1)),n(q,{modelValue:v.value.projectId,"onUpdate:modelValue":_[0]||(_[0]=F=>v.value.projectId=F),placeholder:"选择项目",size:"large",filterable:"",class:"project-select",onChange:E},{default:i(()=>[(t(!0),o(I,null,Q(P(a),F=>(t(),V(J,{key:F.id,label:`${F.project_name} (${F.project_number||"-"})`,value:F.id},{default:i(()=>[s("div",Ns,[s("span",Ws,d(F.project_name),1),s("div",As,[n(T,{type:"info",size:"small"},{default:i(()=>[l(d(F.company_name),1)]),_:2},1024)])])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),P(R)?f("",!0):(t(),V(G,{key:0,description:"暂无项目","image-size":120},{extra:i(()=>[n(w,{type:"primary",onClick:_[1]||(_[1]=F=>k.$router.push({name:"TenderManagement"}))},{default:i(()=>[..._[3]||(_[3]=[s("i",{class:"bi bi-folder-plus"},null,-1),l(" 前往项目管理 ",-1)])]),_:1})]),_:1}))])]),_:1})),v.value.projectId&&P(c)?(t(),o(I,{key:1},[n(N,{class:"current-project-card",shadow:"never"},{default:i(()=>[s("div",Os,[s("div",Js,[s("h3",null,[_[7]||(_[7]=s("i",{class:"bi bi-folder-check"},null,-1)),l(" "+d(P(c).project_name),1)]),n(w,{size:"small",text:"",onClick:m},{default:i(()=>[..._[8]||(_[8]=[s("i",{class:"bi bi-arrow-left-right"},null,-1),l(" 切换项目 ",-1)])]),_:1})]),s("p",Gs," 公司："+d(P(c).company_name)+" | 项目编号："+d(P(c).project_number||"-")+" | 创建时间："+d(P(c).created_at),1)])]),_:1}),(t(),V(Ts,{"project-id":v.value.projectId,"current-documents":P(C),key:v.value.projectId},null,8,["project-id","current-documents"]))],64)):f("",!0)],64))])}}}),ut=re(Hs,[["__scopeId","data-v-a7f77f31"]]);export{ut as default};
