import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";import{E as a,a as l}from"./el-tab-pane-DorCtwCc.js";/* empty css               */import{d as t,a as i,r as n,A as o,c as s,o as u,g as d,F as r,w as c,E as p,l as _,k as m,H as f,bz as v,x as y,B as g,e as h,G as k,t as b,a0 as V,bA as w,be as z,a$ as x,bo as C,a6 as q,aB as I,bi as U,I as j,L as E,bB as D,bC as $,bD as M,bE as R,bF as F,bG as S,aD as P,i as T,bw as B,bH as O,bI as N}from"./index.js";import{L}from"./Loading-D6byd8bp.js";import"./DocumentPreview.vue_vue_type_style_index_0_scoped_e3ac2352_lang-aAcHzWd0.js";/* empty css                *//* empty css                   *//* empty css                 */import"./el-alert-CXP7XODY.js";import{c as Q}from"./company-DNfURC7c.js";import{E as A,a as G}from"./el-form-item-BSZXyn1L.js";/* empty css                 */import{E as J}from"./el-input-number-Bd1Iq8-1.js";import{E as Y,a as W}from"./el-select-zgwPLghA.js";import"./el-scrollbar-COliMHv4.js";import{E as H,a as X}from"./el-col-DR3qk7qZ.js";import{b as K,E as Z,a as ee}from"./el-date-picker-panel-nEeC8MvB.js";import{C as ae}from"./Card-C_skTdco.js";import{E as le}from"./index-_IbxD8AI.js";import{E as te}from"./index-ELBiC1Q4.js";import{E as ie}from"./index-CUnJzTFi.js";import{a as ne,E as oe}from"./el-table-column-UElVgcNc.js";import"./el-checkbox-Chhrgelv.js";import"./raf-CXOaDqGI.js";import"./strings-DTuDRpJG.js";import"./omit-Czoq2i9Z.js";import"./_baseClone-DZAH0W8r.js";import"./index-DzZX4pf4.js";import"./castArray-pal66jBx.js";import"./dayjs.min-62TF2vD4.js";import"./refs-Cw5r5QN8.js";const se={class:"basic-info-tab"},ue=e(t({__name:"BasicInfoTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:a}){const l=e,t=a,{success:y,error:g}=i(),h=n(),k=n(!1),b=n({company_name:"",establish_date:"",legal_representative:"",legal_representative_position:"",legal_representative_gender:"",legal_representative_age:void 0,social_credit_code:"",registered_capital:"",company_type:"",registered_address:"",fixed_phone:"",fax:"",postal_code:"",email:"",business_scope:"",description:""}),V={company_name:[{required:!0,message:"请输入企业名称",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],postal_code:[{pattern:/^\d{6}$/,message:"邮政编码必须是6位数字",trigger:"blur"}]};o(()=>l.companyData,e=>{e&&(b.value={company_name:e.company_name||"",establish_date:e.establish_date||"",legal_representative:e.legal_representative||"",legal_representative_position:e.legal_representative_position||"",legal_representative_gender:e.legal_representative_gender||"",legal_representative_age:e.legal_representative_age||void 0,social_credit_code:e.social_credit_code||"",registered_capital:e.registered_capital||"",company_type:e.company_type||"",registered_address:e.registered_address||"",fixed_phone:e.fixed_phone||"",fax:e.fax||"",postal_code:e.postal_code||"",email:e.email||"",business_scope:e.business_scope||"",description:e.description||""})},{immediate:!0,deep:!0});const w=async()=>{h.value&&await h.value.validate(async e=>{if(e){k.value=!0;try{(await Q.updateCompany(l.companyId,{companyName:b.value.company_name,establishDate:b.value.establish_date,legalRepresentative:b.value.legal_representative,legalRepresentativePosition:b.value.legal_representative_position,legalRepresentativeGender:b.value.legal_representative_gender,legalRepresentativeAge:b.value.legal_representative_age,socialCreditCode:b.value.social_credit_code,registeredCapital:b.value.registered_capital,companyType:b.value.company_type,registeredAddress:b.value.registered_address,fixedPhone:b.value.fixed_phone,fax:b.value.fax,postalCode:b.value.postal_code,email:b.value.email,businessScope:b.value.business_scope,companyDescription:b.value.description})).success&&(y("保存成功","基础信息已更新"),t("update"))}catch(a){g("保存失败",a instanceof Error?a.message:"未知错误")}finally{k.value=!1}}})};return(e,a)=>{const l=p,t=G,i=X,n=K,o=H,y=W,g=Y,z=J,x=f,C=_,q=A;return u(),s("div",se,[d(r(ae),{title:"基础信息"},{default:c(()=>[d(q,{ref_key:"formRef",ref:h,model:b.value,rules:V,"label-width":"140px",class:"basic-form"},{default:c(()=>[d(o,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"企业名称",prop:"company_name"},{default:c(()=>[d(l,{modelValue:b.value.company_name,"onUpdate:modelValue":a[0]||(a[0]=e=>b.value.company_name=e),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"成立日期",prop:"establish_date"},{default:c(()=>[d(n,{modelValue:b.value.establish_date,"onUpdate:modelValue":a[1]||(a[1]=e=>b.value.establish_date=e),type:"date",placeholder:"选择日期",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"法定代表人",prop:"legal_representative"},{default:c(()=>[d(l,{modelValue:b.value.legal_representative,"onUpdate:modelValue":a[2]||(a[2]=e=>b.value.legal_representative=e),placeholder:"请输入法定代表人"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"法定代表人职务",prop:"legal_representative_position"},{default:c(()=>[d(l,{modelValue:b.value.legal_representative_position,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value.legal_representative_position=e),placeholder:"请输入职务"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"法定代表人性别",prop:"legal_representative_gender"},{default:c(()=>[d(g,{modelValue:b.value.legal_representative_gender,"onUpdate:modelValue":a[4]||(a[4]=e=>b.value.legal_representative_gender=e),placeholder:"请选择性别",style:{width:"100%"}},{default:c(()=>[d(y,{label:"男",value:"男"}),d(y,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"法定代表人年龄",prop:"legal_representative_age"},{default:c(()=>[d(z,{modelValue:b.value.legal_representative_age,"onUpdate:modelValue":a[5]||(a[5]=e=>b.value.legal_representative_age=e),min:18,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"统一社会信用代码",prop:"social_credit_code"},{default:c(()=>[d(l,{modelValue:b.value.social_credit_code,"onUpdate:modelValue":a[6]||(a[6]=e=>b.value.social_credit_code=e),placeholder:"请输入统一社会信用代码"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"注册资本",prop:"registered_capital"},{default:c(()=>[d(l,{modelValue:b.value.registered_capital,"onUpdate:modelValue":a[7]||(a[7]=e=>b.value.registered_capital=e),placeholder:"如：1000万元"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"企业类型",prop:"company_type"},{default:c(()=>[d(l,{modelValue:b.value.company_type,"onUpdate:modelValue":a[8]||(a[8]=e=>b.value.company_type=e),placeholder:"如：有限责任公司"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"注册地址",prop:"registered_address"},{default:c(()=>[d(l,{modelValue:b.value.registered_address,"onUpdate:modelValue":a[9]||(a[9]=e=>b.value.registered_address=e),placeholder:"请输入注册地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"联系电话",prop:"fixed_phone"},{default:c(()=>[d(l,{modelValue:b.value.fixed_phone,"onUpdate:modelValue":a[10]||(a[10]=e=>b.value.fixed_phone=e),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"传真",prop:"fax"},{default:c(()=>[d(l,{modelValue:b.value.fax,"onUpdate:modelValue":a[11]||(a[11]=e=>b.value.fax=e),placeholder:"请输入传真"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"邮政编码",prop:"postal_code"},{default:c(()=>[d(l,{modelValue:b.value.postal_code,"onUpdate:modelValue":a[12]||(a[12]=e=>b.value.postal_code=e),placeholder:"请输入邮政编码",maxlength:"6"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"电子邮箱",prop:"email"},{default:c(()=>[d(l,{modelValue:b.value.email,"onUpdate:modelValue":a[13]||(a[13]=e=>b.value.email=e),placeholder:"请输入电子邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,null,{default:c(()=>[d(i,{span:24},{default:c(()=>[d(t,{label:"经营范围",prop:"business_scope"},{default:c(()=>[d(l,{modelValue:b.value.business_scope,"onUpdate:modelValue":a[14]||(a[14]=e=>b.value.business_scope=e),type:"textarea",rows:5,placeholder:"请输入经营范围"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,null,{default:c(()=>[d(i,{span:24},{default:c(()=>[d(t,{label:"企业简介",prop:"description"},{default:c(()=>[d(l,{modelValue:b.value.description,"onUpdate:modelValue":a[15]||(a[15]=e=>b.value.description=e),type:"textarea",rows:5,placeholder:"请输入企业简介"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(o,null,{default:c(()=>[d(i,{span:24},{default:c(()=>[d(t,null,{default:c(()=>[d(C,{type:"primary",loading:k.value,onClick:w},{default:c(()=>[d(x,null,{default:c(()=>[d(r(v))]),_:1}),a[16]||(a[16]=m(" 保存基础信息 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),[["__scopeId","data-v-cf1705e1"]]),de={class:"card-header"},re={class:"qual-info"},ce={class:"qual-name"},pe={class:"badges"},_e={key:0,class:"file-status"},me={key:0,class:"single-file"},fe={class:"file-item"},ve={class:"file-details"},ye={class:"file-name"},ge={class:"file-meta"},he={class:"file-actions"},ke={key:1,class:"multiple-files"},be={class:"file-details"},Ve={class:"file-name"},we={class:"file-meta"},ze={class:"file-actions"},xe={key:1,class:"no-file"},Ce={class:"card-footer"},qe=["accept","multiple"],Ie=e(t({__name:"QualificationCard",props:{qualification:{},fileInfo:{},isCustom:{type:Boolean}},emits:["upload","download","delete","remove-custom"],setup(e,{emit:a}){const l=e,t=a,i=n(),o=y(()=>!!l.fileInfo&&(l.fileInfo.allow_multiple_files?l.fileInfo.files&&l.fileInfo.files.length>0:!!l.fileInfo.original_filename)),p=y(()=>{var e,a;return(null==(e=l.fileInfo)?void 0:e.allow_multiple_files)&&(null==(a=l.fileInfo)?void 0:a.files)}),v=y(()=>"financial_audit_report"===l.qualification.key?".pdf,.xls,.xlsx":".pdf,.jpg,.jpeg,.png"),E=()=>{var e;null==(e=i.value)||e.click()},D=e=>{const a=e.target,i=a.files;i&&0!==i.length&&(l.qualification.allowMultiple?Array.from(i).forEach(e=>{t("upload",e)}):t("upload",i[0]),a.value="")},$=()=>{t("download",l.qualification.key)},M=()=>{t("delete",l.qualification.key)},R=e=>{if(!e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,a)*100)/100+" "+["B","KB","MB","GB"][a]},F=e=>{if(!e)return"";return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})};return(a,n)=>{const y=f,S=le,P=_,T=Z,B=te;return u(),g(B,{class:j(["qualification-card",{required:e.qualification.required,"has-file":o.value}])},{default:c(()=>[h("div",de,[h("div",re,[d(y,{class:"qual-icon",size:20},{default:c(()=>[(u(),g(k(e.qualification.icon)))]),_:1}),h("span",ce,b(e.qualification.name),1)]),h("div",pe,[e.qualification.required?(u(),g(S,{key:0,type:"warning",size:"small"},{default:c(()=>[...n[1]||(n[1]=[m("必需",-1)])]),_:1})):V("",!0),e.qualification.allowMultiple?(u(),g(S,{key:1,type:"info",size:"small"},{default:c(()=>[d(y,null,{default:c(()=>[d(r(w))]),_:1}),n[2]||(n[2]=m(" 多文件 ",-1))]),_:1})):V("",!0)])]),o.value?(u(),s("div",_e,[p.value?(u(),s("div",ke,[(u(!0),s(q,null,I(e.fileInfo.files,e=>(u(),s("div",{key:e.qualification_id,class:"file-item"},[d(y,{class:"file-icon"},{default:c(()=>[d(r(z))]),_:1}),h("div",be,[h("div",Ve,b(e.original_filename),1),h("div",we,[h("span",null,b(R(e.file_size)),1),n[4]||(n[4]=h("span",{class:"divider"},"•",-1)),h("span",null,b(F(e.upload_time)),1)])]),h("div",ze,[d(P,{text:"",type:"primary",size:"small",onClick:a=>{return i=e.qualification_id,void t("download",l.qualification.key,i);var i}},{default:c(()=>[d(y,null,{default:c(()=>[d(r(x))]),_:1})]),_:1},8,["onClick"]),d(P,{text:"",type:"danger",size:"small",onClick:a=>{return i=e.qualification_id,void t("delete",l.qualification.key,i);var i}},{default:c(()=>[d(y,null,{default:c(()=>[d(r(C))]),_:1})]),_:1},8,["onClick"])])]))),128))])):(u(),s("div",me,[h("div",fe,[d(y,{class:"file-icon"},{default:c(()=>[d(r(z))]),_:1}),h("div",ve,[h("div",ye,b(e.fileInfo.original_filename),1),h("div",ge,[h("span",null,b(R(e.fileInfo.file_size)),1),n[3]||(n[3]=h("span",{class:"divider"},"•",-1)),h("span",null,b(F(e.fileInfo.upload_time)),1)])]),h("div",he,[d(P,{text:"",type:"primary",size:"small",onClick:$},{default:c(()=>[d(y,null,{default:c(()=>[d(r(x))]),_:1})]),_:1}),d(P,{text:"",type:"danger",size:"small",onClick:M},{default:c(()=>[d(y,null,{default:c(()=>[d(r(C))]),_:1})]),_:1})])])]))])):(u(),s("div",xe,[d(T,{type:"info",size:"small"},{default:c(()=>[...n[5]||(n[5]=[m("未上传文件",-1)])]),_:1})])),h("div",Ce,[h("input",{ref_key:"fileInputRef",ref:i,type:"file",accept:v.value,multiple:e.qualification.allowMultiple,style:{display:"none"},onChange:D},null,40,qe),d(P,{type:"primary",size:"small",onClick:E},{default:c(()=>[d(y,null,{default:c(()=>[d(r(U))]),_:1}),m(" "+b(e.qualification.allowMultiple?"批量上传":"上传文件"),1)]),_:1}),e.isCustom?(u(),g(P,{key:0,type:"danger",size:"small",onClick:n[0]||(n[0]=e=>a.$emit("remove-custom"))},{default:c(()=>[d(y,null,{default:c(()=>[d(r(C))]),_:1}),n[6]||(n[6]=m(" 移除 ",-1))]),_:1})):V("",!0)])]),_:1},8,["class"])}}}),[["__scopeId","data-v-f691c11d"]]),Ue={class:"qualification-tab"},je={key:1},Ee={class:"qualification-category"},De={class:"category-title text-secondary"},$e=e(t({__name:"QualificationTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:a}){const l=e,t=a,{success:o,error:v}=i(),y=n(!1),k=n({}),w=n([]),z=n(!1),x=n({name:""}),C=[{key:"basic",name:"基本证件资质",color:"primary"},{key:"iso",name:"ISO体系认证",color:"success"},{key:"credit",name:"信用资质证明",color:"info"},{key:"industry",name:"行业专业资质",color:"danger"}],U=[{key:"business_license",name:"营业执照",icon:"Document",category:"basic",required:!0},{key:"bank_account_permit",name:"银行开户许可证",icon:"CreditCard",category:"basic"},{key:"tax_registration",name:"税务登记证",icon:"DocumentChecked",category:"basic"},{key:"iso9001",name:"ISO 9001质量管理体系认证",icon:"Medal",category:"iso"},{key:"iso14001",name:"ISO 14001环境管理体系认证",icon:"Medal",category:"iso"},{key:"iso27001",name:"ISO 27001信息安全管理体系认证",icon:"Lock",category:"iso"},{key:"iso20000",name:"ISO 20000 IT服务管理体系认证",icon:"Monitor",category:"iso"},{key:"dishonest_executor",name:"失信被执行人名单（信用中国）",icon:"WarningFilled",category:"credit"},{key:"tax_violation_check",name:"重大税收违法案件当事人名单（信用中国）",icon:"WarningFilled",category:"credit"},{key:"gov_procurement_creditchina",name:"政府采购严重违法失信（信用中国）",icon:"Flag",category:"credit"},{key:"gov_procurement_ccgp",name:"政府采购严重违法失信行为信息记录（政府采购网）",icon:"CircleCheck",category:"credit"},{key:"basic_telecom_permit",name:"基础电信业务许可证",icon:"PhoneFilled",category:"industry"},{key:"value_added_telecom_permit",name:"增值电信业务许可证",icon:"PhoneFilled",category:"industry"},{key:"software_copyright",name:"软件著作权登记证书",icon:"Document",category:"industry",allowMultiple:!0},{key:"patent_certificate",name:"专利证书",icon:"TrophyBase",category:"industry",allowMultiple:!0},{key:"high_tech",name:"高新技术企业证书",icon:"Star",category:"industry"},{key:"software_enterprise",name:"软件企业认定证书",icon:"Monitor",category:"industry"},{key:"cmmi",name:"CMMI成熟度等级证书",icon:"Trophy",category:"industry"}],M=async()=>{y.value=!0;try{const e=await Q.getCompanyQualifications(l.companyId);e.success&&e.data&&(k.value=e.data)}catch(e){v("加载失败",e instanceof Error?e.message:"未知错误")}finally{y.value=!1}},R=async(e,a)=>{try{const i=new FormData;i.append(`qualifications[${e}]`,a);const n=U.find(a=>a.key===e)||w.value.find(a=>a.key===e);n&&i.append("qualification_names",JSON.stringify({[e]:n.name}));(await Q.uploadQualification(l.companyId,e,a,{})).success&&(o("上传成功",`${(null==n?void 0:n.name)||"资质文件"}上传成功`),await M(),t("update"))}catch(i){v("上传失败",i instanceof Error?i.message:"未知错误")}},F=async(e,a)=>{try{a?await Q.downloadQualification(a,""):window.open(`/api/companies/${l.companyId}/qualifications/${e}/download`)}catch(t){v("下载失败",t instanceof Error?t.message:"未知错误")}},S=async(e,a)=>{try{if(!confirm("确定要删除此资质文件吗？"))return;if(a)await Q.deleteQualification(a);else{if(!(await fetch(`/api/companies/${l.companyId}/qualifications/${e}`,{method:"DELETE"})).ok)throw new Error("删除失败")}o("删除成功","资质文件已删除"),await M(),t("update")}catch(i){v("删除失败",i instanceof Error?i.message:"未知错误")}},P=()=>{x.value.name="",z.value=!0},T=()=>{if(!x.value.name.trim())return void v("错误","请输入资质名称");const e=`custom_${Date.now()}`;w.value.push({key:e,name:x.value.name.trim(),icon:"Document",category:"custom"}),z.value=!1,o("添加成功","自定义资质已添加")};return E(()=>{M()}),(e,a)=>{const l=f,t=X,i=H,n=_,v=p,E=G,M=A,B=ie;return u(),s("div",Ue,[d(r(ae),{title:"资质信息管理"},{default:c(()=>[y.value?(u(),g(r(L),{key:0,text:"加载资质信息..."})):(u(),s("div",je,[(u(),s(q,null,I(C,e=>h("div",{key:e.key,class:"qualification-category"},[h("h6",{class:j(["category-title",`text-${e.color}`])},[d(l,null,{default:c(()=>[d(r($))]),_:1}),m(" "+b(e.name),1)],2),d(i,{gutter:16},{default:c(()=>{return[(u(!0),s(q,null,I((a=e.key,U.filter(e=>e.category===a)),e=>(u(),g(t,{key:e.key,span:12},{default:c(()=>[d(Ie,{qualification:e,"file-info":k.value[e.key],onUpload:a=>R(e.key,a),onDownload:F,onDelete:S},null,8,["qualification","file-info","onUpload"])]),_:2},1024))),128))];var a}),_:2},1024)])),64)),h("div",Ee,[h("h6",De,[d(l,null,{default:c(()=>[d(r(D))]),_:1}),a[3]||(a[3]=m(" 自定义资质 ",-1))]),d(n,{type:"primary",onClick:P},{default:c(()=>[d(l,null,{default:c(()=>[d(r(D))]),_:1}),a[4]||(a[4]=m(" 添加自定义资质 ",-1))]),_:1}),w.value.length>0?(u(),g(i,{key:0,gutter:16,class:"mt-3"},{default:c(()=>[(u(!0),s(q,null,I(w.value,(e,a)=>(u(),g(t,{key:e.key,span:12},{default:c(()=>[d(Ie,{qualification:e,"file-info":k.value[e.key],"is-custom":!0,onUpload:a=>R(e.key,a),onDownload:F,onDelete:S,onRemoveCustom:e=>(e=>{confirm("确定要移除此自定义资质吗？")&&(w.value.splice(e,1),o("移除成功","自定义资质已移除"))})(a)},null,8,["qualification","file-info","onUpload","onRemoveCustom"])]),_:2},1024))),128))]),_:1})):V("",!0)])]))]),_:1}),d(B,{modelValue:z.value,"onUpdate:modelValue":a[2]||(a[2]=e=>z.value=e),title:"添加自定义资质",width:"400px"},{footer:c(()=>[d(n,{onClick:a[1]||(a[1]=e=>z.value=!1)},{default:c(()=>[...a[5]||(a[5]=[m("取消",-1)])]),_:1}),d(n,{type:"primary",onClick:T},{default:c(()=>[...a[6]||(a[6]=[m("确定",-1)])]),_:1})]),default:c(()=>[d(M,{model:x.value,"label-width":"100px"},{default:c(()=>[d(E,{label:"资质名称"},{default:c(()=>[d(v,{modelValue:x.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>x.value.name=e),placeholder:"请输入资质名称",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-1eac8d5a"]]),Me={class:"personnel-tab"},Re={class:"attachments-grid"},Fe={class:"attachment-item"},Se={class:"attachment-header"},Pe={key:0,class:"file-info"},Te={class:"file-name"},Be={class:"file-actions"},Oe={key:1,class:"no-file"},Ne={class:"attachment-item"},Le={class:"attachment-header"},Qe={key:0,class:"file-info"},Ae={class:"file-name"},Ge={class:"file-actions"},Je={key:1,class:"no-file"},Ye={class:"attachment-item"},We={class:"attachment-header"},He={key:0,class:"file-info"},Xe={class:"file-name"},Ke={class:"file-actions"},Ze={key:1,class:"no-file"},ea={class:"attachment-item"},aa={class:"attachment-header"},la={key:0,class:"file-info"},ta={class:"file-name"},ia={class:"file-actions"},na={key:1,class:"no-file"},oa=e(t({__name:"PersonnelTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:a}){const l=e,t=a,{success:y,error:g}=i(),k=n(),V=n(),w=n(),q=n(),I=n(),j=n(!1),D=n({authorized_person_name:"",authorized_person_id:"",authorized_person_gender:"",authorized_person_age:void 0,authorized_person_position:"",authorized_person_title:""}),$=n({id_card_front:null,id_card_back:null,manager_resume:null,social_security:null}),S={authorized_person_id:[{pattern:/^[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/,message:"请输入正确的身份证号",trigger:"blur"}]};o(()=>l.companyData,e=>{e&&(D.value={authorized_person_name:e.authorized_person_name||"",authorized_person_id:e.authorized_person_id||"",authorized_person_gender:e.authorized_person_gender||"",authorized_person_age:e.authorized_person_age||void 0,authorized_person_position:e.authorized_person_position||"",authorized_person_title:e.authorized_person_title||""})},{immediate:!0,deep:!0});const P=async()=>{k.value&&await k.value.validate(async e=>{if(e){j.value=!0;try{(await Q.updateCompany(l.companyId,{authorizedPersonName:D.value.authorized_person_name,authorizedPersonId:D.value.authorized_person_id,authorizedPersonGender:D.value.authorized_person_gender,authorizedPersonAge:D.value.authorized_person_age,authorizedPersonPosition:D.value.authorized_person_position,authorizedPersonTitle:D.value.authorized_person_title})).success&&(y("保存成功","被授权人信息已更新"),t("update"))}catch(a){g("保存失败",a instanceof Error?a.message:"未知错误")}finally{j.value=!1}}})},T=async(e,a)=>{var i;const n=a.target,o=null==(i=n.files)?void 0:i[0];if(o)try{(await Q.uploadQualification(l.companyId,e,o,{})).success&&(y("上传成功","附件上传成功"),N(),t("update"))}catch(s){g("上传失败",s instanceof Error?s.message:"未知错误")}finally{n.value=""}},B=e=>{window.open(`/api/companies/${l.companyId}/qualifications/${e}/download`)},O=async e=>{if(confirm("确定要删除此附件吗？"))try{if(!(await fetch(`/api/companies/${l.companyId}/qualifications/${e}`,{method:"DELETE"})).ok)throw new Error("删除失败");y("删除成功","附件已删除"),N(),t("update")}catch(a){g("删除失败",a instanceof Error?a.message:"未知错误")}},N=async()=>{try{const e=await Q.getCompanyQualifications(l.companyId);if(e.success&&e.data){const a=e.data;$.value={id_card_front:a.id_card_front?{name:a.id_card_front.original_filename}:null,id_card_back:a.id_card_back?{name:a.id_card_back.original_filename}:null,manager_resume:a.manager_resume?{name:a.manager_resume.original_filename}:null,social_security:a.social_security?{name:a.social_security.original_filename}:null}}}catch(e){}};return E(()=>{N()}),(e,a)=>{const l=p,t=G,i=X,n=H,o=W,y=Y,g=J,E=f,N=_,L=A;return u(),s("div",Me,[d(r(ae),{title:"被授权人基本信息"},{default:c(()=>[d(L,{ref_key:"formRef",ref:k,model:D.value,rules:S,"label-width":"140px",class:"personnel-form"},{default:c(()=>[d(n,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"姓名",prop:"authorized_person_name"},{default:c(()=>[d(l,{modelValue:D.value.authorized_person_name,"onUpdate:modelValue":a[0]||(a[0]=e=>D.value.authorized_person_name=e),placeholder:"请输入被授权人姓名"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"身份证号",prop:"authorized_person_id"},{default:c(()=>[d(l,{modelValue:D.value.authorized_person_id,"onUpdate:modelValue":a[1]||(a[1]=e=>D.value.authorized_person_id=e),placeholder:"请输入身份证号",maxlength:"18"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(n,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"性别",prop:"authorized_person_gender"},{default:c(()=>[d(y,{modelValue:D.value.authorized_person_gender,"onUpdate:modelValue":a[2]||(a[2]=e=>D.value.authorized_person_gender=e),placeholder:"请选择性别",style:{width:"100%"}},{default:c(()=>[d(o,{label:"男",value:"男"}),d(o,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"年龄",prop:"authorized_person_age"},{default:c(()=>[d(g,{modelValue:D.value.authorized_person_age,"onUpdate:modelValue":a[3]||(a[3]=e=>D.value.authorized_person_age=e),min:18,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(n,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(t,{label:"职位",prop:"authorized_person_position"},{default:c(()=>[d(l,{modelValue:D.value.authorized_person_position,"onUpdate:modelValue":a[4]||(a[4]=e=>D.value.authorized_person_position=e),placeholder:"请输入职位"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(t,{label:"职称",prop:"authorized_person_title"},{default:c(()=>[d(l,{modelValue:D.value.authorized_person_title,"onUpdate:modelValue":a[5]||(a[5]=e=>D.value.authorized_person_title=e),placeholder:"请输入职称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(n,null,{default:c(()=>[d(i,{span:24},{default:c(()=>[d(t,null,{default:c(()=>[d(N,{type:"primary",loading:j.value,onClick:P},{default:c(()=>[d(E,null,{default:c(()=>[d(r(v))]),_:1}),a[22]||(a[22]=m(" 保存被授权人信息 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),d(r(ae),{title:"相关附件",class:"mt-4"},{default:c(()=>[h("div",Re,[h("div",Fe,[h("div",Se,[d(E,{class:"icon"},{default:c(()=>[d(r(M))]),_:1}),a[23]||(a[23]=h("span",{class:"title"},"被授权人身份证（正面）",-1))]),$.value.id_card_front?(u(),s("div",Pe,[d(E,{class:"file-icon"},{default:c(()=>[d(r(z))]),_:1}),h("span",Te,b($.value.id_card_front.name),1),h("div",Be,[d(N,{text:"",type:"primary",size:"small",onClick:a[6]||(a[6]=e=>B("id_card_front"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(x))]),_:1})]),_:1}),d(N,{text:"",type:"danger",size:"small",onClick:a[7]||(a[7]=e=>O("id_card_front"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(C))]),_:1})]),_:1})])])):(u(),s("div",Oe,"未上传")),h("input",{ref_key:"idCardFrontRef",ref:V,type:"file",accept:".jpg,.jpeg,.png,.pdf",style:{display:"none"},onChange:a[8]||(a[8]=e=>T("id_card_front",e))},null,544),d(N,{size:"small",onClick:a[9]||(a[9]=e=>{var a;return null==(a=V.value)?void 0:a.click()})},{default:c(()=>[d(E,null,{default:c(()=>[d(r(U))]),_:1}),a[24]||(a[24]=m(" 上传文件 ",-1))]),_:1})]),h("div",Ne,[h("div",Le,[d(E,{class:"icon"},{default:c(()=>[d(r(M))]),_:1}),a[25]||(a[25]=h("span",{class:"title"},"被授权人身份证（反面）",-1))]),$.value.id_card_back?(u(),s("div",Qe,[d(E,{class:"file-icon"},{default:c(()=>[d(r(z))]),_:1}),h("span",Ae,b($.value.id_card_back.name),1),h("div",Ge,[d(N,{text:"",type:"primary",size:"small",onClick:a[10]||(a[10]=e=>B("id_card_back"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(x))]),_:1})]),_:1}),d(N,{text:"",type:"danger",size:"small",onClick:a[11]||(a[11]=e=>O("id_card_back"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(C))]),_:1})]),_:1})])])):(u(),s("div",Je,"未上传")),h("input",{ref_key:"idCardBackRef",ref:w,type:"file",accept:".jpg,.jpeg,.png,.pdf",style:{display:"none"},onChange:a[12]||(a[12]=e=>T("id_card_back",e))},null,544),d(N,{size:"small",onClick:a[13]||(a[13]=e=>{var a;return null==(a=w.value)?void 0:a.click()})},{default:c(()=>[d(E,null,{default:c(()=>[d(r(U))]),_:1}),a[26]||(a[26]=m(" 上传文件 ",-1))]),_:1})]),h("div",Ye,[h("div",We,[d(E,{class:"icon"},{default:c(()=>[d(r(R))]),_:1}),a[27]||(a[27]=h("span",{class:"title"},"项目经理简历",-1))]),$.value.manager_resume?(u(),s("div",He,[d(E,{class:"file-icon"},{default:c(()=>[d(r(z))]),_:1}),h("span",Xe,b($.value.manager_resume.name),1),h("div",Ke,[d(N,{text:"",type:"primary",size:"small",onClick:a[14]||(a[14]=e=>B("manager_resume"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(x))]),_:1})]),_:1}),d(N,{text:"",type:"danger",size:"small",onClick:a[15]||(a[15]=e=>O("manager_resume"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(C))]),_:1})]),_:1})])])):(u(),s("div",Ze,"未上传")),h("input",{ref_key:"managerResumeRef",ref:q,type:"file",accept:".pdf,.doc,.docx",style:{display:"none"},onChange:a[16]||(a[16]=e=>T("manager_resume",e))},null,544),d(N,{size:"small",onClick:a[17]||(a[17]=e=>{var a;return null==(a=q.value)?void 0:a.click()})},{default:c(()=>[d(E,null,{default:c(()=>[d(r(U))]),_:1}),a[28]||(a[28]=m(" 上传文件 ",-1))]),_:1})]),h("div",ea,[h("div",aa,[d(E,{class:"icon"},{default:c(()=>[d(r(F))]),_:1}),a[29]||(a[29]=h("span",{class:"title"},"社保证明",-1))]),$.value.social_security?(u(),s("div",la,[d(E,{class:"file-icon"},{default:c(()=>[d(r(z))]),_:1}),h("span",ta,b($.value.social_security.name),1),h("div",ia,[d(N,{text:"",type:"primary",size:"small",onClick:a[18]||(a[18]=e=>B("social_security"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(x))]),_:1})]),_:1}),d(N,{text:"",type:"danger",size:"small",onClick:a[19]||(a[19]=e=>O("social_security"))},{default:c(()=>[d(E,null,{default:c(()=>[d(r(C))]),_:1})]),_:1})])])):(u(),s("div",na,"未上传")),h("input",{ref_key:"socialSecurityRef",ref:I,type:"file",accept:".pdf,.jpg,.jpeg,.png",style:{display:"none"},onChange:a[20]||(a[20]=e=>T("social_security",e))},null,544),d(N,{size:"small",onClick:a[21]||(a[21]=e=>{var a;return null==(a=I.value)?void 0:a.click()})},{default:c(()=>[d(E,null,{default:c(()=>[d(r(U))]),_:1}),a[30]||(a[30]=m(" 上传文件 ",-1))]),_:1})])])]),_:1})])}}}),[["__scopeId","data-v-bb80303a"]]),sa={class:"financial-tab"},ua={class:"shareholders-section"},da={class:"section-header"},ra={class:"save-section"},ca=e(t({__name:"FinancialTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:a}){const l=e,t=a,{success:y,error:k}=i(),b=n(),V=n(),w=n(),x=n(),C=n(!1),U=n(!1),j=n([{key:"audit_report",name:"财务审计报告",icon:z,required:!1,allowMultiple:!0},{key:"taxpayer_certificate",name:"纳税人资格证明",icon:S,required:!1,allowMultiple:!1}]),$=n({}),M=n({bank_name:"",bank_account:""}),R=n({actual_controller:"",controlling_shareholder:""}),F=n({managing_unit_name:"",managed_unit_name:""}),P=n([]),T=n(!1),B=n(-1),O=n({name:"",type:"",ratio:""}),N={name:[{required:!0,message:"请输入股东名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],ratio:[{required:!0,message:"请输入出资比例",trigger:"blur"}]};o(()=>l.companyData,e=>{if(e){M.value={bank_name:e.bank_name||"",bank_account:e.bank_account||""},R.value={actual_controller:e.actual_controller||"",controlling_shareholder:e.controlling_shareholder||""},F.value={managing_unit_name:e.managing_unit_name||"",managed_unit_name:e.managed_unit_name||""};try{const a=e.shareholders_info;a&&(P.value="string"==typeof a?JSON.parse(a):a)}catch(a){P.value=[]}}},{immediate:!0,deep:!0});const L=()=>{B.value=-1,O.value={name:"",type:"",ratio:""},T.value=!0},J=async()=>{x.value&&await x.value.validate(e=>{e&&(-1===B.value?(P.value.push({...O.value}),y("添加成功","股东已添加，请点击保存按钮保存更改")):(P.value[B.value]={...O.value},y("编辑成功","股东信息已更新，请点击保存按钮保存更改")),T.value=!1)})},K=async()=>{try{U.value=!0;const e=await Q.getCompanyQualifications(l.companyId);e.success&&($.value=e.data||{})}catch(e){}finally{U.value=!1}},Z=async(e,a)=>{try{let t;t=a?`/api/qualifications/${a}/download`:`/api/companies/${l.companyId}/qualifications/${e}/download`,window.open(t,"_blank")}catch(t){k("下载失败",t instanceof Error?t.message:"未知错误")}},le=async(e,a)=>{try{if(!confirm("确定要删除此资质文件吗？"))return;if(a)await Q.deleteQualification(a);else{if(!(await fetch(`/api/companies/${l.companyId}/qualifications/${e}`,{method:"DELETE"})).ok)throw new Error("删除失败")}y("删除成功","资质文件已删除"),await K(),t("update")}catch(i){k("删除失败",i instanceof Error?i.message:"未知错误")}},te=async()=>{C.value=!0;try{(await Q.updateCompany(l.companyId,{bank_name:M.value.bank_name,bank_account:M.value.bank_account,actual_controller:R.value.actual_controller,controlling_shareholder:R.value.controlling_shareholder,shareholders_info:JSON.stringify(P.value),managing_unit_name:F.value.managing_unit_name,managed_unit_name:F.value.managed_unit_name})).success&&(y("保存成功","财务信息已更新"),t("update"))}catch(e){k("保存失败",e instanceof Error?e.message:"未知错误")}finally{C.value=!1}};return E(()=>{K()}),(e,a)=>{const i=X,n=H,o=p,z=G,U=A,E=f,S=_,Q=ne,se=oe,ue=ee,de=W,re=Y,ce=ie;return u(),s("div",sa,[d(r(ae),{title:"财务资质文件",class:"mb-4"},{default:c(()=>[d(n,{gutter:20},{default:c(()=>[(u(!0),s(q,null,I(j.value,e=>(u(),g(i,{key:e.key,span:12},{default:c(()=>[d(Ie,{qualification:e,"file-info":$.value[e.key],onUpload:a=>(async(e,a)=>{try{const i=j.value.find(a=>a.key===e);let n=null;if(null==i?void 0:i.allowMultiple){if(n=prompt(`请输入 "${a.name}" 的年份:\n例如：2023、2024`),null===n)return;if(!n.trim())return void k("上传失败","年份不能为空")}const o=new FormData;o.append(`qualifications[${e}]`,a),o.append("qualification_names",JSON.stringify({[e]:(null==i?void 0:i.name)||e})),n&&o.append("file_versions",JSON.stringify({[e]:n.trim()}));const s=await fetch(`/api/companies/${l.companyId}/qualifications/upload`,{method:"POST",body:o}),u=await s.json();if(!u.success)throw new Error(u.error||"上传失败");y("上传成功",`${(null==i?void 0:i.name)||"资质文件"}上传成功`),await K(),t("update")}catch(i){k("上传失败",i instanceof Error?i.message:"未知错误")}})(e.key,a),onDownload:Z,onDelete:le},null,8,["qualification","file-info","onUpload"])]),_:2},1024))),128))]),_:1})]),_:1}),d(r(ae),{title:"银行账户信息"},{default:c(()=>[d(U,{ref_key:"bankFormRef",ref:b,model:M.value,"label-width":"140px",class:"bank-form"},{default:c(()=>[d(n,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(z,{label:"开户行全称"},{default:c(()=>[d(o,{modelValue:M.value.bank_name,"onUpdate:modelValue":a[0]||(a[0]=e=>M.value.bank_name=e),placeholder:"请输入开户行全称"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(z,{label:"银行账号"},{default:c(()=>[d(o,{modelValue:M.value.bank_account,"onUpdate:modelValue":a[1]||(a[1]=e=>M.value.bank_account=e),placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),d(r(ae),{title:"股权结构信息",class:"mt-4"},{default:c(()=>[d(U,{ref_key:"equityFormRef",ref:V,model:R.value,"label-width":"140px",class:"equity-form"},{default:c(()=>[d(n,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(z,{label:"实际控制人"},{default:c(()=>[d(o,{modelValue:R.value.actual_controller,"onUpdate:modelValue":a[2]||(a[2]=e=>R.value.actual_controller=e),placeholder:"请输入实际控制人"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(z,{label:"控股股东"},{default:c(()=>[d(o,{modelValue:R.value.controlling_shareholder,"onUpdate:modelValue":a[3]||(a[3]=e=>R.value.controlling_shareholder=e),placeholder:"请输入控股股东"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),h("div",ua,[h("div",da,[a[12]||(a[12]=h("h6",null,"股东/投资人列表",-1)),d(S,{type:"primary",size:"small",onClick:L},{default:c(()=>[d(E,null,{default:c(()=>[d(r(D))]),_:1}),a[11]||(a[11]=m(" 添加股东 ",-1))]),_:1})]),P.value.length>0?(u(),g(se,{key:0,data:P.value,stripe:""},{default:c(()=>[d(Q,{prop:"name",label:"股东名称","min-width":"150"}),d(Q,{prop:"type",label:"类型",width:"100"}),d(Q,{prop:"ratio",label:"出资比例",width:"120"}),d(Q,{label:"操作",width:"150"},{default:c(({row:e,$index:l})=>[d(S,{text:"",type:"primary",size:"small",onClick:e=>(e=>{B.value=e;const a=P.value[e];O.value={name:a.name,type:a.type,ratio:a.ratio},T.value=!0})(l)},{default:c(()=>[...a[13]||(a[13]=[m(" 编辑 ",-1)])]),_:1},8,["onClick"]),d(S,{text:"",type:"danger",size:"small",onClick:e=>{return a=l,void(confirm("确定要删除此股东吗？")&&(P.value.splice(a,1),y("删除成功","股东已删除，请点击保存按钮保存更改")));var a}},{default:c(()=>[...a[14]||(a[14]=[m(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(u(),g(ue,{key:1,description:"暂无股东信息","image-size":100}))])]),_:1}),d(r(ae),{title:"管理关系信息",class:"mt-4"},{default:c(()=>[d(U,{ref_key:"managementFormRef",ref:w,model:F.value,"label-width":"140px",class:"management-form"},{default:c(()=>[d(n,{gutter:20},{default:c(()=>[d(i,{span:12},{default:c(()=>[d(z,{label:"管理单位名称"},{default:c(()=>[d(o,{modelValue:F.value.managing_unit_name,"onUpdate:modelValue":a[4]||(a[4]=e=>F.value.managing_unit_name=e),placeholder:"如有管理单位请输入"},null,8,["modelValue"])]),_:1})]),_:1}),d(i,{span:12},{default:c(()=>[d(z,{label:"被管理单位名称"},{default:c(()=>[d(o,{modelValue:F.value.managed_unit_name,"onUpdate:modelValue":a[5]||(a[5]=e=>F.value.managed_unit_name=e),placeholder:"如有被管理单位请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),h("div",ra,[d(S,{type:"primary",size:"large",loading:C.value,onClick:te},{default:c(()=>[d(E,null,{default:c(()=>[d(r(v))]),_:1}),a[15]||(a[15]=m(" 保存财务信息 ",-1))]),_:1},8,["loading"])]),d(ce,{modelValue:T.value,"onUpdate:modelValue":a[10]||(a[10]=e=>T.value=e),title:-1===B.value?"添加股东":"编辑股东",width:"500px"},{footer:c(()=>[d(S,{onClick:a[9]||(a[9]=e=>T.value=!1)},{default:c(()=>[...a[16]||(a[16]=[m("取消",-1)])]),_:1}),d(S,{type:"primary",onClick:J},{default:c(()=>[...a[17]||(a[17]=[m("确定",-1)])]),_:1})]),default:c(()=>[d(U,{ref_key:"shareholderFormRef",ref:x,model:O.value,rules:N,"label-width":"100px"},{default:c(()=>[d(z,{label:"股东名称",prop:"name"},{default:c(()=>[d(o,{modelValue:O.value.name,"onUpdate:modelValue":a[6]||(a[6]=e=>O.value.name=e),placeholder:"请输入股东名称"},null,8,["modelValue"])]),_:1}),d(z,{label:"类型",prop:"type"},{default:c(()=>[d(re,{modelValue:O.value.type,"onUpdate:modelValue":a[7]||(a[7]=e=>O.value.type=e),placeholder:"请选择类型",style:{width:"100%"}},{default:c(()=>[d(de,{label:"企业",value:"企业"}),d(de,{label:"自然人",value:"自然人"})]),_:1},8,["modelValue"])]),_:1}),d(z,{label:"出资比例",prop:"ratio"},{default:c(()=>[d(o,{modelValue:O.value.ratio,"onUpdate:modelValue":a[8]||(a[8]=e=>O.value.ratio=e),placeholder:"如：30%"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-405da200"]]),pa={class:"company-detail"},_a={class:"detail-header"},ma={class:"header-title"},fa={key:1,class:"detail-content"},va={class:"tab-label"},ya={class:"tab-label"},ga={class:"tab-label"},ha={class:"tab-label"},ka=e(t({__name:"CompanyDetail",setup(e){const t=P(),o=T(),{error:p}=i(),v=n(!1),y=n("basic"),k=n(0),w=n({}),z={technology:"科技",manufacturing:"制造业",finance:"金融",education:"教育",healthcare:"医疗",retail:"零售",construction:"建筑",other:"其他"},x=async()=>{v.value=!0;try{const e=await Q.getCompany(k.value);e.success&&e.data?w.value=e.data:(p("加载失败","无法获取企业信息"),I())}catch(e){p("加载失败",e instanceof Error?e.message:"未知错误"),I()}finally{v.value=!1}},C=e=>{},q=async()=>{await x()},I=()=>{o.push("/knowledge/company")};return E(()=>{const e=t.params.id;if(e){if(k.value=parseInt(e,10),isNaN(k.value))return p("参数错误","无效的企业ID"),void I();x()}else p("参数错误","缺少企业ID"),I()}),(e,t)=>{const i=_,n=le,o=f,p=l,x=a;return u(),s("div",pa,[h("div",_a,[d(i,{onClick:I,icon:"ArrowLeft"},{default:c(()=>[...t[1]||(t[1]=[m("返回列表",-1)])]),_:1}),h("div",ma,[h("h2",null,b(w.value.company_name||"企业详情"),1),w.value.industry_type?(u(),g(n,{key:0,type:"info"},{default:c(()=>{return[m(b((e=w.value.industry_type,z[e]||e)),1)];var e}),_:1})):V("",!0)])]),v.value?(u(),g(r(L),{key:0,text:"加载企业信息中..."})):(u(),s("div",fa,[d(x,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=e=>y.value=e),class:"company-tabs",onTabChange:C},{default:c(()=>[d(p,{name:"basic"},{label:c(()=>[h("span",va,[d(o,null,{default:c(()=>[d(r(B))]),_:1}),t[2]||(t[2]=m(" 基础信息 ",-1))])]),default:c(()=>[d(ue,{"company-id":k.value,"company-data":w.value,onUpdate:q},null,8,["company-id","company-data"])]),_:1}),d(p,{name:"qualification"},{label:c(()=>[h("span",ya,[d(o,null,{default:c(()=>[d(r(O))]),_:1}),t[3]||(t[3]=m(" 资质信息 ",-1))])]),default:c(()=>[d($e,{"company-id":k.value,"company-data":w.value,onUpdate:q},null,8,["company-id","company-data"])]),_:1}),d(p,{name:"personnel"},{label:c(()=>[h("span",ga,[d(o,null,{default:c(()=>[d(r(R))]),_:1}),t[4]||(t[4]=m(" 被授权人信息 ",-1))])]),default:c(()=>[d(oa,{"company-id":k.value,"company-data":w.value,onUpdate:q},null,8,["company-id","company-data"])]),_:1}),d(p,{name:"financial"},{label:c(()=>[h("span",ha,[d(o,null,{default:c(()=>[d(r(N))]),_:1}),t[5]||(t[5]=m(" 财务信息 ",-1))])]),default:c(()=>[d(ca,{"company-id":k.value,"company-data":w.value,onUpdate:q},null,8,["company-id","company-data"])]),_:1})]),_:1},8,["modelValue"])]))])}}}),[["__scopeId","data-v-4557bbd0"]]);export{ka as default};
