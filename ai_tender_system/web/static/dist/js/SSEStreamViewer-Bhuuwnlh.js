import{n as e,m as a,o as t,F as n,G as s,A as o,H as r,E as i,_ as c}from"./index.js";/* empty css                             */import{ax as l,am as d,an as u,aZ as p,ay as m,aD as y,aA as f,aO as _,aF as g,aE as v,aB as k,aP as S,aG as w,az as b,aS as h,aI as x}from"./editor-6w6Zv5fp.js";import{E as j}from"./index-DuYxzNPz.js";/* empty css                                                                          */const C=["innerHTML"],L={key:0,class:"streaming-indicator"},B={key:0,class:"stream-actions"},E=c(l({__name:"SSEStreamViewer",props:{content:{},isStreaming:{type:Boolean,default:!1},enableMarkdown:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0}},emits:["stop","regenerate"],setup(c,{emit:l}){const E=c,H=l,R=d(null),M=u(()=>{if(!E.content)return"";if(E.enableMarkdown)try{return p.parse(E.content)}catch(e){return E.content}return E.content.replace(/\n/g,"<br>")});m(()=>E.content,async()=>{E.autoScroll&&E.isStreaming&&(await x(),T())});const T=()=>{R.value&&(R.value.scrollTop=R.value.scrollHeight)},U=async()=>{try{await navigator.clipboard.writeText(E.content),i.success("内容已复制到剪贴板")}catch(e){i.error("复制失败，请手动复制")}},F=()=>{try{const e=new Blob([E.content],{type:"text/plain;charset=utf-8"}),a=URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download=`ai-content-${Date.now()}.txt`,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(a),i.success("文档下载成功")}catch(e){i.error("下载失败，请重试")}};return(i,l)=>{const d=e,u=j,p=t;return f(),y("div",{class:_(["sse-stream-viewer",{"is-loading":c.isStreaming}])},[g(u,{class:"stream-content",shadow:"never"},{default:k(()=>[S("div",{ref_key:"contentRef",ref:R,class:"content-wrapper",innerHTML:M.value},null,8,C),c.isStreaming?(f(),y("div",L,[g(d,{class:"is-loading"},{default:k(()=>[g(w(a))]),_:1}),l[2]||(l[2]=S("span",null,"正在生成中...",-1))])):v("",!0)]),_:1}),c.content?(f(),y("div",B,[c.isStreaming?(f(),b(p,{key:0,type:"warning",icon:w(n),onClick:l[0]||(l[0]=e=>H("stop"))},{default:k(()=>[...l[3]||(l[3]=[h(" 停止生成 ",-1)])]),_:1},8,["icon"])):(f(),b(p,{key:1,type:"primary",icon:w(s),onClick:U},{default:k(()=>[...l[4]||(l[4]=[h(" 复制内容 ",-1)])]),_:1},8,["icon"])),!c.isStreaming&&c.content?(f(),b(p,{key:2,type:"success",icon:w(o),onClick:F},{default:k(()=>[...l[5]||(l[5]=[h(" 下载文档 ",-1)])]),_:1},8,["icon"])):v("",!0),!c.isStreaming&&c.content?(f(),b(p,{key:3,icon:w(r),onClick:l[1]||(l[1]=e=>H("regenerate"))},{default:k(()=>[...l[6]||(l[6]=[h(" 重新生成 ",-1)])]),_:1},8,["icon"])):v("",!0)])):v("",!0)],2)}}}),[["__scopeId","data-v-1badfff5"]]);export{E as S};
