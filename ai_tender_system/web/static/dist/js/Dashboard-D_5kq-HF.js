import{D as e,F as a,G as t,a as i,H as o,I as s,m as l,o as n,J as r}from"./vendor-element-plus-CEQaQHNc.js";import{d as c,b7 as d,r as u,b as p,P as f,M as m,c as g,N as v,I as b,O as _,F as h,V as y,Z as j,W as w,R as k,L as C,H as P}from"./vendor-vue-DnBj6vzG.js";import{u as x}from"./project-DRKLdxdD.js";import{a as T,_ as D}from"./index.js";import{t as M}from"./tender-ZYcn_VXM.js";import{d as z}from"./vendor-dayjs-CeOjnJlt.js";import{L as H}from"./Loading-fOFG7xAl.js";import{E as I}from"./Empty-BzPBqxja.js";/* empty css                                                                          */import{C as F}from"./Card-CKMHDauo.js";import{I as Y}from"./IconButton-t7rtXnWM.js";import"./vendor-other-CxXkF0Pk.js";import"./vendor-editor-CGvuleas.js";/* empty css                                                                        */import"./vendor-axios-BG7aBJwU.js";import"./vendor-echarts-C00rBISf.js";const A={class:"dashboard-page"},E={class:"quick-actions"},L=["onClick"],S={class:"action-label"},q={class:"pagination-wrapper"},B=D(c({__name:"Dashboard",setup(c){const D=d(),B=x(),{success:G,error:U,confirm:J}=T(),N=u(!1),O=u(!1),R=u({totalProjects:0,inProgressProjects:0,wonThisMonth:0,pendingTasks:0}),V=u([]),W=u(1),Z=u(10),$=u(0),K=[{name:"start-tender",label:"开始投标",icon:"bi bi-play-circle-fill",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",route:"/tender-management"},{name:"business-response",label:"商务应答",icon:"bi bi-briefcase-fill",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",route:"/business-response"},{name:"point-to-point",label:"点对点应答",icon:"bi bi-arrow-left-right",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",route:"/point-to-point"},{name:"tech-proposal",label:"技术方案",icon:"bi bi-file-code-fill",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",route:"/tech-proposal"},{name:"tender-scoring",label:"标书评分",icon:"bi bi-star-fill",color:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",route:"/tender-scoring"},{name:"knowledge",label:"知识中心",icon:"bi bi-book-fill",color:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",route:"/knowledge/company-library"}];async function Q(){O.value=!0;try{const e=await M.getProjects({page:W.value,page_size:Z.value});e.success&&e.data&&(Array.isArray(e.data)?(V.value=e.data,$.value=e.data.length):e.data.items&&(V.value=e.data.items,$.value=e.data.total||0))}catch(e){U("加载项目列表失败: "+e.message)}finally{O.value=!1}}async function X(){await Q(),G("刷新成功")}function ee(){D.push("/tender-management")}function ae(e){B.setCurrentProject(e),D.push({name:"TenderManagementDetail",params:{id:e.id}})}function te(e){Z.value=e,W.value=1,Q()}function ie(e){W.value=e,Q()}function oe(e){return{pending:"待处理",in_progress:"进行中",completed:"已完成",won:"已中标",lost:"未中标",archived:"已归档"}[e]||e}return p(()=>{!async function(){N.value=!0;try{const e=await M.getDashboardStatistics();e.success&&e.data&&(R.value={totalProjects:e.data.totalProjects,inProgressProjects:e.data.inProgressProjects,wonThisMonth:e.data.wonThisMonth,pendingTasks:e.data.pendingTasks})}catch(e){U("加载统计数据失败: "+e.message)}finally{N.value=!1}}(),Q()}),(c,d)=>{const u=a,p=e,x=t,T=i,M=l,se=s,le=n,ne=o,re=r;return m(),f("div",A,[g(x,{gutter:16,class:"kpi-cards"},{default:v(()=>[g(p,{xs:12,sm:12,md:6,lg:6},{default:v(()=>[g(b(F),{shadow:"hover",loading:N.value},{default:v(()=>[g(u,{title:"总项目数",value:R.value.totalProjects},{prefix:v(()=>[...d[2]||(d[2]=[_("i",{class:"bi bi-folder-fill statistic-icon",style:{color:"#409eff"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),g(p,{xs:12,sm:12,md:6,lg:6},{default:v(()=>[g(b(F),{shadow:"hover",loading:N.value},{default:v(()=>[g(u,{title:"进行中项目",value:R.value.inProgressProjects},{prefix:v(()=>[...d[3]||(d[3]=[_("i",{class:"bi bi-clock-fill statistic-icon",style:{color:"#e6a23c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),g(p,{xs:12,sm:12,md:6,lg:6},{default:v(()=>[g(b(F),{shadow:"hover",loading:N.value},{default:v(()=>[g(u,{title:"本月中标",value:R.value.wonThisMonth},{prefix:v(()=>[...d[4]||(d[4]=[_("i",{class:"bi bi-trophy-fill statistic-icon",style:{color:"#67c23a"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),g(p,{xs:12,sm:12,md:6,lg:6},{default:v(()=>[g(b(F),{shadow:"hover",loading:N.value},{default:v(()=>[g(u,{title:"待处理任务",value:R.value.pendingTasks},{prefix:v(()=>[...d[5]||(d[5]=[_("i",{class:"bi bi-list-task statistic-icon",style:{color:"#f56c6c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1})]),_:1}),g(b(F),{title:"快捷入口",class:"quick-actions-card"},{default:v(()=>[_("div",E,[(m(),f(h,null,y(K,e=>_("div",{key:e.name,class:"action-item",onClick:a=>function(e){D.push(e.route)}(e)},[_("div",{class:"action-icon",style:j({background:e.color})},[_("i",{class:w(e.icon)},null,2)],4),_("div",S,k(e.label),1)],8,L)),64))])]),_:1}),g(b(F),{title:"进行中的项目",class:"projects-card"},{actions:v(()=>[g(b(Y),{icon:"bi-arrow-clockwise",tooltip:"刷新",onClick:X})]),default:v(()=>[O.value?(m(),C(b(H),{key:0,visible:!0,fullscreen:!1,text:"加载项目列表..."})):0===V.value.length?(m(),C(b(I),{key:1,type:"no-data",description:"暂无进行中的项目"},{action:v(()=>[g(T,{type:"primary",onClick:ee},{default:v(()=>[...d[6]||(d[6]=[P("创建第一个项目",-1)])]),_:1})]),_:1})):(m(),f(h,{key:2},[g(ne,{data:V.value,stripe:"",style:{width:"100%"}},{default:v(()=>[g(se,{prop:"project_name",label:"项目名称","min-width":"200"},{default:v(({row:e})=>[g(M,{type:"primary",onClick:a=>ae(e)},{default:v(()=>[P(k(e.project_name),1)]),_:2},1032,["onClick"])]),_:1}),g(se,{prop:"project_number",label:"项目编号",width:"150"}),g(se,{prop:"status",label:"状态",width:"120"},{default:v(({row:e})=>{return[g(le,{type:(a=e.status,{pending:"info",in_progress:"warning",completed:"success",won:"success",lost:"danger",archived:"info"}[a]||"info")},{default:v(()=>[P(k(oe(e.status)),1)]),_:2},1032,["type"])];var a}),_:1}),g(se,{prop:"company_name",label:"关联企业",width:"200"}),g(se,{prop:"created_at",label:"创建时间",width:"180"},{default:v(({row:e})=>{return[P(k((a=e.created_at,a?z(a).format("YYYY-MM-DD HH:mm"):"-")),1)];var a}),_:1}),g(se,{label:"操作",width:"200",fixed:"right"},{default:v(({row:e})=>[g(b(Y),{icon:"bi-eye",type:"primary",tooltip:"查看详情",onClick:a=>ae(e)},null,8,["onClick"]),g(b(Y),{icon:"bi-play-circle",type:"success",tooltip:"继续处理",onClick:a=>{return t=e,B.setCurrentProject(t),void D.push({name:"TenderManagementDetail",params:{id:t.id}});var t}},null,8,["onClick"]),g(b(Y),{icon:"bi-archive",type:"warning",tooltip:"归档",onClick:a=>async function(e){if(await J(`确定要归档项目"${e.project_name}"吗?`,"归档项目","归档后项目将不再显示在进行中列表"))try{await B.updateProject(e.id,{status:"archived"}),G("项目已归档"),await Q()}catch(a){U("归档失败: "+a.message)}}(e)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),_("div",q,[g(re,{"current-page":W.value,"onUpdate:currentPage":d[0]||(d[0]=e=>W.value=e),"page-size":Z.value,"onUpdate:pageSize":d[1]||(d[1]=e=>Z.value=e),total:$.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:te,onCurrentChange:ie},null,8,["current-page","page-size","total"])])],64))]),_:1})])}}}),[["__scopeId","data-v-6925dc07"]]);export{B as default};
