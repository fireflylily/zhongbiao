import{d as e,G as l,D as a,e as t,p as o,n as s,h as u,M as n,y as r,_ as i,l as d,a as c,C as p,Z as v,X as f,W as m,o as _,K as y,j as h}from"./vendor-element-plus-CEQaQHNc.js";import{d as g,r as w,a as j,b as k,P as b,M as F,c as x,L as S,Q as I,N as C,F as P,V,I as $,O as D,H as O,f as T,R as E,v as M}from"./vendor-vue-DnBj6vzG.js";import{eC as U,eD as z,dB as q,er as H,d2 as N,es as A,et as L}from"./vendor-other-CxXkF0Pk.js";/* empty css                                                                          */import{S as R}from"./SSEStreamViewer-D6FfMtBC.js";import{D as W}from"./DocumentUploader-DdyoMp6a.js";import{D as J}from"./DocumentPreview-BsCsR4le.js";import{R as G}from"./RichTextEditor-C6U3pK9p.js";import{u as B,H as K,S as Q,a as X,d as Z}from"./helpers-DkE9d6B1.js";import{_ as Y}from"./index.js";import{t as ee}from"./tender-ZYcn_VXM.js";import{u as le}from"./useProjectDocuments-DkMW_Nbe.js";import"./vendor-dayjs-CeOjnJlt.js";import"./imageCompressor-CTkRt5bg.js";import"./vendor-editor-CGvuleas.js";import"./vendor-echarts-C00rBISf.js";/* empty css                                                                        */import"./vendor-axios-BG7aBJwU.js";import"./project-DRKLdxdD.js";const ae={class:"tech-proposal"},te={class:"card-header"},oe={class:"action-controls"},se={class:"card-header"},ue={class:"card-header"},ne={class:"requirement-categories"},re={class:"category-title"},ie={class:"category-content"},de={key:0,class:"category-summary"},ce={key:1,class:"category-keywords"},pe={key:2,class:"category-points"},ve={class:"card-header"},fe={class:"ç« èŠ‚ç»“æ„"},me={class:"tree-node"},_e={class:"node-title"},ye={key:2,class:"node-desc"},he={class:"card-header"},ge={class:"header-actions"},we={class:"result-content"},je={class:"output-files"},ke={class:"file-buttons"},be=Y(g({__name:"TechProposal",setup(g){const{projects:Y,selectedProject:be,currentDocuments:Fe,loadProjects:xe,handleProjectChange:Se,restoreProjectFromStore:Ie}=le(),{useHitlFile:Ce,hitlFileInfo:Pe,syncing:Ve,synced:$e,loadFromHITL:De,cancelHitlFile:Oe,syncToHitl:Te}=B({onFileLoaded:()=>{qe.value.tenderFiles=[]}}),Ee=w([]),Me=w(!1),Ue=async()=>{},ze=async e=>{try{if(!e.downloadUrl)return void h.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const l=e.filename||e.downloadUrl.split("/").pop()||"æŠ€æœ¯æ–¹æ¡ˆ.docx";Z(e.downloadUrl,l),h.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(l){h.error(l.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}},qe=w({projectId:null,tenderFiles:[]}),He=w({outputPrefix:"æŠ€æœ¯æ–¹æ¡ˆ",aiModel:"shihuang-gpt4o-mini",additionalOutputs:["includeAnalysis","includeMapping","includeSummary"]}),Ne=w(!1),Ae=w(0),Le=w(""),Re=w(null),We=w(!0),Je=w(null),Ge=w(!0),Be=w(null),Ke=w(null),Qe=w(!1),Xe=w(""),Ze=w(""),Ye=w(!1),el=w(null),ll=w(""),al=w(!1),tl=w(!1),ol=j(()=>{var e;return(null==(e=Je.value)?void 0:e.chapters)?Je.value.chapters:[]}),sl=j(()=>qe.value.projectId&&(Ce.value||qe.value.tenderFiles.length>0)),ul=async e=>{var l;const{file:a,onSuccess:t,onError:o}=e;if(!qe.value.projectId){return o(new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")),void h.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")}if(!(null==(l=be.value)?void 0:l.company_id)){return o(new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")),void h.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")}try{const e=new FormData;e.append("file",a),e.append("company_id",be.value.company_id.toString()),e.append("project_id",qe.value.projectId.toString());const l=await ee.parseDocumentStructure(e);if(!l.success)throw new Error(l.message||"ä¸Šä¼ å¤±è´¥");t(l.data),h.success("æŠ€æœ¯éœ€æ±‚æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(s){o(s),h.error(s.message||"æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},nl=()=>{h.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},rl=async()=>{await Se(qe.value.projectId,{onClear:()=>{qe.value.tenderFiles=[],Re.value=null,Je.value=null,Be.value=null,Ke.value=null,Le.value="",Ye.value=!1,ll.value="",Ce.value&&Oe()},onDocumentsLoaded:e=>{e.technicalFile&&De(e,"technicalFile"),e.techProposalFile&&(Ke.value=e.techProposalFile,h.success("å·²åŠ è½½å†å²æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶"))}})},il=async()=>{var e;if(sl.value){Ne.value=!0,Ae.value=0,Le.value="",Re.value=null,Be.value=null,Ye.value=!1,ll.value="";try{const l=new FormData;if(Ce.value&&Pe.value)l.append("use_hitl_technical_file","true"),l.append("project_id",qe.value.projectId.toString());else{if(!(null==(e=qe.value.tenderFiles[0])?void 0:e.raw))throw new Error("è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");l.append("tender_file",qe.value.tenderFiles[0].raw)}l.append("outputPrefix",He.value.outputPrefix),l.append("companyId",be.value.company_id.toString()),l.append("projectName",be.value.project_name||""),l.append("projectId",qe.value.projectId.toString()),l.append("aiModel",He.value.aiModel),l.append("includeAnalysis",He.value.additionalOutputs.includes("includeAnalysis")?"true":"false"),l.append("includeMapping",He.value.additionalOutputs.includes("includeMapping")?"true":"false"),l.append("includeSummary",He.value.additionalOutputs.includes("includeSummary")?"true":"false"),await dl(l),h.success("æŠ€æœ¯æ–¹æ¡ˆç”Ÿæˆå®Œæˆ")}catch(l){h.error(l.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{Ne.value=!1}}else h.warning("è¯·é€‰æ‹©é¡¹ç›®å¹¶ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£")},dl=async e=>{var l,a,t;const o=await fetch("/api/generate-proposal-stream-v2",{method:"POST",body:e});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const s=null==(l=o.body)?void 0:l.getReader();if(!s)throw new Error("æ— æ³•è¯»å–å“åº”æµ");const u=new TextDecoder;let n="";const r={};let i="";for(;;){const{done:e,value:l}=await s.read();if(e)break;n+=u.decode(l,{stream:!0});const o=n.split("\n");n=o.pop()||"";for(const s of o)if(s.startsWith("data: "))try{const e=JSON.parse(s.slice(6));if(void 0!==e.progress&&(Ae.value=e.progress),e.message&&(Le.value+=e.message+"\n"),"analysis_completed"===e.stage&&e.analysis_result&&(Re.value=e.analysis_result),"outline_completed"===e.stage&&e.outline_data&&(Je.value=e.outline_data),"content_generation"===e.stage)if("chapter_start"===e.event)i=e.chapter_number||"",r[i]="",Le.value+=`\n\n## ${e.chapter_number} ${e.chapter_title}\n\n`,Ye.value||(Ye.value=!0);else if("content_chunk"===e.event){const l=e.chapter_number||i;l&&(r[l]=(r[l]||"")+(e.content||""),cl(r))}else"chapter_end"===e.event&&(Le.value+=`\nâœ“ ${e.chapter_title||"ç« èŠ‚"} ç”Ÿæˆå®Œæˆ\n`);if("completed"===e.stage&&e.success&&(Be.value=e,Ke.value={outputFile:e.output_file,downloadUrl:null==(a=e.output_files)?void 0:a.proposal,stats:{requirements_count:e.requirements_count,sections_count:e.sections_count,matches_count:e.matches_count},message:"æŠ€æœ¯æ–¹æ¡ˆå·²ç”Ÿæˆ"},Ye.value=!0,e.output_file&&qe.value.projectId&&await Te(qe.value.projectId,e.output_file,"tech_proposal")),"error"===e.stage)throw Le.value+=`\nâŒ é”™è¯¯: ${e.error||e.message}\n`,new Error(e.error||e.message||"ç”Ÿæˆå¤±è´¥")}catch(d){if(!(null==(t=d.message)?void 0:t.includes("JSON")))throw d}}},cl=e=>{var l;if(null==(l=Je.value)?void 0:l.chapters){let l="";const a=t=>{for(const o of t){const t=o.chapter_number,s=e[t]||"",u=o.level||1;l+=`<h${u}>${t} ${o.title}</h${u}>\n`,s&&(l+=`<div>${s.replace(/\n/g,"<br>")}</div>\n`),o.subsections&&o.subsections.length>0&&a(o.subsections)}};a(Je.value.chapters),ll.value=l}else{let l="";const a=Object.entries(e).sort((e,l)=>{const[a]=e,[t]=l;return a.localeCompare(t,"zh-CN")});for(const[e,t]of a)l+=`<h2>${e}</h2>\n`,l+=`<div>${t.replace(/\n/g,"<br>")}</div>\n`;ll.value=l}},pl=()=>{Ne.value=!1,h.info("å·²åœæ­¢ç”Ÿæˆ")},vl=e=>{var l,a;if(!(null==(a=null==(l=Be.value)?void 0:l.output_files)?void 0:a[e]))return void h.warning("æ–‡ä»¶ä¸å­˜åœ¨");const t=Be.value.output_files[e],o=t.split("/").pop()||`æŠ€æœ¯æ–¹æ¡ˆ_${e}.docx`;Z(t,o),h.success("ä¸‹è½½å·²å¼€å§‹")},fl=()=>{var e,l,a;(null==(l=null==(e=Be.value)?void 0:e.output_files)?void 0:l.proposal)?(Xe.value=Be.value.output_files.proposal,Ze.value=`æŠ€æœ¯æ–¹æ¡ˆ-${(null==(a=be.value)?void 0:a.project_name)||"æ–‡æ¡£"}.docx`,Qe.value=!0):h.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},ml=e=>{Xe.value=e.file_path||e.outputFile,Ze.value=e.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx",Qe.value=!0},_l=async()=>{var e;(null==(e=Be.value)?void 0:e.output_file)?qe.value.projectId?await Te(qe.value.projectId,Be.value.output_file,"tech_proposal"):h.error("é¡¹ç›®IDæ— æ•ˆ"):h.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},yl=()=>{Ke.value=null,Be.value=null,Re.value=null,Je.value=null,Ye.value=!1,ll.value="",h.info("è¯·é…ç½®å‚æ•°åé‡æ–°ç”Ÿæˆ")},hl=async e=>{var l;if(null==(l=Be.value)?void 0:l.output_file)try{tl.value=!0;const l=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:qe.value.projectId,document_type:"tech_proposal",original_file:Be.value.output_file})}),a=await l.json();if(!a.success)throw new Error(a.error||"ä¿å­˜å¤±è´¥");h.success("æŠ€æœ¯æ–¹æ¡ˆå†…å®¹å·²ä¿å­˜"),a.output_file&&(Be.value.output_file=a.output_file,a.download_url&&Be.value.output_files&&(Be.value.output_files.proposal=a.download_url)),a.output_file&&qe.value.projectId&&await Te(qe.value.projectId,a.output_file,"tech_proposal")}catch(a){throw a}finally{tl.value=!1}else h.warning("æ²¡æœ‰å¯ä¿å­˜çš„æ–‡ä»¶")},gl=async()=>{var e;if(null==(e=Ke.value)?void 0:e.outputFile)try{Ye.value=!0,await(async e=>{try{al.value=!0,ll.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const l=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),a=await l.json();if(!a.success||!a.html_content)throw new Error(a.error||"è½¬æ¢å¤±è´¥");ll.value=a.html_content,el.value&&el.value.setContent(a.html_content)}catch(l){ll.value=`\n      <h1>ğŸ“„ æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${l.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"é¢„è§ˆWord"æˆ–"ä¸‹è½½"æŒ‰é’®æŸ¥çœ‹åŸå§‹æ–‡æ¡£</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,h.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨é¢„è§ˆæˆ–ä¸‹è½½åŠŸèƒ½")}finally{al.value=!1}})(Ke.value.outputFile),h.success("å†å²æ–‡ä»¶å·²åŠ è½½åˆ°ç¼–è¾‘å™¨"),setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(l){h.error("æ‰“å¼€å†å²æ–‡ä»¶å¤±è´¥: "+l.message)}else h.error("å†å²æ–‡ä»¶ä¿¡æ¯æ— æ•ˆ")};return k(async()=>{await xe();const e=await Ie({onClear:()=>{qe.value.tenderFiles=[],Re.value=null,Je.value=null,Be.value=null,Ke.value=null,Ce.value&&Oe()},onDocumentsLoaded:e=>{e.technicalFile&&De(e,"technicalFile"),e.techProposalFile&&(Ke.value=e.techProposalFile)}});e&&(qe.value.projectId=e)}),(h,g)=>{const w=s,j=o,k=t,B=a,Z=u,ee=l,le=e,xe=n,Se=c,Ie=r,Te=d,dl=i,cl=p,wl=v,jl=_,kl=m,bl=f,Fl=y;return F(),b("div",ae,[x(xe,{class:"project-section",shadow:"never"},{header:C(()=>[...g[15]||(g[15]=[D("div",{class:"card-header"},[D("span",null,"Step 1: é€‰æ‹©é¡¹ç›®")],-1)])]),default:C(()=>[x(le,{model:qe.value,"label-width":"100px"},{default:C(()=>[x(ee,{gutter:20},{default:C(()=>[x(B,{span:12},{default:C(()=>[x(k,{label:"é¡¹ç›®"},{default:C(()=>[x(j,{modelValue:qe.value.projectId,"onUpdate:modelValue":g[0]||(g[0]=e=>qe.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:rl,style:{width:"100%"}},{default:C(()=>[(F(!0),b(P,null,V($(Y),e=>(F(),S(w,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),x(B,{span:12},{default:C(()=>[x(k,{label:"å…¬å¸"},{default:C(()=>{var e;return[x(Z,{value:(null==(e=$(be))?void 0:e.company_name)||"-",disabled:""},null,8,["value"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),qe.value.projectId?(F(),S(xe,{key:0,class:"upload-section",shadow:"never"},{header:C(()=>[D("div",te,[g[17]||(g[17]=D("span",null,"Step 2: ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",-1)),$(Fe).technicalFile&&!$(Ce)?(F(),S(Se,{key:0,type:"primary",size:"small",onClick:g[1]||(g[1]=e=>$(De)($(Fe),"technicalFile"))},{default:C(()=>[...g[16]||(g[16]=[O(" ä½¿ç”¨æŠ€æœ¯éœ€æ±‚æ–‡ä»¶ ",-1)])]),_:1})):I("",!0)])]),default:C(()=>[$(Ce)?(F(),S($(K),{key:0,"file-info":$(Pe),label:"æŠ€æœ¯éœ€æ±‚æ–‡ä»¶:",onCancel:$(Oe)},null,8,["file-info","onCancel"])):I("",!0),$(Ce)?I("",!0):(F(),S($(W),{key:1,modelValue:qe.value.tenderFiles,"onUpdate:modelValue":g[2]||(g[2]=e=>qe.value.tenderFiles=e),"http-request":ul,accept:".pdf,.doc,.docx",limit:1,"max-size":50,drag:"","tip-text":"ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",onSuccess:nl},null,8,["modelValue"])),x(Ie,null,{default:C(()=>[...g[18]||(g[18]=[O("ç”Ÿæˆé€‰é¡¹",-1)])]),_:1}),x(le,{model:He.value,"label-width":"140px",class:"config-form"},{default:C(()=>[x(ee,{gutter:20},{default:C(()=>[x(B,{span:12},{default:C(()=>[x(k,{label:"è¾“å‡ºæ–‡ä»¶å‰ç¼€"},{default:C(()=>[x(Z,{modelValue:He.value.outputPrefix,"onUpdate:modelValue":g[3]||(g[3]=e=>He.value.outputPrefix=e),placeholder:"æŠ€æœ¯æ–¹æ¡ˆ"},null,8,["modelValue"])]),_:1})]),_:1}),x(B,{span:12},{default:C(()=>[x(k,{label:"AIæ¨¡å‹"},{default:C(()=>[x(j,{modelValue:He.value.aiModel,"onUpdate:modelValue":g[4]||(g[4]=e=>He.value.aiModel=e),style:{width:"100%"}},{default:C(()=>[x(w,{label:"GPT5ï¼ˆæœ€å¼ºæ¨ç†ï¼‰",value:"shihuang-gpt5"}),x(w,{label:"Claude Sonnet 4.5ï¼ˆæ ‡ä¹¦ä¸“ç”¨ï¼‰",value:"shihuang-claude-sonnet-45"}),x(w,{label:"GPT4o Miniï¼ˆæ¨è-é»˜è®¤ï¼‰",value:"shihuang-gpt4o-mini"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),x(k,{label:"é™„åŠ è¾“å‡º"},{default:C(()=>[x(dl,{modelValue:He.value.additionalOutputs,"onUpdate:modelValue":g[5]||(g[5]=e=>He.value.additionalOutputs=e)},{default:C(()=>[x(Te,{label:"includeAnalysis"},{default:C(()=>[...g[19]||(g[19]=[O("éœ€æ±‚åˆ†ææŠ¥å‘Š",-1)])]),_:1}),x(Te,{label:"includeMapping"},{default:C(()=>[...g[20]||(g[20]=[O("éœ€æ±‚åŒ¹é…è¡¨",-1)])]),_:1}),x(Te,{label:"includeSummary"},{default:C(()=>[...g[21]||(g[21]=[O("ç”Ÿæˆæ€»ç»“æŠ¥å‘Š",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),D("div",oe,[x(Se,{type:"primary",size:"large",disabled:!sl.value,loading:Ne.value,onClick:il},{default:C(()=>[x(cl,null,{default:C(()=>[x($(U))]),_:1}),g[22]||(g[22]=O(" ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1},8,["disabled","loading"])])]),_:1})):I("",!0),Ne.value?(F(),S(xe,{key:1,class:"generation-output",shadow:"never"},{header:C(()=>[D("div",se,[g[23]||(g[23]=D("span",null,"AIæ­£åœ¨ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ...",-1)),x(wl,{percentage:Ae.value,status:100===Ae.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:C(()=>[x($(R),{content:Le.value,"is-streaming":Ne.value,onStop:pl},null,8,["content","is-streaming"])]),_:1})):I("",!0),Re.value?(F(),S(xe,{key:2,class:"analysis-section",shadow:"never"},{header:C(()=>[D("div",ue,[g[24]||(g[24]=D("span",null,"éœ€æ±‚åˆ†æç»“æœ",-1)),x(Se,{size:"small",onClick:g[6]||(g[6]=e=>We.value=!We.value)},{default:C(()=>[O(E(We.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:C(()=>[T(D("div",null,[x($(Q),{title:"æ–‡æ¡£æ‘˜è¦",stats:Re.value.document_summary||{},"stat-items":[{key:"total_requirements",label:"æ€»éœ€æ±‚æ•°",suffix:"é¡¹"},{key:"mandatory_count",label:"å¼ºåˆ¶éœ€æ±‚",suffix:"é¡¹"},{key:"optional_count",label:"å¯é€‰éœ€æ±‚",suffix:"é¡¹"}]},null,8,["stats"]),D("div",ne,[g[27]||(g[27]=D("h4",null,"éœ€æ±‚åˆ†ç±»",-1)),x(bl,{accordion:""},{default:C(()=>[(F(!0),b(P,null,V(Re.value.requirement_categories,(e,l)=>(F(),S(kl,{key:l,name:l},{title:C(()=>{return[D("div",re,[D("span",null,E(e.category),1),x(jl,{type:(l=e.priority,{"é«˜":"danger",high:"danger","ä¸­":"warning",medium:"warning","ä½":"info",low:"info"}[l]||"info"),size:"small"},{default:C(()=>[O(E(e.priority),1)]),_:2},1032,["type"]),x(jl,{type:"info",size:"small"},{default:C(()=>[O(E(e.requirements_count||0)+"é¡¹ ",1)]),_:2},1024)])];var l}),default:C(()=>[D("div",ie,[e.summary?(F(),b("p",de,E(e.summary),1)):I("",!0),e.keywords&&e.keywords.length>0?(F(),b("div",ce,[g[25]||(g[25]=D("strong",null,"å…³é”®è¯ï¼š",-1)),(F(!0),b(P,null,V(e.keywords,e=>(F(),S(jl,{key:e,size:"small",style:{"margin-right":"8px"}},{default:C(()=>[O(E(e),1)]),_:2},1024))),128))])):I("",!0),e.key_points&&e.key_points.length>0?(F(),b("div",pe,[g[26]||(g[26]=D("strong",null,"è¦ç‚¹ï¼š",-1)),D("ul",null,[(F(!0),b(P,null,V(e.key_points,(e,l)=>(F(),b("li",{key:l},E(e),1))),128))])])):I("",!0)])]),_:2},1032,["name"]))),128))]),_:1})])],512),[[M,We.value]])]),_:1})):I("",!0),Je.value?(F(),S(xe,{key:3,class:"outline-section",shadow:"never"},{header:C(()=>[D("div",ve,[g[28]||(g[28]=D("span",null,"æŠ€æœ¯æ–¹æ¡ˆå¤§çº²",-1)),x(Se,{size:"small",onClick:g[7]||(g[7]=e=>Ge.value=!Ge.value)},{default:C(()=>[O(E(Ge.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:C(()=>[T(D("div",null,[x($(Q),{title:"å¤§çº²æ¦‚è§ˆ",stats:Je.value,"stat-items":[{key:"total_chapters",label:"æ€»ç« èŠ‚æ•°",suffix:"ç« "},{key:"estimated_pages",label:"é¢„è®¡é¡µæ•°",suffix:"é¡µ"}],span:12},null,8,["stats"]),D("div",fe,[g[29]||(g[29]=D("h4",null,"ç« èŠ‚ç»“æ„",-1)),x(Fl,{data:ol.value,props:{label:"title",children:"subsections"},"default-expand-all":"","node-key":"chapter_number"},{default:C(({node:e,data:l})=>[D("span",me,[1===l.level?(F(),S(cl,{key:0},{default:C(()=>[x($(z))]),_:1})):(F(),S(cl,{key:1},{default:C(()=>[x($(q))]),_:1})),D("span",_e,E(l.chapter_number)+" "+E(l.title),1),l.description?(F(),b("span",ye,E(l.description),1)):I("",!0)])]),_:1},8,["data"])])],512),[[M,Ge.value]])]),_:1})):I("",!0),Ye.value?(F(),S(xe,{key:4,class:"editor-section",shadow:"never"},{default:C(()=>[x($(G),{ref_key:"editorRef",ref:el,modelValue:ll.value,"onUpdate:modelValue":g[8]||(g[8]=e=>ll.value=e),title:"æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£",loading:al.value,saving:tl.value,onSave:hl},null,8,["modelValue","loading","saving"])]),_:1})):I("",!0),Be.value?(F(),S(xe,{key:5,class:"result-section",shadow:"never"},{header:C(()=>[D("div",he,[g[35]||(g[35]=D("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),D("div",ge,[x(Se,{type:"primary",icon:$(N),onClick:fl},{default:C(()=>[...g[30]||(g[30]=[O(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),x(Se,{type:"success",icon:$(H),onClick:g[9]||(g[9]=e=>vl("proposal"))},{default:C(()=>[...g[31]||(g[31]=[O(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1)])]),_:1},8,["icon"]),$($e)?(F(),S(jl,{key:1,type:"success",size:"large"},{default:C(()=>[...g[33]||(g[33]=[O(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(F(),S(Se,{key:0,type:"info",icon:$(A),loading:$(Ve),onClick:_l},{default:C(()=>[...g[32]||(g[32]=[O(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),x(Se,{type:"primary",icon:$(L),onClick:il},{default:C(()=>[...g[34]||(g[34]=[O(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:C(()=>{var e,l,a,t;return[D("div",we,[x($(Q),{title:"ç”Ÿæˆç»Ÿè®¡",stats:Be.value,"stat-items":[{key:"requirements_count",label:"éœ€æ±‚æ•°é‡",suffix:"é¡¹"},{key:"sections_count",label:"ç« èŠ‚æ•°é‡",suffix:"ç« "},{key:"matches_count",label:"åŒ¹é…æ•°é‡",suffix:"é¡¹"}]},null,8,["stats"]),D("div",je,[g[40]||(g[40]=D("h4",null,"è¾“å‡ºæ–‡ä»¶",-1)),D("div",ke,[(null==(e=Be.value.output_files)?void 0:e.proposal)?(F(),S(Se,{key:0,type:"success",onClick:g[10]||(g[10]=e=>vl("proposal"))},{default:C(()=>[x(cl,null,{default:C(()=>[x($(H))]),_:1}),g[36]||(g[36]=O(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1})):I("",!0),(null==(l=Be.value.output_files)?void 0:l.analysis)?(F(),S(Se,{key:1,type:"primary",onClick:g[11]||(g[11]=e=>vl("analysis"))},{default:C(()=>[x(cl,null,{default:C(()=>[x($(H))]),_:1}),g[37]||(g[37]=O(" ä¸‹è½½éœ€æ±‚åˆ†æ ",-1))]),_:1})):I("",!0),(null==(a=Be.value.output_files)?void 0:a.mapping)?(F(),S(Se,{key:2,type:"info",onClick:g[12]||(g[12]=e=>vl("mapping"))},{default:C(()=>[x(cl,null,{default:C(()=>[x($(H))]),_:1}),g[38]||(g[38]=O(" ä¸‹è½½åŒ¹é…è¡¨ ",-1))]),_:1})):I("",!0),(null==(t=Be.value.output_files)?void 0:t.summary)?(F(),S(Se,{key:3,type:"warning",onClick:g[13]||(g[13]=e=>vl("summary"))},{default:C(()=>[x(cl,null,{default:C(()=>[x($(H))]),_:1}),g[39]||(g[39]=O(" ä¸‹è½½ç”ŸæˆæŠ¥å‘Š ",-1))]),_:1})):I("",!0)])])])]}),_:1})):I("",!0),qe.value.projectId?(F(),S($(X),{key:6,title:"è¯¥é¡¹ç›®çš„æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶","current-file":Ke.value,"history-files":Ee.value,loading:Me.value,"show-stats":!1,"show-editor-open":!0,onPreview:ml,onDownload:ze,onRegenerate:yl,onRefresh:Ue,onOpenInEditor:gl},null,8,["current-file","history-files","loading"])):I("",!0),x($(J),{modelValue:Qe.value,"onUpdate:modelValue":g[14]||(g[14]=e=>Qe.value=e),"file-url":Xe.value,"file-name":Ze.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-2e95afaf"]]);export{be as default};
