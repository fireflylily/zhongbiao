import{E as e,e as t,B as a,d as n,i as l,_ as o}from"./index.js";/* empty css                *//* empty css                */import{E as s,a as r}from"./el-tab-pane-BUj78z1R.js";/* empty css                                                                          *//* empty css                             *//* empty css               *//* empty css                                                        */import{am as i,an as d,au as u,ar as c,ax as p,aq as m,av as v,as as h,aD as g,aw as f,ay as y,aC as _}from"./editor-DtHwR8yc.js";/* empty css                   */import{R as b}from"./RichTextEditor-CIdKCOiq.js";/* empty css                    *//* empty css                     *//* empty css                */import{E as k}from"./index-d1_Vt82Z.js";import{E as j}from"./index-DYtF0M78.js";import"./raf-BZHcGSIv.js";import"./strings-BND1Cqg8.js";import"./clamp-DrSLy8WN.js";import"./toNumber-D7Yc6kTN.js";import"./index-BkIdrdH2.js";import"./index-BYHsX_yr.js";import"./index-BCSTGAKU.js";import"./index-BnkWtDPE.js";import"./index-B1D0B4Gf.js";import"./cloneDeep-syPWYH98.js";const w={class:"editor-test-page"},x={style:{"white-space":"pre-wrap","font-size":"12px"}},C={class:"editor-container"},S=o(i({__name:"EditorTest",setup(o){const i=d(null),S=d(""),E=d("word"),L=d(null),T=d(!1),P=d(""),$=e=>{e.raw&&(L.value=e.raw,l.success(`已选择文件: ${e.name}`))},V=async()=>{if(L.value){T.value=!0,P.value="正在转换Word文档...\n";try{const e=new FormData;e.append("file",L.value);const t=await fetch("/api/editor/upload-temp",{method:"POST",body:e});if(!t.ok)throw new Error("文件上传失败");const a=(await t.json()).file_path;P.value+=`✓ 文件已上传: ${a}\n`,P.value+="正在转换为HTML...\n";const n=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:a})}),o=await n.json();if(!o.success||!o.html_content)throw new Error(o.error||"转换失败");{P.value+=`✓ 转换成功！HTML长度: ${o.html_content.length}\n`;const e=(o.html_content.match(/page-break/g)||[]).length;P.value+=`✓ 检测到 ${e} 个分页符\n`,S.value=o.html_content,i.value&&i.value.setContent(o.html_content),l.success("Word文档已加载到编辑器")}}catch(e){P.value+=`❌ 错误: ${e.message}\n`,l.error("转换失败: "+e.message)}finally{T.value=!1}}else l.warning("请先选择Word文档")},A=()=>{const e='\n<h1>第一章 项目概述</h1>\n<p>这是第一章的内容。我们将在这里介绍项目的基本情况和背景。</p>\n<p>项目名称：智能标书管理系统</p>\n<p>项目目标：提高标书编写效率，降低人工成本。</p>\n\n<hr data-type="page-break" />\n\n<h1>第二章 技术方案</h1>\n<p>本章介绍我们采用的技术方案和架构设计。</p>\n<h2>2.1 系统架构</h2>\n<p>系统采用前后端分离架构，前端使用Vue3 + TypeScript，后端使用Python Flask。</p>\n<h2>2.2 技术栈</h2>\n<ul>\n  <li>前端：Vue3 + Element Plus + UmoEditor</li>\n  <li>后端：Python Flask + SQLAlchemy</li>\n  <li>数据库：SQLite / MySQL</li>\n</ul>\n\n<hr data-type="page-break" />\n\n<h1>第三章 实施计划</h1>\n<p>本章描述项目的实施计划和时间安排。</p>\n<table>\n  <tr>\n    <th>阶段</th>\n    <th>任务</th>\n    <th>时间</th>\n  </tr>\n  <tr>\n    <td>第一阶段</td>\n    <td>需求分析</td>\n    <td>2周</td>\n  </tr>\n  <tr>\n    <td>第二阶段</td>\n    <td>系统开发</td>\n    <td>8周</td>\n  </tr>\n  <tr>\n    <td>第三阶段</td>\n    <td>测试上线</td>\n    <td>2周</td>\n  </tr>\n</table>\n\n<hr data-type="page-break" />\n\n<h1>第四章 总结</h1>\n<p>通过本项目的实施，将大幅提升标书编写效率。</p>\n<p><strong>预期成果：</strong></p>\n<ul>\n  <li>标书编写时间缩短50%</li>\n  <li>错误率降低80%</li>\n  <li>用户满意度提升</li>\n</ul>\n  ';S.value=e,i.value&&i.value.setContent(e),l.success("测试内容已加载（包含3个分页符）")},R=()=>{if(!i.value)return void l.warning("编辑器未就绪");const e=i.value.getContent()+'<hr data-type="page-break" />';i.value.setContent(e),l.success("已插入分页符")},q=()=>{S.value="",i.value&&i.value.clear(),l.success("编辑器已清空")},W=()=>{const e="<p>"+"这是一个很长的段落内容。".repeat(50)+"</p>\n",t=`\n<h1>第一章 项目背景</h1>\n${e.repeat(30)}\n\n<div class="umo-page-break" data-line-number="false" data-content="分页符"></div>\n\n<h1>第二章 需求分析</h1>\n${e.repeat(30)}\n\n<div class="umo-page-break" data-line-number="false" data-content="分页符"></div>\n\n<h1>第三章 技术方案</h1>\n${e.repeat(30)}\n\n<div class="umo-page-break" data-line-number="false" data-content="分页符"></div>\n\n<h1>第四章 实施计划</h1>\n${e.repeat(30)}\n\n<div class="umo-page-break" data-line-number="false" data-content="分页符"></div>\n\n<h1>第五章 总结</h1>\n${e.repeat(30)}\n  `;S.value=t,i.value&&i.value.setContent(t),l.success("超长文档已加载（包含原生分页符）")},O=()=>{if(i.value)try{i.value.insertPageBreak()?(l.success("✅ 已插入原生分页符"),setTimeout(()=>{const e=i.value.getContent().match(/<div class="umo-page-break"[^>]*>/g);e&&e.length;const t=document.querySelector('[contenteditable="true"]');if(t){t.querySelectorAll(".umo-page-break")}},200)):l.error("插入失败，返回false")}catch(e){l.error("插入失败: "+e.message)}else l.warning("编辑器未就绪")},D=()=>{if(!i.value)return void l.warning("编辑器未就绪");let e=i.value.getEditor();if(e&&e.__v_isRef&&(e=e.value),e&&e.commands){Object.keys(e.commands).filter(e=>e.toLowerCase().includes("page")||e.toLowerCase().includes("break"))}l.success("调试信息已输出到Console，请查看")},F=()=>{var e;if(i.value)try{let t=i.value.getEditor();t&&t.__v_isRef&&(t=t.value),i.value.setLayout&&i.value.setLayout("page"),(null==(e=t.extensionStorage)?void 0:e.page)&&(t.extensionStorage.page.layout="page");const a=document.querySelector(".umo-editor-container");a&&(a.classList.add("page-layout"),a.classList.remove("continuous-layout"));const n=document.querySelectorAll('.umo-editor-container button, .umo-toolbar button, [role="button"]'),o=Array.from(n).filter(e=>{const t=e.textContent||"",a=e.getAttribute("title")||"",n=e.getAttribute("aria-label")||"";return t.includes("页面")||t.includes("布局")||a.includes("页面")||a.includes("布局")||a.toLowerCase().includes("layout")||n.includes("页面")||n.includes("布局")});o.forEach((e,t)=>{}),o.length>0&&o[0].click(),setTimeout(()=>{document.querySelectorAll(".umo-page, [data-page-number]")},300),l.success("已尝试强制启用分页模式，请查看Console")}catch(t){l.error("操作失败: "+t.message)}else l.warning("编辑器未就绪")},H=()=>{setTimeout(()=>{D()},500)};return(l,o)=>{const d=e,M=t,Q=k,U=n,B=r,I=s,N=j;return c(),u("div",w,[p(N,{shadow:"never"},{header:h(()=>[...o[2]||(o[2]=[f("h2",null,"📝 编辑器 & 分页符测试",-1)])]),default:h(()=>[p(I,{modelValue:E.value,"onUpdate:modelValue":o[0]||(o[0]=e=>E.value=e),type:"card"},{default:h(()=>[p(B,{label:"Word文档测试",name:"word"},{default:h(()=>[p(d,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:h(()=>[...o[3]||(o[3]=[g(" 💡 上传一个包含分页符的Word文档，测试分页符是否正确显示 ",-1)])]),_:1}),p(Q,{class:"upload-demo",drag:"","auto-upload":!1,limit:1,accept:".doc,.docx","on-change":$},{tip:h(()=>[...o[4]||(o[4]=[f("div",{class:"el-upload__tip"}," 仅支持 .doc / .docx 格式文件 ",-1)])]),default:h(()=>[p(M,{class:"el-icon--upload"},{default:h(()=>[p(y(a))]),_:1}),o[5]||(o[5]=f("div",{class:"el-upload__text"},[g(" 拖拽Word文档到此处或 "),f("em",null,"点击上传")],-1))]),_:1}),L.value?(c(),m(U,{key:0,type:"primary",loading:T.value,onClick:V,style:{"margin-top":"16px"}},{default:h(()=>[...o[6]||(o[6]=[g(" 转换并加载到编辑器 ",-1)])]),_:1},8,["loading"])):v("",!0)]),_:1}),p(B,{label:"手动分页符测试",name:"manual"},{default:h(()=>[p(d,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:h(()=>[...o[7]||(o[7]=[g(" 💡 点击下方按钮加载包含分页符的测试内容 ",-1)])]),_:1}),p(U,{type:"primary",onClick:A},{default:h(()=>[...o[8]||(o[8]=[g(" 加载测试内容（带分页符） ",-1)])]),_:1}),p(U,{onClick:R,disabled:!i.value},{default:h(()=>[...o[9]||(o[9]=[g(" 插入HR分页符 ",-1)])]),_:1},8,["disabled"]),p(U,{onClick:O,disabled:!i.value,type:"success"},{default:h(()=>[...o[10]||(o[10]=[g(" 插入原生分页符（实验） ",-1)])]),_:1},8,["disabled"]),p(U,{onClick:D,disabled:!i.value,type:"warning"},{default:h(()=>[...o[11]||(o[11]=[g(" 调试编辑器API ",-1)])]),_:1},8,["disabled"]),p(U,{onClick:F,disabled:!i.value,type:"danger"},{default:h(()=>[...o[12]||(o[12]=[g(" 强制启用分页模式 ",-1)])]),_:1},8,["disabled"]),p(U,{onClick:q,disabled:!i.value},{default:h(()=>[...o[13]||(o[13]=[g(" 清空编辑器 ",-1)])]),_:1},8,["disabled"])]),_:1}),p(B,{label:"长文档测试",name:"long"},{default:h(()=>[p(d,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:h(()=>[...o[14]||(o[14]=[g(" 💡 加载超长文档，测试编辑器性能和分页布局 ",-1)])]),_:1}),p(U,{type:"primary",onClick:W},{default:h(()=>[...o[15]||(o[15]=[g(" 加载长文档（4章节） ",-1)])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),P.value?(c(),m(N,{key:0,shadow:"never",style:{"margin-top":"16px"}},{header:h(()=>[...o[16]||(o[16]=[f("h3",null,"转换日志",-1)])]),default:h(()=>[f("pre",x,_(P.value),1)]),_:1})):v("",!0),p(N,{shadow:"never",style:{"margin-top":"16px"}},{header:h(()=>[...o[17]||(o[17]=[f("h3",null,"富文本编辑器",-1)])]),default:h(()=>[f("div",C,[p(y(b),{ref_key:"editorRef",ref:i,modelValue:S.value,"onUpdate:modelValue":o[1]||(o[1]=e=>S.value=e),title:"测试文档",height:800,onReady:H},null,8,["modelValue"])])]),_:1})])}}}),[["__scopeId","data-v-e5c086fb"]]);export{S as default};
