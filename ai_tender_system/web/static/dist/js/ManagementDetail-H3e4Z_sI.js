import{d as e,i as a,q as l,E as t,e as i,p as s,bb as n,G as r,aU as c,K as o,P as u,N as d,O as _,aO as p}from"./index.js";/* empty css                */import{E as m}from"./el-divider-Deqft6C8.js";import{E as f}from"./el-text-Kv3Vn9-t.js";/* empty css                                                        *//* empty css                */import{E as v,a as h}from"./el-tab-pane-CC1O_BHr.js";/* empty css                             */import{E as b,P as y}from"./el-space-C0mOj24d.js";/* empty css                    */import{C as g}from"./ChapterTree-BqTJTN_w.js";import{E as k}from"./el-input-number-CnPBhObR.js";/* empty css               */import{E as z,a as w}from"./el-select-CldpbmUv.js";/* empty css                     */import{L as j}from"./Loading-DJ2LU2Ls.js";/* empty css                                                                            */import{am as x,ao as C,au as V,ar as q,aB as I,aw as U,av as S,aC as A,aD as E,ax as P,as as D,an as N,ap as T,aq as F,ay as $,aO as O,bt as B,aW as L,az as W,aA as M}from"./editor-Dt4gYtYt.js";/* empty css                         *//* empty css                    */import{_ as R}from"./DocumentPreview.vue_vue_type_script_setup_true_lang-CAKmezWj.js";/* empty css                   *//* empty css                */import{t as K}from"./tender-B2uBMreU.js";import{E as J,a as Q}from"./index-BX21ihZ_.js";import{E as Z}from"./index-CzbDvFem.js";import{E as G}from"./strings-BjAjE6k-.js";import{E as H}from"./index-CzCnSpIZ.js";import{c as X}from"./company-CHa0NuIL.js";import{k as Y}from"./knowledge-BR5smuxz.js";import{u as ee}from"./project-Cff1E3wd.js";import{a as ae,E as le}from"./index-zLnbxgQE.js";import{E as te,a as ie}from"./index-zK8U2JRv.js";import{E as se}from"./index-rLTqmg7l.js";import"./raf-BZHcGSIv.js";import"./clamp-BWjOrnxb.js";import"./toNumber-D5oObipZ.js";import"./el-tree-CUlCaDRQ.js";import"./index-GOKzZPhn.js";import"./index-DdGYlGy6.js";import"./index-CcWeoNg9.js";import"./_baseIteratee-BnEJjc-Z.js";import"./index-BgAfl9sI.js";import"./directive-CBGghap-.js";import"./cloneDeep-syPWYH98.js";const ne={class:"file-card__icon"},re={class:"file-card__info"},ce={class:"file-card__name"},oe={class:"file-card__meta"},ue={key:0,class:"meta-item"},de={key:0,class:"file-card__actions"},_e=l(x({__name:"FileCard",props:{fileUrl:{},fileName:{},fileSize:{},uploadTime:{},type:{default:"default"},showActions:{type:Boolean,default:!0}},emits:["preview"],setup(l,{emit:t}){const i=l,s=t,n=C(()=>{if(i.fileName)return i.fileName;const e=i.fileUrl.split("/");return e[e.length-1]||""}),r=C(()=>{var e;return{pdf:"bi-file-pdf",doc:"bi-file-word",docx:"bi-file-word",xls:"bi-file-excel",xlsx:"bi-file-excel",zip:"bi-file-zip",rar:"bi-file-zip"}[(null==(e=n.value.split(".").pop())?void 0:e.toLowerCase())||""]||"bi-file-earmark-text"}),c=C(()=>i.uploadTime?i.uploadTime.split(" ")[0]||i.uploadTime:""),o=e=>{if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/api/"))return e;let a=e;return a.startsWith("ai_tender_system/data/")&&(a=a.substring(22)),a.startsWith("outputs/")&&(a="download/"+a.substring(8)),`/api/files/serve/${a}`},u=()=>{const e=o(i.fileUrl),l=document.createElement("a");l.href=e+"?download=true",l.download=n.value,document.body.appendChild(l),l.click(),document.body.removeChild(l),a.success("文件下载已开始")},d=()=>{let e="";if(n.value){const a=n.value.split(".");a.length>1&&(e=a[a.length-1].toLowerCase())}if(!e&&i.fileUrl){const a=i.fileUrl.split("?")[0].split(".");a.length>1&&(e=a[a.length-1].toLowerCase())}if("doc"===e||"docx"===e)s("preview",i.fileUrl,n.value);else{const e=o(i.fileUrl);window.open(e,"_blank")}};return(a,t)=>{const i=e;return q(),V("div",{class:I(["file-card",[`file-card--${l.type}`]])},[U("div",ne,[U("i",{class:I(r.value)},null,2)]),U("div",re,[U("div",ce,A(n.value),1),U("div",oe,[c.value?(q(),V("span",ue,[t[0]||(t[0]=U("i",{class:"bi bi-calendar"},null,-1)),E(" "+A(c.value),1)])):S("",!0)])]),l.showActions?(q(),V("div",de,[P(i,{size:"small",onClick:u},{default:D(()=>[...t[1]||(t[1]=[U("i",{class:"bi bi-download"},null,-1),E(" 下载 ",-1)])]),_:1}),P(i,{size:"small",onClick:d},{default:D(()=>[...t[2]||(t[2]=[U("i",{class:"bi bi-eye"},null,-1),E(" 预览 ",-1)])]),_:1})])):S("",!0)],2)}}}),[["__scopeId","data-v-010a89f5"]]),pe={class:"tender-document-processor"},me={class:"card-header"},fe={class:"upload-section"},ve={key:0,class:"existing-document"},he={class:"d-flex align-items-center justify-content-between"},be={class:"me-3"},ye={key:1},ge={key:1,class:"selected-file-status"},ke={class:"d-flex align-items-center justify-content-between"},ze={key:0,class:"parsing-status mt-2"},we={class:"d-flex align-items-center text-info"},je={key:2,class:"quick-actions"},xe={class:"selectors-area"},Ce={class:"action-buttons"},Ve={key:0,class:"quick-action-item"},qe={key:1,class:"quick-action-item"},Ie={key:2,class:"quick-action-item"},Ue={class:"card-header"},Se={class:"chapter-section"},Ae={class:"stats-grid mb-3"},Ee={class:"stat-card"},Pe={class:"stat-value"},De={class:"stat-card"},Ne={class:"stat-value text-success"},Te={class:"stat-card"},Fe={class:"stat-value text-info"},$e={class:"batch-operations mb-3"},Oe={class:"save-actions mt-4"},Be=l(x({__name:"TenderDocumentProcessor",props:{projectId:{},companyId:{},projectDetail:{},responseFileInfo:{},technicalFileInfo:{}},emits:["success","refresh","preview","parseComplete","start-business","start-p2p","start-proposal"],setup(l,{emit:c}){const o=l,u=c,d=N(),_=N(),p=N([]),m=N(null),f=N(!1),v=N("正在解析文档结构..."),h=N(!1),y=N(""),k=N(0),z=N([]),w=N([]),j=N([]),x=N(!1),I=N(!1),B=N(null),L=C(()=>{const e=a=>{let l=a.length;return a.forEach(a=>{a.children&&a.children.length>0&&(l+=e(a.children))}),l};return e(z.value)}),W=C(()=>w.value.length),M=C(()=>j.value.reduce((e,a)=>e+(a.word_count||0),0)),R=C(()=>null!==B.value),X=async e=>{if(!e.raw)return;const l=(e=>e.name.toLowerCase().endsWith(".docx")?e.size>52428800?{valid:!1,error:`文件大小不能超过 50MB，当前文件大小: ${(e.size/1024/1024).toFixed(2)}MB`}:{valid:!0}:{valid:!1,error:"仅支持 .docx 格式的文件，请先将 .doc 文件另存为 .docx 格式"})(e.raw);if(!l.valid)return a.error(l.error||"文件验证失败"),m.value=null,void(p.value=[]);m.value=e.raw,p.value=[e],a.success({message:"文件上传成功，系统正在自动提取项目基本信息",duration:2e3}),setTimeout(()=>{te()},500)},Y=()=>{m.value=null,p.value=[],z.value=[],w.value=[]},ee=()=>{m.value=null,p.value=[]},ae=()=>{B.value&&u("preview",B.value.path,B.value.name)},le=()=>{B.value=null,z.value=[],w.value=[]},te=async()=>{if(m.value){f.value=!0,v.value="正在识别文档目录（AI分析中）...";try{const l=new FormData;l.append("file",m.value),l.append("company_id",o.companyId.toString()),l.append("project_id",o.projectId.toString());const t=await K.parseDocumentStructureQuick(l);if(!t.success)throw new Error(t.message||t.error||"解析失败");z.value=t.chapters||[],y.value=t.file_path||"",k.value=t.toc_end_idx||0,f.value=!1,h.value=!0,a.success({message:"目录识别完成（DeepSeek V3），正在分析字数...",duration:2e3});try{const e=await K.enrichChapters({project_id:o.projectId,file_path:y.value,chapters:z.value,toc_end_idx:k.value});e.success?(z.value=e.chapters||z.value,a.success({message:"文档解析完成",duration:2e3})):a.warning("字数统计失败，但目录结构已识别")}catch(e){a.warning("字数统计失败，但目录结构已识别")}finally{h.value=!1}u("parseComplete"),u("refresh")}catch(l){f.value=!1,h.value=!1;const e=l instanceof Error?l.message:"未知错误";e.includes(".doc")||e.includes("另存为")||e.includes("docx")?r.alert(e,"不支持 .doc 格式",{confirmButtonText:"我知道了",type:"warning",dangerouslyUseHTMLString:!1,customStyle:{width:"500px"}}):a.error(`解析失败: ${e}`)}finally{f.value=!1}}else a.warning("请先上传文档")},ie=(e,a)=>{w.value=e,j.value=a},se=()=>{var e;const a=oe(z.value);null==(e=_.value)||e.setCheckedKeys(a)},ne=()=>{var e;null==(e=_.value)||e.setCheckedKeys([])},re=()=>{var e;const a=ue(z.value,["技术","方案","实施","系统"]);null==(e=_.value)||e.setCheckedKeys(a)},ce=()=>{var e;const a=oe(z.value),l=ue(z.value,["合同","条款","协议"]),t=a.filter(e=>!l.includes(e));null==(e=_.value)||e.setCheckedKeys(t)},oe=e=>{const a=[];return e.forEach(e=>{a.push(e.id),e.children&&e.children.length>0&&a.push(...oe(e.children))}),a},ue=(e,a)=>{const l=[];return e.forEach(e=>{a.some(a=>e.title.includes(a))&&l.push(e.id),e.children&&e.children.length>0&&l.push(...ue(e.children,a))}),l},de=async()=>{if(0!==W.value){x.value=!0;try{await K.saveResponseFile(o.projectId,w.value),u("success","response"),u("refresh")}catch(e){a.error(`保存失败: ${e instanceof Error?e.message:"未知错误"}`)}finally{x.value=!1}}else a.warning("请先选择章节")},_e=async()=>{if(0!==W.value){I.value=!0;try{await K.saveTechnicalChapters(o.projectId,w.value),u("success","technical"),u("refresh")}catch(e){a.error(`保存失败: ${e instanceof Error?e.message:"未知错误"}`)}finally{I.value=!1}}else a.warning("请先选择章节")},Be=e=>{if(!e)return"招标文档";try{const a=e.replace(/\\/g,"/").split("/"),l=a[a.length-1];return decodeURIComponent(l)}catch(a){return"招标文档"}};return T(()=>o.projectDetail,()=>{(()=>{if(!o.projectDetail)return;let e=o.projectDetail.step1_data;if("string"==typeof e)try{e=JSON.parse(e)}catch(a){e=null}if(o.projectDetail.tender_document_path){const e=o.projectDetail.original_filename||Be(o.projectDetail.tender_document_path);B.value={path:o.projectDetail.tender_document_path,name:e,uploadedAt:o.projectDetail.created_at}}else if(null==e?void 0:e.file_path){const a=e.file_name||Be(e.file_path);B.value={path:e.file_path,name:a,uploadedAt:o.projectDetail.created_at}}(null==e?void 0:e.chapters)&&Array.isArray(e.chapters)&&e.chapters.length>0&&(z.value=e.chapters)})()},{immediate:!0}),(a,r)=>{const c=G,o=e,h=t,y=H,k=i,w=Z,j=Q,C=n,N=b,T=J;return q(),V("div",pe,[P(T,{gutter:20},{default:D(()=>[P(j,{xs:24,sm:24,md:10,lg:10},{default:D(()=>[P(w,{shadow:"hover",class:"step-card"},{header:D(()=>[U("div",me,[r[4]||(r[4]=U("i",{class:"bi bi-upload me-2 text-primary"},null,-1)),r[5]||(r[5]=U("span",{class:"step-title"},"步骤1: 上传招标文档（可选）",-1)),m.value||R.value?(q(),F(c,{key:0,type:"success",size:"small",class:"ms-2"},{default:D(()=>[...r[3]||(r[3]=[E(" 已上传 ",-1)])]),_:1})):S("",!0)])]),default:D(()=>[U("div",fe,[R.value?(q(),V("div",ve,[P(h,{type:"success",closable:!1},{title:D(()=>[U("div",he,[U("div",null,[r[7]||(r[7]=U("i",{class:"bi bi-file-earmark-check-fill me-2"},null,-1)),U("span",be,A(B.value.name),1),P(c,{size:"small",type:"success"},{default:D(()=>[...r[6]||(r[6]=[E("已上传",-1)])]),_:1})]),U("div",null,[P(o,{size:"small",onClick:ae},{default:D(()=>[...r[8]||(r[8]=[U("i",{class:"bi bi-eye me-1"},null,-1),E(" 预览 ",-1)])]),_:1}),P(o,{size:"small",onClick:le},{default:D(()=>[...r[9]||(r[9]=[U("i",{class:"bi bi-arrow-repeat me-1"},null,-1),E(" 重新上传 ",-1)])]),_:1})])])]),_:1})])):(q(),V("div",ye,[m.value?(q(),V("div",ge,[P(h,{type:"success",closable:!1},{title:D(()=>[U("div",ke,[U("span",null,[r[13]||(r[13]=U("i",{class:"bi bi-check-circle-fill me-2"},null,-1)),E(" 已选择文件: "+A(m.value.name),1)]),P(o,{size:"small",onClick:ee},{default:D(()=>[...r[14]||(r[14]=[U("i",{class:"bi bi-arrow-repeat me-1"},null,-1),E(" 重新选择 ",-1)])]),_:1})])]),_:1}),f.value?(q(),V("div",ze,[U("div",we,[P(k,{class:"is-loading me-2"},{default:D(()=>[P($(s))]),_:1}),U("span",null,A(v.value),1)])])):S("",!0)])):(q(),F(y,{key:0,ref_key:"uploadRef",ref:d,drag:"","auto-upload":!1,limit:1,accept:".docx","on-change":X,"on-remove":Y,"file-list":p.value},{tip:D(()=>[...r[10]||(r[10]=[U("div",{class:"el-upload__tip"},[U("div",null,[E("推荐使用 "),U("strong",null,".docx"),E(" 格式（兼容性更好），文件大小不超过 50MB")]),U("div",{class:"text-warning",style:{"font-size":"12px","margin-top":"4px"}},[U("i",{class:"bi bi-exclamation-triangle-fill me-1"}),E(" 注意：旧版 .doc 格式暂不支持章节解析，请先转换为 .docx ")])],-1)])]),default:D(()=>[r[11]||(r[11]=U("i",{class:"bi bi-cloud-upload",style:{"font-size":"36px",color:"var(--el-color-primary)"}},null,-1)),r[12]||(r[12]=U("div",{class:"el-upload__text"},[E(" 拖拽文件到此处或 "),U("em",null,"点击上传")],-1))]),_:1},8,["file-list"]))])),R.value||l.responseFileInfo||l.technicalFileInfo?(q(),V("div",je,[U("div",xe,[O(a.$slots,"selectors",{},void 0,!0)]),U("div",Ce,[l.responseFileInfo?(q(),V("div",Ve,[P(o,{type:"primary",size:"large",onClick:r[0]||(r[0]=e=>u("start-business"))},{default:D(()=>[...r[15]||(r[15]=[U("i",{class:"bi bi-rocket-takeoff me-1"},null,-1),E(" 开始商务应答 ",-1)])]),_:1}),r[16]||(r[16]=U("span",{class:"action-hint"},"确认公司和应答文件模板后开始。",-1))])):S("",!0),l.technicalFileInfo?(q(),V("div",qe,[P(o,{type:"primary",size:"large",onClick:r[1]||(r[1]=e=>u("start-p2p"))},{default:D(()=>[...r[17]||(r[17]=[U("i",{class:"bi bi-arrow-left-right me-1"},null,-1),E(" 开始点对点应答 ",-1)])]),_:1}),r[18]||(r[18]=U("span",{class:"action-hint"},"根据标书要求，选做。",-1))])):S("",!0),l.technicalFileInfo?(q(),V("div",Ie,[P(o,{type:"primary",size:"large",onClick:r[2]||(r[2]=e=>u("start-proposal"))},{default:D(()=>[...r[19]||(r[19]=[U("i",{class:"bi bi-file-code me-1"},null,-1),E(" 开始技术方案编写 ",-1)])]),_:1}),r[20]||(r[20]=U("span",{class:"action-hint"},"开始应答。",-1))])):S("",!0)])])):S("",!0)])]),_:3})]),_:3}),P(j,{xs:24,sm:24,md:14,lg:14},{default:D(()=>[z.value.length>0?(q(),F(w,{key:0,shadow:"hover",class:"step-card"},{header:D(()=>[U("div",Ue,[r[21]||(r[21]=U("i",{class:"bi bi-list-nested me-2 text-success"},null,-1)),r[22]||(r[22]=U("span",{class:"step-title"},"步骤2: 选择章节",-1)),W.value>0?(q(),F(c,{key:0,type:"success",size:"small",class:"ms-2"},{default:D(()=>[E(" 已选 "+A(W.value)+" 个 ",1)]),_:1})):S("",!0)])]),default:D(()=>{return[U("div",Se,[U("div",Ae,[U("div",Ee,[r[23]||(r[23]=U("div",{class:"stat-label"},"总章节数",-1)),U("div",Pe,A(L.value),1)]),U("div",De,[r[24]||(r[24]=U("div",{class:"stat-label"},"已选择",-1)),U("div",Ne,A(W.value),1)]),U("div",Te,[r[25]||(r[25]=U("div",{class:"stat-label"},"选中字数",-1)),U("div",Fe,A((e=M.value,e>=1e4?`${(e/1e4).toFixed(1)}万`:e.toLocaleString())),1)])]),U("div",$e,[P(C,null,{default:D(()=>[P(o,{size:"small",onClick:se},{default:D(()=>[...r[26]||(r[26]=[U("i",{class:"bi bi-check-all me-1"},null,-1),E(" 全选 ",-1)])]),_:1}),P(o,{size:"small",onClick:ne},{default:D(()=>[...r[27]||(r[27]=[U("i",{class:"bi bi-x me-1"},null,-1),E(" 全不选 ",-1)])]),_:1}),P(o,{size:"small",type:"success",onClick:re},{default:D(()=>[...r[28]||(r[28]=[U("i",{class:"bi bi-cpu me-1"},null,-1),E(" 仅选技术章节 ",-1)])]),_:1}),P(o,{size:"small",type:"warning",onClick:ce},{default:D(()=>[...r[29]||(r[29]=[U("i",{class:"bi bi-file-x me-1"},null,-1),E(" 排除合同条款 ",-1)])]),_:1})]),_:1})]),P(g,{ref_key:"chapterTreeRef",ref:_,chapters:z.value,onCheck:ie},null,8,["chapters"]),U("div",Oe,[P(N,{size:16},{default:D(()=>[P(o,{type:"info",size:"large",disabled:0===W.value,loading:x.value,onClick:de},{default:D(()=>[...r[30]||(r[30]=[U("i",{class:"bi bi-file-earmark-arrow-down me-1"},null,-1),E(" 另存为应答文件 ",-1)])]),_:1},8,["disabled","loading"]),P(o,{type:"success",size:"large",disabled:0===W.value,loading:I.value,onClick:_e},{default:D(()=>[...r[31]||(r[31]=[U("i",{class:"bi bi-file-code me-1"},null,-1),E(" 另存为技术需求 ",-1)])]),_:1},8,["disabled","loading"])]),_:1})])])];var e}),_:1})):S("",!0)]),_:1})]),_:3})])}}}),[["__scopeId","data-v-5df3f84c"]]),Le={class:"tender-management-detail"},We={class:"selector-item"},Me={class:"tab-content"},Re={class:"info-section"},Ke={class:"section-header",style:{"justify-content":"space-between"}},Je={key:0,class:"bi bi-magic me-1"},Qe={style:{display:"flex","align-items":"center",gap:"10px"}},Ze={key:0,class:"amount"},Ge={key:1},He={key:1,class:"text-muted"},Xe={key:1,class:"text-muted"},Ye={class:"tab-content"},ea={class:"info-section"},aa={class:"section-header"},la={key:0,class:"bi bi-magic me-1"},ta={key:0,class:"requirements-list"},ia={class:"requirement-content"},sa={class:"requirement-text"},na={key:0},ra={key:1},ca={class:"requirement-status"},oa={class:"info-section"},ua={key:0,class:"requirements-list"},da={class:"requirement-content"},_a={class:"requirement-text"},pa={key:0},ma={key:1},fa={key:2},va={class:"requirement-status"},ha={class:"info-section"},ba={key:0,class:"requirements-list"},ya={class:"requirement-content"},ga={class:"requirement-text"},ka={key:0},za={key:1},wa={key:2},ja={class:"requirement-status"},xa={class:"info-section"},Ca={key:0,class:"financial-requirements"},Va={class:"requirement-content"},qa={class:"requirement-text"},Ia={class:"tab-label"},Ua={class:"tab-content"},Sa={class:"file-section"},Aa={class:"section-header"},Ea={class:"file-section"},Pa={class:"section-header"},Da={class:"action-area"},Na={class:"tab-label"},Ta={class:"tab-content"},Fa={class:"file-section"},$a={class:"section-header"},Oa={class:"file-section"},Ba={class:"section-header"},La={class:"file-section"},Wa={class:"section-header"},Ma={class:"action-area"},Ra={class:"tab-label"},Ka={class:"tab-content"},Ja={class:"info-section"},Qa={class:"section-header"},Za={key:0,class:"documents-grid"},Ga={class:"action-area"},Ha={key:1,class:"info-section"},Xa={class:"section-header"},Ya=l(x({__name:"ManagementDetail",setup(l){const i=c(),s=o(),n=ee(),x=N(!1),I=N(!1),O=N(!1),H=N(null),ne=N("basic"),re=N([]),ce=N(!1),oe=N(!1),ue=N([]),de=N([]),pe=N([]),me=N(!1),fe=N(!1),ve=N(""),he=N(""),be=B({name:"",number:"",company_id:null,tenderer:"",agency:"",bidding_method:"",bidding_location:"",bidding_time:"",budget_amount:null,business_contact_name:"",business_contact_phone:"",tenderer_contact_person:"",tenderer_contact_method:"",agency_contact_person:"",agency_contact_method:"",authorized_person_name:"",authorized_person_id:"",product_category_id:null,product_category_name:"",product_items:[]}),ye={name:[{required:!0,message:"请输入项目名称",trigger:"blur"}],number:[{required:!0,message:"请输入项目编号",trigger:"blur"}],company_id:[{required:!0,message:"请选择公司",trigger:"change"}]},ge=C(()=>Number(i.params.id)),ke=C(()=>{var e;return(null==(e=H.value)?void 0:e.name)||"项目详情"}),ze=C(()=>{const e=a=>{let l=a.length;return a.forEach(a=>{a.children&&a.children.length>0&&(l+=e(a.children))}),l};return e(pe.value)}),we=C(()=>{if(!be.product_category_id)return[];const e=de.value.find(e=>e.category_id===be.product_category_id);return(null==e?void 0:e.items)||[]}),je=e=>e?"string"==typeof e?{fileUrl:e,fileName:void 0,fileSize:void 0}:{fileUrl:e.file_url||e.download_url||e.file_path||"",fileName:e.filename||e.file_name,fileSize:e.file_size}:null,xe=C(()=>{var e,a;return je(null==(a=null==(e=H.value)?void 0:e.step1_data)?void 0:a.response_file_path)}),Ce=C(()=>{var e,a;return je(null==(a=null==(e=H.value)?void 0:e.step1_data)?void 0:a.business_response_file)}),Ve=C(()=>{var e,a;return je(null==(a=null==(e=H.value)?void 0:e.step1_data)?void 0:a.technical_file_path)}),qe=C(()=>{var e,a;return je(null==(a=null==(e=H.value)?void 0:e.step1_data)?void 0:a.technical_point_to_point_file)}),Ie=C(()=>{var e,a;return je(null==(a=null==(e=H.value)?void 0:e.step1_data)?void 0:a.technical_proposal_file)}),Ue={business_license:"营业执照信息",legal_id_front:"法人身份证正面",legal_id_back:"法人身份证反面",auth_id_front:"被授权人身份证正面",auth_id_back:"被授权人身份证反面",authorization_letter:"法人授权委托书",bank_permit:"开户许可证",iso9001:"ISO9001质量管理体系认证",iso20000:"ISO20000信息技术服务管理体系认证",iso27001:"ISO27001信息安全管理体系认证",cmmi:"CMMI能力成熟度认证",itss:"ITSS信息技术服务标准认证",value_added_telecom_permit:"增值电信业务许可证",basic_telecom_permit:"基础电信业务许可证",level_protection:"等级保护认证",software_copyright:"软件著作权",patent_certificate:"专利证书",safety_production:"安全生产许可证",project_performance:"项目业绩要求",audit_report:"财务审计报告",social_security:"社会保险证明",dishonest_executor:"失信被执行人",tax_violation_check:"重大税收违法",gov_procurement_creditchina:"政府采购严重违法失信记录（信用中国）",gov_procurement_ccgp:"政府采购严重违法失信记录（政府采购网）",tax_compliance:"依法纳税",commitment_letter:"承诺函",property_certificate:"营业办公场所房产证明",deposit_requirement:"保证金要求",purchaser_blacklist:"采购人黑名单"},Se=C(()=>{var e;const a=null==(e=H.value)?void 0:e.qualifications_data;return a&&"object"==typeof a&&Object.keys(a).length>0?(e=>{const a=[],l=[],t=[];let i=null;const s=["业绩","项目","案例","合同","performance","project"],n=["人员","项目经理","技术负责人","工程师","personnel","staff"],r=["财务","资本","资产","审计","银行","注册资金","营业额","audit","financial"],c={},o=new Set;return Object.entries(e).forEach(([a,l])=>{if(o.has(a))return;const t=a.endsWith("_front")||a.includes("_id_front"),i=a.endsWith("_back")||a.includes("_id_back");if(t){const t=a.replace("_front","_back"),i=e[t];if(i){const e=(l.qualification_name||a).replace("正面","").replace("反面","").trim(),s=l.tender_description||"",n=i.tender_description||"";let r=s;n&&n!==s&&(r=`${s}\n${n}`),r=r?`【需提供正反面】\n${r}`:"需提供正反面",c[a.replace("_front","")]={...l,qualification_name:e,tender_description:r,required_by_tender:l.required_by_tender||i.required_by_tender,is_merged:!0,original_keys:[a,t]},o.add(a),o.add(t)}else c[a]=l,o.add(a)}else if(i){const t=a.replace("_back","_front");e[t]||(c[a]=l,o.add(a))}else c[a]=l,o.add(a)}),Object.entries(c).forEach(([e,c])=>{const o=1==c.required_by_tender||!0===c.required_by_tender||"mandatory"===c.constraint_type,u=c.tender_description||c.detail||"",d=c.qualification_name||c.summary||e,_=c.category||"";"财务要求"===_||_.includes("财务")||r.some(a=>e.includes(a)||_.includes(a))?(i||(i={description:[]}),i.description.push(`${d}: ${u}`)):"业绩要求"===_||s.some(a=>e.includes(a)||_.includes(a))?l.push({description:d,detail:u,required:o}):_.includes("人员")||n.some(a=>e.includes(a)||_.includes(a))?t.push({position:d,detail:u,required:o}):a.push({name:d,note:u,required:o,category:_})}),i&&i.description&&(i.description=i.description.join("；")),{certifications:a,performance:l,personnel:t,financial:i}})(a):{certifications:[],performance:[],personnel:[],financial:null}}),Ae=async()=>{if(ge.value){x.value=!0;try{const a=(await K.getProject(ge.value)).data;H.value={id:a.project_id,name:a.project_name,number:a.project_number,company_id:a.company_id,company_name:a.company_name,status:a.status,created_at:a.created_at,updated_at:a.updated_at,authorized_person_name:a.authorized_person_name,authorized_person_id:a.authorized_person_id,tenderer:a.tenderer,agency:a.agency,bidding_method:a.bidding_method,bidding_location:a.bidding_location,bidding_time:a.bidding_time,budget_amount:a.budget_amount,business_contact_name:a.business_contact_name,business_contact_phone:a.business_contact_phone,tenderer_contact_person:a.tenderer_contact_person,tenderer_contact_method:a.tenderer_contact_method,agency_contact_person:a.agency_contact_person,agency_contact_method:a.agency_contact_method,step1_data:a.step1_data,...a},be.name=H.value.name||"",be.number=H.value.number||"",be.company_id=H.value.company_id||null,be.tenderer=H.value.tenderer||"",be.agency=H.value.agency||"",be.bidding_method=H.value.bidding_method||"",be.bidding_location=H.value.bidding_location||"",be.bidding_time=H.value.bidding_time||"",be.budget_amount=H.value.budget_amount||null,be.business_contact_name=H.value.business_contact_name||"",be.business_contact_phone=H.value.business_contact_phone||"",be.tenderer_contact_person=H.value.tenderer_contact_person||"",be.tenderer_contact_method=H.value.tenderer_contact_method||"",be.agency_contact_person=H.value.agency_contact_person||"",be.agency_contact_method=H.value.agency_contact_method||"",be.authorized_person_name=H.value.authorized_person_name||"",be.authorized_person_id=H.value.authorized_person_id||"",be.product_category_id=H.value.product_category_id||null,be.product_category_name=H.value.product_category_name||"";const l=H.value.product_items;if("string"==typeof l)try{be.product_items=JSON.parse(l)||[]}catch{be.product_items=[]}else be.product_items=l||[];if(a.step1_data)try{const e="string"==typeof a.step1_data?JSON.parse(a.step1_data):a.step1_data;if(e.chapters&&Array.isArray(e.chapters)){const a=e=>e.filter(e=>!(e.para_start_idx>=e.para_end_idx)&&(0!==e.word_count&&(e.children&&Array.isArray(e.children)&&(e.children=a(e.children)),!0)));pe.value=a(e.chapters).map(e=>({...e,children:[]})),pe.value.length,e.chapters.length}const l=[];let t=1;if(a.tender_document_path&&l.push({id:t++,file_path:a.tender_document_path,file_url:a.tender_document_path,original_filename:"招标文档",document_type:"tender",uploaded_at:a.created_at}),e.response_file_path&&l.push({id:t++,file_path:e.response_file_path,file_url:e.response_file_path,original_filename:e.response_filename||"应答文件模板",document_type:"response_template",file_size:e.response_file_size,uploaded_at:a.updated_at}),e.technical_file_path&&l.push({id:t++,file_path:e.technical_file_path,file_url:e.technical_file_path,original_filename:e.technical_filename||"技术需求文件",document_type:"technical",file_size:e.technical_file_size,uploaded_at:a.updated_at}),e.business_response_file){const i="string"==typeof e.business_response_file?{file_path:e.business_response_file}:e.business_response_file;l.push({id:t++,file_path:i.file_path||i.file_url,file_url:i.file_url||i.file_path,original_filename:i.file_name||"商务应答完成文件",document_type:"business_response",file_size:i.file_size,uploaded_at:a.updated_at})}if(e.technical_point_to_point_file){const i="string"==typeof e.technical_point_to_point_file?{file_path:e.technical_point_to_point_file}:e.technical_point_to_point_file;l.push({id:t++,file_path:i.file_path||i.file_url,file_url:i.file_url||i.file_path,original_filename:i.file_name||"技术点对点应答文件",document_type:"technical_p2p",file_size:i.file_size,uploaded_at:a.updated_at})}if(e.technical_proposal_file){const i="string"==typeof e.technical_proposal_file?{file_path:e.technical_proposal_file}:e.technical_proposal_file;l.push({id:t++,file_path:i.file_path||i.file_url,file_url:i.file_url||i.file_path,original_filename:i.file_name||"技术方案文件",document_type:"technical_proposal",file_size:i.file_size,uploaded_at:a.updated_at})}ue.value=l}catch(e){}"新项目"!==H.value.name&&"draft"!==H.value.status||(O.value=!0),H.value&&n.setCurrentProject(H.value)}catch(l){a.error("加载项目详情失败")}finally{x.value=!1}}},Ee=e=>{if(!e)return be.product_category_name="",void(be.product_items=[]);const a=de.value.find(a=>a.category_id===e);a&&(be.product_category_name=a.category_name,be.product_items=[])},Pe=e=>e.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2}),De=e=>({active:"进行中",completed:"已完成",draft:"草稿"}[e]||e),Ne=()=>{Ae()},Te=()=>{O.value=!0},Fe=()=>{r.confirm("确定要取消编辑吗？未保存的更改将丢失","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Ae(),O.value=!1}).catch(()=>{})},$e=async()=>{var e,l;I.value=!0;try{const e={project_name:be.name,project_number:be.number,company_id:be.company_id,tenderer:be.tenderer,agency:be.agency,bidding_method:be.bidding_method,bidding_location:be.bidding_location,bidding_time:be.bidding_time,budget_amount:be.budget_amount,business_contact_name:be.business_contact_name,business_contact_phone:be.business_contact_phone,tenderer_contact_person:be.tenderer_contact_person,tenderer_contact_method:be.tenderer_contact_method,agency_contact_person:be.agency_contact_person,agency_contact_method:be.agency_contact_method,authorized_person_name:be.authorized_person_name,authorized_person_id:be.authorized_person_id,product_category_id:be.product_category_id,product_category_name:be.product_category_name,product_items:be.product_items,status:"active"};await K.updateProject(ge.value,e),a.success("保存成功"),O.value=!1,me.value=!1,await Ae()}catch(t){const i=(null==(l=null==(e=null==t?void 0:t.response)?void 0:e.data)?void 0:l.message)||(null==t?void 0:t.message)||"保存失败，请检查项目名称和编号是否与其他项目重复";a.error({message:i,duration:5e3,showClose:!0})}finally{I.value=!1}},Oe=async()=>{var e;if(!H.value)return;(null==(e=H.value.step1_data)?void 0:e.response_file_path)?(n.setCurrentProject(H.value),await s.push({name:"BusinessResponse"})):a.warning("未找到应答文件模板")},Ya=async()=>{var e;if(!H.value)return;(null==(e=H.value.step1_data)?void 0:e.technical_file_path)?(n.setCurrentProject(H.value),await s.push({name:"PointToPoint"})):a.warning("未找到技术需求文件")},el=async()=>{var e;if(!H.value)return;(null==(e=H.value.step1_data)?void 0:e.technical_file_path)?(n.setCurrentProject(H.value),await s.push({name:"TechProposal"})):a.warning("未找到技术需求文件")},al=async()=>{H.value&&(n.setCurrentProject(H.value),await s.push({name:"FinalTender"}))},ll=async()=>{var e,l;await Ae();if(!(null==(e=H.value)?void 0:e.tenderer)&&!(null==(l=H.value)?void 0:l.qualifications_data)){a.info("开始自动执行AI提取...");try{await il(),await $e(),await sl(),a.success("AI自动提取完成！")}catch(t){a.warning("自动AI提取失败，请手动点击按钮重试")}}},tl=async e=>{await Ae(),"response"===e?(a.success("应答文件已保存，可以开始商务应答处理"),ne.value="business"):"technical"===e&&(a.success("技术需求已保存，可以开始技术方案编写"),ne.value="technical")},il=async()=>{if(ge.value){ce.value=!0;try{const e=await K.extractBasicInfo(ge.value);if(!e.success||!e.data)throw new Error(e.error||"AI提取失败");{const l=e.data,t=e=>{if(!e)return null;const a=String(e),l=a.match(/[\d.]+/);if(!l)return null;const t=parseFloat(l[0]);return isNaN(t)?null:a.includes("万")?1e4*t:t};Object.assign(be,{name:l.project_name||be.name,number:l.project_number||be.number,tenderer:l.tender_party||be.tenderer,agency:l.tender_agent||be.agency,bidding_method:l.tender_method||be.bidding_method,bidding_location:l.tender_location||be.bidding_location,bidding_time:l.tender_deadline||be.bidding_time,budget_amount:t(l.budget_amount)||be.budget_amount,tenderer_contact_person:l.tenderer_contact_person||be.tenderer_contact_person,tenderer_contact_method:l.tenderer_contact_method||be.tenderer_contact_method,agency_contact_person:l.agency_contact_person||be.agency_contact_person,agency_contact_method:l.agency_contact_method||be.agency_contact_method}),H.value&&Object.assign(H.value,{name:l.project_name||H.value.name,number:l.project_number||H.value.number,tenderer:l.tender_party||H.value.tenderer,agency:l.tender_agent||H.value.agency,bidding_method:l.tender_method||H.value.bidding_method,bidding_location:l.tender_location||H.value.bidding_location,bidding_time:l.tender_deadline||H.value.bidding_time,budget_amount:l.budget_amount?parseFloat(String(l.budget_amount).replace(/[^\d.]/g,"")||"0"):H.value.budget_amount,tenderer_contact_person:l.tenderer_contact_person||H.value.tenderer_contact_person,tenderer_contact_method:l.tenderer_contact_method||H.value.tenderer_contact_method,agency_contact_person:l.agency_contact_person||H.value.agency_contact_person,agency_contact_method:l.agency_contact_method||H.value.agency_contact_method}),O.value||(O.value=!0),me.value=!0,a.success({message:"AI提取基本信息成功，已进入编辑模式，请检查信息后手动保存",duration:5e3,showClose:!0}),setTimeout(()=>{const e=document.querySelector(".info-section");e&&e.scrollIntoView({behavior:"smooth",block:"start"})},300)}}catch(e){a.error(`AI提取失败: ${e instanceof Error?e.message:"未知错误"}`)}finally{ce.value=!1}}else a.warning("请先上传并解析招标文档")},sl=async()=>{if(ge.value){oe.value=!0;try{const e=await K.extractQualifications(ge.value);if(!e.success)throw new Error(e.error||"AI提取失败");a.success("AI提取资格要求成功，正在刷新数据..."),await Ae(),a.success("资格要求已更新")}catch(e){a.error(`AI提取失败: ${e instanceof Error?e.message:"未知错误"}`)}finally{oe.value=!1}}else a.warning("请先上传并解析招标文档")},nl=(e,a)=>{ve.value=e,he.value=a,fe.value=!0};return T(()=>be.company_id,e=>{if(e&&re.value.length>0){const l=re.value.find(a=>a.company_id===e);l&&(be.authorized_person_name=l.authorized_person_name||"",be.authorized_person_id=l.authorized_person_id||"",H.value&&(H.value.authorized_person_name=l.authorized_person_name||"",H.value.authorized_person_id=l.authorized_person_id||""),l.authorized_person_name&&a.success(`已自动填充被授权人信息: ${l.authorized_person_name}`))}}),T(()=>i.params.id,()=>{Ae()}),L(()=>{(async()=>{try{const e=await X.getCompanies();re.value=e.data||[]}catch(e){}})(),(async()=>{try{const e=await Y.getProductCategories();e.success&&(de.value=e.data||[])}catch(e){}})(),Ae()}),(a,l)=>{const i=w,s=z,n=Q,r=J,c=e,o=G,C=_,N=d,T=k,B=le,L=ae,K=u,X=ie,Y=b,ee=te,je=h,rl=Z,cl=se,ol=p,ul=f,dl=m,_l=t,pl=v;return q(),V("div",Le,[P($(y),{title:ke.value,"show-back":!0,ghost:!0},null,8,["title"]),x.value?(q(),F($(j),{key:0,text:"加载项目详情..."})):H.value?(q(),V(W,{key:1},[P(Be,{"project-id":ge.value,"company-id":H.value.company_id,"project-detail":H.value,"response-file-info":xe.value,"technical-file-info":Ve.value,onSuccess:tl,onRefresh:Ae,onParseComplete:ll,onPreview:nl,onStartBusiness:Oe,onStartP2p:Ya,onStartProposal:el},{selectors:D(()=>[P(r,{gutter:16},{default:D(()=>[P(n,{span:24},{default:D(()=>[U("div",We,[l[17]||(l[17]=U("span",{class:"selector-label"},"公司：",-1)),P(s,{modelValue:be.company_id,"onUpdate:modelValue":l[0]||(l[0]=e=>be.company_id=e),placeholder:"请选择公司",style:{width:"100%"}},{default:D(()=>[(q(!0),V(W,null,M(re.value,e=>(q(),F(i,{key:e.company_id,label:e.name,value:e.company_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["project-id","company-id","project-detail","response-file-info","technical-file-info"]),P(rl,{class:"tabs-card",shadow:"never"},{default:D(()=>[P(pl,{modelValue:ne.value,"onUpdate:modelValue":l[15]||(l[15]=e=>ne.value=e),class:"detail-tabs"},{default:D(()=>[P(je,{name:"basic"},{label:D(()=>[...l[18]||(l[18]=[U("span",{class:"tab-label"},[U("i",{class:"bi bi-info-circle"}),E(" 基本信息 ")],-1)])]),default:D(()=>[U("div",Me,[U("section",Re,[U("div",Ke,[P(c,{size:"small",type:"primary",loading:ce.value,disabled:!ge.value||ce.value,onClick:il},{default:D(()=>[ce.value?S("",!0):(q(),V("i",Je)),E(" "+A(ce.value?"AI提取中...":"AI提取基本信息"),1)]),_:1},8,["loading","disabled"]),U("div",Qe,[me.value&&O.value?(q(),F(o,{key:0,type:"warning",size:"small"},{default:D(()=>[...l[19]||(l[19]=[U("i",{class:"bi bi-exclamation-triangle-fill"},null,-1),E(" 有未保存的更改 ",-1)])]),_:1})):S("",!0),O.value?S("",!0):(q(),V(W,{key:1},[P(c,{size:"small",onClick:Ne},{default:D(()=>[...l[20]||(l[20]=[U("i",{class:"bi bi-arrow-clockwise"},null,-1),E(" 刷新 ",-1)])]),_:1}),P(c,{size:"small",type:"primary",onClick:Te},{default:D(()=>[...l[21]||(l[21]=[U("i",{class:"bi bi-pencil"},null,-1),E(" 编辑项目 ",-1)])]),_:1})],64)),O.value?(q(),V(W,{key:2},[P(c,{size:"small",onClick:Fe},{default:D(()=>[...l[22]||(l[22]=[U("i",{class:"bi bi-x-lg"},null,-1),E(" 取消 ",-1)])]),_:1}),P(c,{size:"small",type:"primary",loading:I.value,onClick:$e},{default:D(()=>[...l[23]||(l[23]=[U("i",{class:"bi bi-check-lg"},null,-1),E(" 保存 ",-1)])]),_:1},8,["loading"])],64)):S("",!0)])]),O.value?(q(),F(K,{key:0,model:be,rules:ye,"label-width":"120px",class:"edit-form"},{default:D(()=>[P(r,{gutter:20},{default:D(()=>[P(n,{span:12},{default:D(()=>[P(N,{label:"项目名称",prop:"name"},{default:D(()=>[P(C,{modelValue:be.name,"onUpdate:modelValue":l[1]||(l[1]=e=>be.name=e),placeholder:"请输入项目名称"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"项目编号",prop:"number"},{default:D(()=>[P(C,{modelValue:be.number,"onUpdate:modelValue":l[2]||(l[2]=e=>be.number=e),placeholder:"请输入项目编号"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"招标单位"},{default:D(()=>[P(C,{modelValue:be.tenderer,"onUpdate:modelValue":l[3]||(l[3]=e=>be.tenderer=e),placeholder:"请输入招标单位"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"招标代理"},{default:D(()=>[P(C,{modelValue:be.agency,"onUpdate:modelValue":l[4]||(l[4]=e=>be.agency=e),placeholder:"请输入招标代理"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"招标方式"},{default:D(()=>[P(C,{modelValue:be.bidding_method,"onUpdate:modelValue":l[5]||(l[5]=e=>be.bidding_method=e),placeholder:"请输入招标方式"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"开标地点"},{default:D(()=>[P(C,{modelValue:be.bidding_location,"onUpdate:modelValue":l[6]||(l[6]=e=>be.bidding_location=e),placeholder:"请输入开标地点"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"开标时间"},{default:D(()=>[P(C,{modelValue:be.bidding_time,"onUpdate:modelValue":l[7]||(l[7]=e=>be.bidding_time=e),placeholder:"请输入开标时间"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"预算金额"},{default:D(()=>[P(T,{modelValue:be.budget_amount,"onUpdate:modelValue":l[8]||(l[8]=e=>be.budget_amount=e),controls:!1,precision:2,placeholder:"请输入预算金额",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"招标方联系人"},{default:D(()=>[P(C,{modelValue:be.tenderer_contact_person,"onUpdate:modelValue":l[9]||(l[9]=e=>be.tenderer_contact_person=e),placeholder:"请输入招标方联系人"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"招标方联系电话"},{default:D(()=>[P(C,{modelValue:be.tenderer_contact_method,"onUpdate:modelValue":l[10]||(l[10]=e=>be.tenderer_contact_method=e),placeholder:"请输入招标方联系电话"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"代理机构联系人"},{default:D(()=>[P(C,{modelValue:be.agency_contact_person,"onUpdate:modelValue":l[11]||(l[11]=e=>be.agency_contact_person=e),placeholder:"请输入代理机构联系人"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"代理机构联系电话"},{default:D(()=>[P(C,{modelValue:be.agency_contact_method,"onUpdate:modelValue":l[12]||(l[12]=e=>be.agency_contact_method=e),placeholder:"请输入代理机构联系电话"},null,8,["modelValue"])]),_:1})]),_:1}),P(n,{span:12},{default:D(()=>[P(N,{label:"产品分类"},{default:D(()=>[P(s,{modelValue:be.product_category_id,"onUpdate:modelValue":l[13]||(l[13]=e=>be.product_category_id=e),placeholder:"选择产品分类",clearable:"",style:{width:"100%"},onChange:Ee},{default:D(()=>[(q(!0),V(W,null,M(de.value,e=>(q(),F(i,{key:e.category_id,label:e.category_name,value:e.category_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),we.value.length>0?(q(),F(n,{key:0,span:12},{default:D(()=>[P(N,{label:"具体产品"},{default:D(()=>[P(L,{modelValue:be.product_items,"onUpdate:modelValue":l[14]||(l[14]=e=>be.product_items=e)},{default:D(()=>[(q(!0),V(W,null,M(we.value,e=>(q(),F(B,{key:e.item_id,label:e.item_name},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):S("",!0)]),_:1})]),_:1},8,["model"])):(q(),F(ee,{key:1,column:2,border:""},{default:D(()=>[P(X,{label:"项目名称",span:2},{default:D(()=>[U("strong",null,A(H.value.name),1)]),_:1}),P(X,{label:"项目编号"},{default:D(()=>[E(A(H.value.number||"-"),1)]),_:1}),P(X,{label:"创建时间"},{default:D(()=>[E(A(H.value.created_at),1)]),_:1}),P(X,{label:"最后更新"},{default:D(()=>[E(A(H.value.updated_at||"-"),1)]),_:1}),P(X,{label:"状态"},{default:D(()=>{return[P(o,{type:(e=H.value.status,{active:"success",completed:"primary",draft:"info"}[e]||"info")},{default:D(()=>[E(A(De(H.value.status)),1)]),_:1},8,["type"])];var e}),_:1}),P(X,{label:"招标单位"},{default:D(()=>[E(A(H.value.tenderer||"-"),1)]),_:1}),P(X,{label:"招标代理"},{default:D(()=>[E(A(H.value.agency||"-"),1)]),_:1}),P(X,{label:"招标方式"},{default:D(()=>[E(A(H.value.bidding_method||"-"),1)]),_:1}),P(X,{label:"开标地点"},{default:D(()=>[E(A(H.value.bidding_location||"-"),1)]),_:1}),P(X,{label:"开标时间"},{default:D(()=>[E(A(H.value.bidding_time||"-"),1)]),_:1}),P(X,{label:"预算金额"},{default:D(()=>[H.value.budget_amount?(q(),V("span",Ze," ¥ "+A(Pe(H.value.budget_amount)),1)):(q(),V("span",Ge,"-"))]),_:1}),P(X,{label:"招标方联系人"},{default:D(()=>[E(A(H.value.tenderer_contact_person||"-"),1)]),_:1}),P(X,{label:"招标方联系电话"},{default:D(()=>[E(A(H.value.tenderer_contact_method||"-"),1)]),_:1}),P(X,{label:"代理机构联系人"},{default:D(()=>[E(A(H.value.agency_contact_person||"-"),1)]),_:1}),P(X,{label:"代理机构联系电话"},{default:D(()=>[E(A(H.value.agency_contact_method||"-"),1)]),_:1}),P(X,{label:"产品分类"},{default:D(()=>[H.value.product_category_name?(q(),F(o,{key:0,type:"primary"},{default:D(()=>[E(A(H.value.product_category_name),1)]),_:1})):(q(),V("span",He,"未选择"))]),_:1}),P(X,{label:"具体产品"},{default:D(()=>{var e;return[(null==(e=H.value.product_items)?void 0:e.length)?(q(),F(Y,{key:0,wrap:""},{default:D(()=>[(q(!0),V(W,null,M(H.value.product_items,e=>(q(),F(o,{key:e,size:"small"},{default:D(()=>[E(A(e),1)]),_:2},1024))),128))]),_:1})):(q(),V("span",Xe,"-"))]}),_:1})]),_:1}))])])]),_:1}),P(je,{name:"qualifications"},{label:D(()=>[...l[24]||(l[24]=[U("span",{class:"tab-label"},[U("i",{class:"bi bi-award"}),E(" 资格要求 ")],-1)])]),default:D(()=>[U("div",Ye,[U("section",ea,[U("div",aa,[l[25]||(l[25]=U("h3",null,[U("i",{class:"bi bi-patch-check"}),E(" 资质要求")],-1)),P(c,{size:"small",type:"primary",loading:oe.value,disabled:!ge.value||oe.value,onClick:sl},{default:D(()=>[oe.value?S("",!0):(q(),V("i",la)),E(" "+A(oe.value?"AI提取中...":"AI提取资格要求"),1)]),_:1},8,["loading","disabled"])]),Se.value.certifications.length>0?(q(),V("div",ta,[(q(!0),V(W,null,M(Se.value.certifications,(e,a)=>(q(),F(rl,{key:a,shadow:"never",class:"requirement-item"},{default:D(()=>{return[U("div",ia,[l[28]||(l[28]=U("div",{class:"requirement-icon"},[U("i",{class:"bi bi-shield-check"})],-1)),U("div",sa,[U("h4",null,A((a=e.name,Ue[a]?Ue[a]:a)),1),e.level?(q(),V("p",na,"等级要求: "+A(e.level),1)):S("",!0),e.note?(q(),V("p",ra,A(e.note),1)):S("",!0)]),U("div",ca,[e.required?(q(),F(o,{key:0,type:"danger",size:"small"},{default:D(()=>[...l[26]||(l[26]=[E(" 必需 ",-1)])]),_:1})):(q(),F(o,{key:1,type:"info",size:"small"},{default:D(()=>[...l[27]||(l[27]=[E("可选",-1)])]),_:1}))])])];var a}),_:2},1024))),128))])):(q(),F(cl,{key:1,description:"暂无资质要求","image-size":80}))]),U("section",oa,[l[32]||(l[32]=U("div",{class:"section-header"},[U("h3",null,[U("i",{class:"bi bi-graph-up-arrow"}),E(" 业绩要求")])],-1)),Se.value.performance.length>0?(q(),V("div",ua,[(q(!0),V(W,null,M(Se.value.performance,(e,a)=>(q(),F(rl,{key:a,shadow:"never",class:"requirement-item"},{default:D(()=>[U("div",da,[l[31]||(l[31]=U("div",{class:"requirement-icon"},[U("i",{class:"bi bi-briefcase"})],-1)),U("div",_a,[U("h4",null,A(e.description),1),e.amount?(q(),V("p",pa,"金额要求: ≥ ¥"+A(Pe(e.amount)),1)):S("",!0),e.time_range?(q(),V("p",ma,"时间范围: "+A(e.time_range),1)):S("",!0),e.count?(q(),V("p",fa,"数量要求: "+A(e.count)+" 个",1)):S("",!0)]),U("div",va,[e.required?(q(),F(o,{key:0,type:"danger",size:"small"},{default:D(()=>[...l[29]||(l[29]=[E(" 必需 ",-1)])]),_:1})):(q(),F(o,{key:1,type:"info",size:"small"},{default:D(()=>[...l[30]||(l[30]=[E("可选",-1)])]),_:1}))])])]),_:2},1024))),128))])):(q(),F(cl,{key:1,description:"暂无业绩要求","image-size":80}))]),U("section",ha,[l[36]||(l[36]=U("div",{class:"section-header"},[U("h3",null,[U("i",{class:"bi bi-people"}),E(" 人员配置要求")])],-1)),Se.value.personnel.length>0?(q(),V("div",ba,[(q(!0),V(W,null,M(Se.value.personnel,(e,a)=>(q(),F(rl,{key:a,shadow:"never",class:"requirement-item"},{default:D(()=>[U("div",ya,[l[35]||(l[35]=U("div",{class:"requirement-icon"},[U("i",{class:"bi bi-person-badge"})],-1)),U("div",ga,[U("h4",null,A(e.position),1),e.count?(q(),V("p",ka,"人数: "+A(e.count)+" 人",1)):S("",!0),e.qualification?(q(),V("p",za,"资格要求: "+A(e.qualification),1)):S("",!0),e.experience?(q(),V("p",wa,"经验要求: "+A(e.experience),1)):S("",!0)]),U("div",ja,[e.required?(q(),F(o,{key:0,type:"danger",size:"small"},{default:D(()=>[...l[33]||(l[33]=[E(" 必需 ",-1)])]),_:1})):(q(),F(o,{key:1,type:"info",size:"small"},{default:D(()=>[...l[34]||(l[34]=[E("可选",-1)])]),_:1}))])])]),_:2},1024))),128))])):(q(),F(cl,{key:1,description:"暂无人员配置要求","image-size":80}))]),U("section",xa,[l[39]||(l[39]=U("div",{class:"section-header"},[U("h3",null,[U("i",{class:"bi bi-cash-stack"}),E(" 财务要求")])],-1)),Se.value.financial?(q(),V("div",Ca,[P(rl,{shadow:"never",class:"requirement-item"},{default:D(()=>[U("div",Va,[l[38]||(l[38]=U("div",{class:"requirement-icon"},[U("i",{class:"bi bi-cash-stack"})],-1)),U("div",qa,[l[37]||(l[37]=U("h4",null,"财务相关要求",-1)),U("p",null,A(Se.value.financial.description),1)])])]),_:1})])):(q(),F(cl,{key:1,description:"暂无财务要求","image-size":80}))])])]),_:1}),P(je,{name:"business"},{label:D(()=>{var e;return[U("span",Ia,[l[40]||(l[40]=U("i",{class:"bi bi-briefcase"},null,-1)),l[41]||(l[41]=E(" 商务应答 ",-1)),(null==(e=H.value.step1_data)?void 0:e.business_response_file)?(q(),F(ol,{key:0,"is-dot":"",type:"success"})):S("",!0)])]}),default:D(()=>[U("div",Ua,[U("section",Sa,[U("div",Aa,[l[43]||(l[43]=U("h3",null,[U("i",{class:"bi bi-file-earmark-text"}),E(" 应答文件模板")],-1)),P(o,{type:"info",size:"small"},{default:D(()=>[...l[42]||(l[42]=[E("AI 自动提取",-1)])]),_:1})]),xe.value?(q(),F(_e,{key:0,"file-url":xe.value.fileUrl,"file-name":xe.value.fileName,"file-size":xe.value.fileSize,"show-actions":!0,onPreview:nl},null,8,["file-url","file-name","file-size"])):(q(),F(cl,{key:1,description:"暂未提取到应答文件模板","image-size":80},{extra:D(()=>[P(ul,{type:"info",size:"small"},{default:D(()=>[...l[44]||(l[44]=[E(" 请先上传招标文件并进行 AI 解析 ",-1)])]),_:1})]),_:1}))]),P(dl),U("section",Ea,[U("div",Pa,[l[47]||(l[47]=U("h3",null,[U("i",{class:"bi bi-file-earmark-check"}),E(" 商务应答完成文件")],-1)),Ce.value?(q(),F(o,{key:0,type:"success",size:"small"},{default:D(()=>[...l[45]||(l[45]=[U("i",{class:"bi bi-check-circle-fill"},null,-1),E(" 已生成 ",-1)])]),_:1})):(q(),F(o,{key:1,type:"info",size:"small"},{default:D(()=>[...l[46]||(l[46]=[E("未生成",-1)])]),_:1}))]),Ce.value?(q(),F(_e,{key:0,"file-url":Ce.value.fileUrl,"file-name":Ce.value.fileName,"file-size":Ce.value.fileSize,"show-actions":!0,type:"success",onPreview:nl},null,8,["file-url","file-name","file-size"])):(q(),F(cl,{key:1,description:"暂未生成商务应答文件","image-size":80},{extra:D(()=>[P(ul,{type:"info",size:"small"},{default:D(()=>[...l[48]||(l[48]=[E(" 点击下方按钮开始生成商务应答 ",-1)])]),_:1})]),_:1}))]),U("div",Da,[P(c,{type:"primary",size:"large",disabled:!xe.value,onClick:Oe},{default:D(()=>[l[49]||(l[49]=U("i",{class:"bi bi-rocket-takeoff"},null,-1)),E(" "+A(Ce.value?"重新生成":"开始")+"商务应答 ",1)]),_:1},8,["disabled"]),xe.value?S("",!0):(q(),F(ul,{key:0,type:"warning",size:"small"},{default:D(()=>[...l[50]||(l[50]=[U("i",{class:"bi bi-exclamation-triangle"},null,-1),E(" 请先上传招标文件并进行 AI 解析 ",-1)])]),_:1}))])])]),_:1}),P(je,{name:"technical"},{label:D(()=>{var e,a;return[U("span",Na,[l[51]||(l[51]=U("i",{class:"bi bi-cpu"},null,-1)),l[52]||(l[52]=E(" 技术需求 ",-1)),(null==(e=H.value.step1_data)?void 0:e.technical_point_to_point_file)||(null==(a=H.value.step1_data)?void 0:a.technical_proposal_file)?(q(),F(ol,{key:0,"is-dot":"",type:"success"})):S("",!0)])]}),default:D(()=>[U("div",Ta,[U("section",Fa,[U("div",$a,[l[54]||(l[54]=U("h3",null,[U("i",{class:"bi bi-file-earmark-text"}),E(" 技术需求文件")],-1)),P(o,{type:"info",size:"small"},{default:D(()=>[...l[53]||(l[53]=[E("AI 自动提取",-1)])]),_:1})]),Ve.value?(q(),F(_e,{key:0,"file-url":Ve.value.fileUrl,"file-name":Ve.value.fileName,"file-size":Ve.value.fileSize,"show-actions":!0,onPreview:nl},null,8,["file-url","file-name","file-size"])):(q(),F(cl,{key:1,description:"暂未提取到技术需求文件","image-size":80}))]),P(dl),U("section",Oa,[U("div",Ba,[l[57]||(l[57]=U("h3",null,[U("i",{class:"bi bi-arrow-left-right"}),E(" 点对点应答完成文件")],-1)),qe.value?(q(),F(o,{key:0,type:"success",size:"small"},{default:D(()=>[...l[55]||(l[55]=[U("i",{class:"bi bi-check-circle-fill"},null,-1),E(" 已生成 ",-1)])]),_:1})):(q(),F(o,{key:1,type:"info",size:"small"},{default:D(()=>[...l[56]||(l[56]=[E("未生成",-1)])]),_:1}))]),qe.value?(q(),F(_e,{key:0,"file-url":qe.value.fileUrl,"file-name":qe.value.fileName,"file-size":qe.value.fileSize,"show-actions":!0,type:"success",onPreview:nl},null,8,["file-url","file-name","file-size"])):(q(),F(cl,{key:1,description:"暂未生成点对点应答文件","image-size":80}))]),P(dl),U("section",La,[U("div",Wa,[l[60]||(l[60]=U("h3",null,[U("i",{class:"bi bi-file-code"}),E(" 技术方案完成文件")],-1)),Ie.value?(q(),F(o,{key:0,type:"success",size:"small"},{default:D(()=>[...l[58]||(l[58]=[U("i",{class:"bi bi-check-circle-fill"},null,-1),E(" 已生成 ",-1)])]),_:1})):(q(),F(o,{key:1,type:"info",size:"small"},{default:D(()=>[...l[59]||(l[59]=[E("未生成",-1)])]),_:1}))]),Ie.value?(q(),F(_e,{key:0,"file-url":Ie.value.fileUrl,"file-name":Ie.value.fileName,"file-size":Ie.value.fileSize,"show-actions":!0,type:"success",onPreview:nl},null,8,["file-url","file-name","file-size"])):(q(),F(cl,{key:1,description:"暂未生成技术方案文件","image-size":80}))]),U("div",Ma,[P(Y,{size:16},{default:D(()=>[P(c,{type:"primary",size:"large",disabled:!Ve.value,onClick:Ya},{default:D(()=>[l[61]||(l[61]=U("i",{class:"bi bi-arrow-left-right"},null,-1)),E(" "+A(qe.value?"重新生成":"开始")+"点对点应答 ",1)]),_:1},8,["disabled"]),P(c,{type:"primary",size:"large",disabled:!Ve.value,onClick:el},{default:D(()=>[l[62]||(l[62]=U("i",{class:"bi bi-file-code"},null,-1)),E(" "+A(Ie.value?"重新生成":"开始")+"技术方案编写 ",1)]),_:1},8,["disabled"])]),_:1}),Ve.value?S("",!0):(q(),F(_l,{key:0,type:"warning",closable:!1,class:"mt-3"},{title:D(()=>[...l[63]||(l[63]=[U("div",{style:{"font-size":"13px"}},[U("i",{class:"bi bi-info-circle-fill me-2"}),U("strong",null,"操作提示："),E("需要先保存技术需求文件 ")],-1)])]),default:D(()=>[l[64]||(l[64]=U("div",{style:{"font-size":"12px","line-height":"1.6","margin-top":"8px"}},[E(" 请按以下步骤操作："),U("br"),E(" 1. 在页面顶部上传招标文档并解析"),U("br"),E(" 2. 选择技术相关的章节"),U("br"),E(' 3. 点击"'),U("strong",null,"另存为技术需求"),E('"按钮'),U("br"),E(" 4. 保存成功后，本按钮将自动启用 ")],-1))]),_:1}))])])]),_:1}),P(je,{name:"documents"},{label:D(()=>[U("span",Ra,[l[65]||(l[65]=U("i",{class:"bi bi-files"},null,-1)),l[66]||(l[66]=E(" 文档与章节 ",-1)),ue.value.length>0||pe.value.length>0?(q(),F(ol,{key:0,value:ue.value.length,type:"success"},null,8,["value"])):S("",!0)])]),default:D(()=>[U("div",Ka,[U("section",Ja,[U("div",Qa,[l[67]||(l[67]=U("h3",null,[U("i",{class:"bi bi-file-earmark-text"}),E(" 项目文档")],-1)),ue.value.length>0?(q(),F(o,{key:0,type:"success",size:"small"},{default:D(()=>[E(" 共 "+A(ue.value.length)+" 个文件 ",1)]),_:1})):S("",!0)]),ue.value.length>0?(q(),V("div",Za,[(q(!0),V(W,null,M(ue.value,e=>(q(),F(_e,{key:e.id,"file-url":e.file_url||e.file_path,"file-name":e.original_filename,"file-size":e.file_size,"upload-time":e.uploaded_at,"show-actions":!0,onPreview:nl},null,8,["file-url","file-name","file-size","upload-time"]))),128))])):(q(),F(cl,{key:1,description:"暂无文档","image-size":80},{extra:D(()=>[P(ul,{type:"info",size:"small"},{default:D(()=>[...l[68]||(l[68]=[E(" 请在页面顶部上传招标文档 ",-1)])]),_:1})]),_:1}))]),U("div",Ga,[P(c,{type:"primary",size:"large",onClick:al},{default:D(()=>[...l[69]||(l[69]=[U("i",{class:"bi bi-file-earmark-zip"},null,-1),E(" 合成最终标书 ",-1)])]),_:1})]),pe.value.length>0?(q(),F(dl,{key:0})):S("",!0),pe.value.length>0?(q(),V("section",Ha,[U("div",Xa,[l[70]||(l[70]=U("h3",null,[U("i",{class:"bi bi-list-nested"}),E(" 已识别章节")],-1)),P(o,{type:"success",size:"small"},{default:D(()=>[E(" 共 "+A(ze.value)+" 个章节 ",1)]),_:1})]),P(g,{chapters:pe.value,"show-checkbox":!1,"show-search":!0},null,8,["chapters"])])):S("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})],64)):(q(),F(cl,{key:2,description:"项目不存在或加载失败"})),P($(R),{modelValue:fe.value,"onUpdate:modelValue":l[16]||(l[16]=e=>fe.value=e),"file-url":ve.value,"file-name":he.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-2e3e322a"]]);export{Ya as default};
