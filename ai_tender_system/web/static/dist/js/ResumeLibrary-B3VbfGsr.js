import{aK as e,bE as l,bG as a,av as t,aw as o,be as u,aL as r,aN as s,aQ as i,aY as d,aS as n,aW as p,aU as c,cq as v,aX as m,b8 as f,cr as _,aR as b,bM as w,bJ as y,bK as h,ci as g,b0 as V,a$ as k,cm as j,cp as x,bb as C,cf as U,cg as L,cj as E,ch as z,bc as D,aZ as R}from"./index.js";/* empty css                                                                          *//* empty css                             */import{E as F}from"./el-input-number-CULvBqYk.js";import{E as $}from"./el-divider-BW0DbTKo.js";/* empty css                    *//* empty css               */import{E as I,a as O}from"./el-select-JVjgICbv.js";import{L as M}from"./Loading-DiM5rrv-.js";import{E as P}from"./Empty-Cym7PiOz.js";import{C as X}from"./Card-CuExVMRy.js";import"./DocumentPreview.vue_vue_type_style_index_0_scoped_056f7814_lang-Cvhffcax.js";/* empty css                   *//* empty css                */import{k as K,f as N}from"./formatters-BCM66Wc4.js";import{v as q,a as B}from"./validators-BHjNrE0Y.js";import{E as J}from"./index--HjUvM4F.js";import{E as Q,a as S}from"./index-YEioaD_d.js";import{E as W}from"./index-DwbH8caQ.js";import{a as Y,E as Z}from"./index-QjymKf1u.js";import{E as G}from"./index-Ck60z3mc.js";import"./index-BDtcSmIb.js";import"./toNumber-CM6xia4s.js";import"./_baseIteratee-chHnNCKt.js";import"./index-CiTGQxVM.js";import"./flatMap-BtkQY1kY.js";import"./map-Dt0HIbty.js";import"./_baseEach-B8o-eFGg.js";import"./index-DQuz_84T.js";import"./raf-p9A-23_P.js";import"./cloneDeep-BA-8E20e.js";const H={class:"resume-library"},A={class:"stats-bar"},T={class:"stat-content"},ee={class:"stat-icon"},le={class:"stat-info"},ae={class:"stat-value"},te={class:"stat-content"},oe={class:"stat-icon"},ue={class:"stat-info"},re={class:"stat-value"},se={class:"stat-content"},ie={class:"stat-icon"},de={class:"stat-info"},ne={class:"stat-value"},pe={class:"filter-section"},ce=R(e({__name:"ResumeLibrary",setup(e){const R=l(),{success:ce,error:ve}=a(),me=t(!1),fe=t([]),_e=t({keyword:"",educationLevel:"",position:"",status:""}),be=t(!1),we=t(!1),ye=t(),he=t({name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""}),ge={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:50,message:"姓名长度在 2 到 50 个字符",trigger:"blur"}],phone:[{validator:B,trigger:"blur"}],email:[{validator:q,trigger:"blur"}]},Ve=t(!1),ke=t(!1),je=t(),xe=t([]),Ce=t(null),Ue=o(()=>{let e=[...fe.value];if(_e.value.keyword){const l=_e.value.keyword.toLowerCase();e=e.filter(e=>{var a,t,o,u;return(null==(a=e.name)?void 0:a.toLowerCase().includes(l))||(null==(t=e.current_position)?void 0:t.toLowerCase().includes(l))||(null==(o=e.skills)?void 0:o.toLowerCase().includes(l))||(null==(u=e.major)?void 0:u.toLowerCase().includes(l))})}if(_e.value.educationLevel&&(e=e.filter(e=>e.education_level===_e.value.educationLevel)),_e.value.position){const l=_e.value.position.toLowerCase();e=e.filter(e=>{var a;return null==(a=e.current_position)?void 0:a.toLowerCase().includes(l)})}return _e.value.status&&(e=e.filter(e=>e.status===_e.value.status)),e}),Le=o(()=>fe.value.filter(e=>"active"===e.status).length),Ee=o(()=>{const e=fe.value.filter(e=>e.work_years&&e.work_years>0);if(0===e.length)return 0;return(e.reduce((e,l)=>e+(l.work_years||0),0)/e.length).toFixed(1)}),ze=async()=>{me.value=!0;try{const e=await K.getResumes();if(e.success&&e.data){const l=e.data.resumes||e.data;fe.value=l.map(e=>({...e,created_at:e.created_at?N(e.created_at):"-",updated_at:e.updated_at?N(e.updated_at):"-"}))}}catch(e){ve("加载失败",e instanceof Error?e.message:"未知错误")}finally{me.value=!1}},De=()=>{},Re=()=>{_e.value.keyword="",_e.value.educationLevel="",_e.value.position="",_e.value.status=""},Fe=e=>{switch(e){case"active":return"success";case"inactive":return"warning";default:return"info"}},$e=e=>{switch(e){case"active":return"活跃";case"inactive":return"离职";case"archived":return"已归档";default:return"-"}},Ie=()=>{be.value=!0},Oe=async()=>{ye.value&&await ye.value.validate(async e=>{if(e){we.value=!0;try{const e=await K.createResume({name:he.value.name,gender:he.value.gender||void 0,phone:he.value.phone||void 0,email:he.value.email||void 0,education_level:he.value.education_level||void 0,degree:he.value.degree||void 0,university:he.value.university||void 0,major:he.value.major||void 0,current_position:he.value.current_position||void 0,professional_title:he.value.professional_title||void 0,work_years:he.value.work_years,current_company:he.value.current_company||void 0,introduction:he.value.introduction||void 0,status:"active"});e.success?(ce("创建成功","简历创建成功"),be.value=!1,await ze()):ve("创建失败",e.error||"未知错误")}catch(l){ve("创建失败",l instanceof Error?l.message:"未知错误")}finally{we.value=!1}}})},Me=()=>{Ve.value=!0},Pe=e=>{if(e.raw){const l=10485760;if(e.raw.size>l)return ve("文件过大","文件大小不能超过10MB"),xe.value=[],void(Ce.value=null);Ce.value=e.raw}},Xe=()=>{Ce.value=null},Ke=async()=>{if(Ce.value){ke.value=!0;try{const e=await K.parseResumeFile(Ce.value,!0);e.success?(ce("导入成功","简历已自动解析并创建"),Ve.value=!1,await ze()):ve("导入失败",e.error||"解析失败")}catch(e){ve("导入失败",e instanceof Error?e.message:"未知错误")}finally{ke.value=!1}}else ve("请选择文件","请先选择要上传的简历文件")},Ne=()=>{xe.value=[],Ce.value=null},qe=()=>{var e;he.value={name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""},null==(e=ye.value)||e.resetFields()};return u(()=>{ze()}),(e,l)=>{const a=p,t=J,o=V,u=h,N=y,q=O,B=I,Ce=w,Be=S,Je=W,Qe=Q,Se=$,We=Z,Ye=L,Ze=U,Ge=Y,He=F,Ae=E,Te=z,el=G;return s(),r("div",H,[i("div",A,[d(t,{class:"stat-card"},{default:n(()=>[i("div",T,[i("div",ee,[d(a,{size:32,color:"#409eff"},{default:n(()=>[d(c(v))]),_:1})]),i("div",le,[l[22]||(l[22]=i("div",{class:"stat-label"},"总简历数",-1)),i("div",ae,m(fe.value.length),1)])])]),_:1}),d(t,{class:"stat-card"},{default:n(()=>[i("div",te,[i("div",oe,[d(a,{size:32,color:"#67c23a"},{default:n(()=>[d(c(f))]),_:1})]),i("div",ue,[l[23]||(l[23]=i("div",{class:"stat-label"},"活跃简历",-1)),i("div",re,m(Le.value),1)])])]),_:1}),d(t,{class:"stat-card"},{default:n(()=>[i("div",se,[i("div",ie,[d(a,{size:32,color:"#e6a23c"},{default:n(()=>[d(c(_))]),_:1})]),i("div",de,[l[24]||(l[24]=i("div",{class:"stat-label"},"平均工龄",-1)),i("div",ne,m(Ee.value)+"年",1)])])]),_:1})]),d(c(X),{title:"简历列表"},{actions:n(()=>[d(o,{type:"primary",onClick:Ie},{default:n(()=>[d(a,null,{default:n(()=>[d(c(x))]),_:1}),l[25]||(l[25]=k(" 新建简历 ",-1))]),_:1}),d(o,{type:"success",onClick:Me},{default:n(()=>[d(a,null,{default:n(()=>[d(c(C))]),_:1}),l[26]||(l[26]=k(" 智能导入 ",-1))]),_:1})]),default:n(()=>[i("div",pe,[d(Ce,{inline:!0,model:_e.value},{default:n(()=>[d(N,{label:"搜索"},{default:n(()=>[d(u,{modelValue:_e.value.keyword,"onUpdate:modelValue":l[0]||(l[0]=e=>_e.value.keyword=e),placeholder:"搜索姓名、职位、技能...",clearable:"",style:{width:"300px"},onInput:De},{prefix:n(()=>[d(a,null,{default:n(()=>[d(c(g))]),_:1})]),_:1},8,["modelValue"])]),_:1}),d(N,{label:"学历"},{default:n(()=>[d(B,{modelValue:_e.value.educationLevel,"onUpdate:modelValue":l[1]||(l[1]=e=>_e.value.educationLevel=e),placeholder:"全部学历",clearable:"",style:{width:"120px"},onChange:De},{default:n(()=>[d(q,{label:"全部学历",value:""}),d(q,{label:"博士",value:"博士"}),d(q,{label:"硕士",value:"硕士"}),d(q,{label:"本科",value:"本科"}),d(q,{label:"大专",value:"大专"}),d(q,{label:"高中",value:"高中"})]),_:1},8,["modelValue"])]),_:1}),d(N,{label:"职位"},{default:n(()=>[d(u,{modelValue:_e.value.position,"onUpdate:modelValue":l[2]||(l[2]=e=>_e.value.position=e),placeholder:"职位关键词",clearable:"",style:{width:"150px"},onInput:De},null,8,["modelValue"])]),_:1}),d(N,{label:"状态"},{default:n(()=>[d(B,{modelValue:_e.value.status,"onUpdate:modelValue":l[3]||(l[3]=e=>_e.value.status=e),placeholder:"全部状态",clearable:"",style:{width:"120px"},onChange:De},{default:n(()=>[d(q,{label:"全部状态",value:""}),d(q,{label:"活跃",value:"active"}),d(q,{label:"离职",value:"inactive"}),d(q,{label:"已归档",value:"archived"})]),_:1},8,["modelValue"])]),_:1}),d(N,null,{default:n(()=>[d(o,{onClick:Re},{default:n(()=>[d(a,null,{default:n(()=>[d(c(j))]),_:1}),l[27]||(l[27]=k(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),me.value?(s(),b(c(M),{key:0,text:"加载中..."})):Ue.value.length?(s(),b(Qe,{key:2,data:Ue.value,stripe:"",style:{width:"100%"}},{default:n(()=>[d(Be,{prop:"resume_id",label:"ID",width:"70",fixed:""}),d(Be,{prop:"name",label:"姓名",width:"100",fixed:""}),d(Be,{prop:"gender",label:"性别",width:"60",align:"center"},{default:n(({row:e})=>[k(m(e.gender||"-"),1)]),_:1}),d(Be,{prop:"education_level",label:"学历",width:"80"},{default:n(({row:e})=>{return[d(Je,{type:(l=e.education_level,l?"博士"===l?"danger":"硕士"===l?"warning":"本科"===l?"success":"info":"info"),size:"small"},{default:n(()=>[k(m(e.education_level||"-"),1)]),_:2},1032,["type"])];var l}),_:1}),d(Be,{prop:"university",label:"毕业院校",width:"140","show-overflow-tooltip":""}),d(Be,{prop:"major",label:"专业",width:"120","show-overflow-tooltip":""}),d(Be,{prop:"current_position",label:"当前职位",width:"140","show-overflow-tooltip":""}),d(Be,{prop:"professional_title",label:"职称",width:"100"}),d(Be,{prop:"work_years",label:"工作年限",width:"90",align:"center"},{default:n(({row:e})=>[k(m(e.work_years?`${e.work_years}年`:"-"),1)]),_:1}),d(Be,{prop:"current_company",label:"当前单位",width:"160","show-overflow-tooltip":""}),d(Be,{prop:"phone",label:"联系电话",width:"120"}),d(Be,{prop:"email",label:"邮箱",width:"180","show-overflow-tooltip":""}),d(Be,{prop:"status",label:"状态",width:"80",align:"center"},{default:n(({row:e})=>[d(Je,{type:Fe(e.status),size:"small"},{default:n(()=>[k(m($e(e.status)),1)]),_:2},1032,["type"])]),_:1}),d(Be,{prop:"created_at",label:"创建时间",width:"160","show-overflow-tooltip":""}),d(Be,{label:"操作",width:"220",fixed:"right"},{default:n(({row:e})=>[d(o,{text:"",type:"primary",size:"small",onClick:l=>(e=>{R.push(`/knowledge/resume/${e.resume_id}`)})(e)},{default:n(()=>[...l[28]||(l[28]=[k(" 查看详情 ",-1)])]),_:1},8,["onClick"]),d(o,{text:"",type:"warning",size:"small",onClick:l=>(e=>{R.push(`/knowledge/resume/${e.resume_id}`)})(e)},{default:n(()=>[...l[29]||(l[29]=[k(" 编辑 ",-1)])]),_:1},8,["onClick"]),d(o,{text:"",type:"danger",size:"small",onClick:l=>(async e=>{try{if(!confirm(`确定要删除简历 "${e.name}" 吗？此操作不可恢复。`))return;const l=await K.deleteResume(e.resume_id);l.success?(ce("删除成功",`已删除简历: ${e.name}`),await ze()):ve("删除失败",l.error||"未知错误")}catch(l){ve("删除失败",l instanceof Error?l.message:"未知错误")}})(e)},{default:n(()=>[...l[30]||(l[30]=[k(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(s(),b(c(P),{key:1,type:"no-data",description:"暂无简历数据"}))]),_:1}),d(Ae,{modelValue:be.value,"onUpdate:modelValue":l[18]||(l[18]=e=>be.value=e),title:"新建简历",width:"700px",onClose:qe},{footer:n(()=>[d(o,{onClick:l[17]||(l[17]=e=>be.value=!1)},{default:n(()=>[...l[36]||(l[36]=[k("取消",-1)])]),_:1}),d(o,{type:"primary",loading:we.value,onClick:Oe},{default:n(()=>[...l[37]||(l[37]=[k(" 确定 ",-1)])]),_:1},8,["loading"])]),default:n(()=>[d(Ce,{ref_key:"createFormRef",ref:ye,model:he.value,rules:ge,"label-width":"120px"},{default:n(()=>[d(Se,{"content-position":"left"},{default:n(()=>[...l[31]||(l[31]=[k("基本信息",-1)])]),_:1}),d(Ge,{gutter:20},{default:n(()=>[d(We,{span:12},{default:n(()=>[d(N,{label:"姓名",prop:"name"},{default:n(()=>[d(u,{modelValue:he.value.name,"onUpdate:modelValue":l[4]||(l[4]=e=>he.value.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),d(We,{span:12},{default:n(()=>[d(N,{label:"性别",prop:"gender"},{default:n(()=>[d(Ze,{modelValue:he.value.gender,"onUpdate:modelValue":l[5]||(l[5]=e=>he.value.gender=e)},{default:n(()=>[d(Ye,{label:"男"},{default:n(()=>[...l[32]||(l[32]=[k("男",-1)])]),_:1}),d(Ye,{label:"女"},{default:n(()=>[...l[33]||(l[33]=[k("女",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(Ge,{gutter:20},{default:n(()=>[d(We,{span:12},{default:n(()=>[d(N,{label:"联系电话",prop:"phone"},{default:n(()=>[d(u,{modelValue:he.value.phone,"onUpdate:modelValue":l[6]||(l[6]=e=>he.value.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1})]),_:1}),d(We,{span:12},{default:n(()=>[d(N,{label:"邮箱",prop:"email"},{default:n(()=>[d(u,{modelValue:he.value.email,"onUpdate:modelValue":l[7]||(l[7]=e=>he.value.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(Se,{"content-position":"left"},{default:n(()=>[...l[34]||(l[34]=[k("教育信息",-1)])]),_:1}),d(Ge,{gutter:20},{default:n(()=>[d(We,{span:12},{default:n(()=>[d(N,{label:"学历",prop:"education_level"},{default:n(()=>[d(B,{modelValue:he.value.education_level,"onUpdate:modelValue":l[8]||(l[8]=e=>he.value.education_level=e),placeholder:"请选择学历",style:{width:"100%"}},{default:n(()=>[d(q,{label:"博士",value:"博士"}),d(q,{label:"硕士",value:"硕士"}),d(q,{label:"本科",value:"本科"}),d(q,{label:"大专",value:"大专"}),d(q,{label:"高中",value:"高中"}),d(q,{label:"中专",value:"中专"}),d(q,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),d(We,{span:12},{default:n(()=>[d(N,{label:"学位",prop:"degree"},{default:n(()=>[d(B,{modelValue:he.value.degree,"onUpdate:modelValue":l[9]||(l[9]=e=>he.value.degree=e),placeholder:"请选择学位",style:{width:"100%"}},{default:n(()=>[d(q,{label:"博士学位",value:"博士"}),d(q,{label:"硕士学位",value:"硕士"}),d(q,{label:"学士学位",value:"学士"}),d(q,{label:"无学位",value:"无"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(Ge,{gutter:20},{default:n(()=>[d(We,{span:12},{default:n(()=>[d(N,{label:"毕业院校",prop:"university"},{default:n(()=>[d(u,{modelValue:he.value.university,"onUpdate:modelValue":l[10]||(l[10]=e=>he.value.university=e),placeholder:"请输入毕业院校"},null,8,["modelValue"])]),_:1})]),_:1}),d(We,{span:12},{default:n(()=>[d(N,{label:"专业",prop:"major"},{default:n(()=>[d(u,{modelValue:he.value.major,"onUpdate:modelValue":l[11]||(l[11]=e=>he.value.major=e),placeholder:"请输入专业"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(Se,{"content-position":"left"},{default:n(()=>[...l[35]||(l[35]=[k("工作信息",-1)])]),_:1}),d(Ge,{gutter:20},{default:n(()=>[d(We,{span:12},{default:n(()=>[d(N,{label:"当前职位",prop:"current_position"},{default:n(()=>[d(u,{modelValue:he.value.current_position,"onUpdate:modelValue":l[12]||(l[12]=e=>he.value.current_position=e),placeholder:"如：项目经理"},null,8,["modelValue"])]),_:1})]),_:1}),d(We,{span:12},{default:n(()=>[d(N,{label:"职称",prop:"professional_title"},{default:n(()=>[d(u,{modelValue:he.value.professional_title,"onUpdate:modelValue":l[13]||(l[13]=e=>he.value.professional_title=e),placeholder:"如：高级工程师"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(Ge,{gutter:20},{default:n(()=>[d(We,{span:12},{default:n(()=>[d(N,{label:"工作年限",prop:"work_years"},{default:n(()=>[d(He,{modelValue:he.value.work_years,"onUpdate:modelValue":l[14]||(l[14]=e=>he.value.work_years=e),min:0,max:50,placeholder:"年",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),d(We,{span:12},{default:n(()=>[d(N,{label:"当前单位",prop:"current_company"},{default:n(()=>[d(u,{modelValue:he.value.current_company,"onUpdate:modelValue":l[15]||(l[15]=e=>he.value.current_company=e),placeholder:"请输入当前工作单位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),d(N,{label:"个人简介",prop:"introduction"},{default:n(()=>[d(u,{modelValue:he.value.introduction,"onUpdate:modelValue":l[16]||(l[16]=e=>he.value.introduction=e),type:"textarea",rows:3,placeholder:"请简要介绍个人经历、专长等"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),d(Ae,{modelValue:Ve.value,"onUpdate:modelValue":l[21]||(l[21]=e=>Ve.value=e),title:"智能导入简历",width:"500px",onClose:Ne},{footer:n(()=>[d(o,{onClick:l[20]||(l[20]=e=>Ve.value=!1)},{default:n(()=>[...l[40]||(l[40]=[k("取消",-1)])]),_:1}),d(o,{type:"primary",loading:ke.value,onClick:Ke},{default:n(()=>[...l[41]||(l[41]=[k(" 开始解析 ",-1)])]),_:1},8,["loading"])]),default:n(()=>[d(Te,{title:"智能解析",type:"info",description:"上传PDF/DOC/DOCX格式的简历文件，系统将自动提取信息并创建简历记录",closable:!1,style:{"margin-bottom":"20px"}}),d(el,{ref_key:"uploadRef",ref:je,"file-list":xe.value,"onUpdate:fileList":l[19]||(l[19]=e=>xe.value=e),"auto-upload":!1,limit:1,accept:".pdf,.doc,.docx",drag:"","on-change":Pe,"on-remove":Xe},{tip:n(()=>[...l[38]||(l[38]=[i("div",{class:"el-upload__tip"}," 支持PDF、DOC、DOCX格式，文件大小不超过10MB ",-1)])]),default:n(()=>[d(a,{class:"el-icon--upload"},{default:n(()=>[d(c(D))]),_:1}),l[39]||(l[39]=i("div",{class:"el-upload__text"},[k(" 拖拽文件到这里 或 "),i("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d80ddb3a"]]);export{ce as default};
