import{O as e,e as l,s as a,d as t,Q as s,R as o,E as n,D as r,F as i,y as u,J as d,S as c,h as p,i as v,q as m}from"./index.js";/* empty css                   *//* empty css                                                        *//* empty css                             *//* empty css                    *//* empty css                     *//* empty css               *//* empty css                                                                            *//* empty css                *//* empty css                */import{E as f,a as h}from"./el-select-2eEOxmwc.js";import{am as y,an as g,ao as w,aW as _,au as j,ar as b,ax as x,aq as F,av as k,as as V,aw as C,az as I,aA as q,ay as S,aC as U,aD as E,aS as z,at as $,aU as T}from"./editor-zVZ1kHVk.js";/* empty css                */import{S as D}from"./SSEStreamViewer-CrzG5MiJ.js";import{D as M}from"./DocumentUploader-Be453JcP.js";import{_ as P}from"./DocumentPreview.vue_vue_type_script_setup_true_lang-D4KN3en7.js";import{R as L}from"./RichTextEditor-ChUjsSrA.js";import{u as O,S as R,d as W}from"./helpers-BLearzfn.js";import{t as N}from"./tender-DnxfeLI4.js";import{u as A}from"./useProjectDocuments-CRVtfecb.js";import{E as B}from"./index-BMbtWNDi.js";import{E as H}from"./index-_jYzz5Db.js";import{E as J,a as G}from"./index-B2x62aoe.js";import{E as Q,a as K}from"./index-DjyvXpKV.js";import{E as X}from"./index-CdSpfZF-.js";import{E as Y}from"./strings-BE50mNvJ.js";import{E as Z,a as ee}from"./index-DNE8wpxT.js";import{v as le}from"./directive-BVG3C7QE.js";import{E as ae}from"./index-ogmKdR8O.js";import"./index-D1NGdGTb.js";import"./toNumber-BpJiEHLP.js";import"./_baseIteratee-ZpxLkVXu.js";import"./imageCompressor-CTkRt5bg.js";import"./index-fB22Rz4w.js";import"./cloneDeep-syPWYH98.js";import"./index-D-1a5a6j.js";import"./index-BiOBX4RZ.js";import"./project-DkmUVYhm.js";import"./index-QszVrH1C.js";import"./flatMap-DETszGXG.js";import"./map-B1xFbd59.js";import"./_baseEach-DQS2JKhf.js";import"./index-CfLDUDVX.js";import"./raf-BZHcGSIv.js";const te={class:"point-to-point"},se={class:"panel-row project-row"},oe={class:"row-item"},ne={class:"row-item"},re={class:"panel-row project-row document-row"},ie={class:"row-item"},ue={key:0,class:"file-chip file-chip--success"},de=["title"],ce={key:1,class:"file-chip file-chip--info"},pe=["title"],ve={key:2,class:"file-placeholder"},me={class:"config-section"},fe={class:"panel-row project-row"},he={class:"row-item"},ye={class:"row-item"},ge={key:0,class:"panel-row project-row"},we={class:"row-item"},_e={class:"row-item"},je={class:"format-preview"},be={key:1,class:"panel-row project-row"},xe={class:"row-item"},Fe={class:"panel-actions"},ke={class:"card-header"},Ve={class:"card-header"},Ce={class:"header-actions"},Ie={class:"result-content"},qe={class:"file-info-section"},Se={class:"card-header"},Ue={class:"header-actions"},Ee={class:"requirement-text"},ze={class:"card-header"},$e={class:"card-header"},Te={class:"header-actions"},De={class:"collapse-title"},Me={class:"requirement-preview"},Pe={class:"response-content"},Le={class:"response-item"},Oe={class:"requirement-detail"},Re={class:"response-item"},We={key:0,class:"response-item"},Ne={key:0,class:"response-dialog"},Ae={class:"dialog-section"},Be={class:"requirement-detail"},He={class:"dialog-section"},Je={key:0,class:"dialog-section"},Ge={class:"collapse-header"},Qe={class:"filename-cell"},Ke=m(y({__name:"PointToPoint",setup(m){const{projects:y,selectedProject:Ke,loadProjects:Xe,handleProjectChange:Ye,restoreProjectFromStore:Ze}=A(),{useHitlFile:el,hitlFileInfo:ll,syncing:al,synced:tl,loadFromHITL:sl,cancelHitlFile:ol,syncToHitl:nl}=O({onFileLoaded:()=>{rl.value.tenderFiles=[]}}),rl=g({projectId:null,tenderFiles:[]}),il=g({responseFrequency:"every_paragraph",responseMode:"simple",aiModel:"qwen-max",responseContent:"åº”ç­”ï¼šæ»¡è¶³ã€‚",responseTextFormat:"gray_background"}),ul=g(!1),dl=g(0),cl=g(""),pl=g([]),vl=g([]),ml=g(""),fl=g(""),hl=w(()=>{let e=pl.value;return ml.value&&(e=e.filter(e=>e.requirement.toLowerCase().includes(ml.value.toLowerCase()))),fl.value&&(e=e.filter(e=>e.category===fl.value)),e}),yl=g(!1),gl=g(0),wl=g(""),_l=g(""),jl=g(""),bl=g(null),xl=g(null),Fl=g(!1),kl=g(null),Vl=g(""),Cl=g(!1),Il=g([]),ql=g(null),Sl=g([]),Ul=g(!1),El=g([]),zl=g(!1),$l=g(""),Tl=g(""),Dl=w(()=>pl.value.some(e=>e.response)),Ml=g([]),Pl=g(!1),Ll=g(null),Ol=w(()=>rl.value.projectId&&(rl.value.tenderFiles.length>0||el.value)),Rl=w(()=>"red_bold"===il.value.responseTextFormat?{color:"#F56C6C",fontWeight:"bold",background:"transparent"}:{color:"#000000",fontWeight:"normal",background:"#E5E5E5"}),Wl=async e=>{var l;const{file:a,onSuccess:t,onError:s}=e;if(!rl.value.projectId){return s(new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")),void v.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")}if(!(null==(l=Ke.value)?void 0:l.company_id)){return s(new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")),void v.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")}try{const e=new FormData;e.append("file",a),e.append("company_id",Ke.value.company_id.toString()),e.append("project_id",rl.value.projectId.toString());const l=await N.parseDocumentStructure(e);if(!l.success)throw new Error(l.message||"ä¸Šä¼ å¤±è´¥");t(l.data),v.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(o){s(o),v.error(o.message||"æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},Nl=async()=>{await Ye(rl.value.projectId,{onClear:()=>{rl.value.tenderFiles=[],pl.value=[],vl.value=[],ql.value=null,xl.value=null,Fl.value=!1,Vl.value="",Il.value=[],Sl.value=[],el.value&&ol()},onDocumentsLoaded:Bl}),rl.value.projectId&&await ua()},Al=()=>{v.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},Bl=e=>{e.technicalFile?sl(e,"technicalFile"):e.tenderFile&&(rl.value.tenderFiles=[e.tenderFile]),e.p2pResponseFile&&(ql.value=e.p2pResponseFile,Fl.value=!1)},Hl=e=>{vl.value=e},Jl=async()=>{if(0!==vl.value.length){yl.value=!0,gl.value=0,wl.value="";try{await Gl(),v.success("ç‚¹å¯¹ç‚¹åº”ç­”ç”Ÿæˆå®Œæˆ")}catch(e){v.error("ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{yl.value=!1}}else v.warning("è¯·é€‰æ‹©è¦ç”Ÿæˆåº”ç­”çš„è¦æ±‚")},Gl=async()=>new Promise(e=>{const l=vl.value.length;let a=0;const t=setInterval(()=>{if(a<l){const e=vl.value[a];gl.value=Math.round((a+1)/l*100),wl.value+=`\n[${a+1}/${l}] æ­£åœ¨ç”Ÿæˆ"${e.requirement.substring(0,20)}..."çš„åº”ç­”`;const t=pl.value.findIndex(l=>l.id===e.id);-1!==t&&(pl.value[t]={...pl.value[t],status:"generated",response:Kl(e),compliance:Math.random()>.3?"å®Œå…¨ç¬¦åˆ":"éƒ¨åˆ†ç¬¦åˆ"}),a++}else clearInterval(t),e()},800)}),Ql=async()=>{if(rl.value.projectId&&Ke.value)if(el.value||0!==rl.value.tenderFiles.length){yl.value=!0,gl.value=0,xl.value=null,Fl.value=!0,Vl.value='<h1>ğŸ“„ ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£</h1><p style="color: #909399;">AIæ­£åœ¨ç”Ÿæˆå†…è”åº”ç­”ï¼Œè¯·ç¨å€™...</p>',setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100);try{const e=new FormData;el.value&&ll.value?(e.append("use_hitl_technical_file","true"),e.append("project_id",rl.value.projectId.toString())):rl.value.tenderFiles.length>0&&rl.value.tenderFiles[0].raw&&e.append("file",rl.value.tenderFiles[0].raw),e.append("companyId",Ke.value.company_id.toString()),e.append("projectName",Ke.value.project_name||""),e.append("responseFrequency",il.value.responseFrequency),e.append("responseMode",il.value.responseMode),e.append("aiModel",il.value.aiModel),e.append("responseContent",il.value.responseContent),e.append("responseTextFormat",il.value.responseTextFormat);const l=await fetch("/api/process-point-to-point",{method:"POST",body:e}),a=await l.json();if(!a.success){let e="å¤„ç†å¤±è´¥";throw a.error?e="object"==typeof a.error&&a.error.message?a.error.message:"string"==typeof a.error?a.error:JSON.stringify(a.error):a.message&&(e=a.message),new Error(e)}_l.value=a.output_file,jl.value=a.download_url,bl.value=a.stats,xl.value={success:!0,outputFile:a.output_file,downloadUrl:a.download_url,stats:a.stats||{},message:a.message||"ç‚¹å¯¹ç‚¹åº”ç­”ç”Ÿæˆå®Œæˆ"},await Yl(a.output_file),v.success("ç‚¹å¯¹ç‚¹åº”ç­”ç”Ÿæˆå®Œæˆï¼å¯ä»¥ç¼–è¾‘äº†"),a.output_file&&await nl(rl.value.projectId,a.output_file,"point_to_point")}catch(e){let l="å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•";"string"==typeof e?l=e:(null==e?void 0:e.message)?l=e.message:(null==e?void 0:e.error)?l=e.error:"object"==typeof e&&(l=JSON.stringify(e)),kl.value&&kl.value.appendContent(`<p style="color: red;">âŒ é”™è¯¯: ${l}</p>`),v.error({message:l,duration:5e3})}finally{yl.value=!1}}else v.error("è¯·å…ˆä¸Šä¼ æ‹›æ ‡æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");else v.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")},Kl=e=>({technical:"## æŠ€æœ¯å“åº”\n\næˆ‘æ–¹ç³»ç»Ÿå®Œå…¨æ»¡è¶³è¯¥æŠ€æœ¯è¦æ±‚ï¼š\n\n### æ–¹æ¡ˆè¯´æ˜\n1. é‡‡ç”¨xxxæ¶æ„è®¾è®¡ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®\n2. ç»è¿‡å‹åŠ›æµ‹è¯•ï¼Œå¯æ”¯æŒxxxå¹¶å‘ç”¨æˆ·\n3. é…ç½®xxxæœåŠ¡å™¨é›†ç¾¤ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§\n\n### æŠ€æœ¯æŒ‡æ ‡\n- å¹¶å‘å¤„ç†èƒ½åŠ›ï¼šæ»¡è¶³è¦æ±‚\n- å“åº”æ—¶é—´ï¼šå¹³å‡2ç§’ä»¥å†…\n- ç³»ç»Ÿå¯ç”¨æ€§ï¼š99.9%\n\n### è¯æ˜ææ–™\nè¯¦è§é™„ä»¶ã€ŠæŠ€æœ¯æ–¹æ¡ˆä¹¦ã€‹ç¬¬xxé¡µ",business:"## å•†åŠ¡å“åº”\n\næˆ‘æ–¹å®Œå…¨æ¥å—è¯¥å•†åŠ¡æ¡æ¬¾ï¼š\n\n### æ‰¿è¯ºå†…å®¹\n1. ä¸¥æ ¼æŒ‰ç…§è¦æ±‚æ‰§è¡Œ\n2. æä¾›ç›¸åº”çš„ä¿éšœæªæ–½\n3. ç¡®ä¿æŒ‰æ—¶å®Œæˆ\n\n### å…·ä½“å®‰æ’\n- é¡¹ç›®å‘¨æœŸï¼šç¬¦åˆè¦æ±‚\n- è´¨ä¿æœŸï¼šæ»¡è¶³è¦æ±‚\n- éªŒæ”¶æ ‡å‡†ï¼šæŒ‰ç…§æ‹›æ ‡æ–‡ä»¶æ‰§è¡Œ\n\n### æœåŠ¡ä¿éšœ\nè¯¦è§é™„ä»¶ã€Šå•†åŠ¡åº”ç­”ä¹¦ã€‹ç¬¬xxé¡µ",qualification:"## èµ„è´¨å“åº”\n\næˆ‘æ–¹å…·å¤‡è¯¥é¡¹èµ„è´¨è¦æ±‚ï¼š\n\n### èµ„è´¨è¯æ˜\n1. æŒæœ‰xxxè¯ä¹¦ï¼Œè¯ä¹¦ç¼–å·ï¼šxxx\n2. è¯ä¹¦æœ‰æ•ˆæœŸï¼šxxxxå¹´xxæœˆè‡³xxxxå¹´xxæœˆ\n3. è®¤è¯èŒƒå›´ï¼šè¦†ç›–æœ¬é¡¹ç›®éœ€æ±‚\n\n### ç›¸å…³ä¸šç»©\n- è¿‘ä¸‰å¹´å®Œæˆç±»ä¼¼é¡¹ç›®xxä¸ª\n- é¡¹ç›®éªŒæ”¶åˆæ ¼ç‡100%\n\n### é™„ä»¶ææ–™\nè¯¦è§é™„ä»¶ã€Šèµ„è´¨è¯æ˜æ–‡ä»¶ã€‹",other:"## å…¶ä»–è¦æ±‚å“åº”\n\næˆ‘æ–¹æ‰¿è¯ºæ»¡è¶³è¯¥è¦æ±‚ï¼š\n\n### å…·ä½“å®‰æ’\n1. åˆ¶å®šè¯¦ç»†è®¡åˆ’\n2. é…å¤‡ä¸“ä¸šäººå‘˜\n3. æä¾›å®Œæ•´æ–‡æ¡£\n\n### æ‰§è¡Œæ ‡å‡†\n- ä¸¥æ ¼æŒ‰ç…§æ‹›æ ‡æ–‡ä»¶è¦æ±‚\n- ç¡®ä¿è´¨é‡å’Œè¿›åº¦\n\n### ç›¸å…³æ–‡ä»¶\nè¯¦è§é™„ä»¶ç›¸å…³ç« èŠ‚"}[e.category]||"æˆ‘æ–¹å®Œå…¨å“åº”è¯¥è¦æ±‚ã€‚"),Xl=()=>{yl.value=!1,v.info("å·²åœæ­¢ç”Ÿæˆ")},Yl=async e=>{try{Vl.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const l=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),a=await l.json();if(!a.success||!a.html_content)throw new Error(a.error||"è½¬æ¢å¤±è´¥");Vl.value=a.html_content,kl.value&&kl.value.setContent(a.html_content)}catch(l){Vl.value=`\n      <h1>ğŸ“„ ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${l.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç‚¹å‡»ä¸‹æ–¹"æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"ä¸‹è½½Wordæ–‡æ¡£æŸ¥çœ‹</li>\n          <li>Wordæ–‡æ¡£ä¸­å·²åŒ…å«å†…è”å›å¤ï¼ˆç°è‰²åº•çº¹æ ‡è®°ï¼‰</li>\n        </ul>\n      </div>\n    `,v.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨ä¸‹è½½åŠŸèƒ½æŸ¥çœ‹")}},Zl=async e=>{var l,a;if(rl.value.projectId){Cl.value=!0;try{const t=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:rl.value.projectId,document_type:"point_to_point",original_file:null==(l=xl.value)?void 0:l.outputFile})}),s=await t.json();if(!s.success)throw new Error(s.error||"ä¿å­˜å¤±è´¥");xl.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:(null==(a=xl.value)?void 0:a.stats)||{},message:"æ–‡æ¡£å·²ä¿å­˜"},s.output_file&&await nl(rl.value.projectId,s.output_file,"point_to_point")}catch(t){throw t}finally{Cl.value=!1}}else v.error("é¡¹ç›®IDæ— æ•ˆ")},ea=()=>{var e;xl.value?xl.value.downloadUrl?($l.value=xl.value.outputFile,Tl.value=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Ke.value)?void 0:e.project_name)||"æ–‡æ¡£"}.docx`,zl.value=!0):v.warning("æ–‡æ¡£åœ°å€æ— æ•ˆ"):v.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},la=()=>{var e;if(xl.value)try{const l=xl.value.downloadUrl,a=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Ke.value)?void 0:e.project_name)||"æ–‡æ¡£"}-${Date.now()}.docx`;W(l,a),v.success("Wordæ–‡æ¡£ä¸‹è½½æˆåŠŸ")}catch(l){v.error("æ–‡æ¡£ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}else v.warning("æš‚æ— æ–‡æ¡£å¯ä¸‹è½½")},aa=async()=>{var e;(null==(e=xl.value)?void 0:e.outputFile)?rl.value.projectId?await nl(rl.value.projectId,xl.value.outputFile,"point_to_point"):v.error("é¡¹ç›®IDæ— æ•ˆ"):v.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},ta=()=>{var e;const l=pl.value.filter(e=>e.response).map((e,l)=>`${l+1}. ã€${sa(e.category)}ã€‘${e.requirement}\n\n${e.response}\n\nç¬¦åˆæ€§ï¼š${e.compliance}\n\n---\n`).join("\n"),a=new Blob([`# ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£\n\n${l}`],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(a),s=document.createElement("a");s.href=t,s.download=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Ke.value)?void 0:e.project_name)||"export"}-${Date.now()}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),v.success("å¯¼å‡ºæˆåŠŸ")},sa=e=>({technical:"æŠ€æœ¯è¦æ±‚",business:"å•†åŠ¡è¦æ±‚",qualification:"èµ„è´¨è¦æ±‚",other:"å…¶ä»–è¦æ±‚"}[e]||e),oa=e=>({technical:"primary",business:"success",qualification:"warning",other:"info"}[e]||""),na=e=>({pending:"å¾…ç”Ÿæˆ",generated:"å·²ç”Ÿæˆ",reviewed:"å·²å®¡æ ¸"}[e]||e),ra=e=>({pending:"info",generated:"success",reviewed:"primary"}[e]||""),ia=e=>{if(!e)return"-";let l=e;try{l=decodeURIComponent(e)}catch{}const a=l.split("/");return a[a.length-1]||"-"},ua=async()=>{if(rl.value.projectId){Ul.value=!0;try{const e=await fetch(`/api/point-to-point/files?project_id=${rl.value.projectId}`),l=await e.json();if(!l.success)throw new Error(l.error||"åŠ è½½å¤±è´¥");Sl.value=l.data||[]}catch(e){v.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{Ul.value=!1}}else Sl.value=[]},da=e=>{const l=["B","KB","MB","GB"];let a=e,t=0;for(;a>=1024&&t<l.length-1;)a/=1024,t++;return`${a.toFixed(1)} ${l[t]}`},ca=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}};return _(async()=>{await Xe();const e=await Ze({onClear:()=>{rl.value.tenderFiles=[],pl.value=[],vl.value=[],ql.value=null,xl.value=null,Fl.value=!1,Vl.value="",el.value&&ol()},onDocumentsLoaded:Bl});e&&(rl.value.projectId=e)}),(m,g)=>{const w=h,_=f,O=e,N=l,A=t,Xe=o,Ye=s,Ze=B,sl=H,nl=Y,_l=n,jl=K,bl=X,Cl=Q,ql=J,Bl=G,Gl=ee,Kl=Z,Yl=p,pa=ae,va=le;return b(),j("div",te,[x(Ze,{class:"main-panel",shadow:"never"},{default:V(()=>{var e,l,t;return[C("div",se,[C("div",oe,[g[16]||(g[16]=C("label",{class:"row-label"},"é€‰æ‹©é¡¹ç›®",-1)),x(_,{modelValue:rl.value.projectId,"onUpdate:modelValue":g[0]||(g[0]=e=>rl.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:Nl,class:"row-select"},{default:V(()=>[(b(!0),j(I,null,q(S(y),e=>(b(),F(w,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),C("div",ne,[g[17]||(g[17]=C("label",{class:"row-label"},"åº”ç­”å…¬å¸",-1)),x(O,{value:(null==(e=S(Ke))?void 0:e.company_name)||"-",disabled:"",class:"row-input"},null,8,["value"])])]),C("div",re,[C("div",ie,[g[23]||(g[23]=C("label",{class:"row-label"},"æŠ€æœ¯æ–‡æ¡£",-1)),S(el)?(b(),j("div",ue,[x(N,{class:"file-chip-icon"},{default:V(()=>[x(S(a))]),_:1}),C("span",{class:"file-chip-name",title:null==(l=S(ll))?void 0:l.filename},U((null==(t=S(ll))?void 0:t.filename)||"æœªçŸ¥æ–‡ä»¶"),9,de),g[19]||(g[19]=C("span",{class:"file-chip-tag"},"å·²åŠ è½½",-1)),x(A,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:S(ol)},{default:V(()=>[...g[18]||(g[18]=[E("Ã—",-1)])]),_:1},8,["onClick"])])):rl.value.tenderFiles.length>0?(b(),j("div",ce,[x(N,{class:"file-chip-icon"},{default:V(()=>[x(S(a))]),_:1}),C("span",{class:"file-chip-name",title:rl.value.tenderFiles[0].name},U(rl.value.tenderFiles[0].name),9,pe),g[21]||(g[21]=C("span",{class:"file-chip-tag"},"å·²ä¸Šä¼ ",-1)),x(A,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:g[1]||(g[1]=e=>rl.value.tenderFiles=[])},{default:V(()=>[...g[20]||(g[20]=[E("Ã—",-1)])]),_:1})])):(b(),j("div",ve,[g[22]||(g[22]=C("span",{class:"placeholder-text"},"è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",-1)),x(S(M),{modelValue:rl.value.tenderFiles,"onUpdate:modelValue":g[2]||(g[2]=e=>rl.value.tenderFiles=e),"http-request":Wl,accept:".pdf,.doc,.docx",limit:5,"max-size":50,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:Al},null,8,["modelValue"])]))])]),C("div",me,[C("div",fe,[C("div",he,[g[24]||(g[24]=C("label",{class:"row-label"},"åº”ç­”é¢‘ç‡",-1)),x(_,{modelValue:il.value.responseFrequency,"onUpdate:modelValue":g[3]||(g[3]=e=>il.value.responseFrequency=e),class:"row-select"},{default:V(()=>[x(w,{label:"æ¯æ®µåº”ç­”",value:"every_paragraph"}),x(w,{label:"æ¯é¡µåº”ç­”",value:"every_page"}),x(w,{label:"æ¯ç« èŠ‚åº”ç­”",value:"every_section"}),x(w,{label:"æ–‡æ¡£æœ«å°¾ç»Ÿä¸€åº”ç­”",value:"end_of_document"})]),_:1},8,["modelValue"])]),C("div",ye,[g[27]||(g[27]=C("label",{class:"row-label"},"åº”ç­”æ–¹å¼",-1)),x(Ye,{modelValue:il.value.responseMode,"onUpdate:modelValue":g[4]||(g[4]=e=>il.value.responseMode=e),class:"row-radio-group"},{default:V(()=>[x(Xe,{label:"simple"},{default:V(()=>[...g[25]||(g[25]=[E("ç®€å•æ¨¡æ¿åº”ç­”",-1)])]),_:1}),x(Xe,{label:"ai"},{default:V(()=>[...g[26]||(g[26]=[E("AIæ™ºèƒ½åº”ç­”",-1)])]),_:1})]),_:1},8,["modelValue"])])]),"simple"===il.value.responseMode?(b(),j("div",ge,[C("div",we,[g[28]||(g[28]=C("label",{class:"row-label"},"åº”ç­”å†…å®¹",-1)),x(O,{modelValue:il.value.responseContent,"onUpdate:modelValue":g[5]||(g[5]=e=>il.value.responseContent=e),placeholder:"è¯·è¾“å…¥åº”ç­”å†…å®¹",class:"row-input"},null,8,["modelValue"])]),C("div",_e,[g[29]||(g[29]=C("label",{class:"row-label"},"æ–‡æœ¬æ ¼å¼",-1)),C("div",je,[x(_,{modelValue:il.value.responseTextFormat,"onUpdate:modelValue":g[6]||(g[6]=e=>il.value.responseTextFormat=e),style:{width:"120px"}},{default:V(()=>[x(w,{label:"ç°åº•é»‘å­—",value:"gray_background"}),x(w,{label:"çº¢å­—åŠ ç²—",value:"red_bold"})]),_:1},8,["modelValue"]),C("span",{style:z(Rl.value),class:"format-sample"},U(il.value.responseContent),5)])])])):k("",!0),"ai"===il.value.responseMode?(b(),j("div",be,[C("div",xe,[g[30]||(g[30]=C("label",{class:"row-label"},"AIæ¨¡å‹",-1)),x(_,{modelValue:il.value.aiModel,"onUpdate:modelValue":g[7]||(g[7]=e=>il.value.aiModel=e),class:"row-select"},{default:V(()=>[x(w,{label:"GPT5ï¼ˆæœ€å¼ºæ¨ç†ï¼‰",value:"shihuang-gpt5"}),x(w,{label:"Claude Sonnet 4.5ï¼ˆæ ‡ä¹¦ä¸“ç”¨ï¼‰",value:"shihuang-claude-sonnet-45"}),x(w,{label:"GPT4o Mini",value:"shihuang-gpt4o-mini"}),x(w,{label:"é€šä¹‰åƒé—®-Maxï¼ˆæ¨è-é»˜è®¤ï¼‰",value:"qwen-max"})]),_:1},8,["modelValue"])]),g[31]||(g[31]=C("div",{class:"row-item"},null,-1))])):k("",!0)]),C("div",Fe,[x(A,{type:"primary",size:"large",disabled:!Ol.value,loading:yl.value,onClick:Ql},{default:V(()=>[...g[32]||(g[32]=[E(" å¼€å§‹ç‚¹å¯¹ç‚¹åº”ç­” ",-1)])]),_:1},8,["disabled","loading"])])]}),_:1}),ul.value?(b(),F(Ze,{key:0,class:"extracting-section",shadow:"never"},{header:V(()=>[C("div",ke,[g[33]||(g[33]=C("span",null,"æ­£åœ¨æå–æ‹›æ ‡è¦æ±‚...",-1)),x(sl,{percentage:dl.value,status:100===dl.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:V(()=>[x(S(D),{content:cl.value,"is-streaming":ul.value},null,8,["content","is-streaming"])]),_:1})):k("",!0),Fl.value?(b(),F(Ze,{key:1,class:"editor-section",shadow:"never"},{default:V(()=>[x(S(L),{ref_key:"editorRef",ref:kl,modelValue:Vl.value,"onUpdate:modelValue":g[8]||(g[8]=e=>Vl.value=e),title:"ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£",streaming:yl.value,height:700,onSave:Zl,onPreview:ea,onExport:la},null,8,["modelValue","streaming"])]),_:1})):k("",!0),Fl.value&&xl.value?(b(),F(Bl,{key:2,modelValue:Il.value,"onUpdate:modelValue":g[9]||(g[9]=e=>Il.value=e),class:"result-collapse"},{default:V(()=>[x(ql,{name:"result",title:"ğŸ“„ æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"},{default:V(()=>[x(Ze,{class:"result-section",shadow:"never"},{header:V(()=>[C("div",Ve,[g[39]||(g[39]=C("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),C("div",Ce,[x(A,{type:"primary",size:"large",icon:S(r),onClick:ea},{default:V(()=>[...g[34]||(g[34]=[E(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),x(A,{type:"success",size:"large",icon:S(i),onClick:la},{default:V(()=>[...g[35]||(g[35]=[E(" ä¸‹è½½Wordæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),S(tl)?(b(),F(nl,{key:1,type:"success",size:"large"},{default:V(()=>[...g[37]||(g[37]=[E(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(b(),F(A,{key:0,type:"info",size:"large",icon:S(u),loading:S(al),onClick:aa},{default:V(()=>[...g[36]||(g[36]=[E(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),x(A,{type:"primary",size:"large",icon:S(d),onClick:Ql},{default:V(()=>[...g[38]||(g[38]=[E(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:V(()=>[C("div",Ie,[x(_l,{type:"success",title:xl.value.message,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["title"]),xl.value.stats&&Object.keys(xl.value.stats).length>0?(b(),F(S(R),{key:0,title:"å¤„ç†ç»Ÿè®¡",stats:xl.value.stats},null,8,["stats"])):k("",!0),C("div",qe,[g[40]||(g[40]=C("h4",null,"ç”Ÿæˆæ–‡ä»¶",-1)),x(Cl,{column:2,border:""},{default:V(()=>[x(jl,{label:"æ–‡ä»¶å"},{default:V(()=>[E(U(ia(xl.value.outputFile)),1)]),_:1}),x(jl,{label:"ä¸‹è½½åœ°å€"},{default:V(()=>[x(bl,{href:xl.value.downloadUrl,type:"primary"},{default:V(()=>[E(U(ia(xl.value.downloadUrl)),1)]),_:1},8,["href"])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1},8,["modelValue"])):k("",!0),pl.value.length>0?(b(),F(Ze,{key:3,class:"requirements-section",shadow:"never"},{header:V(()=>[C("div",Se,[C("span",null,"æ‹›æ ‡è¦æ±‚åˆ—è¡¨ (å…± "+U(pl.value.length)+" æ¡)",1),C("div",Ue,[x(O,{modelValue:ml.value,"onUpdate:modelValue":g[10]||(g[10]=e=>ml.value=e),placeholder:"æœç´¢è¦æ±‚...",clearable:"",style:{width:"200px"}},{prefix:V(()=>[x(N,null,{default:V(()=>[x(S(c))]),_:1})]),_:1},8,["modelValue"]),x(_,{modelValue:fl.value,"onUpdate:modelValue":g[11]||(g[11]=e=>fl.value=e),placeholder:"ç­›é€‰åˆ†ç±»",clearable:"",style:{width:"150px"}},{default:V(()=>[x(w,{label:"å…¨éƒ¨",value:""}),x(w,{label:"æŠ€æœ¯è¦æ±‚",value:"technical"}),x(w,{label:"å•†åŠ¡è¦æ±‚",value:"business"}),x(w,{label:"èµ„è´¨è¦æ±‚",value:"qualification"}),x(w,{label:"å…¶ä»–è¦æ±‚",value:"other"})]),_:1},8,["modelValue"]),x(A,{type:"primary",disabled:0===vl.value.length,loading:yl.value,onClick:Jl},{default:V(()=>[E(" ç”Ÿæˆåº”ç­” ("+U(vl.value.length)+") ",1)]),_:1},8,["disabled","loading"])])])]),default:V(()=>[x(Kl,{data:hl.value,border:"",onSelectionChange:Hl,"max-height":"500"},{default:V(()=>[x(Gl,{type:"selection",width:"55"}),x(Gl,{type:"index",label:"åºå·",width:"60"}),x(Gl,{prop:"category",label:"åˆ†ç±»",width:"100"},{default:V(({row:e})=>[x(nl,{type:oa(e.category),size:"small"},{default:V(()=>[E(U(sa(e.category)),1)]),_:2},1032,["type"])]),_:1}),x(Gl,{prop:"requirement",label:"æ‹›æ ‡è¦æ±‚","min-width":"300"},{default:V(({row:e})=>[C("div",Ee,U(e.requirement),1)]),_:1}),x(Gl,{prop:"priority",label:"ä¼˜å…ˆçº§",width:"100"},{default:V(({row:e})=>{return[x(nl,{type:(l=e.priority,{"é«˜":"danger","ä¸­":"warning","ä½":"info"}[l]||""),size:"small"},{default:V(()=>[E(U(e.priority),1)]),_:2},1032,["type"])];var l}),_:1}),x(Gl,{prop:"status",label:"åº”ç­”çŠ¶æ€",width:"100"},{default:V(({row:e})=>[x(nl,{type:ra(e.status),size:"small"},{default:V(()=>[E(U(na(e.status)),1)]),_:2},1032,["type"])]),_:1}),x(Gl,{label:"æ“ä½œ",width:"100",fixed:"right"},{default:V(({row:e})=>[e.response?(b(),F(A,{key:0,type:"primary",size:"small",text:"",onClick:l=>{return a=e,Ll.value=a,void(Pl.value=!0);var a}},{default:V(()=>[...g[41]||(g[41]=[E(" æŸ¥çœ‹ ",-1)])]),_:1},8,["onClick"])):k("",!0)]),_:1})]),_:1},8,["data"])]),_:1})):k("",!0),yl.value?(b(),F(Ze,{key:4,class:"generation-output",shadow:"never"},{header:V(()=>[C("div",ze,[g[42]||(g[42]=C("span",null,"AIæ­£åœ¨ç”Ÿæˆç‚¹å¯¹ç‚¹åº”ç­”...",-1)),x(sl,{percentage:gl.value,status:100===gl.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:V(()=>[x(S(D),{content:wl.value,"is-streaming":yl.value,onStop:Xl},null,8,["content","is-streaming"])]),_:1})):k("",!0),Dl.value?(b(),F(Ze,{key:5,class:"responses-section",shadow:"never"},{header:V(()=>[C("div",$e,[g[44]||(g[44]=C("span",null,"ç‚¹å¯¹ç‚¹åº”ç­”ç»“æœ",-1)),C("div",Te,[x(A,{type:"success",icon:S(i),onClick:ta},{default:V(()=>[...g[43]||(g[43]=[E(" å¯¼å‡ºåº”ç­”æ–‡æ¡£ ",-1)])]),_:1},8,["icon"])])])]),default:V(()=>[x(Bl,{modelValue:Ml.value,"onUpdate:modelValue":g[12]||(g[12]=e=>Ml.value=e),accordion:""},{default:V(()=>[(b(!0),j(I,null,q(pl.value.filter(e=>e.response),e=>(b(),F(ql,{key:e.id,name:e.id},{title:V(()=>[C("div",De,[x(nl,{type:oa(e.category),size:"small"},{default:V(()=>[E(U(sa(e.category)),1)]),_:2},1032,["type"]),C("span",Me,U(e.requirement),1),x(nl,{type:ra(e.status),size:"small"},{default:V(()=>[E(U(na(e.status)),1)]),_:2},1032,["type"])])]),default:V(()=>[C("div",Pe,[C("div",Le,[g[45]||(g[45]=C("h4",null,"æ‹›æ ‡è¦æ±‚",-1)),C("div",Oe,U(e.requirement),1)]),C("div",Re,[g[46]||(g[46]=C("h4",null,"æˆ‘æ–¹åº”ç­”",-1)),x(S(D),{content:e.response||"","is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),e.compliance?(b(),j("div",We,[g[47]||(g[47]=C("h4",null,"ç¬¦åˆæ€§è¯´æ˜",-1)),x(nl,{type:"å®Œå…¨ç¬¦åˆ"===e.compliance?"success":"warning",size:"large"},{default:V(()=>[E(U(e.compliance),1)]),_:2},1032,["type"])])):k("",!0)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1})):k("",!0),x(Yl,{modelValue:Pl.value,"onUpdate:modelValue":g[13]||(g[13]=e=>Pl.value=e),title:"åº”ç­”è¯¦æƒ…",width:"800px","destroy-on-close":""},{default:V(()=>[Ll.value?(b(),j("div",Ne,[C("div",Ae,[g[48]||(g[48]=C("h4",null,"æ‹›æ ‡è¦æ±‚",-1)),C("div",Be,U(Ll.value.requirement),1)]),C("div",He,[g[49]||(g[49]=C("h4",null,"æˆ‘æ–¹åº”ç­”",-1)),x(S(D),{content:Ll.value.response||"","is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),Ll.value.compliance?(b(),j("div",Je,[g[50]||(g[50]=C("h4",null,"ç¬¦åˆæ€§",-1)),x(nl,{type:"å®Œå…¨ç¬¦åˆ"===Ll.value.compliance?"success":"warning"},{default:V(()=>[E(U(Ll.value.compliance),1)]),_:1},8,["type"])])):k("",!0)])):k("",!0)]),_:1},8,["modelValue"]),rl.value.projectId?(b(),F(Bl,{key:6,modelValue:El.value,"onUpdate:modelValue":g[14]||(g[14]=e=>El.value=e),class:"history-collapse"},{default:V(()=>[x(ql,{name:"history"},{title:V(()=>[C("div",Ge,[C("span",null,"ğŸ“‚ æœ¬é¡¹ç›®å†å²æ–‡ä»¶ ("+U(Sl.value.length)+")",1),El.value?(b(),F(A,{key:0,type:"primary",size:"small",loading:Ul.value,onClick:T(ua,["stop"]),style:{"margin-left":"16px"}},{default:V(()=>[...g[51]||(g[51]=[E(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):k("",!0)])]),default:V(()=>[x(Ze,{shadow:"never",style:{border:"none"}},{default:V(()=>[$((b(),F(Kl,{data:Sl.value,border:"",stripe:"","max-height":"400"},{default:V(()=>[x(Gl,{type:"index",label:"åºå·",width:"60"}),x(Gl,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:V(({row:e})=>[C("div",Qe,[x(N,null,{default:V(()=>[x(S(a))]),_:1}),C("span",null,U(e.filename),1)])]),_:1}),x(Gl,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:V(({row:e})=>[E(U(da(e.size)),1)]),_:1}),x(Gl,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:V(({row:e})=>[E(U(ca(e.process_time)),1)]),_:1}),x(Gl,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:V(({row:e})=>[x(A,{type:"primary",size:"small",onClick:l=>{var a;(a=e).file_path?($l.value=a.file_path,Tl.value=a.filename,zl.value=!0):v.warning("æ— æ³•è·å–æ–‡ä»¶ä¿¡æ¯")}},{default:V(()=>[...g[52]||(g[52]=[E(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),x(A,{type:"success",size:"small",onClick:l=>S(W)(e)},{default:V(()=>[...g[53]||(g[53]=[E(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[va,Ul.value]]),Ul.value||0!==Sl.value.length?k("",!0):(b(),F(pa,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"])):k("",!0),x(S(P),{modelValue:zl.value,"onUpdate:modelValue":g[15]||(g[15]=e=>zl.value=e),"file-url":$l.value,"file-name":Tl.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-a881c8ae"]]);export{Ke as default};
