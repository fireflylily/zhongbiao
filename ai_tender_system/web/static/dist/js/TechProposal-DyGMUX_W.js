import{ax as e,T as a,aB as l,aA as t,az as s,aC as n,a2 as o,aD as i,b9 as r,aI as u,aK as d,_ as c,u as p,aO as v,aE as m,aM as g,aL as h,au as f,b0 as y,as as _,w,aq as b,e as k,a7 as x,p as V,b_ as S,bp as j,q as P,O as F,s as C,d as M,Q as I,R as E,b$ as $,c0 as z,c1 as B,bI as D,F as T,D as N,y as L,J as U,i as R}from"./index.js";/* empty css                   *//* empty css                                                        *//* empty css                             *//* empty css                    *//* empty css                     *//* empty css               */import{E as O}from"./el-tree-DpdYJux7.js";import"./el-text-CdErL3M6.js";/* empty css                                                                            *//* empty css                */import{E as A}from"./el-input-number-t3iT0k9m.js";/* empty css                          */import{d as X,E as Y,a as q}from"./el-select-BJBcYONu.js";import{bR as W,ci as Q,bO as K,an as J,ao as H,ap as G,aF as Z,am as ee,bt as ae,bz as le,au as te,ar as se,ax as ne,as as oe,aw as ie,aB as re,ay as ue,aC as de,aS as ce,bB as pe,bA as ve,c8 as me,aW as ge,bP as he,aq as fe,av as ye,az as _e,aA as we,aU as be,aD as ke,at as xe,aV as Ve}from"./editor-DIU3HkCl.js";/* empty css                */import{S as Se}from"./SSEStreamViewer-DJugGuAN.js";import{D as je}from"./DocumentUploader-Z5X72Kgu.js";import{_ as Pe}from"./DocumentPreview.vue_vue_type_script_setup_true_lang-t5AFBzO7.js";import{R as Fe}from"./RichTextEditor-2l4oQ9EU.js";import{u as Ce,S as Me,d as Ie}from"./helpers-eyWsfAZD.js";/* empty css                */import{E as Ee}from"./strings-BtUgbwSu.js";import{a as $e,E as ze}from"./index-CkkRJnWa.js";import{t as Be}from"./tender-DY5X_q7i.js";import{u as De}from"./useProjectDocuments-Cl_fFug8.js";import{a as Te,E as Ne}from"./index-8o1yQINi.js";import{c as Le}from"./clamp-BAEQQ5va.js";import{E as Ue}from"./index-CyT3SlO3.js";import{E as Re}from"./index-DUONv1q7.js";import{E as Oe,a as Ae}from"./index-BNNUloTG.js";import{v as Xe}from"./directive-CcWiTPRI.js";import{E as Ye}from"./index-BEtJVLvu.js";import"./index-UsLHCNol.js";import"./index-tSogorqz.js";import"./index-E3rjqy71.js";import"./toNumber-D3tTWSp1.js";import"./_baseIteratee-DHzWGqJL.js";import"./imageCompressor-CTkRt5bg.js";import"./index-CNRcJ6ka.js";import"./cloneDeep-syPWYH98.js";import"./index-A7UgwcJ-.js";import"./index-CBo-fVzc.js";import"./project-B4EXd33R.js";import"./flatMap-2JDpzW_x.js";import"./map-BGIEIDPF.js";import"./_baseEach-BByE8SyV.js";import"./raf-BZHcGSIv.js";const qe=Symbol("sliderContextKey"),We=a({modelValue:{type:o([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:i,inputSize:i,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:o(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:o(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:Q,default:"top"},marks:{type:o(Object)},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...n(["ariaLabel"])}),Qe=a=>e(a)||W(a)&&a.every(e),Ke={[s]:Qe,[t]:Qe,[l]:Qe},Je=a({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:Q,default:"top"}}),He={[s]:a=>e(a)},Ge=(e,a,l)=>{const{disabled:t,min:n,max:o,step:i,showTooltip:c,persistent:p,precision:v,sliderSize:m,formatTooltip:g,emitChange:h,resetSize:f,updateDragging:y}=K(qe),{tooltip:_,tooltipVisible:w,formatValue:b,displayTooltip:k,hideTooltip:x}=((e,a,l)=>{const t=J(),s=J(!1),n=H(()=>a.value instanceof Function),o=H(()=>n.value&&a.value(e.modelValue)||e.modelValue),i=X(()=>{l.value&&(s.value=!0)},50),r=X(()=>{l.value&&(s.value=!1)},50);return{tooltip:t,tooltipVisible:s,formatValue:o,displayTooltip:i,hideTooltip:r}})(e,g,c),V=J(),S=H(()=>(e.modelValue-n.value)/(o.value-n.value)*100+"%"),j=H(()=>e.vertical?{bottom:S.value}:{left:S.value}),P=e=>{t.value||(e.preventDefault(),M(e),window.addEventListener("mousemove",I),window.addEventListener("touchmove",I),window.addEventListener("mouseup",E),window.addEventListener("touchend",E),window.addEventListener("contextmenu",E),V.value.focus())},F=e=>{t.value||(a.newPosition=Number.parseFloat(S.value)+e/(o.value-n.value)*100,$(a.newPosition),h())},C=e=>{let a,l;return e.type.startsWith("touch")?(l=e.touches[0].clientY,a=e.touches[0].clientX):(l=e.clientY,a=e.clientX),{clientX:a,clientY:l}},M=l=>{a.dragging=!0,a.isClick=!0;const{clientX:t,clientY:s}=C(l);e.vertical?a.startY=s:a.startX=t,a.startPosition=Number.parseFloat(S.value),a.newPosition=a.startPosition},I=l=>{if(a.dragging){let t;a.isClick=!1,k(),f();const{clientX:s,clientY:n}=C(l);e.vertical?(a.currentY=n,t=(a.startY-a.currentY)/m.value*100):(a.currentX=s,t=(a.currentX-a.startX)/m.value*100),a.newPosition=a.startPosition+t,$(a.newPosition)}},E=()=>{a.dragging&&(setTimeout(()=>{a.dragging=!1,a.hovering||x(),a.isClick||$(a.newPosition),h()},0),window.removeEventListener("mousemove",I),window.removeEventListener("touchmove",I),window.removeEventListener("mouseup",E),window.removeEventListener("touchend",E),window.removeEventListener("contextmenu",E))},$=async t=>{if(null===t||Number.isNaN(+t))return;t=Le(t,0,100);const r=Math.floor((o.value-n.value)/i.value),u=r*i.value/(o.value-n.value)*100,d=u+(100-u)/2;let c;if(t<u){const e=u/r,a=Math.round(t/e);c=n.value+a*i.value}else c=t<d?n.value+r*i.value:o.value;c=Number.parseFloat(c.toFixed(v.value)),c!==e.modelValue&&l(s,c),a.dragging||e.modelValue===a.oldValue||(a.oldValue=e.modelValue),await Z(),a.dragging&&k(),_.value.updatePopper()};return G(()=>a.dragging,e=>{y(e)}),r(V,"touchstart",P,{passive:!1}),{disabled:t,button:V,tooltip:_,tooltipVisible:w,showTooltip:c,persistent:p,wrapperStyle:j,formatValue:b,handleMouseEnter:()=>{a.hovering=!0,k()},handleMouseLeave:()=>{a.hovering=!1,a.dragging||x()},onButtonDown:P,onKeyDown:e=>{let a=!0;switch(u(e)){case d.left:case d.down:F(-i.value);break;case d.right:case d.up:F(i.value);break;case d.home:t.value||($(0),h());break;case d.end:t.value||($(100),h());break;case d.pageDown:F(4*-i.value);break;case d.pageUp:F(4*i.value);break;default:a=!1}a&&e.preventDefault()},setPosition:$}},Ze=ee({name:"ElSliderButton"});var ea=c(ee({...Ze,props:Je,emits:He,setup(e,{expose:a,emit:l}){const t=e,s=p("slider"),n=ae({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:t.modelValue}),o=H(()=>!!d.value&&c.value),{disabled:i,button:r,tooltip:u,showTooltip:d,persistent:c,tooltipVisible:m,wrapperStyle:g,formatValue:h,handleMouseEnter:f,handleMouseLeave:y,onButtonDown:_,onKeyDown:w,setPosition:b}=Ge(t,n,l),{hovering:k,dragging:x}=le(n);return a({onButtonDown:_,onKeyDown:w,setPosition:b,hovering:k,dragging:x}),(e,a)=>(se(),te("div",{ref_key:"button",ref:r,class:re([ue(s).e("button-wrapper"),{hover:ue(k),dragging:ue(x)}]),style:ce(ue(g)),tabindex:ue(i)?-1:0,onMouseenter:ue(f),onMouseleave:ue(y),onMousedown:ue(_),onFocus:ue(f),onBlur:ue(y),onKeydown:ue(w)},[ne(ue(v),{ref_key:"tooltip",ref:u,visible:ue(m),placement:e.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":e.tooltipClass,disabled:!ue(d),persistent:ue(o)},{content:oe(()=>[ie("span",null,de(ue(h)),1)]),default:oe(()=>[ie("div",{class:re([ue(s).e("button"),{hover:ue(k),dragging:ue(x)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}}),[["__file","button.vue"]]);var aa=ee({name:"ElSliderMarker",props:a({mark:{type:o([String,Object]),default:void 0}}),setup(e){const a=p("slider"),l=H(()=>pe(e.mark)?e.mark:e.mark.label),t=H(()=>pe(e.mark)?void 0:e.mark.style);return()=>ve("div",{class:a.e("marks-text"),style:t.value},l.value)}});const la=(e,a,n)=>{const{form:o,formItem:i}=m(),r=me(),u=J(),d=J(),c={firstButton:u,secondButton:d},p=H(()=>e.disabled||(null==o?void 0:o.disabled)||!1),v=H(()=>Math.min(a.firstValue,a.secondValue)),g=H(()=>Math.max(a.firstValue,a.secondValue)),h=H(()=>e.range?100*(g.value-v.value)/(e.max-e.min)+"%":100*(a.firstValue-e.min)/(e.max-e.min)+"%"),f=H(()=>e.range?100*(v.value-e.min)/(e.max-e.min)+"%":"0%"),y=H(()=>e.vertical?{height:e.height}:{}),_=H(()=>e.vertical?{height:h.value,bottom:f.value}:{width:h.value,left:f.value}),w=()=>{if(r.value){const l=r.value.getBoundingClientRect();a.sliderSize=l[e.vertical?"height":"width"]}},b=l=>{const t=(l=>{const t=e.min+l*(e.max-e.min)/100;if(!e.range)return u;let s;return s=Math.abs(v.value-t)<Math.abs(g.value-t)?a.firstValue<a.secondValue?"firstButton":"secondButton":a.firstValue>a.secondValue?"firstButton":"secondButton",c[s]})(l);return t.value.setPosition(l),t},k=e=>{n(s,e),n(t,e)},x=async()=>{await Z(),n(l,e.range?[v.value,g.value]:e.modelValue)},V=l=>{var t,s,n,o,i,u;if(p.value||a.dragging)return;w();let d=0;if(e.vertical){const e=null!=(n=null==(s=null==(t=l.touches)?void 0:t.item(0))?void 0:s.clientY)?n:l.clientY;d=(r.value.getBoundingClientRect().bottom-e)/a.sliderSize*100}else{d=((null!=(u=null==(i=null==(o=l.touches)?void 0:o.item(0))?void 0:i.clientX)?u:l.clientX)-r.value.getBoundingClientRect().left)/a.sliderSize*100}return d<0||d>100?void 0:b(d)};return{elFormItem:i,slider:r,firstButton:u,secondButton:d,sliderDisabled:p,minValue:v,maxValue:g,runwayStyle:y,barStyle:_,resetSize:w,setPosition:b,emitChange:x,onSliderWrapperPrevent:e=>{var a,l;((null==(a=c.firstButton.value)?void 0:a.dragging)||(null==(l=c.secondButton.value)?void 0:l.dragging))&&e.preventDefault()},onSliderClick:e=>{V(e)&&x()},onSliderDown:async e=>{const a=V(e);a&&(await Z(),a.value.onButtonDown(e))},onSliderMarkerDown:e=>{if(p.value||a.dragging)return;b(e)&&x()},setFirstValue:l=>{a.firstValue=null!=l?l:e.min,k(e.range?[v.value,g.value]:null!=l?l:e.min)},setSecondValue:l=>{a.secondValue=l,e.range&&k([v.value,g.value])}}},ta=ee({name:"ElSlider"});const sa=w(c(ee({...ta,props:We,emits:Ke,setup(a,{expose:l,emit:n}){const o=a,i=p("slider"),{t:u}=f(),d=ae({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:c,slider:v,firstButton:m,secondButton:w,sliderDisabled:b,minValue:k,maxValue:x,runwayStyle:V,barStyle:S,resetSize:j,emitChange:P,onSliderWrapperPrevent:F,onSliderClick:C,onSliderDown:M,onSliderMarkerDown:I,setFirstValue:E,setSecondValue:$}=la(o,d,n),{stops:z,getStopStyle:B}=((e,a,l,t)=>({stops:H(()=>{if(!e.showStops||e.min>e.max)return[];if(0===e.step)return[];const s=Math.ceil((e.max-e.min)/e.step),n=100*e.step/(e.max-e.min),o=Array.from({length:s-1}).map((e,a)=>(a+1)*n);return e.range?o.filter(a=>a<100*(l.value-e.min)/(e.max-e.min)||a>100*(t.value-e.min)/(e.max-e.min)):o.filter(l=>l>100*(a.firstValue-e.min)/(e.max-e.min))}),getStopStyle:a=>e.vertical?{bottom:`${a}%`}:{left:`${a}%`}}))(o,d,k,x),{inputId:D,isLabeledByFormItem:T}=y(o,{formItemContext:c}),N=_(),L=H(()=>o.inputSize||N.value),U=H(()=>o.ariaLabel||u("el.slider.defaultLabel",{min:o.min,max:o.max})),R=H(()=>o.range?o.rangeStartLabel||u("el.slider.defaultRangeStartLabel"):U.value),O=H(()=>o.formatValueText?o.formatValueText(oe.value):`${oe.value}`),X=H(()=>o.rangeEndLabel||u("el.slider.defaultRangeEndLabel")),Y=H(()=>o.formatValueText?o.formatValueText(de.value):`${de.value}`),q=H(()=>[i.b(),i.m(N.value),i.is("vertical",o.vertical),{[i.m("with-input")]:o.showInput}]),Q=(e=>H(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((e,a)=>e-a).filter(a=>a<=e.max&&a>=e.min).map(a=>({point:a,position:100*(a-e.min)/(e.max-e.min),mark:e.marks[a]})):[]))(o);((a,l,n,o,i,r)=>{const u=e=>{i(s,e),i(t,e)},d=()=>a.range?![n.value,o.value].every((e,a)=>e===l.oldValue[a]):a.modelValue!==l.oldValue,c=()=>{var t,s;a.min>a.max&&g("Slider","min should not be greater than max.");const n=a.modelValue;a.range&&W(n)?n[1]<a.min?u([a.min,a.min]):n[0]>a.max?u([a.max,a.max]):n[0]<a.min?u([a.min,n[1]]):n[1]>a.max?u([n[0],a.max]):(l.firstValue=n[0],l.secondValue=n[1],d()&&(a.validateEvent&&(null==(t=null==r?void 0:r.validate)||t.call(r,"change").catch(e=>h())),l.oldValue=n.slice())):a.range||!e(n)||Number.isNaN(n)||(n<a.min?u(a.min):n>a.max?u(a.max):(l.firstValue=n,d()&&(a.validateEvent&&(null==(s=null==r?void 0:r.validate)||s.call(r,"change").catch(e=>h())),l.oldValue=n)))};c(),G(()=>l.dragging,e=>{e||c()}),G(()=>a.modelValue,(e,a)=>{l.dragging||W(e)&&W(a)&&e.every((e,l)=>e===a[l])&&l.firstValue===e[0]&&l.secondValue===e[1]||c()},{deep:!0}),G(()=>[a.min,a.max],()=>{c()})})(o,d,k,x,n,c);const K=H(()=>{const e=[o.min,o.max,o.step].map(e=>{const a=`${e}`.split(".")[1];return a?a.length:0});return Math.max.apply(null,e)}),{sliderWrapper:ee}=((a,l,t)=>{const s=J();return ge(async()=>{a.range?(W(a.modelValue)?(l.firstValue=Math.max(a.min,a.modelValue[0]),l.secondValue=Math.min(a.max,a.modelValue[1])):(l.firstValue=a.min,l.secondValue=a.max),l.oldValue=[l.firstValue,l.secondValue]):(!e(a.modelValue)||Number.isNaN(a.modelValue)?l.firstValue=a.min:l.firstValue=Math.min(a.max,Math.max(a.min,a.modelValue)),l.oldValue=l.firstValue),r(window,"resize",t),await Z(),t()}),{sliderWrapper:s}})(o,d,j),{firstValue:oe,secondValue:de,sliderSize:pe}=le(d);return r(ee,"touchstart",F,{passive:!1}),r(ee,"touchmove",F,{passive:!1}),he(qe,{...le(o),sliderSize:pe,disabled:b,precision:K,emitChange:P,resetSize:j,updateDragging:e=>{d.dragging=e}}),l({onSliderClick:C}),(e,a)=>{var l,t;return se(),te("div",{id:e.range?ue(D):void 0,ref_key:"sliderWrapper",ref:ee,class:re(ue(q)),role:e.range?"group":void 0,"aria-label":e.range&&!ue(T)?ue(U):void 0,"aria-labelledby":e.range&&ue(T)?null==(l=ue(c))?void 0:l.labelId:void 0},[ie("div",{ref_key:"slider",ref:v,class:re([ue(i).e("runway"),{"show-input":e.showInput&&!e.range},ue(i).is("disabled",ue(b))]),style:ce(ue(V)),onMousedown:ue(M),onTouchstartPassive:ue(M)},[ie("div",{class:re(ue(i).e("bar")),style:ce(ue(S))},null,6),ne(ea,{id:e.range?void 0:ue(D),ref_key:"firstButton",ref:m,"model-value":ue(oe),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":e.range||!ue(T)?ue(R):void 0,"aria-labelledby":!e.range&&ue(T)?null==(t=ue(c))?void 0:t.labelId:void 0,"aria-valuemin":e.min,"aria-valuemax":e.range?ue(de):e.max,"aria-valuenow":ue(oe),"aria-valuetext":ue(O),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":ue(b),"onUpdate:modelValue":ue(E)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),e.range?(se(),fe(ea,{key:0,ref_key:"secondButton",ref:w,"model-value":ue(de),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":ue(X),"aria-valuemin":ue(oe),"aria-valuemax":e.max,"aria-valuenow":ue(de),"aria-valuetext":ue(Y),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":ue(b),"onUpdate:modelValue":ue($)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):ye("v-if",!0),e.showStops?(se(),te("div",{key:1},[(se(!0),te(_e,null,we(ue(z),(e,a)=>(se(),te("div",{key:a,class:re(ue(i).e("stop")),style:ce(ue(B)(e))},null,6))),128))])):ye("v-if",!0),ue(Q).length>0?(se(),te(_e,{key:2},[ie("div",null,[(se(!0),te(_e,null,we(ue(Q),(e,a)=>(se(),te("div",{key:a,style:ce(ue(B)(e.position)),class:re([ue(i).e("stop"),ue(i).e("marks-stop")])},null,6))),128))]),ie("div",{class:re(ue(i).e("marks"))},[(se(!0),te(_e,null,we(ue(Q),(e,a)=>(se(),fe(ue(aa),{key:a,mark:e.mark,style:ce(ue(B)(e.position)),onMousedown:be(a=>ue(I)(e.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):ye("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),e.showInput&&!e.range?(se(),fe(ue(A),{key:0,ref:"input","model-value":ue(oe),class:re(ue(i).e("input")),step:e.step,disabled:ue(b),controls:e.showInputControls,min:e.min,max:e.max,precision:ue(K),size:ue(L),"onUpdate:modelValue":ue(E),onChange:ue(P)},null,8,["model-value","class","step","disabled","controls","min","max","precision","size","onUpdate:modelValue","onChange"])):ye("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}}),[["__file","slider.vue"]])),na={class:"crew-progress-tracker"},oa={class:"tracker-header"},ia={class:"phase-list"},ra={class:"phase-icon"},ua={class:"phase-content"},da={class:"phase-name"},ca={key:0,class:"phase-result"},pa={key:1,class:"phase-message"},va={key:0,class:"phase-connector"},ma={class:"detail-content"},ga={class:"dim-name"},ha={class:"dim-count"},fa={class:"dim-score"},ya={class:"detail-content"},_a={key:0,class:"review-section"},wa={key:1,class:"review-section"},ba=P(ee({__name:"CrewProgressTracker",props:{currentPhase:{default:""},phaseProgress:{default:()=>({})},scoringPoints:{},productMatch:{},scoringStrategy:{},materials:{},reviewResult:{},showDetails:{type:Boolean,default:!1}},setup(e){const a=e,l=J([]),t=[{key:"scoring_extraction",label:"è¯„åˆ†ç‚¹æå–"},{key:"product_matching",label:"äº§å“èƒ½åŠ›åŒ¹é…"},{key:"strategy_planning",label:"è¯„åˆ†ç­–ç•¥è§„åˆ’"},{key:"material_retrieval",label:"å†å²ç´ ææ£€ç´¢"},{key:"outline_generation",label:"å¤§çº²ç»“æ„ç”Ÿæˆ"},{key:"content_writing",label:"æŠ€æœ¯æ–¹æ¡ˆæ’°å†™"},{key:"expert_review",label:"ä¸“å®¶è¯„å®¡"},{key:"complete",label:"ç”Ÿæˆå®Œæˆ"}],s=e=>({scoring_extraction:"æå–è¯„åˆ†ç‚¹",product_matching:"åŒ¹é…äº§å“",strategy_planning:"ç­–ç•¥è§„åˆ’",material_retrieval:"æ£€ç´¢ç´ æ",outline_generation:"ç”Ÿæˆå¤§çº²",content_writing:"æ’°å†™å†…å®¹",expert_review:"ä¸“å®¶è¯„å®¡",iteration:"è¿­ä»£ä¼˜åŒ–",complete:"å·²å®Œæˆ"}[e]||e),n=H(()=>a.scoringPoints||a.reviewResult);return(a,o)=>{const i=k,r=Ee,u=ze,d=$e;return se(),te("div",na,[ie("div",oa,[ne(i,null,{default:oe(()=>[ne(ue(b))]),_:1}),o[1]||(o[1]=ie("span",null,"Quality-First æ™ºèƒ½ä½“åä½œè¿›åº¦",-1)),e.currentPhase?(se(),fe(r,{key:0,type:(c=e.currentPhase,"complete"===c?"success":"expert_review"===c?"warning":"content_writing"===c?"primary":"info"),size:"small"},{default:oe(()=>[ke(de(s(e.currentPhase)),1)]),_:1},8,["type"])):ye("",!0)]),ie("div",ia,[(se(),te(_e,null,we(t,a=>{var l,t,s,n,u,d,c,p;return ie("div",{key:a.key,class:re(["phase-item",{"phase-item--complete":"complete"===(null==(l=e.phaseProgress[a.key])?void 0:l.status),"phase-item--running":"running"===(null==(t=e.phaseProgress[a.key])?void 0:t.status),"phase-item--skipped":"skipped"===(null==(s=e.phaseProgress[a.key])?void 0:s.status),"phase-item--pending":!e.phaseProgress[a.key]}])},[ie("div",ra,["complete"===(null==(n=e.phaseProgress[a.key])?void 0:n.status)?(se(),fe(i,{key:0,class:"icon-success"},{default:oe(()=>[ne(ue(x))]),_:1})):"running"===(null==(u=e.phaseProgress[a.key])?void 0:u.status)?(se(),fe(i,{key:1,class:"icon-running"},{default:oe(()=>[ne(ue(V))]),_:1})):"skipped"===(null==(d=e.phaseProgress[a.key])?void 0:d.status)?(se(),fe(i,{key:2,class:"icon-skipped"},{default:oe(()=>[ne(ue(S))]),_:1})):(se(),fe(i,{key:3,class:"icon-pending"},{default:oe(()=>[ne(ue(j))]),_:1}))]),ie("div",ua,[ie("div",da,de(a.label),1),(null==(c=e.phaseProgress[a.key])?void 0:c.result)?(se(),te("div",ca,["scoring_extraction"===a.key?(se(),te(_e,{key:0},[ke(de(e.phaseProgress[a.key].result.count||0)+"ä¸ªè¯„åˆ†ç»´åº¦ ",1)],64)):"product_matching"===a.key?(se(),te(_e,{key:1},[ke(" è¦†ç›–ç‡ "+de((100*(e.phaseProgress[a.key].result.coverage_rate||0)).toFixed(1))+"% ",1)],64)):"strategy_planning"===a.key?(se(),te(_e,{key:2},[ke(" é¢„ä¼°å¾—åˆ† "+de(e.phaseProgress[a.key].result.estimated_score||0)+"åˆ† ",1)],64)):"material_retrieval"===a.key?(se(),te(_e,{key:3},[ke(de(e.phaseProgress[a.key].result.package_count||0)+"ä¸ªç´ æåŒ… ",1)],64)):"outline_generation"===a.key?(se(),te(_e,{key:4},[ke(de(e.phaseProgress[a.key].result.chapter_count||0)+"ç« èŠ‚ ",1)],64)):"content_writing"===a.key?(se(),te(_e,{key:5},[ke(de(e.phaseProgress[a.key].result.chapter_count||0)+"ç« ï¼Œ"+de(e.phaseProgress[a.key].result.total_words||0)+"å­— ",1)],64)):"expert_review"===a.key?(se(),te(_e,{key:6},[ke(de(e.phaseProgress[a.key].result.overall_score||0)+"åˆ† ",1),ne(r,{type:e.phaseProgress[a.key].result.pass_recommendation?"success":"warning",size:"small"},{default:oe(()=>[ke(de(e.phaseProgress[a.key].result.pass_recommendation?"é€šè¿‡":"éœ€æ”¹è¿›"),1)]),_:2},1032,["type"])],64)):ye("",!0)])):(null==(p=e.phaseProgress[a.key])?void 0:p.message)?(se(),te("div",pa,de(e.phaseProgress[a.key].message),1)):ye("",!0)]),"complete"!==a.key?(se(),te("div",va,[...o[2]||(o[2]=[ie("div",{class:"connector-line"},null,-1)])])):ye("",!0)],2)}),64))]),e.showDetails&&n.value?(se(),fe(d,{key:0,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),class:"details-collapse"},{default:oe(()=>[e.scoringPoints?(se(),fe(u,{key:0,title:"è¯„åˆ†ç‚¹è¯¦æƒ…",name:"scoring"},{default:oe(()=>[ie("div",ma,[(se(!0),te(_e,null,we(e.scoringPoints.dimensions,e=>(se(),te("div",{key:e.name,class:"dimension-item"},[ie("span",ga,de(e.name),1),ie("span",ha,de(e.count)+"é¡¹",1),ie("span",fa,de(e.total_score)+"åˆ†",1)]))),128))])]),_:1})):ye("",!0),e.reviewResult?(se(),fe(u,{key:1,title:"è¯„å®¡è¯¦æƒ…",name:"review"},{default:oe(()=>{var a,l;return[ie("div",ya,[(null==(a=e.reviewResult.strengths)?void 0:a.length)?(se(),te("div",_a,[o[3]||(o[3]=ie("h4",null,"ä¼˜åŠ¿",-1)),ie("ul",null,[(se(!0),te(_e,null,we(e.reviewResult.strengths,(e,a)=>(se(),te("li",{key:a},de(e),1))),128))])])):ye("",!0),(null==(l=e.reviewResult.weaknesses)?void 0:l.length)?(se(),te("div",wa,[o[4]||(o[4]=ie("h4",null,"ä¸è¶³",-1)),ie("ul",null,[(se(!0),te(_e,null,we(e.reviewResult.weaknesses,(e,a)=>(se(),te("li",{key:a},de(e),1))),128))])])):ye("",!0)])]}),_:1})):ye("",!0)]),_:1},8,["modelValue"])):ye("",!0)]);var c}}}),[["__scopeId","data-v-a30635fb"]]),ka={class:"tech-proposal"},xa={class:"panel-row project-row"},Va={class:"row-item"},Sa={class:"row-item"},ja={class:"panel-row project-row document-row"},Pa={class:"row-item"},Fa={key:0,class:"file-chip file-chip--success"},Ca=["title"],Ma={key:1,class:"file-chip file-chip--info"},Ia=["title"],Ea={key:2,class:"file-placeholder"},$a={class:"config-section"},za={class:"panel-row project-row"},Ba={class:"row-item"},Da={class:"row-item"},Ta={class:"panel-row project-row"},Na={class:"row-item"},La={key:0,class:"row-item"},Ua={key:1,class:"row-item"},Ra={key:0,class:"quality-first-config"},Oa={class:"config-header"},Aa={class:"panel-row project-row"},Xa={class:"row-item"},Ya={class:"panel-row project-row"},qa={class:"row-item slider-row"},Wa={class:"slider-wrapper"},Qa={class:"panel-row project-row"},Ka={class:"row-item"},Ja={class:"panel-row project-row"},Ha={class:"row-item slider-row"},Ga={class:"slider-wrapper"},Za={class:"page-hint"},el={class:"panel-row project-row"},al={class:"row-item"},ll={class:"row-item"},tl={class:"panel-row project-row"},sl={class:"row-item"},nl={class:"row-item"},ol={class:"panel-actions"},il={class:"card-header"},rl={class:"card-header"},ul={class:"requirement-categories"},dl={class:"category-title"},cl={class:"category-content"},pl={key:0,class:"category-summary"},vl={key:1,class:"category-keywords"},ml={key:2,class:"category-points"},gl={class:"card-header"},hl={class:"ç« èŠ‚ç»“æ„"},fl={class:"tree-node"},yl={class:"node-title"},_l={key:2,class:"node-desc"},wl={class:"card-header"},bl={class:"header-actions"},kl={class:"result-content"},xl={class:"output-files"},Vl={class:"file-buttons"},Sl={class:"collapse-header"},jl={class:"filename-cell"},Pl=P(ee({__name:"TechProposal",setup(e){const{projects:a,selectedProject:l,loadProjects:t,handleProjectChange:s,restoreProjectFromStore:n}=De(),{useHitlFile:o,hitlFileInfo:i,syncing:r,synced:u,loadFromHITL:d,cancelHitlFile:c,syncToHitl:p}=Ce({onFileLoaded:()=>{w.value.tenderFiles=[]}}),m=J([]),g=J(!1),h=J([]),f=async()=>{if(w.value.projectId){g.value=!0;try{const e=await fetch(`/api/tech-proposal/files?project_id=${w.value.projectId}`),a=await e.json();if(!a.success)throw new Error(a.error||"åŠ è½½å¤±è´¥");m.value=a.data||[]}catch(e){R.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{g.value=!1}}else m.value=[]},y=e=>{const a=["B","KB","MB","GB"];let l=e,t=0;for(;l>=1024&&t<a.length-1;)l/=1024,t++;return`${l.toFixed(1)} ${a[t]}`},_=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}},w=J({projectId:null,tenderFiles:[]}),b=J({outputPrefix:"æŠ€æœ¯æ–¹æ¡ˆ",aiModel:"shihuang-gpt4o-mini",generationMode:"Quality-First",templateName:"æ”¿åºœé‡‡è´­æ ‡å‡†",pageCount:200,contentStyle:{tables:"é€‚é‡",flowcharts:"æµç¨‹å›¾",images:"å°‘é‡"},additionalOutputs:["includeAnalysis","includeMapping","includeSummary"]}),x=J({enabledPhases:["product_matching","material_retrieval","expert_review"],minReviewScore:85,maxIterations:2}),V=J({scoringPoints:null,productMatch:null,scoringStrategy:null,materials:null,reviewResult:null,currentPhase:"",phaseProgress:{}}),S=J(!1),j=J(0),P=J(""),X=J(null),W=J(!0),Q=J(null),K=J(!0),G=J(null),Z=J(null),ee=J(!1),ae=J(""),le=J(""),re=J(!1),ce=J(null),pe=J(""),ve=J(!1),me=J(!1),he=H(()=>{var e;return(null==(e=Q.value)?void 0:e.chapters)?Q.value.chapters:[]}),Le=H(()=>w.value.projectId&&(o.value||w.value.tenderFiles.length>0)),qe=async e=>{var a;const{file:t,onSuccess:s,onError:n}=e;if(!w.value.projectId){return n(new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")),void R.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")}if(!(null==(a=l.value)?void 0:a.company_id)){return n(new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")),void R.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")}try{const e=new FormData;e.append("file",t),e.append("company_id",l.value.company_id.toString()),e.append("project_id",w.value.projectId.toString());const a=await Be.parseDocumentStructure(e);if(!a.success)throw new Error(a.message||"ä¸Šä¼ å¤±è´¥");s(a.data),R.success("æŠ€æœ¯éœ€æ±‚æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(o){n(o),R.error(o.message||"æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},We=()=>{R.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},Qe=async()=>{await s(w.value.projectId,{onClear:()=>{w.value.tenderFiles=[],X.value=null,Q.value=null,G.value=null,Z.value=null,P.value="",re.value=!1,pe.value="",m.value=[],o.value&&c()},onDocumentsLoaded:e=>{e.technicalFile&&d(e,"technicalFile"),e.techProposalFile&&(Z.value=e.techProposalFile)}}),w.value.projectId&&await f()},Ke=async()=>{var e;if(Le.value){S.value=!0,j.value=0,P.value="",X.value=null,G.value=null,re.value=!1,pe.value="";try{const a=new FormData;if(o.value&&i.value)a.append("use_hitl_technical_file","true"),a.append("project_id",w.value.projectId.toString());else{if(!(null==(e=w.value.tenderFiles[0])?void 0:e.raw))throw new Error("è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");a.append("tender_file",w.value.tenderFiles[0].raw)}a.append("outputPrefix",b.value.outputPrefix),a.append("companyId",l.value.company_id.toString()),a.append("projectName",l.value.project_name||""),a.append("projectId",w.value.projectId.toString()),a.append("aiModel",b.value.aiModel),b.value.generationMode&&(a.append("generation_mode",b.value.generationMode),a.append("page_count",b.value.pageCount.toString()),a.append("content_style",JSON.stringify(b.value.contentStyle)),"ç¼–å†™ä¸“é¡¹ç« èŠ‚"===b.value.generationMode&&b.value.templateName&&a.append("template_name",b.value.templateName)),a.append("includeAnalysis",b.value.additionalOutputs.includes("includeAnalysis")?"true":"false"),a.append("includeMapping",b.value.additionalOutputs.includes("includeMapping")?"true":"false"),a.append("includeSummary",b.value.additionalOutputs.includes("includeSummary")?"true":"false"),await Je(a),R.success("æŠ€æœ¯æ–¹æ¡ˆç”Ÿæˆå®Œæˆ")}catch(a){R.error(a.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{S.value=!1}}else R.warning("è¯·é€‰æ‹©é¡¹ç›®å¹¶ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£")},Je=async e=>{var a,l,t,s,n,o,i,r,u,d,c,v,m,g,h,f;let y;"Quality-First"===b.value.generationMode?(y="/api/agent/generate-crew",e.append("crew_config",JSON.stringify({skip_product_matching:!x.value.enabledPhases.includes("product_matching"),skip_material_retrieval:!x.value.enabledPhases.includes("material_retrieval"),enable_expert_review:x.value.enabledPhases.includes("expert_review"),min_review_score:x.value.minReviewScore,max_iterations:x.value.maxIterations})),V.value={scoringPoints:null,productMatch:null,scoringStrategy:null,materials:null,reviewResult:null,currentPhase:"",phaseProgress:{}}):y=b.value.generationMode?"/api/agent/generate":"/api/generate-proposal-stream-v2";const _=await fetch(y,{method:"POST",body:e});if(!_.ok)throw new Error(`HTTP ${_.status}: ${_.statusText}`);const k=null==(a=_.body)?void 0:a.getReader();if(!k)throw new Error("æ— æ³•è¯»å–å“åº”æµ");const S=new TextDecoder;let F="";const C={};let M="",I=null;const E=()=>{I&&clearTimeout(I),I=setTimeout(()=>{He(C)},500)};for(;;){const{done:e,value:a}=await k.read();if(e)break;F+=S.decode(a,{stream:!0});const y=F.split("\n");F=y.pop()||"";for(const _ of y)if(_.startsWith("data: "))try{const e=JSON.parse(_.slice(6));if(void 0!==e.progress&&(j.value=e.progress),e.message&&(P.value+=e.message+"\n"),"analysis_completed"===e.stage&&e.analysis_result&&(X.value=e.analysis_result),"outline_completed"===e.stage&&e.outline_data&&(Q.value=e.outline_data),"Quality-First"===b.value.generationMode){if(e.phase&&(V.value.currentPhase=e.phase,V.value.phaseProgress[e.phase]={status:e.status,message:e.message,result:e.result}),"scoring_extraction"===e.phase&&"complete"===e.status&&(V.value.scoringPoints=e.result,P.value+=`âœ… è¯„åˆ†ç‚¹æå–å®Œæˆ: ${(null==(l=e.result)?void 0:l.count)||0}ä¸ªè¯„åˆ†ç»´åº¦\n`),"product_matching"===e.phase&&"complete"===e.status){V.value.productMatch=e.result;const a=(null==(t=e.result)?void 0:t.coverage_rate)||0;P.value+=`âœ… äº§å“èƒ½åŠ›åŒ¹é…å®Œæˆ: è¦†ç›–ç‡ ${(100*a).toFixed(1)}%\n`}if("strategy_planning"===e.phase&&"complete"===e.status&&(V.value.scoringStrategy=e.result,P.value+=`âœ… è¯„åˆ†ç­–ç•¥åˆ¶å®šå®Œæˆ: é¢„ä¼°å¾—åˆ† ${(null==(s=e.result)?void 0:s.estimated_score)||0}\n`),"material_retrieval"===e.phase&&"complete"===e.status&&(V.value.materials=e.result,P.value+=`âœ… ç´ ææ£€ç´¢å®Œæˆ: ${(null==(n=e.result)?void 0:n.package_count)||0}ä¸ªç´ æåŒ…\n`),"outline_generation"===e.phase&&"complete"===e.status&&((null==(o=e.result)?void 0:o.outline)&&(Q.value={chapters:e.result.outline,total_chapters:e.result.chapter_count,total_words:e.result.total_words}),P.value+=`âœ… å¤§çº²ç”Ÿæˆå®Œæˆ: ${(null==(i=e.result)?void 0:i.chapter_count)||0}ç« \n`),"content_writing"===e.phase)if("chapter_progress"===e.event)M=(null==(r=e.chapter_index)?void 0:r.toString())||"",P.value+=`ğŸ“ æ­£åœ¨æ’°å†™: ${e.chapter_title}\n`,re.value||(re.value=!0);else if("chapter_complete"===e.event&&e.chapter){const a=(null==(u=e.chapter)?void 0:u.chapter_number)||M;a&&(C[a]=(null==(d=e.chapter)?void 0:d.content)||"",He(C)),P.value+=`âœ“ ${(null==(c=e.chapter)?void 0:c.title)||"ç« èŠ‚"} æ’°å†™å®Œæˆ\n`}if("expert_review"===e.phase&&"complete"===e.status){V.value.reviewResult=e.result;const a=(null==(v=e.result)?void 0:v.overall_score)||0,l=(null==(m=e.result)?void 0:m.pass_recommendation)?"âœ…é€šè¿‡":"âš ï¸éœ€æ”¹è¿›";P.value+=`âœ… ä¸“å®¶è¯„å®¡å®Œæˆ: ${a}åˆ† ${l}\n`}"iteration"===e.phase&&("running"===e.status?P.value+=`ğŸ”„ ç¬¬${e.iteration}è½®ä¼˜åŒ–ä¸­... (å½“å‰${e.current_score}åˆ† â†’ ç›®æ ‡${e.target_score}åˆ†)\n`:"complete"===e.status&&(P.value+=`âœ… ç¬¬${e.iteration}è½®ä¼˜åŒ–å®Œæˆ: ${(null==(g=e.result)?void 0:g.new_score)||0}åˆ†\n`)),"skipped"===e.status&&(P.value+=`â­ï¸ è·³è¿‡: ${e.message}\n`)}if("content_generation"===e.stage)if("chapter_start"===e.event)M=e.chapter_number||"",C[M]="",P.value+=`\n\n## ${e.chapter_number} ${e.chapter_title}\n\n`,re.value||(re.value=!0);else if("content_chunk"===e.event){const a=e.chapter_number||M;a&&(C[a]=(C[a]||"")+(e.content||""),E())}else"chapter_end"===e.event&&(I&&clearTimeout(I),He(C),P.value+=`\nâœ“ ${e.chapter_title||"ç« èŠ‚"} ç”Ÿæˆå®Œæˆ\n`);if("completed"===e.stage&&e.success&&(G.value=e,Z.value={outputFile:e.output_file,downloadUrl:null==(h=e.output_files)?void 0:h.proposal,stats:{requirements_count:e.requirements_count,sections_count:e.sections_count,matches_count:e.matches_count},message:"æŠ€æœ¯æ–¹æ¡ˆå·²ç”Ÿæˆ"},re.value=!0,e.output_file&&await ta(e.output_file),e.output_file&&w.value.projectId&&await p(w.value.projectId,e.output_file,"tech_proposal")),"error"===e.stage){const a=e.error||e.message||"æœªçŸ¥é”™è¯¯";throw P.value+=`\nâŒ é”™è¯¯: ${a}\n`,e.traceback&&(P.value+=`\nğŸ“‹ è¯¦ç»†ä¿¡æ¯:\n${e.traceback}\n`),new Error(a)}}catch($){if(!(null==(f=$.message)?void 0:f.includes("JSON")))throw $}}},He=e=>{var a;if(null==(a=Q.value)?void 0:a.chapters){let a="";const l=t=>{for(const s of t){const t=s.chapter_number,n=e[t]||"",o=s.level||1,i=`ch-${t.replace(/\./g,"-")}`;a+=`<h${o} id="${i}">${t} ${s.title}</h${o}>\n`,s.description&&(a+=`<div style="padding: 12px; background: #E8F4FD; border-left: 4px solid #409EFF; margin: 12px 0;">\n            <strong>ã€æœ¬ç« è¯´æ˜ã€‘</strong> ${s.description}\n          </div>\n`),s.response_strategy&&(a+=`<div style="padding: 12px; background: #F0F9FF; border-left: 4px solid #67C23A; margin: 12px 0;">\n            <strong>ã€åº”ç­”ç­–ç•¥ã€‘</strong> ${s.response_strategy}\n          </div>\n`),s.content_hints&&s.content_hints.length>0&&(a+=`<div style="padding: 12px; background: #FFF7E6; border-left: 4px solid #E6A23C; margin: 12px 0;">\n            <strong>ã€å†…å®¹æç¤ºã€‘</strong>\n            <ul style="margin: 8px 0; padding-left: 24px;">\n              ${s.content_hints.map(e=>`<li>${e}</li>`).join("")}\n            </ul>\n          </div>\n`),s.response_tips&&s.response_tips.length>0&&(a+=`<div style="padding: 12px; background: #FEF0F0; border-left: 4px solid #F56C6C; margin: 12px 0;">\n            <strong>ã€åº”ç­”å»ºè®®ã€‘</strong>\n            <ul style="margin: 8px 0; padding-left: 24px;">\n              ${s.response_tips.map(e=>`<li>${e}</li>`).join("")}\n            </ul>\n          </div>\n`),n?(a+='<div style="padding: 12px; background: #F0FFF4; border-left: 4px solid #52C41A; margin: 12px 0;">\n            <strong style="color: #52C41A;">ã€AIç”Ÿæˆå†…å®¹ã€‘</strong>\n          </div>\n',a+=`<div style="line-height: 1.8; margin: 12px 0;">${n.replace(/\n/g,"<br>")}</div>\n`):t in e&&(a+='<div style="padding: 12px; background: #F5F5F5; border: 1px dashed #D9D9D9; margin: 12px 0; color: #999;">\n            <em>æ­£åœ¨ç”Ÿæˆå†…å®¹...</em>\n          </div>\n'),s.subsections&&s.subsections.length>0&&l(s.subsections)}};l(Q.value.chapters),pe.value=a}else{let a="";const l=Object.entries(e).sort((e,a)=>{const[l]=e,[t]=a;return l.localeCompare(t,"zh-CN")});for(const[e,t]of l)a+=`<h2>${e}</h2>\n`,t&&(a+=`<div style="line-height: 1.8;">${t.replace(/\n/g,"<br>")}</div>\n`);pe.value=a}},Ge=()=>{S.value=!1,R.info("å·²åœæ­¢ç”Ÿæˆ")},Ze=e=>{var a,l;if(!(null==(l=null==(a=G.value)?void 0:a.output_files)?void 0:l[e]))return void R.warning("æ–‡ä»¶ä¸å­˜åœ¨");const t=G.value.output_files[e];let s=t.split("/").pop()||`æŠ€æœ¯æ–¹æ¡ˆ_${e}.docx`;s=s.split("?")[0],Ie(t,s),R.success("ä¸‹è½½å·²å¼€å§‹")},ea=()=>{var e,a,t;(null==(a=null==(e=G.value)?void 0:e.output_files)?void 0:a.proposal)?(ae.value=G.value.output_files.proposal,le.value=`æŠ€æœ¯æ–¹æ¡ˆ-${(null==(t=l.value)?void 0:t.project_name)||"æ–‡æ¡£"}.docx`,ee.value=!0):R.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},aa=async()=>{var e;(null==(e=G.value)?void 0:e.output_file)?w.value.projectId?await p(w.value.projectId,G.value.output_file,"tech_proposal"):R.error("é¡¹ç›®IDæ— æ•ˆ"):R.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},la=async e=>{var a;if(null==(a=G.value)?void 0:a.output_file)try{me.value=!0;const a=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:w.value.projectId,document_type:"tech_proposal",original_file:G.value.output_file})}),l=await a.json();if(!l.success)throw new Error(l.error||"ä¿å­˜å¤±è´¥");R.success("æŠ€æœ¯æ–¹æ¡ˆå†…å®¹å·²ä¿å­˜"),l.output_file&&(G.value.output_file=l.output_file,l.download_url&&G.value.output_files&&(G.value.output_files.proposal=l.download_url)),l.output_file&&w.value.projectId&&await p(w.value.projectId,l.output_file,"tech_proposal")}catch(l){throw l}finally{me.value=!1}else R.warning("æ²¡æœ‰å¯ä¿å­˜çš„æ–‡ä»¶")},ta=async e=>{try{ve.value=!0,pe.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const a=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),l=await a.json();if(!l.success||!l.html_content)throw new Error(l.error||"è½¬æ¢å¤±è´¥");pe.value=l.html_content,ce.value&&ce.value.setContent(l.html_content)}catch(a){pe.value=`\n      <h1>ğŸ“„ æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${a.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"é¢„è§ˆWord"æˆ–"ä¸‹è½½"æŒ‰é’®æŸ¥çœ‹åŸå§‹æ–‡æ¡£</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,R.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨é¢„è§ˆæˆ–ä¸‹è½½åŠŸèƒ½")}finally{ve.value=!1}};return ge(async()=>{await t();const e=await n({onClear:()=>{w.value.tenderFiles=[],X.value=null,Q.value=null,G.value=null,Z.value=null,o.value&&c()},onDocumentsLoaded:e=>{e.technicalFile&&d(e,"technicalFile"),e.techProposalFile&&(Z.value=e.techProposalFile)}});e&&(w.value.projectId=e)}),(e,t)=>{const s=q,n=Y,d=F,p=k,J=M,H=Ee,Z=E,ge=I,Ce=v,Be=Ne,De=Te,Je=sa,He=A,ta=Ue,na=Re,oa=ze,ia=$e,ra=O,ua=Ae,da=Oe,ca=Ye,pa=Xe;return se(),te("div",ka,[ne(ta,{class:"main-panel",shadow:"never"},{default:oe(()=>{var e,r,u;return[ie("div",xa,[ie("div",Va,[t[25]||(t[25]=ie("label",{class:"row-label"},"é€‰æ‹©é¡¹ç›®",-1)),ne(n,{modelValue:w.value.projectId,"onUpdate:modelValue":t[0]||(t[0]=e=>w.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:Qe,class:"row-select"},{default:oe(()=>[(se(!0),te(_e,null,we(ue(a),e=>(se(),fe(s,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),ie("div",Sa,[t[26]||(t[26]=ie("label",{class:"row-label"},"åº”ç­”å…¬å¸",-1)),ne(d,{value:(null==(e=ue(l))?void 0:e.company_name)||"-",disabled:"",class:"row-input"},null,8,["value"])])]),ie("div",ja,[ie("div",Pa,[t[32]||(t[32]=ie("label",{class:"row-label"},"æŠ€æœ¯æ–‡æ¡£",-1)),ue(o)?(se(),te("div",Fa,[ne(p,{class:"file-chip-icon"},{default:oe(()=>[ne(ue(C))]),_:1}),ie("span",{class:"file-chip-name",title:null==(r=ue(i))?void 0:r.filename},de((null==(u=ue(i))?void 0:u.filename)||"æœªçŸ¥æ–‡ä»¶"),9,Ca),t[28]||(t[28]=ie("span",{class:"file-chip-tag"},"å·²åŠ è½½",-1)),ne(J,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:ue(c)},{default:oe(()=>[...t[27]||(t[27]=[ke("Ã—",-1)])]),_:1},8,["onClick"])])):w.value.tenderFiles.length>0?(se(),te("div",Ma,[ne(p,{class:"file-chip-icon"},{default:oe(()=>[ne(ue(C))]),_:1}),ie("span",{class:"file-chip-name",title:w.value.tenderFiles[0].name},de(w.value.tenderFiles[0].name),9,Ia),t[30]||(t[30]=ie("span",{class:"file-chip-tag"},"å·²ä¸Šä¼ ",-1)),ne(J,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:t[1]||(t[1]=e=>w.value.tenderFiles=[])},{default:oe(()=>[...t[29]||(t[29]=[ke("Ã—",-1)])]),_:1})])):(se(),te("div",Ea,[t[31]||(t[31]=ie("span",{class:"placeholder-text"},"è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",-1)),ne(ue(je),{modelValue:w.value.tenderFiles,"onUpdate:modelValue":t[2]||(t[2]=e=>w.value.tenderFiles=e),"http-request":qe,accept:".pdf,.doc,.docx",limit:1,"max-size":50,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:We},null,8,["modelValue"])]))])]),ie("div",$a,[ie("div",za,[ie("div",Ba,[t[33]||(t[33]=ie("label",{class:"row-label"},"è¾“å‡ºå‰ç¼€",-1)),ne(d,{modelValue:b.value.outputPrefix,"onUpdate:modelValue":t[3]||(t[3]=e=>b.value.outputPrefix=e),placeholder:"æŠ€æœ¯æ–¹æ¡ˆ",class:"row-input"},null,8,["modelValue"])]),ie("div",Da,[t[34]||(t[34]=ie("label",{class:"row-label"},"AIæ¨¡å‹",-1)),ne(n,{modelValue:b.value.aiModel,"onUpdate:modelValue":t[4]||(t[4]=e=>b.value.aiModel=e),class:"row-select"},{default:oe(()=>[ne(s,{label:"GPT5ï¼ˆæœ€å¼ºæ¨ç†ï¼‰",value:"shihuang-gpt5"}),ne(s,{label:"Claude Sonnet 4.5ï¼ˆæ ‡ä¹¦ä¸“ç”¨ï¼‰",value:"shihuang-claude-sonnet-45"}),ne(s,{label:"GPT4o Miniï¼ˆæ¨è-é»˜è®¤ï¼‰",value:"shihuang-gpt4o-mini"})]),_:1},8,["modelValue"])])]),ie("div",Ta,[ie("div",Na,[t[40]||(t[40]=ie("label",{class:"row-label"},"ç”Ÿæˆæ¨¡å¼",-1)),ne(ge,{modelValue:b.value.generationMode,"onUpdate:modelValue":t[5]||(t[5]=e=>b.value.generationMode=e),class:"row-radio-group"},{default:oe(()=>[ne(Z,{value:"Quality-First"},{default:oe(()=>[t[36]||(t[36]=ke(" Quality-Firstæ¨¡å¼ ",-1)),ne(H,{type:"success",size:"small",style:{"margin-left":"4px"}},{default:oe(()=>[...t[35]||(t[35]=[ke("æ¨è",-1)])]),_:1})]),_:1}),ne(Z,{value:"æŒ‰è¯„åˆ†ç‚¹å†™"},{default:oe(()=>[...t[37]||(t[37]=[ke("æŒ‰è¯„åˆ†ç‚¹å†™",-1)])]),_:1}),ne(Z,{value:"æŒ‰æ‹›æ ‡ä¹¦ç›®å½•å†™"},{default:oe(()=>[...t[38]||(t[38]=[ke("æŒ‰æ‹›æ ‡ä¹¦ç›®å½•å†™",-1)])]),_:1}),ne(Z,{value:"ç¼–å†™ä¸“é¡¹ç« èŠ‚"},{default:oe(()=>[...t[39]||(t[39]=[ke("ä½¿ç”¨å›ºå®šæ¨¡æ¿",-1)])]),_:1})]),_:1},8,["modelValue"])]),"ç¼–å†™ä¸“é¡¹ç« èŠ‚"===b.value.generationMode?(se(),te("div",La,[t[41]||(t[41]=ie("label",{class:"row-label"},"é€‰æ‹©æ¨¡æ¿",-1)),ne(n,{modelValue:b.value.templateName,"onUpdate:modelValue":t[6]||(t[6]=e=>b.value.templateName=e),placeholder:"è¯·é€‰æ‹©æ¨¡æ¿",class:"row-select"},{default:oe(()=>[ne(s,{label:"æ”¿åºœé‡‡è´­æ ‡å‡†ï¼ˆ5ç« ï¼‰",value:"æ”¿åºœé‡‡è´­æ ‡å‡†"}),ne(s,{label:"è½¯ä»¶å¼€å‘é¡¹ç›®ï¼ˆ8ç« ï¼‰",value:"è½¯ä»¶å¼€å‘é¡¹ç›®"}),ne(s,{label:"ISOè´¨é‡ä½“ç³»ï¼ˆ6ç« ï¼‰",value:"ISOè´¨é‡ä½“ç³»"})]),_:1},8,["modelValue"])])):(se(),te("div",Ua))]),"Quality-First"===b.value.generationMode?(se(),te("div",Ra,[ie("div",Oa,[ne(p,null,{default:oe(()=>[ne(ue($))]),_:1}),t[42]||(t[42]=ie("span",null,"Quality-First é«˜çº§é…ç½®",-1)),ne(Ce,{content:"8ä¸ªæ™ºèƒ½ä½“åä½œç”Ÿæˆé«˜è´¨é‡æŠ€æœ¯æ–¹æ¡ˆï¼šè¯„åˆ†ç‚¹æå– â†’ äº§å“åŒ¹é… â†’ ç­–ç•¥è§„åˆ’ â†’ ç´ ææ£€ç´¢ â†’ å¤§çº²ç”Ÿæˆ â†’ å†…å®¹æ’°å†™ â†’ ä¸“å®¶è¯„å®¡ â†’ è¿­ä»£ä¼˜åŒ–",placement:"top"},{default:oe(()=>[ne(p,{class:"help-icon"},{default:oe(()=>[ne(ue(z))]),_:1})]),_:1})]),ie("div",Aa,[ie("div",Xa,[t[46]||(t[46]=ie("label",{class:"row-label"},"æµç¨‹æ§åˆ¶",-1)),ne(De,{modelValue:x.value.enabledPhases,"onUpdate:modelValue":t[7]||(t[7]=e=>x.value.enabledPhases=e),class:"row-checkbox-group"},{default:oe(()=>[ne(Be,{label:"product_matching"},{default:oe(()=>[...t[43]||(t[43]=[ke("äº§å“åŒ¹é…",-1)])]),_:1}),ne(Be,{label:"material_retrieval"},{default:oe(()=>[...t[44]||(t[44]=[ke("ç´ ææ£€ç´¢",-1)])]),_:1}),ne(Be,{label:"expert_review"},{default:oe(()=>[...t[45]||(t[45]=[ke("ä¸“å®¶è¯„å®¡",-1)])]),_:1})]),_:1},8,["modelValue"])])]),ie("div",Ya,[ie("div",qa,[t[47]||(t[47]=ie("label",{class:"row-label"},"è´¨é‡ç›®æ ‡",-1)),ie("div",Wa,[ne(Je,{modelValue:x.value.minReviewScore,"onUpdate:modelValue":t[8]||(t[8]=e=>x.value.minReviewScore=e),min:60,max:100,step:5,marks:{60:"60åˆ†",70:"70åˆ†",80:"80åˆ†",90:"90åˆ†",100:"100åˆ†"},"show-input":"","show-input-controls":!1},null,8,["modelValue"])]),t[48]||(t[48]=ie("span",{class:"page-hint",style:{color:"var(--el-color-success)",background:"var(--el-color-success-light-9)"}},"è¯„å®¡ç›®æ ‡åˆ†æ•°",-1))])]),ie("div",Qa,[ie("div",Ka,[t[49]||(t[49]=ie("label",{class:"row-label"},"è¿­ä»£ä¼˜åŒ–",-1)),ne(He,{modelValue:x.value.maxIterations,"onUpdate:modelValue":t[9]||(t[9]=e=>x.value.maxIterations=e),min:0,max:5,step:1,"controls-position":"right"},null,8,["modelValue"]),t[50]||(t[50]=ie("span",{class:"page-hint"},"0è¡¨ç¤ºä¸è¿­ä»£ï¼Œæœ€å¤š5è½®",-1))]),t[51]||(t[51]=ie("div",{class:"row-item"},null,-1))])])):ye("",!0),ie("div",Ja,[ie("div",Ha,[t[52]||(t[52]=ie("label",{class:"row-label"},"é¡µæ•°æ§åˆ¶",-1)),ie("div",Ga,[ne(Je,{modelValue:b.value.pageCount,"onUpdate:modelValue":t[10]||(t[10]=e=>b.value.pageCount=e),min:50,max:400,step:10,marks:{50:"50é¡µ",100:"100é¡µ",200:"200é¡µ",300:"300é¡µ",400:"400é¡µ"},"show-input":"","show-input-controls":!1},null,8,["modelValue"])]),ie("span",Za,"çº¦ "+de(Math.round(700*b.value.pageCount*.8).toLocaleString())+" - "+de(Math.round(700*b.value.pageCount).toLocaleString())+" å­—",1)])]),ie("div",el,[ie("div",al,[t[53]||(t[53]=ie("label",{class:"row-label"},"è¡¨æ ¼æ•°é‡",-1)),ne(n,{modelValue:b.value.contentStyle.tables,"onUpdate:modelValue":t[11]||(t[11]=e=>b.value.contentStyle.tables=e),class:"row-select"},{default:oe(()=>[ne(s,{label:"æ— ",value:"æ— "}),ne(s,{label:"å°‘é‡",value:"å°‘é‡"}),ne(s,{label:"é€‚é‡ï¼ˆæ¨èï¼‰",value:"é€‚é‡"}),ne(s,{label:"å¤§é‡",value:"å¤§é‡"})]),_:1},8,["modelValue"])]),ie("div",ll,[t[54]||(t[54]=ie("label",{class:"row-label"},"æµç¨‹å›¾",-1)),ne(n,{modelValue:b.value.contentStyle.flowcharts,"onUpdate:modelValue":t[12]||(t[12]=e=>b.value.contentStyle.flowcharts=e),class:"row-select"},{default:oe(()=>[ne(s,{label:"æ— ",value:"æ— "}),ne(s,{label:"æµç¨‹å›¾ï¼ˆæ¨èï¼‰",value:"æµç¨‹å›¾"}),ne(s,{label:"SmartArt",value:"SmartArt"})]),_:1},8,["modelValue"])])]),ie("div",tl,[ie("div",sl,[t[55]||(t[55]=ie("label",{class:"row-label"},"å›¾ç‰‡æ•°é‡",-1)),ne(n,{modelValue:b.value.contentStyle.images,"onUpdate:modelValue":t[13]||(t[13]=e=>b.value.contentStyle.images=e),class:"row-select"},{default:oe(()=>[ne(s,{label:"æ— ",value:"æ— "}),ne(s,{label:"å°‘é‡ï¼ˆæ¨èï¼‰",value:"å°‘é‡"}),ne(s,{label:"å¤§é‡",value:"å¤§é‡"})]),_:1},8,["modelValue"])]),ie("div",nl,[t[59]||(t[59]=ie("label",{class:"row-label"},"é™„åŠ è¾“å‡º",-1)),ne(De,{modelValue:b.value.additionalOutputs,"onUpdate:modelValue":t[14]||(t[14]=e=>b.value.additionalOutputs=e),class:"row-checkbox-group"},{default:oe(()=>[ne(Be,{label:"includeAnalysis"},{default:oe(()=>[...t[56]||(t[56]=[ke("éœ€æ±‚åˆ†æ",-1)])]),_:1}),ne(Be,{label:"includeMapping"},{default:oe(()=>[...t[57]||(t[57]=[ke("åŒ¹é…è¡¨",-1)])]),_:1}),ne(Be,{label:"includeSummary"},{default:oe(()=>[...t[58]||(t[58]=[ke("æ€»ç»“æŠ¥å‘Š",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),ie("div",ol,[ne(J,{type:"primary",size:"large",disabled:!Le.value,loading:S.value,onClick:Ke},{default:oe(()=>[ne(p,null,{default:oe(()=>[ne(ue(B))]),_:1}),t[60]||(t[60]=ke(" ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1},8,["disabled","loading"])])]}),_:1}),S.value?(se(),fe(ta,{key:0,class:"generation-output",shadow:"never"},{header:oe(()=>[ie("div",il,[t[61]||(t[61]=ie("span",null,"AIæ­£åœ¨ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ...",-1)),ne(na,{percentage:j.value,status:100===j.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:oe(()=>["Quality-First"===b.value.generationMode?(se(),fe(ue(ba),{key:0,"current-phase":V.value.currentPhase,"phase-progress":V.value.phaseProgress,"scoring-points":V.value.scoringPoints,"product-match":V.value.productMatch,"scoring-strategy":V.value.scoringStrategy,materials:V.value.materials,"review-result":V.value.reviewResult,"show-details":!0,class:"crew-tracker"},null,8,["current-phase","phase-progress","scoring-points","product-match","scoring-strategy","materials","review-result"])):ye("",!0),ne(ue(Se),{content:P.value,"is-streaming":S.value,onStop:Ge},null,8,["content","is-streaming"])]),_:1})):ye("",!0),X.value?(se(),fe(ta,{key:1,class:"analysis-section",shadow:"never"},{header:oe(()=>[ie("div",rl,[t[62]||(t[62]=ie("span",null,"éœ€æ±‚åˆ†æç»“æœ",-1)),ne(J,{size:"small",onClick:t[15]||(t[15]=e=>W.value=!W.value)},{default:oe(()=>[ke(de(W.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:oe(()=>[xe(ie("div",null,[ne(ue(Me),{title:"æ–‡æ¡£æ‘˜è¦",stats:X.value.document_summary||{},"stat-items":[{key:"total_requirements",label:"æ€»éœ€æ±‚æ•°",suffix:"é¡¹"},{key:"mandatory_count",label:"å¼ºåˆ¶éœ€æ±‚",suffix:"é¡¹"},{key:"optional_count",label:"å¯é€‰éœ€æ±‚",suffix:"é¡¹"}]},null,8,["stats"]),ie("div",ul,[t[65]||(t[65]=ie("h4",null,"éœ€æ±‚åˆ†ç±»",-1)),ne(ia,{accordion:""},{default:oe(()=>[(se(!0),te(_e,null,we(X.value.requirement_categories,(e,a)=>(se(),fe(oa,{key:a,name:a},{title:oe(()=>{return[ie("div",dl,[ie("span",null,de(e.category),1),ne(H,{type:(a=e.priority,{"é«˜":"danger",high:"danger","ä¸­":"warning",medium:"warning","ä½":"info",low:"info"}[a]||"info"),size:"small"},{default:oe(()=>[ke(de(e.priority),1)]),_:2},1032,["type"]),ne(H,{type:"info",size:"small"},{default:oe(()=>[ke(de(e.requirements_count||0)+"é¡¹ ",1)]),_:2},1024)])];var a}),default:oe(()=>[ie("div",cl,[e.summary?(se(),te("p",pl,de(e.summary),1)):ye("",!0),e.keywords&&e.keywords.length>0?(se(),te("div",vl,[t[63]||(t[63]=ie("strong",null,"å…³é”®è¯ï¼š",-1)),(se(!0),te(_e,null,we(e.keywords,e=>(se(),fe(H,{key:e,size:"small",style:{"margin-right":"8px"}},{default:oe(()=>[ke(de(e),1)]),_:2},1024))),128))])):ye("",!0),e.key_points&&e.key_points.length>0?(se(),te("div",ml,[t[64]||(t[64]=ie("strong",null,"è¦ç‚¹ï¼š",-1)),ie("ul",null,[(se(!0),te(_e,null,we(e.key_points,(e,a)=>(se(),te("li",{key:a},de(e),1))),128))])])):ye("",!0)])]),_:2},1032,["name"]))),128))]),_:1})])],512),[[Ve,W.value]])]),_:1})):ye("",!0),Q.value?(se(),fe(ta,{key:2,class:"outline-section",shadow:"never"},{header:oe(()=>[ie("div",gl,[t[66]||(t[66]=ie("span",null,"æŠ€æœ¯æ–¹æ¡ˆå¤§çº²",-1)),ne(J,{size:"small",onClick:t[16]||(t[16]=e=>K.value=!K.value)},{default:oe(()=>[ke(de(K.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:oe(()=>[xe(ie("div",null,[ne(ue(Me),{title:"å¤§çº²æ¦‚è§ˆ",stats:Q.value,"stat-items":[{key:"total_chapters",label:"æ€»ç« èŠ‚æ•°",suffix:"ç« "},{key:"estimated_pages",label:"é¢„è®¡é¡µæ•°",suffix:"é¡µ"}],span:12},null,8,["stats"]),ie("div",hl,[t[67]||(t[67]=ie("h4",null,"ç« èŠ‚ç»“æ„",-1)),ne(ra,{data:he.value,props:{label:"title",children:"subsections"},"default-expand-all":"","node-key":"chapter_number"},{default:oe(({node:e,data:a})=>[ie("span",fl,[1===a.level?(se(),fe(p,{key:0},{default:oe(()=>[ne(ue(D))]),_:1})):(se(),fe(p,{key:1},{default:oe(()=>[ne(ue(C))]),_:1})),ie("span",yl,de(a.chapter_number)+" "+de(a.title),1),a.description?(se(),te("span",_l,de(a.description),1)):ye("",!0)])]),_:1},8,["data"])])],512),[[Ve,K.value]])]),_:1})):ye("",!0),re.value?(se(),fe(ta,{key:3,class:"editor-section",shadow:"never"},{default:oe(()=>[ne(ue(Fe),{ref_key:"editorRef",ref:ce,modelValue:pe.value,"onUpdate:modelValue":t[17]||(t[17]=e=>pe.value=e),title:"æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£",height:1e3,loading:ve.value,saving:me.value,onSave:la},null,8,["modelValue","loading","saving"])]),_:1})):ye("",!0),G.value?(se(),fe(ta,{key:4,class:"result-section",shadow:"never"},{header:oe(()=>[ie("div",wl,[t[73]||(t[73]=ie("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),ie("div",bl,[ne(J,{type:"primary",icon:ue(N),onClick:ea},{default:oe(()=>[...t[68]||(t[68]=[ke(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),ne(J,{type:"success",icon:ue(T),onClick:t[18]||(t[18]=e=>Ze("proposal"))},{default:oe(()=>[...t[69]||(t[69]=[ke(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1)])]),_:1},8,["icon"]),ue(u)?(se(),fe(H,{key:1,type:"success",size:"large"},{default:oe(()=>[...t[71]||(t[71]=[ke(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(se(),fe(J,{key:0,type:"info",icon:ue(L),loading:ue(r),onClick:aa},{default:oe(()=>[...t[70]||(t[70]=[ke(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),ne(J,{type:"primary",icon:ue(U),onClick:Ke},{default:oe(()=>[...t[72]||(t[72]=[ke(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:oe(()=>{var e,a,l,s;return[ie("div",kl,[ne(ue(Me),{title:"ç”Ÿæˆç»Ÿè®¡",stats:G.value,"stat-items":[{key:"requirements_count",label:"éœ€æ±‚æ•°é‡",suffix:"é¡¹"},{key:"sections_count",label:"ç« èŠ‚æ•°é‡",suffix:"ç« "},{key:"matches_count",label:"åŒ¹é…æ•°é‡",suffix:"é¡¹"}]},null,8,["stats"]),ie("div",xl,[t[78]||(t[78]=ie("h4",null,"è¾“å‡ºæ–‡ä»¶",-1)),ie("div",Vl,[(null==(e=G.value.output_files)?void 0:e.proposal)?(se(),fe(J,{key:0,type:"success",onClick:t[19]||(t[19]=e=>Ze("proposal"))},{default:oe(()=>[ne(p,null,{default:oe(()=>[ne(ue(T))]),_:1}),t[74]||(t[74]=ke(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1})):ye("",!0),(null==(a=G.value.output_files)?void 0:a.analysis)?(se(),fe(J,{key:1,type:"primary",onClick:t[20]||(t[20]=e=>Ze("analysis"))},{default:oe(()=>[ne(p,null,{default:oe(()=>[ne(ue(T))]),_:1}),t[75]||(t[75]=ke(" ä¸‹è½½éœ€æ±‚åˆ†æ ",-1))]),_:1})):ye("",!0),(null==(l=G.value.output_files)?void 0:l.mapping)?(se(),fe(J,{key:2,type:"info",onClick:t[21]||(t[21]=e=>Ze("mapping"))},{default:oe(()=>[ne(p,null,{default:oe(()=>[ne(ue(T))]),_:1}),t[76]||(t[76]=ke(" ä¸‹è½½åŒ¹é…è¡¨ ",-1))]),_:1})):ye("",!0),(null==(s=G.value.output_files)?void 0:s.summary)?(se(),fe(J,{key:3,type:"warning",onClick:t[22]||(t[22]=e=>Ze("summary"))},{default:oe(()=>[ne(p,null,{default:oe(()=>[ne(ue(T))]),_:1}),t[77]||(t[77]=ke(" ä¸‹è½½ç”ŸæˆæŠ¥å‘Š ",-1))]),_:1})):ye("",!0)])])])]}),_:1})):ye("",!0),w.value.projectId?(se(),fe(ia,{key:5,modelValue:h.value,"onUpdate:modelValue":t[23]||(t[23]=e=>h.value=e),class:"history-collapse"},{default:oe(()=>[ne(oa,{name:"history"},{title:oe(()=>[ie("div",Sl,[ie("span",null,"ğŸ“‚ æœ¬é¡¹ç›®å†å²æ–‡ä»¶ ("+de(m.value.length)+")",1),h.value?(se(),fe(J,{key:0,type:"primary",size:"small",loading:g.value,onClick:be(f,["stop"]),style:{"margin-left":"16px"}},{default:oe(()=>[...t[79]||(t[79]=[ke(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):ye("",!0)])]),default:oe(()=>[ne(ta,{shadow:"never",style:{border:"none"}},{default:oe(()=>[xe((se(),fe(da,{data:m.value,border:"",stripe:"","max-height":"400"},{default:oe(()=>[ne(ua,{type:"index",label:"åºå·",width:"60"}),ne(ua,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:oe(({row:e})=>[ie("div",jl,[ne(p,null,{default:oe(()=>[ne(ue(C))]),_:1}),ie("span",null,de(e.filename),1)])]),_:1}),ne(ua,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:oe(({row:e})=>[ke(de(y(e.size)),1)]),_:1}),ne(ua,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:oe(({row:e})=>[ke(de(_(e.process_time)),1)]),_:1}),ne(ua,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:oe(({row:e})=>[ne(J,{type:"primary",size:"small",onClick:a=>{return l=e,ae.value=l.file_path||l.outputFile,le.value=l.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx",void(ee.value=!0);var l}},{default:oe(()=>[...t[80]||(t[80]=[ke(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),ne(J,{type:"success",size:"small",onClick:a=>(async e=>{try{if(!e.download_url)return void R.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const a=e.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx";Ie(e.download_url,a),R.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(a){R.error(a.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}})(e)},{default:oe(()=>[...t[81]||(t[81]=[ke(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[pa,g.value]]),g.value||0!==m.value.length?ye("",!0):(se(),fe(ca,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"])):ye("",!0),ne(ue(Pe),{modelValue:ee.value,"onUpdate:modelValue":t[24]||(t[24]=e=>ee.value=e),"file-url":ae.value,"file-name":le.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-16691338"]]);export{Pl as default};
