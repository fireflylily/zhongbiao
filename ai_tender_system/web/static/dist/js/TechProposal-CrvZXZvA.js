import{d as We,I as Ge,G as Be,f as Je,q as Qe,o as Ye,i as Ze,Q as Ke,z as Xe,ai as et,m as tt,a as lt,D as ot,aj as at,a4 as nt,a2 as st,Z as rt,p as ut,O as it,ak as dt,F as pt,$ as L,_ as ct,a0 as ft,a1 as vt,k as f}from"./element-plus-IkZgpaz4.js";import{bT as mt,bt as m,bu as ve,bG as _t,bU as P,bV as u,c8 as l,b$ as _,c3 as h,c0 as t,c7 as Z,cC as K,bv as s,bY as r,c5 as g,c1 as me,c6 as E,c9 as _e}from"./vendor-CdA3MjAt.js";/* empty css                                                                          */import{S as yt}from"./SSEStreamViewer-BoeXFWk-.js";import{D as gt}from"./DocumentUploader-BBjdsRhi.js";import{D as ht}from"./DocumentPreview-BbjmwCia.js";import{R as wt}from"./RichTextEditor-BDdJ_J7M.js";import{u as bt,H as kt,S as ie,a as Ft,d as ye}from"./helpers-Btlcunlb.js";import{_ as Ct}from"./index.js";import{t as Et}from"./tender-2TSD_jRl.js";import{u as St}from"./useProjectDocuments-BId2nzjv.js";import"./onnxruntime-DkHy2lK3.js";import"./imageCompressor-D9CndpqW.js";import"./umo-editor-BmhDOXHm.js";import"./mermaid-e-fO57px.js";import"./echarts-Cqw1j_Z-.js";/* empty css                                                                        */import"./project-C4LB9E9r.js";const jt={class:"tech-proposal"},xt={class:"card-header"},It={class:"action-controls"},Pt={class:"card-header"},Tt={class:"card-header"},Vt={class:"requirement-categories"},$t={class:"category-title"},Dt={class:"category-content"},Ot={key:0,class:"category-summary"},Ht={key:1,class:"category-keywords"},Ut={key:2,class:"category-points"},Nt={class:"card-header"},Mt={class:"ç« èŠ‚ç»“æ„"},zt={class:"tree-node"},Rt={class:"node-title"},qt={key:2,class:"node-desc"},At={class:"card-header"},Lt={class:"header-actions"},Wt={class:"result-content"},Gt={class:"output-files"},Bt={class:"file-buttons"},Jt=mt({__name:"TechProposal",setup(Qt){const{projects:ge,selectedProject:N,currentDocuments:de,loadProjects:he,handleProjectChange:we,restoreProjectFromStore:be}=St(),{useHitlFile:O,hitlFileInfo:pe,syncing:ke,synced:Fe,loadFromHITL:X,cancelHitlFile:ee,syncToHitl:te}=bt({onFileLoaded:()=>{c.value.tenderFiles=[]}}),Ce=m([]),Ee=m(!1),Se=async()=>{console.log("å†å²æ–‡ä»¶APIæš‚æœªå®ç°")},je=async o=>{try{if(!o.downloadUrl){f.error("ä¸‹è½½åœ°å€æ— æ•ˆ");return}const e=o.filename||o.downloadUrl.split("/").pop()||"æŠ€æœ¯æ–¹æ¡ˆ.docx";ye(o.downloadUrl,e),f.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(e){console.error("ä¸‹è½½æ–‡ä»¶å¤±è´¥:",e),f.error(e.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}},c=m({projectId:null,tenderFiles:[]}),k=m({outputPrefix:"æŠ€æœ¯æ–¹æ¡ˆ",aiModel:"shihuang-gpt4o-mini",additionalOutputs:["includeAnalysis","includeMapping","includeSummary"]}),M=m(!1),W=m(0),H=m(""),$=m(null),G=m(!0),S=m(null),B=m(!0),v=m(null),T=m(null),J=m(!1),le=m(""),oe=m(""),D=m(!1),ae=m(null),j=m(""),ne=m(!1),se=m(!1),xe=ve(()=>{var o;return(o=S.value)!=null&&o.chapters?S.value.chapters:[]}),ce=ve(()=>c.value.projectId&&(O.value||c.value.tenderFiles.length>0)),Ie=o=>({é«˜:"danger",high:"danger",ä¸­:"warning",medium:"warning",ä½:"info",low:"info"})[o]||"info",Pe=async o=>{var y;const{file:e,onSuccess:i,onError:p}=o;if(!c.value.projectId){const d=new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®");p(d),f.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®");return}if(!((y=N.value)!=null&&y.company_id)){const d=new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸");p(d),f.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸");return}try{const d=new FormData;d.append("file",e),d.append("company_id",N.value.company_id.toString()),d.append("project_id",c.value.projectId.toString());const w=await Et.parseDocumentStructure(d);if(w.success)i(w.data),f.success("æŠ€æœ¯éœ€æ±‚æ–‡æ¡£ä¸Šä¼ æˆåŠŸ");else throw new Error(w.message||"ä¸Šä¼ å¤±è´¥")}catch(d){p(d),f.error(d.message||"æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},Te=()=>{f.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},Ve=async()=>{await we(c.value.projectId,{onClear:()=>{c.value.tenderFiles=[],$.value=null,S.value=null,v.value=null,T.value=null,H.value="",D.value=!1,j.value="",O.value&&ee()},onDocumentsLoaded:o=>{o.technicalFile&&X(o,"technicalFile"),o.techProposalFile&&(T.value=o.techProposalFile,f.success("å·²åŠ è½½å†å²æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶"))}})},fe=async()=>{var o;if(!ce.value){f.warning("è¯·é€‰æ‹©é¡¹ç›®å¹¶ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£");return}M.value=!0,W.value=0,H.value="",$.value=null,v.value=null,D.value=!1,j.value="";try{const e=new FormData;if(O.value&&pe.value)e.append("use_hitl_technical_file","true"),e.append("project_id",c.value.projectId.toString());else if((o=c.value.tenderFiles[0])!=null&&o.raw)e.append("tender_file",c.value.tenderFiles[0].raw);else throw new Error("è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");e.append("outputPrefix",k.value.outputPrefix),e.append("companyId",N.value.company_id.toString()),e.append("projectName",N.value.project_name||""),e.append("projectId",c.value.projectId.toString()),e.append("aiModel",k.value.aiModel),e.append("includeAnalysis",k.value.additionalOutputs.includes("includeAnalysis")?"true":"false"),e.append("includeMapping",k.value.additionalOutputs.includes("includeMapping")?"true":"false"),e.append("includeSummary",k.value.additionalOutputs.includes("includeSummary")?"true":"false"),await $e(e),f.success("æŠ€æœ¯æ–¹æ¡ˆç”Ÿæˆå®Œæˆ")}catch(e){console.error("ç”Ÿæˆå¤±è´¥:",e),f.error(e.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{M.value=!1}},$e=async o=>{var x,b,Q;const p=await fetch("/api/generate-proposal-stream-v2",{method:"POST",body:o});if(!p.ok)throw new Error(`HTTP ${p.status}: ${p.statusText}`);const y=(x=p.body)==null?void 0:x.getReader();if(!y)throw new Error("æ— æ³•è¯»å–å“åº”æµ");const d=new TextDecoder;let w="";const F={};let V="";for(;;){const{done:R,value:re}=await y.read();if(R)break;w+=d.decode(re,{stream:!0});const I=w.split(`
`);w=I.pop()||"";for(const q of I)if(q.startsWith("data: "))try{const a=JSON.parse(q.slice(6));if(a.progress!==void 0&&(W.value=a.progress),a.message&&(H.value+=a.message+`
`),a.stage==="analysis_completed"&&a.analysis_result&&($.value=a.analysis_result),a.stage==="outline_completed"&&a.outline_data&&(S.value=a.outline_data),a.stage==="content_generation")if(a.event==="chapter_start")V=a.chapter_number||"",F[V]="",H.value+=`

## ${a.chapter_number} ${a.chapter_title}

`,D.value||(D.value=!0);else if(a.event==="content_chunk"){const A=a.chapter_number||V;A&&(F[A]=(F[A]||"")+(a.content||""),De(F))}else a.event==="chapter_end"&&(H.value+=`
âœ“ ${a.chapter_title||"ç« èŠ‚"} ç”Ÿæˆå®Œæˆ
`);if(a.stage==="completed"&&a.success&&(v.value=a,T.value={outputFile:a.output_file,downloadUrl:(b=a.output_files)==null?void 0:b.proposal,stats:{requirements_count:a.requirements_count,sections_count:a.sections_count,matches_count:a.matches_count},message:"æŠ€æœ¯æ–¹æ¡ˆå·²ç”Ÿæˆ"},D.value=!0,a.output_file&&c.value.projectId&&await te(c.value.projectId,a.output_file,"tech_proposal")),a.stage==="error")throw H.value+=`
âŒ é”™è¯¯: ${a.error||a.message}
`,new Error(a.error||a.message||"ç”Ÿæˆå¤±è´¥")}catch(a){if(!((Q=a.message)!=null&&Q.includes("JSON")))throw console.error("SSEå¤„ç†é”™è¯¯:",a,"åŸå§‹æ•°æ®:",q),a}}},De=o=>{var e;if((e=S.value)!=null&&e.chapters){let i="";const p=y=>{for(const d of y){const w=d.chapter_number,F=o[w]||"",V=d.level||1;i+=`<h${V}>${w} ${d.title}</h${V}>
`,F&&(i+=`<div>${F.replace(/\n/g,"<br>")}</div>
`),d.subsections&&d.subsections.length>0&&p(d.subsections)}};p(S.value.chapters),j.value=i}else{let i="";const p=Object.entries(o).sort((y,d)=>{const[w]=y,[F]=d;return w.localeCompare(F,"zh-CN")});for(const[y,d]of p)i+=`<h2>${y}</h2>
`,i+=`<div>${d.replace(/\n/g,"<br>")}</div>
`;j.value=i}},Oe=()=>{M.value=!1,f.info("å·²åœæ­¢ç”Ÿæˆ")},z=o=>{var p,y;if(!((y=(p=v.value)==null?void 0:p.output_files)!=null&&y[o])){f.warning("æ–‡ä»¶ä¸å­˜åœ¨");return}const e=v.value.output_files[o],i=e.split("/").pop()||`æŠ€æœ¯æ–¹æ¡ˆ_${o}.docx`;ye(e,i),f.success("ä¸‹è½½å·²å¼€å§‹")},He=()=>{var o,e,i;if(!((e=(o=v.value)==null?void 0:o.output_files)!=null&&e.proposal)){f.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ");return}le.value=v.value.output_files.proposal,oe.value=`æŠ€æœ¯æ–¹æ¡ˆ-${((i=N.value)==null?void 0:i.project_name)||"æ–‡æ¡£"}.docx`,J.value=!0},Ue=o=>{le.value=o.file_path||o.outputFile,oe.value=o.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx",J.value=!0},Ne=async()=>{var o;if(!((o=v.value)!=null&&o.output_file)){f.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶");return}if(!c.value.projectId){f.error("é¡¹ç›®IDæ— æ•ˆ");return}await te(c.value.projectId,v.value.output_file,"tech_proposal")},Me=()=>{T.value=null,v.value=null,$.value=null,S.value=null,D.value=!1,j.value="",f.info("è¯·é…ç½®å‚æ•°åé‡æ–°ç”Ÿæˆ")},ze=async o=>{var e;if(!((e=v.value)!=null&&e.output_file)){f.warning("æ²¡æœ‰å¯ä¿å­˜çš„æ–‡ä»¶");return}try{se.value=!0;const p=await(await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:o,project_id:c.value.projectId,document_type:"tech_proposal",original_file:v.value.output_file})})).json();if(p.success)f.success("æŠ€æœ¯æ–¹æ¡ˆå†…å®¹å·²ä¿å­˜"),p.output_file&&(v.value.output_file=p.output_file,p.download_url&&v.value.output_files&&(v.value.output_files.proposal=p.download_url)),p.output_file&&c.value.projectId&&await te(c.value.projectId,p.output_file,"tech_proposal");else throw new Error(p.error||"ä¿å­˜å¤±è´¥")}catch(i){throw console.error("[TechProposal] ä¿å­˜ç¼–è¾‘å†…å®¹å¤±è´¥:",i),i}finally{se.value=!1}},Re=async o=>{try{ne.value=!0,j.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const i=await(await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:o})})).json();if(i.success&&i.html_content)j.value=i.html_content,ae.value&&ae.value.setContent(i.html_content),console.log("[TechProposal] Wordæ–‡æ¡£å·²åŠ è½½åˆ°ç¼–è¾‘å™¨");else throw new Error(i.error||"è½¬æ¢å¤±è´¥")}catch(e){console.error("[TechProposal] åŠ è½½æ–‡æ¡£åˆ°ç¼–è¾‘å™¨å¤±è´¥:",e),j.value=`
      <h1>ğŸ“„ æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£</h1>
      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">
        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>
        <p>åŸå› ï¼š${e.message}</p>
        <p>æ‚¨å¯ä»¥ï¼š</p>
        <ul>
          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>
          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"é¢„è§ˆWord"æˆ–"ä¸‹è½½"æŒ‰é’®æŸ¥çœ‹åŸå§‹æ–‡æ¡£</li>
        </ul>
      </div>
      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>
    `,f.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨é¢„è§ˆæˆ–ä¸‹è½½åŠŸèƒ½")}finally{ne.value=!1}},qe=async()=>{var o;if(!((o=T.value)!=null&&o.outputFile)){f.error("å†å²æ–‡ä»¶ä¿¡æ¯æ— æ•ˆ");return}try{D.value=!0,await Re(T.value.outputFile),f.success("å†å²æ–‡ä»¶å·²åŠ è½½åˆ°ç¼–è¾‘å™¨"),setTimeout(()=>{var e;(e=document.querySelector(".editor-section"))==null||e.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(e){console.error("[TechProposal] æ‰“å¼€å†å²æ–‡ä»¶å¤±è´¥:",e),f.error("æ‰“å¼€å†å²æ–‡ä»¶å¤±è´¥: "+e.message)}};return _t(async()=>{await he();const o=await be({onClear:()=>{c.value.tenderFiles=[],$.value=null,S.value=null,v.value=null,T.value=null,O.value&&ee()},onDocumentsLoaded:e=>{e.technicalFile&&X(e,"technicalFile"),e.techProposalFile&&(T.value=e.techProposalFile)}});o&&(c.value.projectId=o)}),(o,e)=>{const i=Ye,p=Qe,y=Je,d=Be,w=Ze,F=Ge,V=We,x=Ke,b=lt,Q=Xe,R=tt,re=et,I=ot,q=nt,a=ut,A=rt,Ae=st,Le=it;return u(),P("div",jt,[l(x,{class:"project-section",shadow:"never"},{header:t(()=>[...e[15]||(e[15]=[r("div",{class:"card-header"},[r("span",null,"Step 1: é€‰æ‹©é¡¹ç›®")],-1)])]),default:t(()=>[l(V,{model:c.value,"label-width":"100px"},{default:t(()=>[l(F,{gutter:20},{default:t(()=>[l(d,{span:12},{default:t(()=>[l(y,{label:"é¡¹ç›®"},{default:t(()=>[l(p,{modelValue:c.value.projectId,"onUpdate:modelValue":e[0]||(e[0]=n=>c.value.projectId=n),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:Ve,style:{width:"100%"}},{default:t(()=>[(u(!0),P(Z,null,K(s(ge),n=>(u(),_(i,{key:n.id,label:`${n.project_name} (${n.project_number||"-"})`,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(d,{span:12},{default:t(()=>[l(y,{label:"å…¬å¸"},{default:t(()=>{var n;return[l(w,{value:((n=s(N))==null?void 0:n.company_name)||"-",disabled:""},null,8,["value"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),c.value.projectId?(u(),_(x,{key:0,class:"upload-section",shadow:"never"},{header:t(()=>[r("div",xt,[e[17]||(e[17]=r("span",null,"Step 2: ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",-1)),s(de).technicalFile&&!s(O)?(u(),_(b,{key:0,type:"primary",size:"small",onClick:e[1]||(e[1]=n=>s(X)(s(de),"technicalFile"))},{default:t(()=>[...e[16]||(e[16]=[g(" ä½¿ç”¨æŠ€æœ¯éœ€æ±‚æ–‡ä»¶ ",-1)])]),_:1})):h("",!0)])]),default:t(()=>[s(O)?(u(),_(s(kt),{key:0,"file-info":s(pe),label:"æŠ€æœ¯éœ€æ±‚æ–‡ä»¶:",onCancel:s(ee)},null,8,["file-info","onCancel"])):h("",!0),s(O)?h("",!0):(u(),_(s(gt),{key:1,modelValue:c.value.tenderFiles,"onUpdate:modelValue":e[2]||(e[2]=n=>c.value.tenderFiles=n),"http-request":Pe,accept:".pdf,.doc,.docx",limit:1,"max-size":50,drag:"","tip-text":"ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",onSuccess:Te},null,8,["modelValue"])),l(Q,null,{default:t(()=>[...e[18]||(e[18]=[g("ç”Ÿæˆé€‰é¡¹",-1)])]),_:1}),l(V,{model:k.value,"label-width":"140px",class:"config-form"},{default:t(()=>[l(F,{gutter:20},{default:t(()=>[l(d,{span:12},{default:t(()=>[l(y,{label:"è¾“å‡ºæ–‡ä»¶å‰ç¼€"},{default:t(()=>[l(w,{modelValue:k.value.outputPrefix,"onUpdate:modelValue":e[3]||(e[3]=n=>k.value.outputPrefix=n),placeholder:"æŠ€æœ¯æ–¹æ¡ˆ"},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{span:12},{default:t(()=>[l(y,{label:"AIæ¨¡å‹"},{default:t(()=>[l(p,{modelValue:k.value.aiModel,"onUpdate:modelValue":e[4]||(e[4]=n=>k.value.aiModel=n),style:{width:"100%"}},{default:t(()=>[l(i,{label:"GPT5ï¼ˆæœ€å¼ºæ¨ç†ï¼‰",value:"shihuang-gpt5"}),l(i,{label:"Claude Sonnet 4.5ï¼ˆæ ‡ä¹¦ä¸“ç”¨ï¼‰",value:"shihuang-claude-sonnet-45"}),l(i,{label:"GPT4o Miniï¼ˆæ¨è-é»˜è®¤ï¼‰",value:"shihuang-gpt4o-mini"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(y,{label:"é™„åŠ è¾“å‡º"},{default:t(()=>[l(re,{modelValue:k.value.additionalOutputs,"onUpdate:modelValue":e[5]||(e[5]=n=>k.value.additionalOutputs=n)},{default:t(()=>[l(R,{label:"includeAnalysis"},{default:t(()=>[...e[19]||(e[19]=[g("éœ€æ±‚åˆ†ææŠ¥å‘Š",-1)])]),_:1}),l(R,{label:"includeMapping"},{default:t(()=>[...e[20]||(e[20]=[g("éœ€æ±‚åŒ¹é…è¡¨",-1)])]),_:1}),l(R,{label:"includeSummary"},{default:t(()=>[...e[21]||(e[21]=[g("ç”Ÿæˆæ€»ç»“æŠ¥å‘Š",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),r("div",It,[l(b,{type:"primary",size:"large",disabled:!ce.value,loading:M.value,onClick:fe},{default:t(()=>[l(I,null,{default:t(()=>[l(s(at))]),_:1}),e[22]||(e[22]=g(" ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1},8,["disabled","loading"])])]),_:1})):h("",!0),M.value?(u(),_(x,{key:1,class:"generation-output",shadow:"never"},{header:t(()=>[r("div",Pt,[e[23]||(e[23]=r("span",null,"AIæ­£åœ¨ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ...",-1)),l(q,{percentage:W.value,status:W.value===100?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:t(()=>[l(s(yt),{content:H.value,"is-streaming":M.value,onStop:Oe},null,8,["content","is-streaming"])]),_:1})):h("",!0),$.value?(u(),_(x,{key:2,class:"analysis-section",shadow:"never"},{header:t(()=>[r("div",Tt,[e[24]||(e[24]=r("span",null,"éœ€æ±‚åˆ†æç»“æœ",-1)),l(b,{size:"small",onClick:e[6]||(e[6]=n=>G.value=!G.value)},{default:t(()=>[g(E(G.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:t(()=>[me(r("div",null,[l(s(ie),{title:"æ–‡æ¡£æ‘˜è¦",stats:$.value.document_summary||{},"stat-items":[{key:"total_requirements",label:"æ€»éœ€æ±‚æ•°",suffix:"é¡¹"},{key:"mandatory_count",label:"å¼ºåˆ¶éœ€æ±‚",suffix:"é¡¹"},{key:"optional_count",label:"å¯é€‰éœ€æ±‚",suffix:"é¡¹"}]},null,8,["stats"]),r("div",Vt,[e[27]||(e[27]=r("h4",null,"éœ€æ±‚åˆ†ç±»",-1)),l(Ae,{accordion:""},{default:t(()=>[(u(!0),P(Z,null,K($.value.requirement_categories,(n,C)=>(u(),_(A,{key:C,name:C},{title:t(()=>[r("div",$t,[r("span",null,E(n.category),1),l(a,{type:Ie(n.priority),size:"small"},{default:t(()=>[g(E(n.priority),1)]),_:2},1032,["type"]),l(a,{type:"info",size:"small"},{default:t(()=>[g(E(n.requirements_count||0)+"é¡¹ ",1)]),_:2},1024)])]),default:t(()=>[r("div",Dt,[n.summary?(u(),P("p",Ot,E(n.summary),1)):h("",!0),n.keywords&&n.keywords.length>0?(u(),P("div",Ht,[e[25]||(e[25]=r("strong",null,"å…³é”®è¯ï¼š",-1)),(u(!0),P(Z,null,K(n.keywords,U=>(u(),_(a,{key:U,size:"small",style:{"margin-right":"8px"}},{default:t(()=>[g(E(U),1)]),_:2},1024))),128))])):h("",!0),n.key_points&&n.key_points.length>0?(u(),P("div",Ut,[e[26]||(e[26]=r("strong",null,"è¦ç‚¹ï¼š",-1)),r("ul",null,[(u(!0),P(Z,null,K(n.key_points,(U,Y)=>(u(),P("li",{key:Y},E(U),1))),128))])])):h("",!0)])]),_:2},1032,["name"]))),128))]),_:1})])],512),[[_e,G.value]])]),_:1})):h("",!0),S.value?(u(),_(x,{key:3,class:"outline-section",shadow:"never"},{header:t(()=>[r("div",Nt,[e[28]||(e[28]=r("span",null,"æŠ€æœ¯æ–¹æ¡ˆå¤§çº²",-1)),l(b,{size:"small",onClick:e[7]||(e[7]=n=>B.value=!B.value)},{default:t(()=>[g(E(B.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:t(()=>[me(r("div",null,[l(s(ie),{title:"å¤§çº²æ¦‚è§ˆ",stats:S.value,"stat-items":[{key:"total_chapters",label:"æ€»ç« èŠ‚æ•°",suffix:"ç« "},{key:"estimated_pages",label:"é¢„è®¡é¡µæ•°",suffix:"é¡µ"}],span:12},null,8,["stats"]),r("div",Mt,[e[29]||(e[29]=r("h4",null,"ç« èŠ‚ç»“æ„",-1)),l(Le,{data:xe.value,props:{label:"title",children:"subsections"},"default-expand-all":"","node-key":"chapter_number"},{default:t(({node:n,data:C})=>[r("span",zt,[C.level===1?(u(),_(I,{key:0},{default:t(()=>[l(s(dt))]),_:1})):(u(),_(I,{key:1},{default:t(()=>[l(s(pt))]),_:1})),r("span",Rt,E(C.chapter_number)+" "+E(C.title),1),C.description?(u(),P("span",qt,E(C.description),1)):h("",!0)])]),_:1},8,["data"])])],512),[[_e,B.value]])]),_:1})):h("",!0),D.value?(u(),_(x,{key:4,class:"editor-section",shadow:"never"},{default:t(()=>[l(s(wt),{ref_key:"editorRef",ref:ae,modelValue:j.value,"onUpdate:modelValue":e[8]||(e[8]=n=>j.value=n),title:"æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£",loading:ne.value,saving:se.value,onSave:ze},null,8,["modelValue","loading","saving"])]),_:1})):h("",!0),v.value?(u(),_(x,{key:5,class:"result-section",shadow:"never"},{header:t(()=>[r("div",At,[e[35]||(e[35]=r("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),r("div",Lt,[l(b,{type:"primary",icon:s(ct),onClick:He},{default:t(()=>[...e[30]||(e[30]=[g(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),l(b,{type:"success",icon:s(L),onClick:e[9]||(e[9]=n=>z("proposal"))},{default:t(()=>[...e[31]||(e[31]=[g(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1)])]),_:1},8,["icon"]),s(Fe)?(u(),_(a,{key:1,type:"success",size:"large"},{default:t(()=>[...e[33]||(e[33]=[g(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(u(),_(b,{key:0,type:"info",icon:s(ft),loading:s(ke),onClick:Ne},{default:t(()=>[...e[32]||(e[32]=[g(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),l(b,{type:"primary",icon:s(vt),onClick:fe},{default:t(()=>[...e[34]||(e[34]=[g(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:t(()=>{var n,C,U,Y;return[r("div",Wt,[l(s(ie),{title:"ç”Ÿæˆç»Ÿè®¡",stats:v.value,"stat-items":[{key:"requirements_count",label:"éœ€æ±‚æ•°é‡",suffix:"é¡¹"},{key:"sections_count",label:"ç« èŠ‚æ•°é‡",suffix:"ç« "},{key:"matches_count",label:"åŒ¹é…æ•°é‡",suffix:"é¡¹"}]},null,8,["stats"]),r("div",Gt,[e[40]||(e[40]=r("h4",null,"è¾“å‡ºæ–‡ä»¶",-1)),r("div",Bt,[(n=v.value.output_files)!=null&&n.proposal?(u(),_(b,{key:0,type:"success",onClick:e[10]||(e[10]=ue=>z("proposal"))},{default:t(()=>[l(I,null,{default:t(()=>[l(s(L))]),_:1}),e[36]||(e[36]=g(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1})):h("",!0),(C=v.value.output_files)!=null&&C.analysis?(u(),_(b,{key:1,type:"primary",onClick:e[11]||(e[11]=ue=>z("analysis"))},{default:t(()=>[l(I,null,{default:t(()=>[l(s(L))]),_:1}),e[37]||(e[37]=g(" ä¸‹è½½éœ€æ±‚åˆ†æ ",-1))]),_:1})):h("",!0),(U=v.value.output_files)!=null&&U.mapping?(u(),_(b,{key:2,type:"info",onClick:e[12]||(e[12]=ue=>z("mapping"))},{default:t(()=>[l(I,null,{default:t(()=>[l(s(L))]),_:1}),e[38]||(e[38]=g(" ä¸‹è½½åŒ¹é…è¡¨ ",-1))]),_:1})):h("",!0),(Y=v.value.output_files)!=null&&Y.summary?(u(),_(b,{key:3,type:"warning",onClick:e[13]||(e[13]=ue=>z("summary"))},{default:t(()=>[l(I,null,{default:t(()=>[l(s(L))]),_:1}),e[39]||(e[39]=g(" ä¸‹è½½ç”ŸæˆæŠ¥å‘Š ",-1))]),_:1})):h("",!0)])])])]}),_:1})):h("",!0),c.value.projectId?(u(),_(s(Ft),{key:6,title:"è¯¥é¡¹ç›®çš„æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶","current-file":T.value,"history-files":Ce.value,loading:Ee.value,"show-stats":!1,"show-editor-open":!0,onPreview:Ue,onDownload:je,onRegenerate:Me,onRefresh:Se,onOpenInEditor:qe},null,8,["current-file","history-files","loading"])):h("",!0),l(s(ht),{modelValue:J.value,"onUpdate:modelValue":e[14]||(e[14]=n=>J.value=n),"file-url":le.value,"file-name":oe.value},null,8,["modelValue","file-url","file-name"])])}}}),vl=Ct(Jt,[["__scopeId","data-v-2e95afaf"]]);export{vl as default};
