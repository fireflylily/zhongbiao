import{aL as e,bA as a,bC as t,av as i,b7 as o,aM as s,aO as l,aZ as r,aT as n,aV as c,aR as d,bd as u,be as p,aP as m,aQ as f,aY as g,aS as b,b1 as v,b0 as _,bl as j,a_ as h}from"./index.js";import{I as y,E as w}from"./IconButton-bWqh9_lK.js";/* empty css               */import"./el-select-Bg6tRkm-.js";/* empty css                     *//* empty css                             *//* empty css                    *//* empty css                *//* empty css                *//* empty css                                                                          */import{u as k}from"./project-D1NKtbTH.js";import{t as x}from"./tender-B2_G1CPt.js";import{L as C}from"./Loading-K1G2Hqsj.js";import{E as P}from"./Empty-DCcAshlT.js";import{C as M}from"./Card-DwWoE2PQ.js";import"./DocumentPreview.vue_vue_type_style_index_0_scoped_3e333bda_lang-e-Hg8YbH.js";/* empty css                */import{E as T,a as E}from"./index-CicgRNCL.js";import{E as z}from"./index-DzioAtGx.js";import{E as D,a as Y}from"./index-CIPWUdeB.js";import{E as I}from"./index-BgiK_flY.js";import{E as L}from"./index-vOji2UsA.js";import"./strings-CAibmfqB.js";import"./toNumber-Dx_mmd_0.js";import"./_baseIteratee-0c652xZp.js";import"./index-CbEdxjaG.js";import"./flatMap-BjBe_kjl.js";import"./map-dYop5yfU.js";import"./_baseEach-DkduhBbQ.js";import"./index-Bvqlv6ty.js";import"./raf-CSK_qRxG.js";const A={class:"dashboard-page"},H={class:"quick-actions"},S=["onClick"],q={class:"action-label"},N={class:"pagination-wrapper"},O=h(e({__name:"Dashboard",setup(e){const h=a(),O=k(),{success:Q,error:R,confirm:U}=t(),Z=i(!1),$=i(!1),B=i({totalProjects:0,inProgressProjects:0,wonThisMonth:0,pendingTasks:0}),F=i([]),J=i(1),K=i(10),V=i(0),W=[{name:"start-tender",label:"开始投标",icon:"bi bi-play-circle-fill",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",route:"/tender-management"},{name:"business-response",label:"商务应答",icon:"bi bi-briefcase-fill",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",route:"/business-response"},{name:"point-to-point",label:"点对点应答",icon:"bi bi-arrow-left-right",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",route:"/point-to-point"},{name:"tech-proposal",label:"技术方案",icon:"bi bi-file-code-fill",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",route:"/tech-proposal"},{name:"tender-scoring",label:"标书评分",icon:"bi bi-star-fill",color:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",route:"/tender-scoring"},{name:"knowledge",label:"知识中心",icon:"bi bi-book-fill",color:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",route:"/knowledge/company-library"}];async function X(){$.value=!0;try{const e=await x.getProjects({page:J.value,page_size:K.value});e.success&&e.data&&(Array.isArray(e.data)?(F.value=e.data,V.value=e.data.length):e.data.items&&(F.value=e.data.items,V.value=e.data.total||0))}catch(e){R("加载项目列表失败: "+e.message)}finally{$.value=!1}}async function G(){await X(),Q("刷新成功")}function ee(){h.push("/tender-management")}function ae(e){O.setCurrentProject(e),h.push({name:"TenderManagementDetail",params:{id:e.id}})}function te(e){K.value=e,J.value=1,X()}function ie(e){J.value=e,X()}function oe(e){return{pending:"待处理",in_progress:"进行中",completed:"已完成",won:"已中标",lost:"未中标",archived:"已归档"}[e]||e}return o(()=>{!async function(){Z.value=!0;try{setTimeout(()=>{B.value={totalProjects:156,inProgressProjects:23,wonThisMonth:8,pendingTasks:12},Z.value=!1},500)}catch(e){R("加载统计数据失败: "+e.message),Z.value=!1}}(),X()}),(e,a)=>{const t=z,i=T,o=E,k=v,x=I,se=Y,le=L,re=D,ne=w;return l(),s("div",A,[r(o,{gutter:16,class:"kpi-cards"},{default:n(()=>[r(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[r(c(M),{shadow:"hover",loading:Z.value},{default:n(()=>[r(t,{title:"总项目数",value:B.value.totalProjects},{prefix:n(()=>[...a[2]||(a[2]=[d("i",{class:"bi bi-folder-fill statistic-icon",style:{color:"#409eff"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),r(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[r(c(M),{shadow:"hover",loading:Z.value},{default:n(()=>[r(t,{title:"进行中项目",value:B.value.inProgressProjects},{prefix:n(()=>[...a[3]||(a[3]=[d("i",{class:"bi bi-clock-fill statistic-icon",style:{color:"#e6a23c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),r(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[r(c(M),{shadow:"hover",loading:Z.value},{default:n(()=>[r(t,{title:"本月中标",value:B.value.wonThisMonth},{prefix:n(()=>[...a[4]||(a[4]=[d("i",{class:"bi bi-trophy-fill statistic-icon",style:{color:"#67c23a"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),r(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[r(c(M),{shadow:"hover",loading:Z.value},{default:n(()=>[r(t,{title:"待处理任务",value:B.value.pendingTasks},{prefix:n(()=>[...a[5]||(a[5]=[d("i",{class:"bi bi-list-task statistic-icon",style:{color:"#f56c6c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1})]),_:1}),r(c(M),{title:"快捷入口",class:"quick-actions-card"},{default:n(()=>[d("div",H,[(l(),s(u,null,p(W,e=>d("div",{key:e.name,class:"action-item",onClick:a=>function(e){h.push(e.route)}(e)},[d("div",{class:"action-icon",style:m({background:e.color})},[d("i",{class:f(e.icon)},null,2)],4),d("div",q,g(e.label),1)],8,S)),64))])]),_:1}),r(c(M),{title:"进行中的项目",class:"projects-card"},{actions:n(()=>[r(c(y),{icon:"bi-arrow-clockwise",tooltip:"刷新",onClick:G})]),default:n(()=>[$.value?(l(),b(c(C),{key:0,visible:!0,fullscreen:!1,text:"加载项目列表..."})):0===F.value.length?(l(),b(c(P),{key:1,type:"no-data",description:"暂无进行中的项目"},{action:n(()=>[r(k,{type:"primary",onClick:ee},{default:n(()=>[...a[6]||(a[6]=[_("创建第一个项目",-1)])]),_:1})]),_:1})):(l(),s(u,{key:2},[r(re,{data:F.value,stripe:"",style:{width:"100%"}},{default:n(()=>[r(se,{prop:"project_name",label:"项目名称","min-width":"200"},{default:n(({row:e})=>[r(x,{type:"primary",onClick:a=>ae(e)},{default:n(()=>[_(g(e.project_name),1)]),_:2},1032,["onClick"])]),_:1}),r(se,{prop:"project_number",label:"项目编号",width:"150"}),r(se,{prop:"status",label:"状态",width:"120"},{default:n(({row:e})=>{return[r(le,{type:(a=e.status,{pending:"info",in_progress:"warning",completed:"success",won:"success",lost:"danger",archived:"info"}[a]||"info")},{default:n(()=>[_(g(oe(e.status)),1)]),_:2},1032,["type"])];var a}),_:1}),r(se,{prop:"company_name",label:"关联企业",width:"200"}),r(se,{prop:"created_at",label:"创建时间",width:"180"},{default:n(({row:e})=>{return[_(g((a=e.created_at,a?j(a).format("YYYY-MM-DD HH:mm"):"-")),1)];var a}),_:1}),r(se,{label:"操作",width:"200",fixed:"right"},{default:n(({row:e})=>[r(c(y),{icon:"bi-eye",type:"primary",tooltip:"查看详情",onClick:a=>ae(e)},null,8,["onClick"]),r(c(y),{icon:"bi-play-circle",type:"success",tooltip:"继续处理",onClick:a=>{return t=e,O.setCurrentProject(t),void h.push({name:"TenderManagementDetail",params:{id:t.id}});var t}},null,8,["onClick"]),r(c(y),{icon:"bi-archive",type:"warning",tooltip:"归档",onClick:a=>async function(e){if(await U(`确定要归档项目"${e.project_name}"吗?`,"归档项目","归档后项目将不再显示在进行中列表"))try{await O.updateProject(e.id,{status:"archived"}),Q("项目已归档"),await X()}catch(a){R("归档失败: "+a.message)}}(e)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),d("div",N,[r(ne,{"current-page":J.value,"onUpdate:currentPage":a[0]||(a[0]=e=>J.value=e),"page-size":K.value,"onUpdate:pageSize":a[1]||(a[1]=e=>K.value=e),total:V.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:te,onCurrentChange:ie},null,8,["current-page","page-size","total"])])],64))]),_:1})])}}}),[["__scopeId","data-v-74c5835e"]]);export{O as default};
