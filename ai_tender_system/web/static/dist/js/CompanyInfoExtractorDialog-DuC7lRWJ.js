import{aA as e,T as a,a6 as l,aX as s,_ as t,c8 as o,A as i,ax as n,u as r,c9 as u,ca as c,bb as d,cb as p,e as v,a0 as m,bC as f,b7 as _,cc as y,bt as g,ad as b,J as h,cd as k,ce as w,aL as x,aN as S,w as z,cf as C,cg as I,l as V,a5 as $,ch as E,ci as j,cj as O,ck as N,aE as A,U as T,a8 as P,b9 as L,M as B,P as R,N as U,O as q,aQ as Y,d as M,h as D,p as F,aU as X,q as Q}from"./index.js";/* empty css               *//* empty css                *//* empty css                *//* empty css                    *//* empty css                                                        */import{u as W,E as H,a as K}from"./el-tab-pane-Dwr03H4K.js";/* empty css                             *//* empty css                     */import{E as G,a as Z}from"./el-select-DZeK41OH.js";/* empty css                                                                          */import{by as J,am as ee,bV as ae,an as le,cn as se,ao as te,c9 as oe,ap as ie,aX as ne,aq as re,ar as ue,as as ce,ax as de,aS as pe,aw as ve,aT as me,aB as fe,ay as _e,av as ye,au as ge,aP as be,aV as he,az as ke,aD as we,aC as xe,aU as Se,aF as ze,bK as Ce,bH as Ie,aQ as Ve,bL as $e,bY as Ee,ci as je,bC as Oe,c4 as Ne,bR as Ae,bQ as Te,aY as Pe,at as Le,aW as Be,aA as Re}from"./editor-CkQC1Uq_.js";import{c as Ue}from"./company-CHa0NuIL.js";import{E as qe}from"./index-ZlCuKr4C.js";import{E as Ye}from"./index-DzllSHb7.js";import{E as Me}from"./index-DO7-lxyV.js";import{E as De,a as Fe}from"./index-CwhopI9-.js";import{E as Xe}from"./index-CwbKUXgF.js";import{E as Qe}from"./index-Jdk3-L3D.js";import{E as We}from"./index-CPjPqG6g.js";import{d as He}from"./index-C1LY3n9p.js";import{E as Ke}from"./index-lVhqCxeU.js";function Ge(e,a,l){var s=!0,t=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return J(l)&&(s="leading"in l?!!l.leading:s,t="trailing"in l?!!l.trailing:t),He(e,a,{leading:s,maxWait:a,trailing:t})}const Ze=a({urlList:{type:l(Array),default:()=>s([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:l(String)}}),Je={close:()=>!0,error:e=>e instanceof Event,switch:a=>e(a),rotate:a=>e(a)},ea=ee({name:"ElImageViewer"});const aa=z(t(ee({...ea,props:Ze,emits:Je,setup(e,{expose:a,emit:l}){var s;const t=e,z={CONTAIN:{name:"contain",icon:ae(i)},ORIGINAL:{name:"original",icon:ae(o)}};let C,I="";const{t:V}=n(),$=r("image-viewer"),{nextZIndex:E}=u(),j=le(),O=le(),N=se(),A=te(()=>{const{scale:e,minScale:a,maxScale:l}=t;return c(e,a,l)}),T=le(!0),P=le(!1),L=le(t.initialIndex),B=oe(z.CONTAIN),R=le({scale:A.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),U=le(null!=(s=t.zIndex)?s:E()),q=te(()=>{const{urlList:e}=t;return e.length<=1}),Y=te(()=>0===L.value),M=te(()=>L.value===t.urlList.length-1),D=te(()=>t.urlList[L.value]),F=te(()=>[$.e("btn"),$.e("prev"),$.is("disabled",!t.infinite&&Y.value)]),X=te(()=>[$.e("btn"),$.e("next"),$.is("disabled",!t.infinite&&M.value)]),Q=te(()=>{const{scale:e,deg:a,offsetX:l,offsetY:s,enableTransition:t}=R.value;let o=l/e,i=s/e;const n=a*Math.PI/180,r=Math.cos(n),u=Math.sin(n);o=o*r+i*u,i=i*r-l/e*u;const c={transform:`scale(${e}) rotate(${a}deg) translate(${o}px, ${i}px)`,transition:t?"transform .3s":""};return B.value.name===z.CONTAIN.name&&(c.maxWidth=c.maxHeight="100%"),c}),W=te(()=>`${L.value+1} / ${t.urlList.length}`);function H(){N.stop(),null==C||C(),document.body.style.overflow=I,l("close")}function K(){T.value=!1}function G(e){P.value=!0,T.value=!1,l("error",e),e.target.alt=V("el.image.error")}function Z(e){if(T.value||0!==e.button||!j.value)return;R.value.enableTransition=!1;const{offsetX:a,offsetY:l}=R.value,s=e.pageX,t=e.pageY,o=Ge(e=>{R.value={...R.value,offsetX:a+e.pageX-s,offsetY:l+e.pageY-t}}),i=d(document,"mousemove",o);d(document,"mouseup",()=>{i()}),e.preventDefault()}function J(){R.value={scale:A.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(T.value||P.value)return;const e=w(z),a=Object.values(z),l=B.value.name,s=(a.findIndex(e=>e.name===l)+1)%e.length;B.value=z[e[s]],J()}function Ce(e){P.value=!1;const a=t.urlList.length;L.value=(e+a)%a}function Ie(){Y.value&&!t.infinite||Ce(L.value-1)}function Ve(){M.value&&!t.infinite||Ce(L.value+1)}function $e(e,a={}){if(T.value||P.value)return;const{minScale:s,maxScale:o}=t,{zoomRate:i,rotateDeg:n,enableTransition:r}={zoomRate:t.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":R.value.scale>s&&(R.value.scale=Number.parseFloat((R.value.scale/i).toFixed(3)));break;case"zoomIn":R.value.scale<o&&(R.value.scale=Number.parseFloat((R.value.scale*i).toFixed(3)));break;case"clockwise":R.value.deg+=n,l("rotate",R.value.deg);break;case"anticlockwise":R.value.deg-=n,l("rotate",R.value.deg)}R.value.enableTransition=r}function Ee(e){var a;"pointer"===(null==(a=e.detail)?void 0:a.focusReason)&&e.preventDefault()}function je(){t.closeOnPressEscape&&H()}function Oe(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}return ie(()=>A.value,e=>{R.value.scale=e}),ie(D,()=>{ze(()=>{const e=O.value;(null==e?void 0:e.complete)||(T.value=!0)})}),ie(L,e=>{J(),l("switch",e)}),ne(()=>{!function(){const e=Ge(e=>{switch(x(e)){case S.esc:t.closeOnPressEscape&&H();break;case S.space:ee();break;case S.left:Ie();break;case S.up:$e("zoomIn");break;case S.right:Ve();break;case S.down:$e("zoomOut")}}),a=Ge(e=>{$e((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:t.zoomRate,enableTransition:!1})});N.run(()=>{d(document,"keydown",e),d(document,"wheel",a)})}(),C=d("wheel",Oe,{passive:!1}),I=document.body.style.overflow,document.body.style.overflow="hidden"}),a({setActiveItem:Ce}),(e,a)=>(ue(),re(_e(k),{to:"body",disabled:!e.teleported},{default:ce(()=>[de(pe,{name:"viewer-fade",appear:""},{default:ce(()=>[ve("div",{ref_key:"wrapper",ref:j,tabindex:-1,class:fe(_e($).e("wrapper")),style:me({zIndex:U.value})},[de(_e(p),{loop:"",trapped:"","focus-trap-el":j.value,"focus-start-el":"container",onFocusoutPrevented:Ee,onReleaseRequested:je},{default:ce(()=>[ve("div",{class:fe(_e($).e("mask")),onClick:he(a=>e.hideOnClickModal&&H(),["self"])},null,10,["onClick"]),ye(" CLOSE "),ve("span",{class:fe([_e($).e("btn"),_e($).e("close")]),onClick:H},[de(_e(v),null,{default:ce(()=>[de(_e(m))]),_:1})],2),ye(" ARROW "),_e(q)?ye("v-if",!0):(ue(),ge(ke,{key:0},[ve("span",{class:fe(_e(F)),onClick:Ie},[de(_e(v),null,{default:ce(()=>[de(_e(f))]),_:1})],2),ve("span",{class:fe(_e(X)),onClick:Ve},[de(_e(v),null,{default:ce(()=>[de(_e(_))]),_:1})],2)],64)),e.$slots.progress||e.showProgress?(ue(),ge("div",{key:1,class:fe([_e($).e("btn"),_e($).e("progress")])},[be(e.$slots,"progress",{activeIndex:L.value,total:e.urlList.length},()=>[we(xe(_e(W)),1)])],2)):ye("v-if",!0),ye(" ACTIONS "),ve("div",{class:fe([_e($).e("btn"),_e($).e("actions")])},[ve("div",{class:fe(_e($).e("actions__inner"))},[be(e.$slots,"toolbar",{actions:$e,prev:Ie,next:Ve,reset:ee,activeIndex:L.value,setActiveItem:Ce},()=>[de(_e(v),{onClick:e=>$e("zoomOut")},{default:ce(()=>[de(_e(y))]),_:1},8,["onClick"]),de(_e(v),{onClick:e=>$e("zoomIn")},{default:ce(()=>[de(_e(g))]),_:1},8,["onClick"]),ve("i",{class:fe(_e($).e("actions__divider"))},null,2),de(_e(v),{onClick:ee},{default:ce(()=>[(ue(),re(Se(_e(B).icon)))]),_:1}),ve("i",{class:fe(_e($).e("actions__divider"))},null,2),de(_e(v),{onClick:e=>$e("anticlockwise")},{default:ce(()=>[de(_e(b))]),_:1},8,["onClick"]),de(_e(v),{onClick:e=>$e("clockwise")},{default:ce(()=>[de(_e(h))]),_:1},8,["onClick"])])],2)],2),ye(" CANVAS "),ve("div",{class:fe(_e($).e("canvas"))},[P.value&&e.$slots["viewer-error"]?be(e.$slots,"viewer-error",{key:0,activeIndex:L.value,src:_e(D)}):(ue(),ge("img",{ref_key:"imgRef",ref:O,key:_e(D),src:_e(D),style:me(_e(Q)),class:fe(_e($).e("img")),crossorigin:e.crossorigin,onLoad:K,onError:G,onMousedown:Z},null,46,["src","crossorigin"]))],2),be(e.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}}),[["__file","image-viewer.vue"]])),la=a({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:l([String,Object])},previewSrcList:{type:l(Array),default:()=>s([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:l(String)}}),sa={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:a=>e(a),close:()=>!0,show:()=>!0},ta=ee({name:"ElImage",inheritAttrs:!1});const oa=z(t(ee({...ta,props:la,emits:sa,setup(e,{expose:a,emit:l}){const s=e,{t:t}=n(),o=r("image"),i=Ce(),u=te(()=>C(Object.entries(i).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),c=I({excludeListeners:!0,excludeKeys:te(()=>Object.keys(u.value))}),d=le(),p=le(!1),v=le(!0),m=le(!1),f=le(),_=le(),y=V&&"loading"in HTMLImageElement.prototype;let g;const b=te(()=>[o.e("inner"),k.value&&o.e("preview"),v.value&&o.is("loading")]),h=te(()=>{const{fit:e}=s;return V&&e?{objectFit:e}:{}}),k=te(()=>{const{previewSrcList:e}=s;return Ie(e)&&e.length>0}),w=te(()=>{const{previewSrcList:e,initialIndex:a}=s;let l=a;return a>e.length-1&&(l=0),l}),x=te(()=>"eager"!==s.loading&&(!y&&"lazy"===s.loading||s.lazy)),S=()=>{V&&(v.value=!0,p.value=!1,d.value=s.src)};function z(e){v.value=!1,p.value=!1,l("load",e)}function A(e){v.value=!1,p.value=!0,l("error",e)}const T=N(function(e){e&&(S(),L())},200,!0);async function P(){var e;if(!V)return;await ze();const{scrollContainer:a}=s;if($(a))_.value=a;else if(Oe(a)&&""!==a)_.value=null!=(e=document.querySelector(a))?e:void 0;else if(f.value){const e=E(f.value);_.value=j(e)?void 0:e}const{stop:l}=O(f,([e])=>{T(e.isIntersecting)},{root:_});g=l}function L(){V&&T&&(null==g||g(),_.value=void 0,g=void 0)}function B(){k.value&&(m.value=!0,l("show"))}function R(){m.value=!1,l("close")}function U(e){l("switch",e)}return ie(()=>s.src,()=>{x.value?(v.value=!0,p.value=!1,L(),P()):S()}),ne(()=>{x.value?P():S()}),a({showPreview:B}),(e,a)=>(ue(),ge("div",Ve({ref_key:"container",ref:f},_e(u),{class:[_e(o).b(),e.$attrs.class]}),[p.value?be(e.$slots,"error",{key:0},()=>[ve("div",{class:fe(_e(o).e("error"))},xe(_e(t)("el.image.error")),3)]):(ue(),ge(ke,{key:1},[void 0!==d.value?(ue(),ge("img",Ve({key:0},_e(c),{src:d.value,loading:e.loading,style:_e(h),class:_e(b),crossorigin:e.crossorigin,onClick:B,onLoad:z,onError:A}),null,16,["src","loading","crossorigin"])):ye("v-if",!0),v.value?(ue(),ge("div",{key:1,class:fe(_e(o).e("wrapper"))},[be(e.$slots,"placeholder",{},()=>[ve("div",{class:fe(_e(o).e("placeholder"))},null,2)])],2)):ye("v-if",!0)],64)),_e(k)?(ue(),ge(ke,{key:2},[m.value?(ue(),re(_e(aa),{key:0,"z-index":e.zIndex,"initial-index":_e(w),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"show-progress":e.showProgress,"url-list":e.previewSrcList,scale:e.scale,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:R,onSwitch:U},$e({toolbar:ce(a=>[be(e.$slots,"toolbar",Ee(je(a)))]),default:ce(()=>[e.$slots.viewer?(ue(),ge("div",{key:0},[be(e.$slots,"viewer")])):ye("v-if",!0)]),_:2},[e.$slots.progress?{name:"progress",fn:ce(a=>[be(e.$slots,"progress",Ee(je(a)))])}:void 0,e.$slots["viewer-error"]?{name:"viewer-error",fn:ce(a=>[be(e.$slots,"viewer-error",Ee(je(a)))])}:void 0]),1032,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","scale","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):ye("v-if",!0)],64)):ye("v-if",!0)],16))}}),[["__file","image.vue"]])),ia=a({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),na={[A]:(a,l)=>[a,l].every(e)},ra="ElSteps",ua=ee({name:"ElSteps"});var ca=t(ee({...ua,props:ia,emits:na,setup(e,{emit:a}){const l=e,s=r("steps"),{children:t,addChild:o,removeChild:i,ChildrenSorter:n}=W(Ne(),"ElStep");return ie(t,()=>{t.value.forEach((e,a)=>{e.setIndex(a)})}),Ae(ra,{props:l,steps:t,addStep:o,removeStep:i}),ie(()=>l.active,(e,l)=>{a(A,e,l)}),(e,a)=>(ue(),ge("div",{class:fe([_e(s).b(),_e(s).m(e.simple?"simple":e.direction)])},[be(e.$slots,"default"),de(_e(n))],2))}}),[["__file","steps.vue"]]);const da=a({title:{type:String,default:""},icon:{type:T},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),pa=ee({name:"ElStep"});var va=t(ee({...pa,props:da,setup(a){const l=a,s=r("step"),t=le(-1),o=le({}),i=le(""),n=Te(ra),u=Ne();ne(()=>{ie([()=>n.props.active,()=>n.props.processStatus,()=>n.props.finishStatus],([e])=>{w(e)},{immediate:!0})});const c=te(()=>l.status||i.value),d=te(()=>{const e=n.steps.value[t.value-1];return e?e.internalStatus.value:"wait"}),p=te(()=>n.props.alignCenter),f=te(()=>"vertical"===n.props.direction),_=te(()=>n.props.simple),y=te(()=>n.steps.value.length),g=te(()=>{var e;return(null==(e=n.steps.value[y.value-1])?void 0:e.uid)===u.uid}),b=te(()=>_.value?"":n.props.space),h=te(()=>[s.b(),s.is(_.value?"simple":n.props.direction),s.is("flex",g.value&&!b.value&&!p.value),s.is("center",p.value&&!f.value&&!_.value)]),k=te(()=>{const a={flexBasis:e(b.value)?`${b.value}px`:b.value?b.value:100/(y.value-(p.value?0:1))+"%"};return f.value||g.value&&(a.maxWidth=100/y.value+"%"),a}),w=e=>{e>t.value?i.value=n.props.finishStatus:e===t.value&&"error"!==d.value?i.value=n.props.processStatus:i.value="wait";const a=n.steps.value[t.value-1];a&&a.calcProgress(i.value)},x={uid:u.uid,getVnode:()=>u.vnode,currentStatus:c,internalStatus:i,setIndex:e=>{t.value=e},calcProgress:e=>{const a="wait"===e,l={transitionDelay:`${a?"-":""}${150*t.value}ms`},s=e===n.props.processStatus||a?0:100;l.borderWidth=s&&!_.value?"1px":0,l["vertical"===n.props.direction?"height":"width"]=`${s}%`,o.value=l}};return n.addStep(x),Pe(()=>{n.removeStep(x)}),(e,a)=>(ue(),ge("div",{style:me(_e(k)),class:fe(_e(h))},[ye(" icon & line "),ve("div",{class:fe([_e(s).e("head"),_e(s).is(_e(c))])},[_e(_)?ye("v-if",!0):(ue(),ge("div",{key:0,class:fe(_e(s).e("line"))},[ve("i",{class:fe(_e(s).e("line-inner")),style:me(o.value)},null,6)],2)),ve("div",{class:fe([_e(s).e("icon"),_e(s).is(e.icon||e.$slots.icon?"icon":"text")])},[be(e.$slots,"icon",{},()=>[e.icon?(ue(),re(_e(v),{key:0,class:fe(_e(s).e("icon-inner"))},{default:ce(()=>[(ue(),re(Se(e.icon)))]),_:1},8,["class"])):"success"===_e(c)?(ue(),re(_e(v),{key:1,class:fe([_e(s).e("icon-inner"),_e(s).is("status")])},{default:ce(()=>[de(_e(P))]),_:1},8,["class"])):"error"===_e(c)?(ue(),re(_e(v),{key:2,class:fe([_e(s).e("icon-inner"),_e(s).is("status")])},{default:ce(()=>[de(_e(m))]),_:1},8,["class"])):_e(_)?ye("v-if",!0):(ue(),ge("div",{key:3,class:fe(_e(s).e("icon-inner"))},xe(t.value+1),3))])],2)],2),ye(" title & description "),ve("div",{class:fe(_e(s).e("main"))},[ve("div",{class:fe([_e(s).e("title"),_e(s).is(_e(c))])},[be(e.$slots,"title",{},()=>[we(xe(e.title),1)])],2),_e(_)?(ue(),ge("div",{key:0,class:fe(_e(s).e("arrow"))},null,2)):(ue(),ge("div",{key:1,class:fe([_e(s).e("description"),_e(s).is(_e(c))])},[be(e.$slots,"description",{},()=>[we(xe(e.description),1)])],2))],2)],6))}}),[["__file","item.vue"]]);const ma=z(ca,{Step:va}),fa=L(va),_a={class:"step-content"},ya={class:"model-select"},ga={class:"step-content"},ba={class:"extraction-progress"},ha={class:"progress-text"},ka={class:"step-content preview-content"},wa={key:0,class:"no-images"},xa=["onClick"],Sa={class:"image-error"},za={class:"image-info"},Ca={class:"extraction-stats"},Ia={class:"dialog-footer"},Va=Q(ee({__name:"CompanyInfoExtractorDialog",props:{modelValue:{type:Boolean},companyId:{}},emits:["update:modelValue","success"],setup(e,{emit:a}){const l=e,s=a,t=te({get:()=>l.modelValue,set:e=>s("update:modelValue",e)}),o=te(()=>!l.companyId),i=te(()=>o.value?"从标书创建公司":"从标书提取信息"),n=le(0),r=le([]),u=le(null),c=le("gpt-4o-mini"),d=le(!1),p=le(!1),f=le(0),_=le(""),y=le(""),g=le([]),b=le("basic"),h=le({company_info:{},authorized_person:{},financial_info:{},qualification_images:[]}),k=[{key:"company_name",label:"公司名称"},{key:"social_credit_code",label:"统一社会信用代码",placeholder:"18位代码"},{key:"legal_representative",label:"法定代表人"},{key:"legal_representative_position",label:"法定代表人职务"},{key:"registered_capital",label:"注册资本",placeholder:"如：1000万元"},{key:"establish_date",label:"成立日期",placeholder:"YYYY-MM-DD"},{key:"company_type",label:"公司类型"},{key:"registered_address",label:"注册地址"},{key:"office_address",label:"办公地址"},{key:"fixed_phone",label:"联系电话"},{key:"email",label:"电子邮箱"},{key:"employee_count",label:"员工人数"}],w=[{key:"name",label:"被授权人姓名"},{key:"id_number",label:"身份证号",placeholder:"18位身份证号"},{key:"gender",label:"性别",placeholder:"男/女"},{key:"position",label:"职位"},{key:"title",label:"职称"},{key:"phone",label:"联系电话"}],x=[{key:"business_license",name:"营业执照"},{key:"legal_id_front",name:"法人身份证正面"},{key:"legal_id_back",name:"法人身份证反面"},{key:"auth_id_front",name:"被授权人身份证正面"},{key:"auth_id_back",name:"被授权人身份证反面"},{key:"iso9001",name:"ISO9001认证"},{key:"iso14001",name:"ISO14001认证"},{key:"iso20000",name:"ISO20000认证"},{key:"iso27001",name:"ISO27001认证"},{key:"cmmi",name:"CMMI认证"},{key:"itss",name:"ITSS认证"},{key:"value_added_telecom_permit",name:"增值电信许可证"},{key:"level_protection",name:"等级保护认证"},{key:"software_copyright",name:"软件著作权"},{key:"patent_certificate",name:"专利证书"},{key:"high_tech_enterprise",name:"高新技术企业证书"},{key:"audit_report",name:"审计报告"},{key:"bank_account_permit",name:"开户许可证"},{key:"unknown",name:"其他/未识别"}],{success:S,error:z}=B(),C=te(()=>Object.values(h.value.company_info).filter(e=>e).length),I=te(()=>h.value.qualification_images.filter(e=>e.confirmed).length),V=e=>{u.value=e.raw,r.value=[e]},$=()=>{u.value=null,r.value=[]},E=e=>`data:${e.content_type};base64,${e.image_data}`,j=()=>{n.value>0&&(n.value=0,f.value=0,g.value=[],_.value="")},O=async()=>{var e;if(u.value){d.value=!0,n.value=1,f.value=0,g.value=[],_.value="",y.value="正在上传文档...";try{N("正在上传文档...","loading"),f.value=10;const a=new FormData;a.append("file",u.value),a.append("model",c.value),A("success"),N("文档上传成功","success"),f.value=30,N("正在解析文档结构...","loading"),y.value="正在AI提取...",f.value=40;const l=await Ue.extractFromTender(a);if(A("success"),f.value=80,!l.success)throw new Error(l.error||"提取失败");N("公司信息提取完成","success"),N(`识别到 ${(null==(e=l.qualification_images)?void 0:e.length)||0} 张资质图片`,"success"),f.value=100,_.value="success",y.value="提取完成!",h.value={company_info:l.company_info||{},authorized_person:l.authorized_person||{},financial_info:l.financial_info||{},qualification_images:(l.qualification_images||[]).map(e=>({...e,confirmed:e.confidence>=.6}))},setTimeout(()=>{n.value=2},800)}catch(a){_.value="exception",y.value="提取失败",N(`错误: ${a.message}`,"error"),z("提取失败",a.message)}finally{d.value=!1}}},N=(e,a)=>{g.value.push({message:e,status:a})},A=e=>{const a=g.value[g.value.length-1];a&&"loading"===a.status&&(a.status=e)},T=async()=>{p.value=!0;try{const a={company_name:h.value.company_info.company_name,social_credit_code:h.value.company_info.social_credit_code,legal_representative:h.value.company_info.legal_representative,legal_representative_position:h.value.company_info.legal_representative_position,legal_representative_gender:h.value.company_info.legal_representative_gender,registered_capital:h.value.company_info.registered_capital,establish_date:h.value.company_info.establish_date,company_type:h.value.company_info.company_type,registered_address:h.value.company_info.registered_address,office_address:h.value.company_info.office_address,fixed_phone:h.value.company_info.fixed_phone,email:h.value.company_info.email,employee_count:h.value.company_info.employee_count,authorized_person_name:h.value.authorized_person.name,authorized_person_id:h.value.authorized_person.id_number,authorized_person_gender:h.value.authorized_person.gender,authorized_person_position:h.value.authorized_person.position,authorized_person_title:h.value.authorized_person.title,bank_name:h.value.financial_info.bank_name,bank_account:h.value.financial_info.bank_account};let i;if(o.value){if(!a.company_name)return z("保存失败","公司名称不能为空"),void(p.value=!1);const e=await Ue.createCompany({name:a.company_name});if(!e.success||!e.data)throw new Error(e.error||"创建公司失败");i=e.data.company_id,await Ue.updateCompany(i,a)}else i=l.companyId,await Ue.updateCompany(i,a);const n=h.value.qualification_images.filter(e=>e.confirmed);if(n.length>0)for(const l of n)try{const e=atob(l.image_data),a=new Array(e.length);for(let l=0;l<e.length;l++)a[l]=e.charCodeAt(l);const s=new Uint8Array(a),t=new Blob([s],{type:l.content_type}),o=new File([t],l.original_filename,{type:l.content_type});await Ue.uploadQualification(i,l.guessed_type,o,{})}catch(e){}S("保存成功",o.value?"公司信息已创建":"公司信息已更新"),s("success",i),t.value=!1}catch(a){z("保存失败",a.message)}finally{p.value=!1}},L=()=>{n.value=0,r.value=[],u.value=null,f.value=0,g.value=[],_.value="",h.value={company_info:{},authorized_person:{},financial_info:{},qualification_images:[]},b.value="basic",t.value=!1};return ie(t,e=>{e&&(n.value=0,r.value=[],u.value=null,f.value=0,g.value=[])}),(e,a)=>{const l=fa,s=ma,S=qe,z=Z,N=G,A=Ye,B=v,Q=Me,W=q,J=U,ee=Fe,ae=De,le=R,se=K,te=Y,oe=Xe,ie=oa,ne=Ke,pe=We,me=H,be=Qe,he=M,Se=D;return ue(),re(Se,{modelValue:t.value,"onUpdate:modelValue":a[4]||(a[4]=e=>t.value=e),title:i.value,width:"900px","close-on-click-modal":!1,"destroy-on-close":"",onClose:L},{footer:ce(()=>[ve("div",Ia,[de(he,{onClick:L},{default:ce(()=>[...a[11]||(a[11]=[we("取消",-1)])]),_:1}),n.value>0&&n.value<2?(ue(),re(he,{key:0,onClick:j,disabled:d.value},{default:ce(()=>[...a[12]||(a[12]=[we(" 上一步 ",-1)])]),_:1},8,["disabled"])):ye("",!0),0===n.value?(ue(),re(he,{key:1,type:"primary",onClick:O,disabled:!u.value},{default:ce(()=>[...a[13]||(a[13]=[we(" 开始提取 ",-1)])]),_:1},8,["disabled"])):ye("",!0),2===n.value?(ue(),re(he,{key:2,type:"primary",onClick:T,loading:p.value},{default:ce(()=>[we(xe(o.value?"创建公司":"保存信息"),1)]),_:1},8,["loading"])):ye("",!0)])]),default:ce(()=>[de(s,{active:n.value,"finish-status":"success",class:"extractor-steps"},{default:ce(()=>[de(l,{title:"上传文档"}),de(l,{title:"AI提取"}),de(l,{title:"预览确认"})]),_:1},8,["active"]),Le(ve("div",_a,[de(S,{ref:"uploadRef",drag:"","auto-upload":!1,limit:1,accept:".docx,.doc","on-change":V,"on-remove":$,"file-list":r.value,class:"upload-area"},{tip:ce(()=>[...a[5]||(a[5]=[ve("div",{class:"el-upload__tip"}," 支持 .docx/.doc 格式的投标文件，系统将自动提取公司信息和资质图片 ",-1)])]),default:ce(()=>[a[6]||(a[6]=ve("i",{class:"bi bi-file-earmark-word upload-icon"},null,-1)),a[7]||(a[7]=ve("div",{class:"el-upload__text"},[we(" 拖拽历史标书到此处，或 "),ve("em",null,"点击选择文件")],-1))]),_:1},8,["file-list"]),ve("div",ya,[a[8]||(a[8]=ve("span",{class:"label"},"AI模型：",-1)),de(N,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),size:"small",style:{width:"200px"}},{default:ce(()=>[de(z,{label:"GPT-4o-mini (快速)",value:"gpt-4o-mini"}),de(z,{label:"DeepSeek-V3 (推荐)",value:"yuanjing-deepseek-v3"}),de(z,{label:"Qwen3-235B (最强)",value:"yuanjing-qwen3-235b"})]),_:1},8,["modelValue"])])],512),[[Be,0===n.value]]),Le(ve("div",ga,[ve("div",ba,[de(A,{percentage:f.value,status:_.value,"stroke-width":16,"text-inside":!0},null,8,["percentage","status"]),ve("div",ha,xe(y.value),1),de(Q,{height:"180px",class:"extraction-log"},{default:ce(()=>[(ue(!0),ge(ke,null,Re(g.value,(e,a)=>(ue(),ge("div",{key:a,class:"log-item"},["success"===e.status?(ue(),re(B,{key:0,color:"#67c23a"},{default:ce(()=>[de(_e(P))]),_:1})):"loading"===e.status?(ue(),re(B,{key:1,class:"is-loading",color:"#409eff"},{default:ce(()=>[de(_e(F))]),_:1})):(ue(),re(B,{key:2,color:"#f56c6c"},{default:ce(()=>[de(_e(m))]),_:1})),ve("span",null,xe(e.message),1)]))),128))]),_:1})])],512),[[Be,1===n.value]]),Le(ve("div",ka,[de(me,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),class:"preview-tabs"},{default:ce(()=>[de(se,{label:"基本信息",name:"basic"},{default:ce(()=>[de(Q,{height:"400px"},{default:ce(()=>[de(le,{model:h.value.company_info,"label-width":"140px",class:"preview-form"},{default:ce(()=>[de(ae,{gutter:20},{default:ce(()=>[(ue(),ge(ke,null,Re(k,e=>de(ee,{span:12,key:e.key},{default:ce(()=>[de(J,{label:e.label},{default:ce(()=>[de(W,{modelValue:h.value.company_info[e.key],"onUpdate:modelValue":a=>h.value.company_info[e.key]=a,placeholder:e.placeholder||`请输入${e.label}`,clearable:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])]),_:2},1024)),64))]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),de(se,{label:"被授权人",name:"personnel"},{default:ce(()=>[de(le,{model:h.value.authorized_person,"label-width":"140px",class:"preview-form"},{default:ce(()=>[de(ae,{gutter:20},{default:ce(()=>[(ue(),ge(ke,null,Re(w,e=>de(ee,{span:12,key:e.key},{default:ce(()=>[de(J,{label:e.label},{default:ce(()=>[de(W,{modelValue:h.value.authorized_person[e.key],"onUpdate:modelValue":a=>h.value.authorized_person[e.key]=a,placeholder:e.placeholder||`请输入${e.label}`,clearable:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])]),_:2},1024)),64))]),_:1})]),_:1},8,["model"])]),_:1}),de(se,{label:"财务信息",name:"financial"},{default:ce(()=>[de(le,{model:h.value.financial_info,"label-width":"140px",class:"preview-form"},{default:ce(()=>[de(ae,{gutter:20},{default:ce(()=>[de(ee,{span:12},{default:ce(()=>[de(J,{label:"开户银行"},{default:ce(()=>[de(W,{modelValue:h.value.financial_info.bank_name,"onUpdate:modelValue":a[1]||(a[1]=e=>h.value.financial_info.bank_name=e),placeholder:"请输入开户银行",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),de(ee,{span:12},{default:ce(()=>[de(J,{label:"银行账号"},{default:ce(()=>[de(W,{modelValue:h.value.financial_info.bank_account,"onUpdate:modelValue":a[2]||(a[2]=e=>h.value.financial_info.bank_account=e),placeholder:"请输入银行账号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),de(se,{name:"qualifications"},{label:ce(()=>[ve("span",null,[a[9]||(a[9]=we(" 资质文件 ",-1)),I.value>0?(ue(),re(te,{key:0,value:I.value,type:"success",class:"badge-margin"},null,8,["value"])):ye("",!0)])]),default:ce(()=>[de(Q,{height:"400px"},{default:ce(()=>[0===h.value.qualification_images.length?(ue(),ge("div",wa,[de(oe,{description:"未从文档中提取到图片"})])):(ue(),re(ae,{key:1,gutter:16,class:"image-grid"},{default:ce(()=>[(ue(!0),ge(ke,null,Re(h.value.qualification_images,(e,l)=>(ue(),re(ee,{span:8,key:l},{default:ce(()=>[de(pe,{class:fe(["image-card",{"is-confirmed":e.confirmed}]),shadow:"hover"},{default:ce(()=>[ve("div",{class:"image-preview",onClick:e=>{}},[de(ie,{src:E(e),fit:"contain","preview-src-list":[E(e)],"preview-teleported":!0},{error:ce(()=>[ve("div",Sa,[de(B,null,{default:ce(()=>[de(_e(X))]),_:1})])]),_:1},8,["src","preview-src-list"])],8,xa),ve("div",za,[de(N,{modelValue:e.guessed_type,"onUpdate:modelValue":a=>e.guessed_type=a,size:"small",placeholder:"选择资质类型",onChange:a=>(e=>{"unknown"!==e.guessed_type&&(e.confirmed=!0)})(e)},{default:ce(()=>[(ue(),ge(ke,null,Re(x,e=>de(z,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"]),de(ne,{modelValue:e.confirmed,"onUpdate:modelValue":a=>e.confirmed=a,size:"small"},{default:ce(()=>[...a[10]||(a[10]=[we(" 导入此图片 ",-1)])]),_:1},8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"]),ve("div",Ca,[de(be,{type:"info"},{default:ce(()=>[we(" 基本信息: "+xe(C.value)+"/"+xe(k.length)+" 字段 ",1)]),_:1}),de(be,{type:"info"},{default:ce(()=>[we(" 资质图片: "+xe(I.value)+"/"+xe(h.value.qualification_images.length)+" 张 ",1)]),_:1})])],512),[[Be,2===n.value]])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-9884c4c3"]]);export{Va as C};
