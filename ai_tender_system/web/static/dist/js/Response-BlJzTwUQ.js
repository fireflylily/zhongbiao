import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";import{E as n,a}from"./el-tab-pane-D784-xxe.js";/* empty css                */import{E as l,a as s}from"./el-form-item-36bfcgrq.js";import{E as t,a as o}from"./el-col-DR3qk7qZ.js";/* empty css                 */import"./el-tag-Bqv51Q1S.js";import{E as r,a as u}from"./el-select-DifvCuS7.js";import"./el-scrollbar-CIZTQeWR.js";/* empty css                   */import{d,r as i,x as c,L as p,c as m,g as v,B as g,a0 as f,F as _,w as j,aA as h,o as y,a6 as x,aB as b,E as w,e as k,k as $,l as I,t as S,aT as V,aU as F}from"./index.js";import"./DocumentUploader.vue_vue_type_style_index_0_scoped_1530a3ce_lang-kpO4p46J.js";import{P as R}from"./PageHeader-BjzQIq6-.js";import{S as U}from"./SSEStreamViewer-vj7zVCfL.js";import{D as E}from"./DocumentUploader-BrnGgnC5.js";import{t as C}from"./tender-Z_tK6YyL.js";import{E as D}from"./index-C4gi5RAB.js";import{E as L}from"./index-2qkNUAPG.js";import"./raf-C3W2Tojd.js";import"./strings-DTR7aduZ.js";import"./index-C9x2piTf.js";import"./omit-CrzxF80D.js";import"./_baseClone-DjpDAVKO.js";import"./castArray-Bpm97oyT.js";import"./index-C1e8Wm8f.js";const P={class:"business-response"},B={class:"upload-item"},O={class:"upload-item"},z={class:"generation-controls"},A={class:"card-header"},M={class:"card-header"},q={class:"header-actions"},H={class:"analysis-section"},J={class:"progress-text"},K=e(d({__name:"Response",setup(e){const d=i({projectId:null,tenderFiles:[],templateFiles:[]}),K=i([]),N=c(()=>K.value.find(e=>e.id===d.value.projectId)),Q=c(()=>d.value.projectId&&d.value.tenderFiles.length>0),T=i(!1),W=i(0),G=i(""),X=i(null),Y=i("content"),Z=()=>{d.value.tenderFiles=[],d.value.templateFiles=[],X.value=null,G.value=""},ee=()=>{h.success("招标文档上传成功")},ne=()=>{h.success("商务应答模板上传成功")},ae=async()=>{if(d.value.projectId)if(0!==d.value.tenderFiles.length){T.value=!0,W.value=0,G.value="",X.value=null;try{await le(),h.success("商务应答生成完成")}catch(e){h.error("生成失败，请重试")}finally{T.value=!1}}else h.warning("请先上传招标文档");else h.warning("请先选择项目")},le=async()=>new Promise(e=>{const n=[{progress:20,message:"正在解析招标文档..."},{progress:40,message:"正在提取商务条款要求..."},{progress:60,message:"正在检索公司资质信息..."},{progress:80,message:"正在生成商务应答内容..."},{progress:100,message:"生成完成！"}];let a=0;const l=setInterval(()=>{if(a<n.length){const e=n[a];W.value=e.progress,G.value+=`\n[${e.progress}%] ${e.message}`,a++}else clearInterval(l),X.value={content:"# 商务应答文档\n\n## 一、公司资质响应\n\n### 1.1 营业执照\n我公司持有有效的营业执照，注册资本xxxx万元，经营范围涵盖本项目所需的全部业务内容。\n\n### 1.2 相关资质证书\n- ISO 9001质量管理体系认证\n- ISO 27001信息安全管理体系认证\n- CMMI 3级认证\n\n## 二、商务条款响应\n\n### 2.1 付款方式\n我司完全接受贵方提出的付款方式，具体如下：\n- 合同签订后支付30%\n- 项目验收后支付60%\n- 质保期满后支付10%\n\n### 2.2 质保期\n我司承诺提供**2年免费质保期**，质保期内免费提供7x24小时技术支持。\n\n### 2.3 违约责任\n我司完全接受招标文件中关于违约责任的约定，并承诺严格履行合同义务。\n\n## 三、服务承诺\n\n1. **响应时间承诺**\n   - 一般问题：2小时内响应\n   - 紧急问题：30分钟内响应\n\n2. **人员配置承诺**\n   - 配备专职项目经理1名\n   - 技术团队不少于5人\n\n3. **培训承诺**\n   - 提供不少于3次系统培训\n   - 提供完整的操作手册",responseRate:92,analysis:"# 商务条款响应度分析\n\n## 完全响应的条款（85%）\n\n1. **付款方式** ✅\n   - 完全接受甲方提出的三期付款方式\n\n2. **质保期** ✅\n   - 质保期2年，超出招标文件要求的1年\n\n3. **违约责任** ✅\n   - 完全接受违约责任条款\n\n## 部分响应的条款（7%）\n\n1. **人员配置**\n   - 招标文件要求技术人员不少于8人\n   - 我方承诺不少于5人\n   - **建议**: 增加至8人以完全满足要求\n\n## 未响应的条款（8%）\n\n1. **保险要求**\n   - 招标文件要求购买项目保险\n   - 应答文件中未提及\n   - **建议**: 补充保险购买承诺",risks:"# 商务风险提示\n\n## ⚠️ 高风险项\n\n### 1. 人员配置不足\n- **风险**: 技术人员配置低于招标要求\n- **影响**: 可能被认定为非实质性响应\n- **建议**: 立即调整人员配置方案\n\n### 2. 缺少保险承诺\n- **风险**: 未响应保险要求\n- **影响**: 可能被扣分\n- **建议**: 补充项目保险购买计划\n\n## ⚡ 中风险项\n\n### 1. 质保期成本\n- **风险**: 质保期超出招标要求\n- **影响**: 增加成本负担\n- **建议**: 评估质保成本，调整报价\n\n## ✅ 低风险项\n\n1. 付款方式完全符合要求\n2. 违约责任条款明确\n3. 服务响应时间合理",suggestions:'# 改进建议\n\n## 1. 人员配置优化\n\n**当前**: 技术团队不少于5人\n**建议**: 调整为不少于8人\n**原因**: 满足招标文件要求\n\n## 2. 补充保险条款\n\n**建议内容**:\n> 我司承诺为本项目购买项目责任保险，保额不低于xxxx万元，保险期限覆盖整个项目周期。\n\n## 3. 完善服务承诺\n\n**建议增加**:\n- 定期巡检计划（每月1次）\n- 应急预案（含备用方案）\n- 培训计划详细安排\n\n## 4. 优化表述\n\n- 将"完全接受"改为具体承诺\n- 增加量化指标\n- 补充证明材料清单',documentUrl:"/api/documents/download/business-response-123.docx"},e()},800)}),se=()=>{T.value=!1,h.info("已停止生成")},te=()=>{var e;if(X.value)try{const n=oe(),a=new Blob([n],{type:"text/plain;charset=utf-8"}),l=`商务应答-${(null==(e=N.value)?void 0:e.name)||"文档"}-${Date.now()}.txt`,s=URL.createObjectURL(a),t=document.createElement("a");t.href=s,t.download=l,document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s),h.success("文档下载成功")}catch(n){h.error("文档下载失败，请重试")}else h.warning("暂无文档可下载")},oe=()=>{var e,n,a;if(!X.value)return"";let l="# 商务应答文档\n\n";return l+="## 项目信息\n",l+=`- 项目名称: ${(null==(e=N.value)?void 0:e.name)||"-"}\n`,l+=`- 项目编号: ${(null==(n=N.value)?void 0:n.number)||"-"}\n`,l+=`- 公司名称: ${(null==(a=N.value)?void 0:a.company_name)||"-"}\n`,l+=`- 生成时间: ${(new Date).toLocaleString()}\n\n`,l+="## 商务应答内容\n\n",l+=`${X.value.content}\n\n`,l+="---\n\n",l+="## 响应度分析\n\n",l+=`**总体响应度: ${X.value.responseRate}%**\n\n`,l+=`${X.value.analysis}\n\n`,l+="---\n\n",l+="## 风险提示\n\n",l+=`${X.value.risks}\n\n`,l+="---\n\n",l+="## 改进建议\n\n",l+=`${X.value.suggestions}\n`,l};return p(()=>{(async()=>{var e;try{const n=await C.getProjects({page:1,page_size:100});K.value=(null==(e=n.data)?void 0:e.items)||[]}catch(n){h.error("加载项目列表失败")}})()}),(e,i)=>{const c=u,p=r,h=s,C=o,le=w,oe=t,re=l,ue=D,de=I,ie=L,ce=n,pe=a;return y(),m("div",P,[v(_(R),{title:"商务应答",description:"智能生成商务应答文档"}),v(ue,{class:"project-section",shadow:"never"},{header:j(()=>[...i[4]||(i[4]=[k("div",{class:"card-header"},[k("span",null,"Step 1: 选择项目")],-1)])]),default:j(()=>[v(re,{model:d.value,"label-width":"100px"},{default:j(()=>[v(oe,{gutter:20},{default:j(()=>[v(C,{span:12},{default:j(()=>[v(h,{label:"项目"},{default:j(()=>[v(p,{modelValue:d.value.projectId,"onUpdate:modelValue":i[0]||(i[0]=e=>d.value.projectId=e),placeholder:"请选择项目",filterable:"",onChange:Z,style:{width:"100%"}},{default:j(()=>[(y(!0),m(x,null,b(K.value,e=>(y(),g(c,{key:e.id,label:`${e.name} (${e.number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),v(C,{span:12},{default:j(()=>[v(h,{label:"公司"},{default:j(()=>{var e;return[v(le,{value:(null==(e=N.value)?void 0:e.company_name)||"-",disabled:""},null,8,["value"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),d.value.projectId?(y(),g(ue,{key:0,class:"upload-section",shadow:"never"},{header:j(()=>[...i[5]||(i[5]=[k("div",{class:"card-header"},[k("span",null,"Step 2: 上传相关文档")],-1)])]),default:j(()=>[v(oe,{gutter:20},{default:j(()=>[v(C,{span:12},{default:j(()=>[k("div",B,[i[6]||(i[6]=k("h4",null,[$("招标文档 "),k("span",{class:"required"},"*")],-1)),v(_(E),{modelValue:d.value.tenderFiles,"onUpdate:modelValue":i[1]||(i[1]=e=>d.value.tenderFiles=e),"upload-url":`/api/tender-projects/${d.value.projectId}/upload-tender`,accept:".pdf,.doc,.docx",limit:5,"max-size":50,drag:"","tip-text":"支持PDF、Word格式，最大50MB，可上传多个文件",onSuccess:ee},null,8,["modelValue","upload-url"])])]),_:1}),v(C,{span:12},{default:j(()=>[k("div",O,[i[7]||(i[7]=k("h4",null,"商务应答模板",-1)),v(_(E),{modelValue:d.value.templateFiles,"onUpdate:modelValue":i[2]||(i[2]=e=>d.value.templateFiles=e),"upload-url":`/api/tender-projects/${d.value.projectId}/upload-template`,accept:".doc,.docx",limit:1,"max-size":20,drag:"","tip-text":"可选上传商务应答模板，用于保持格式一致",onSuccess:ne},null,8,["modelValue","upload-url"])])]),_:1})]),_:1}),k("div",z,[v(de,{type:"primary",size:"large",disabled:!Q.value,loading:T.value,onClick:ae},{default:j(()=>[...i[8]||(i[8]=[$(" 开始生成商务应答 ",-1)])]),_:1},8,["disabled","loading"])])]),_:1})):f("",!0),T.value?(y(),g(ue,{key:1,class:"generation-output",shadow:"never"},{header:j(()=>[k("div",A,[i[9]||(i[9]=k("span",null,"AI正在生成商务应答...",-1)),v(ie,{percentage:W.value,status:100===W.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:j(()=>[v(_(U),{content:G.value,"is-streaming":T.value,onStop:se,onRegenerate:ae},null,8,["content","is-streaming"])]),_:1})):f("",!0),X.value?(y(),g(ue,{key:2,class:"result-section",shadow:"never"},{header:j(()=>[k("div",M,[i[12]||(i[12]=k("span",null,"生成结果",-1)),k("div",q,[v(de,{type:"success",icon:_(V),onClick:te},{default:j(()=>[...i[10]||(i[10]=[$(" 下载文档 ",-1)])]),_:1},8,["icon"]),v(de,{type:"primary",icon:_(F),onClick:ae},{default:j(()=>[...i[11]||(i[11]=[$(" 重新生成 ",-1)])]),_:1},8,["icon"])])])]),default:j(()=>[v(pe,{modelValue:Y.value,"onUpdate:modelValue":i[3]||(i[3]=e=>Y.value=e)},{default:j(()=>[v(ce,{label:"商务应答内容",name:"content"},{default:j(()=>[v(_(U),{content:X.value.content,"is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),_:1}),v(ce,{label:"响应度分析",name:"analysis"},{default:j(()=>{return[k("div",H,[i[13]||(i[13]=k("h4",null,"商务条款响应度",-1)),v(ie,{percentage:X.value.responseRate,color:(e=X.value.responseRate,e>=90?"#67c23a":e>=70?"#e6a23c":"#f56c6c"),"stroke-width":20},{default:j(()=>[k("span",J,S(X.value.responseRate)+"%",1)]),_:1},8,["percentage","color"]),i[14]||(i[14]=k("h4",{style:{"margin-top":"30px"}},"详细分析",-1)),v(_(U),{content:X.value.analysis,"is-streaming":!1,"enable-markdown":!0},null,8,["content"])])];var e}),_:1}),v(ce,{label:"风险提示",name:"risks"},{default:j(()=>[v(_(U),{content:X.value.risks,"is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),_:1}),v(ce,{label:"改进建议",name:"suggestions"},{default:j(()=>[v(_(U),{content:X.value.suggestions,"is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),_:1})]),_:1},8,["modelValue"])]),_:1})):f("",!0)])}}}),[["__scopeId","data-v-28279486"]]);export{K as default};
