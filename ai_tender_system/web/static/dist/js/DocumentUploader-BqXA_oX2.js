import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";import"./DocumentPreview.vue_vue_type_style_index_0_scoped_c8a3e4c1_lang-CvTZjc9R.js";/* empty css                */import{d as a,r as s,x as t,c as l,o,g as r,a2 as i,w as u,C as d,e as p,B as c,a0 as n,H as m,F as f,be as x,t as g,bf as v,bg as _,k as y,bh as b,l as h,bi as k,bj as w,aA as B}from"./index.js";import{E as $}from"./index-IN6Zpv5z.js";import{E as j}from"./index-DzZX4pf4.js";const z={class:"document-uploader"},V={key:1,class:"upload-drag-area"},F={key:0,class:"upload-hint"},D={key:0,class:"upload-tip"},L={class:"upload-file-item"},S={class:"file-name"},T={class:"file-size"},C=e(a({__name:"DocumentUploader",props:{uploadUrl:{default:"/api/upload"},uploadHeaders:{},uploadData:{},accept:{default:".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx"},limit:{default:10},maxSize:{default:50},multiple:{type:Boolean,default:!1},drag:{type:Boolean,default:!1},showFileList:{type:Boolean,default:!0},triggerText:{default:"选择文件"},tipText:{default:""},modelValue:{}},emits:["update:modelValue","success","error","exceed","remove"],setup(e,{expose:a,emit:C}){const H=e,U=C,E=s(),M=t({get:()=>H.modelValue||[],set:e=>U("update:modelValue",e)}),A=e=>{var a;if(H.maxSize&&e.size/1024/1024>H.maxSize)return B.error(`文件大小不能超过 ${H.maxSize}MB`),!1;if(H.accept){const s=H.accept.split(",").map(e=>e.trim()),t="."+(null==(a=e.name.split(".").pop())?void 0:a.toLowerCase());if(!s.some(e=>t===e.toLowerCase()))return B.error(`不支持的文件格式：${t}`),!1}return!0},G=(e,a,s)=>{},I=(e,a,s)=>{B.success("文件上传成功"),U("success",a,s),U("update:modelValue",s)},K=(e,a,s)=>{B.error("文件上传失败："+e.message),U("error",e,a,s)},N=(e,a)=>{B.warning(`最多只能上传 ${H.limit} 个文件`),U("exceed",e,a)},P=(e,a)=>{U("remove",e,a),U("update:modelValue",a)},R=e=>{if(!e)return"0 B";const a=["B","KB","MB","GB"];let s=0,t=e;for(;t>=1024&&s<a.length-1;)t/=1024,s++;return`${t.toFixed(2)} ${a[s]}`};return a({clearFiles:()=>{var e;null==(e=E.value)||e.clearFiles(),U("update:modelValue",[])},submit:()=>{var e;null==(e=E.value)||e.submit()},abort:e=>{var a;null==(a=E.value)||a.abort(e)}}),(a,s)=>{const t=h,B=m,C=j,H=$;return o(),l("div",z,[r(H,i({ref_key:"uploadRef",ref:E,action:e.uploadUrl,headers:e.uploadHeaders,data:e.uploadData,accept:e.accept,limit:e.limit,multiple:e.multiple,drag:e.drag,"show-file-list":e.showFileList,"before-upload":A,"on-progress":G,"on-success":I,"on-error":K,"on-exceed":N,"on-remove":P,"file-list":M.value},a.$attrs),{default:u(()=>[d(a.$slots,"trigger",{},()=>[e.drag?(o(),l("div",V,[r(B,{class:"upload-icon"},{default:u(()=>[r(f(w))]),_:1}),s[0]||(s[0]=p("div",{class:"upload-text"},[y(" 将文件拖到此处，或"),p("em",null,"点击上传")],-1)),e.accept?(o(),l("div",F," 支持的文件格式："+g(e.accept),1)):n("",!0)])):(o(),c(t,{key:0,type:"primary",icon:f(k)},{default:u(()=>[y(g(e.triggerText),1)]),_:1},8,["icon"]))],!0)]),tip:u(()=>[d(a.$slots,"tip",{},()=>[e.tipText?(o(),l("div",D,[r(B,null,{default:u(()=>[r(f(b))]),_:1}),y(" "+g(e.tipText),1)])):n("",!0)],!0)]),file:u(({file:e})=>[d(a.$slots,"file",{file:e},()=>[p("div",L,[r(B,{class:"file-icon"},{default:u(()=>[r(f(x))]),_:1}),p("span",S,g(e.name),1),p("span",T,g(R(e.size)),1),"uploading"===e.status?(o(),c(C,{key:0,percentage:e.percentage,"stroke-width":2},null,8,["percentage"])):n("",!0),"success"===e.status?(o(),c(B,{key:1,class:"status-icon success"},{default:u(()=>[r(f(v))]),_:1})):n("",!0),"fail"===e.status?(o(),c(B,{key:2,class:"status-icon error"},{default:u(()=>[r(f(_))]),_:1})):n("",!0)])],!0)]),_:3},16,["action","headers","data","accept","limit","multiple","drag","show-file-list","file-list"])])}}}),[["__scopeId","data-v-1530a3ce"]]);export{C as D};
