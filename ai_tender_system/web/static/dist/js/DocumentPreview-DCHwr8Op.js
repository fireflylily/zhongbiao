import{d as e,r as a,c as t,D as l,k as o,o as s,w as n,aa as r,e as u,l as i,m as d,f as m,h as v,aI as c,aJ as f,j as p,aK as y,A as _}from"./vendor-CDDpMtwV.js";/* empty css                                                                        */import{_ as h}from"./index.js";const w={"element-loading-text":"正在加载文档...",class:"preview-container"},C={key:1,class:"editor-preview-wrapper"},V=h(e({__name:"DocumentPreview",props:{modelValue:{type:Boolean,default:!1},fileUrl:{default:""},fileName:{default:"文档预览"},htmlContent:{default:""}},emits:["update:modelValue"],setup(e,{emit:h}){const V=e,g=h,b=a(!1),j=a(""),x=a(""),U=a(null),k=t({get:()=>V.modelValue,set:e=>g("update:modelValue",e)}),D=t(()=>`文档预览 - ${V.fileName||"未命名文档"}`),T=()=>{U.value&&x.value&&setTimeout(()=>{"function"==typeof U.value.setContent&&U.value.setContent(x.value)},300)},N=()=>{k.value=!1};return l(()=>V.modelValue,async e=>{e&&(V.fileUrl||V.htmlContent)?(await y(),(async()=>{if(V.htmlContent)x.value=V.htmlContent;else if(V.fileUrl){b.value=!0,j.value="";try{const e=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:V.fileUrl})}),a=await e.json();if(!a.success||!a.html_content)throw new Error(a.error||"Word转HTML失败");x.value=a.html_content}catch(e){j.value=`文档预览失败: ${e.message||"未知错误"}`,_.error("文档预览失败，请检查文件是否正确或尝试下载后查看")}finally{b.value=!1}}else j.value="文档地址不能为空"})()):(j.value="",x.value="")}),(e,a)=>{const t=d,l=p,y=f;return s(),o(l,{modelValue:k.value,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value=e),title:D.value,width:"90%","before-close":N,"destroy-on-close":"",class:"document-preview-dialog"},{default:n(()=>[r((s(),u("div",w,[j.value?(s(),o(t,{key:0,type:"error",title:j.value,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["title"])):i("",!0),!j.value&&x.value?(s(),u("div",C,[m(v(c),{ref_key:"editorRef",ref:U,document:{readOnly:!0},onCreated:T},null,512)])):i("",!0)])),[[y,b.value]])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-62c282b6"]]);export{V as D};
