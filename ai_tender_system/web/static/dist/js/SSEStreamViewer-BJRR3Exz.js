import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";/* empty css                */import{d as t,r as a,x as n,A as s,c as o,o as r,I as c,g as i,a0 as l,w as d,e as u,H as p,F as m,aQ as y,B as _,l as f,bu as g,k as v,bv as k,b6 as w,b7 as b,aA as S,W as h}from"./index.js";import{k as x}from"./DocumentPreview.vue_vue_type_style_index_0_scoped_c8a3e4c1_lang-CvTZjc9R.js";import{E as j}from"./index-ELBiC1Q4.js";const L=["innerHTML"],C={key:0,class:"streaming-indicator"},B={key:0,class:"stream-actions"},R=e(t({__name:"SSEStreamViewer",props:{content:{},isStreaming:{type:Boolean,default:!1},enableMarkdown:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0}},emits:["stop","regenerate"],setup(e,{emit:t}){const R=e,H=t,M=a(null),T=n(()=>{if(!R.content)return"";if(R.enableMarkdown)try{return x.parse(R.content)}catch(e){return R.content}return R.content.replace(/\n/g,"<br>")});s(()=>R.content,async()=>{R.autoScroll&&R.isStreaming&&(await h(),U())});const U=()=>{M.value&&(M.value.scrollTop=M.value.scrollHeight)},E=async()=>{try{await navigator.clipboard.writeText(R.content),S.success("内容已复制到剪贴板")}catch(e){S.error("复制失败，请手动复制")}},A=()=>{try{const e=new Blob([R.content],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`ai-content-${Date.now()}.txt`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t),S.success("文档下载成功")}catch(e){S.error("下载失败，请重试")}};return(t,a)=>{const n=p,s=j,S=f;return r(),o("div",{class:c(["sse-stream-viewer",{"is-loading":e.isStreaming}])},[i(s,{class:"stream-content",shadow:"never"},{default:d(()=>[u("div",{ref_key:"contentRef",ref:M,class:"content-wrapper",innerHTML:T.value},null,8,L),e.isStreaming?(r(),o("div",C,[i(n,{class:"is-loading"},{default:d(()=>[i(m(y))]),_:1}),a[2]||(a[2]=u("span",null,"正在生成中...",-1))])):l("",!0)]),_:1}),e.content?(r(),o("div",B,[e.isStreaming?(r(),_(S,{key:0,type:"warning",icon:m(g),onClick:a[0]||(a[0]=e=>H("stop"))},{default:d(()=>[...a[3]||(a[3]=[v(" 停止生成 ",-1)])]),_:1},8,["icon"])):(r(),_(S,{key:1,type:"primary",icon:m(k),onClick:E},{default:d(()=>[...a[4]||(a[4]=[v(" 复制内容 ",-1)])]),_:1},8,["icon"])),!e.isStreaming&&e.content?(r(),_(S,{key:2,type:"success",icon:m(w),onClick:A},{default:d(()=>[...a[5]||(a[5]=[v(" 下载文档 ",-1)])]),_:1},8,["icon"])):l("",!0),!e.isStreaming&&e.content?(r(),_(S,{key:3,icon:m(b),onClick:a[1]||(a[1]=e=>H("regenerate"))},{default:d(()=>[...a[6]||(a[6]=[v(" 重新生成 ",-1)])]),_:1},8,["icon"])):l("",!0)])):l("",!0)],2)}}}),[["__scopeId","data-v-cba4d568"]]);export{R as S};
