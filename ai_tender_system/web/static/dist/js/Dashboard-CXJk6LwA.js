import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";import{E as a}from"./el-tag-CIDvEaT7.js";import{a as t,E as l}from"./el-select-CSRo3b5h.js";import{E as n}from"./el-scrollbar-DsjZ7Tvs.js";/* empty css                   */import{E as s}from"./el-input-DvOUeopF.js";import{L as i,E as o,a as r}from"./Loading-DZ6TusUK.js";import"./el-checkbox-B0HC3nmW.js";import{E as u,a as c,d as p}from"./el-col-CxySkGPJ.js";import{aI as d,m as g,p as v,_ as m,d as f,K as b,x as y,c as h,o as _,B as S,t as j,w as k,G as P,F as x,H as C,N as z,s as w,n as T,au as N,v as $,r as I,A as M,g as B,a8 as D,aC as E,I as O,aJ as L,an as q,e as A,E as F,aK as U,a3 as H,aL as J,aM as K,aN as R,j as Y,q as V,O as G,aO as Q,aP as W,M as X,ax as Z,ai as ee,aQ as ae,ag as te,aR as le,J as ne,aS as se,C as ie,k as oe,D as re,P as ue,aT as ce,az as pe,aU as de,a as ge,L as ve,l as me,i as fe}from"./index.js";import{P as be,C as ye,E as he}from"./IconButton.vue_vue_type_style_index_0_scoped_628ec5f8_lang-BLOjLzl-.js";/* empty css                    */import"./strings-cNGkbWe_.js";import"./castArray-1-lWFeBZ.js";import"./index-DxJLt_gU.js";import"./_baseClone-DZGxnlWo.js";import"./omit-CeOIu7oa.js";import"./raf-CHxA5dQD.js";import"./index-B7TJi9dg.js";const _e={getProjects:async e=>d.get("/tender-projects",e),getProject:async e=>d.get(`/tender-projects/${e}`),createProject:async e=>d.post("/tender-projects",e),updateProject:async(e,a)=>d.put(`/tender-projects/${e}`,a),deleteProject:async e=>d.delete(`/tender-projects/${e}`),async uploadTenderDocument(e,a,t){const l=new FormData;return l.append("file",a),l.append("project_id",e.toString()),d.upload("/upload/tender-document",l,e=>{if(t&&e.total){const a=Math.round(100*e.loaded/e.total);t(a)}})},async uploadBusinessTemplate(e,a,t){const l=new FormData;return l.append("file",a),l.append("project_id",e.toString()),d.upload("/upload/business-template",l,e=>{if(t&&e.total){const a=Math.round(100*e.loaded/e.total);t(a)}})},async uploadTechnicalTemplate(e,a,t){const l=new FormData;return l.append("file",a),l.append("project_id",e.toString()),d.upload("/upload/technical-template",l,e=>{if(t&&e.total){const a=Math.round(100*e.loaded/e.total);t(a)}})},getProjectDocuments:async e=>d.get(`/tender-projects/${e}/documents`),deleteDocument:async e=>d.delete(`/documents/${e}`),downloadDocument:async(e,a,t)=>d.download(`/documents/${e}/download`,a,e=>{if(t&&e.total){const a=Math.round(100*e.loaded/e.total);t(a)}}),startTenderProcessing:async e=>d.post("/tender-processing/start",e),getTaskStatus:async e=>d.get(`/tasks/${e}/status`),cancelTask:async e=>d.post(`/tasks/${e}/cancel`),getTaskResult:async e=>d.get(`/tasks/${e}/result`),getSourceDocuments:async e=>d.get(`/document-merger/source-documents/${e}`),startDocumentMerge:async e=>d.post("/document-merger/merge",e),getMergeTaskResult:async e=>d.get(`/document-merger/tasks/${e}/result`),downloadMergedDocument:async(e,a,t)=>d.download(`/document-merger/tasks/${e}/download`,a,e=>{if(t&&e.total){const a=Math.round(100*e.loaded/e.total);t(a)}}),getHITLTask:async e=>d.get(`/hitl/${e}`),updateHITLTask:async(e,a)=>d.put(`/hitl/${e}`,a),submitHITLReview:async(e,a)=>d.post(`/hitl/${e}/submit`,a),getProjectStatistics:async e=>d.get(`/tender-projects/${e}/statistics`)},Se=Symbol("elPaginationKey"),je=g({disabled:Boolean,currentPage:{type:Number,default:1},prevText:{type:String},prevIcon:{type:v}}),ke={click:e=>e instanceof MouseEvent},Pe=f({name:"ElPaginationPrev"});var xe=m(f({...Pe,props:je,emits:ke,setup(e){const a=e,{t:t}=b(),l=y(()=>a.disabled||a.currentPage<=1);return(e,a)=>(_(),h("button",{type:"button",class:"btn-prev",disabled:x(l),"aria-label":e.prevText||x(t)("el.pagination.prev"),"aria-disabled":x(l),onClick:a=>e.$emit("click",a)},[e.prevText?(_(),h("span",{key:0},j(e.prevText),1)):(_(),S(x(C),{key:1},{default:k(()=>[(_(),S(P(e.prevIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}}),[["__file","prev.vue"]]);const Ce=g({disabled:Boolean,currentPage:{type:Number,default:1},pageCount:{type:Number,default:50},nextText:{type:String},nextIcon:{type:v}}),ze=f({name:"ElPaginationNext"});var we=m(f({...ze,props:Ce,emits:["click"],setup(e){const a=e,{t:t}=b(),l=y(()=>a.disabled||a.currentPage===a.pageCount||0===a.pageCount);return(e,a)=>(_(),h("button",{type:"button",class:"btn-next",disabled:x(l),"aria-label":e.nextText||x(t)("el.pagination.next"),"aria-disabled":x(l),onClick:a=>e.$emit("click",a)},[e.nextText?(_(),h("span",{key:0},j(e.nextText),1)):(_(),S(x(C),{key:1},{default:k(()=>[(_(),S(P(e.nextIcon)))]),_:1}))],8,["disabled","aria-label","aria-disabled","onClick"]))}}),[["__file","next.vue"]]);const Te=()=>z(Se,{}),Ne=g({pageSize:{type:Number,required:!0},pageSizes:{type:T(Array),default:()=>N([10,20,30,40,50,100])},popperClass:{type:String},popperStyle:{type:T([String,Object])},disabled:Boolean,teleported:Boolean,size:{type:String,values:w},appendSizeTo:String}),$e=f({name:"ElPaginationSizes"});var Ie=m(f({...$e,props:Ne,emits:["page-size-change"],setup(e,{emit:a}){const n=e,{t:s}=b(),i=$("pagination"),o=Te(),r=I(n.pageSize);M(()=>n.pageSizes,(e,t)=>{if(!L(e,t)&&q(e)){const t=e.includes(n.pageSize)?n.pageSize:n.pageSizes[0];a("page-size-change",t)}}),M(()=>n.pageSize,e=>{r.value=e});const u=y(()=>n.pageSizes);function c(e){var a;e!==r.value&&(r.value=e,null==(a=o.handleSizeChange)||a.call(o,Number(e)))}return(e,a)=>(_(),h("span",{class:O(x(i).e("sizes"))},[B(x(l),{"model-value":r.value,disabled:e.disabled,"popper-class":e.popperClass,"popper-style":e.popperStyle,size:e.size,teleported:e.teleported,"validate-event":!1,"append-to":e.appendSizeTo,onChange:c},{default:k(()=>[(_(!0),h(D,null,E(x(u),e=>(_(),S(x(t),{key:e,value:e,label:e+x(s)("el.pagination.pagesize")},null,8,["value","label"]))),128))]),_:1},8,["model-value","disabled","popper-class","popper-style","size","teleported","append-to"])],2))}}),[["__file","sizes.vue"]]);const Me=g({size:{type:String,values:w}}),Be=f({name:"ElPaginationJumper"});var De=m(f({...Be,props:Me,setup(e){const{t:a}=b(),t=$("pagination"),{pageCount:l,disabled:n,currentPage:s,changeEvent:i}=Te(),o=I(),r=y(()=>{var e;return null!=(e=o.value)?e:null==s?void 0:s.value});function u(e){o.value=e?+e:""}function c(e){e=Math.trunc(+e),null==i||i(e),o.value=void 0}return(e,s)=>(_(),h("span",{class:O(x(t).e("jump")),disabled:x(n)},[A("span",{class:O([x(t).e("goto")])},j(x(a)("el.pagination.goto")),3),B(x(F),{size:e.size,class:O([x(t).e("editor"),x(t).is("in-pagination")]),min:1,max:x(l),disabled:x(n),"model-value":x(r),"validate-event":!1,"aria-label":x(a)("el.pagination.page"),type:"number","onUpdate:modelValue":u,onChange:c},null,8,["size","class","max","disabled","model-value","aria-label"]),A("span",{class:O([x(t).e("classifier")])},j(x(a)("el.pagination.pageClassifier")),3)],10,["disabled"]))}}),[["__file","jumper.vue"]]);const Ee=g({total:{type:Number,default:1e3}}),Oe=f({name:"ElPaginationTotal"});var Le=m(f({...Oe,props:Ee,setup(e){const{t:a}=b(),t=$("pagination"),{disabled:l}=Te();return(e,n)=>(_(),h("span",{class:O(x(t).e("total")),disabled:x(l)},j(x(a)("el.pagination.total",{total:e.total})),11,["disabled"]))}}),[["__file","total.vue"]]);const qe=g({currentPage:{type:Number,default:1},pageCount:{type:Number,required:!0},pagerCount:{type:Number,default:7},disabled:Boolean}),Ae=f({name:"ElPaginationPager"});var Fe=m(f({...Ae,props:qe,emits:[U],setup(e,{emit:a}){const t=e,l=$("pager"),n=$("icon"),{t:s}=b(),i=I(!1),o=I(!1),r=I(!1),u=I(!1),c=I(!1),p=I(!1),d=y(()=>{const e=t.pagerCount,a=(e-1)/2,l=Number(t.currentPage),n=Number(t.pageCount);let s=!1,i=!1;n>e&&(l>e-a&&(s=!0),l<n-a&&(i=!0));const o=[];if(s&&!i){for(let a=n-(e-2);a<n;a++)o.push(a)}else if(!s&&i)for(let t=2;t<e;t++)o.push(t);else if(s&&i){const a=Math.floor(e/2)-1;for(let e=l-a;e<=l+a;e++)o.push(e)}else for(let t=2;t<n;t++)o.push(t);return o}),g=y(()=>["more","btn-quickprev",n.b(),l.is("disabled",t.disabled)]),v=y(()=>["more","btn-quicknext",n.b(),l.is("disabled",t.disabled)]),m=y(()=>t.disabled?-1:0);function f(e=!1){t.disabled||(e?r.value=!0:u.value=!0)}function k(e=!1){e?c.value=!0:p.value=!0}function P(e){const l=e.target;if("li"===l.tagName.toLowerCase()&&Array.from(l.classList).includes("number")){const e=Number(l.textContent);e!==t.currentPage&&a(U,e)}else"li"===l.tagName.toLowerCase()&&Array.from(l.classList).includes("more")&&C(e)}function C(e){const l=e.target;if("ul"===l.tagName.toLowerCase()||t.disabled)return;let n=Number(l.textContent);const s=t.pageCount,i=t.currentPage,o=t.pagerCount-2;l.className.includes("more")&&(l.className.includes("quickprev")?n=i-o:l.className.includes("quicknext")&&(n=i+o)),Number.isNaN(+n)||(n<1&&(n=1),n>s&&(n=s)),n!==i&&a(U,n)}return M(()=>[t.pageCount,t.pagerCount,t.currentPage],([e,a,t])=>{const l=(a-1)/2;let n=!1,s=!1;e>a&&(n=t>a-l,s=t<e-l),r.value&&(r.value=n),u.value&&(u.value=s),i.value=n,o.value=s},{immediate:!0}),(e,a)=>(_(),h("ul",{class:O(x(l).b()),onClick:C,onKeyup:Y(P,["enter"])},[e.pageCount>0?(_(),h("li",{key:0,class:O([[x(l).is("active",1===e.currentPage),x(l).is("disabled",e.disabled)],"number"]),"aria-current":1===e.currentPage,"aria-label":x(s)("el.pagination.currentPage",{pager:1}),tabindex:x(m)}," 1 ",10,["aria-current","aria-label","tabindex"])):H("v-if",!0),i.value?(_(),h("li",{key:1,class:O(x(g)),tabindex:x(m),"aria-label":x(s)("el.pagination.prevPages",{pager:e.pagerCount-2}),onMouseenter:e=>f(!0),onMouseleave:e=>r.value=!1,onFocus:e=>k(!0),onBlur:e=>c.value=!1},[!r.value&&!c.value||e.disabled?(_(),S(x(K),{key:1})):(_(),S(x(J),{key:0}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):H("v-if",!0),(_(!0),h(D,null,E(x(d),a=>(_(),h("li",{key:a,class:O([[x(l).is("active",e.currentPage===a),x(l).is("disabled",e.disabled)],"number"]),"aria-current":e.currentPage===a,"aria-label":x(s)("el.pagination.currentPage",{pager:a}),tabindex:x(m)},j(a),11,["aria-current","aria-label","tabindex"]))),128)),o.value?(_(),h("li",{key:2,class:O(x(v)),tabindex:x(m),"aria-label":x(s)("el.pagination.nextPages",{pager:e.pagerCount-2}),onMouseenter:e=>f(),onMouseleave:e=>u.value=!1,onFocus:e=>k(),onBlur:e=>p.value=!1},[!u.value&&!p.value||e.disabled?(_(),S(x(K),{key:1})):(_(),S(x(R),{key:0}))],42,["tabindex","aria-label","onMouseenter","onMouseleave","onFocus","onBlur"])):H("v-if",!0),e.pageCount>1?(_(),h("li",{key:3,class:O([[x(l).is("active",e.currentPage===e.pageCount),x(l).is("disabled",e.disabled)],"number"]),"aria-current":e.currentPage===e.pageCount,"aria-label":x(s)("el.pagination.currentPage",{pager:e.pageCount}),tabindex:x(m)},j(e.pageCount),11,["aria-current","aria-label","tabindex"])):H("v-if",!0)],42,["onKeyup"]))}}),[["__file","pager.vue"]]);const Ue=e=>"number"!=typeof e,He=g({pageSize:Number,defaultPageSize:Number,total:Number,pageCount:Number,pagerCount:{type:Number,validator:e=>V(e)&&Math.trunc(e)===e&&e>4&&e<22&&e%2==1,default:7},currentPage:Number,defaultCurrentPage:Number,layout:{type:String,default:["prev","pager","next","jumper","->","total"].join(", ")},pageSizes:{type:T(Array),default:()=>N([10,20,30,40,50,100])},popperClass:{type:String,default:""},popperStyle:{type:T([String,Object])},prevText:{type:String,default:""},prevIcon:{type:v,default:()=>le},nextText:{type:String,default:""},nextIcon:{type:v,default:()=>te},teleported:{type:Boolean,default:!0},small:Boolean,size:ae,background:Boolean,disabled:Boolean,hideOnSinglePage:Boolean,appendSizeTo:String}),Je="ElPagination";const Ke=ne(f({name:Je,props:He,emits:{"update:current-page":e=>V(e),"update:page-size":e=>V(e),"size-change":e=>V(e),change:(e,a)=>V(e)&&V(a),"current-change":e=>V(e),"prev-click":e=>V(e),"next-click":e=>V(e)},setup(e,{emit:a,slots:t}){const{t:l}=b(),n=$("pagination"),s=G().vnode.props||{},i=Q(),o=y(()=>{var a;return e.small?"small":null!=(a=e.size)?a:i.value});W({from:"small",replacement:"size",version:"3.0.0",scope:"el-pagination",ref:"https://element-plus.org/zh-CN/component/pagination.html"},y(()=>!!e.small));const r="onUpdate:currentPage"in s||"onUpdate:current-page"in s||"onCurrentChange"in s,u="onUpdate:pageSize"in s||"onUpdate:page-size"in s||"onSizeChange"in s,c=y(()=>{if(Ue(e.total)&&Ue(e.pageCount))return!1;if(!Ue(e.currentPage)&&!r)return!1;if(e.layout.includes("sizes"))if(Ue(e.pageCount)){if(!Ue(e.total)&&!Ue(e.pageSize)&&!u)return!1}else if(!u)return!1;return!0}),p=I(Ue(e.defaultPageSize)?10:e.defaultPageSize),d=I(Ue(e.defaultCurrentPage)?1:e.defaultCurrentPage),g=y({get:()=>Ue(e.pageSize)?p.value:e.pageSize,set(t){Ue(e.pageSize)&&(p.value=t),u&&(a("update:page-size",t),a("size-change",t))}}),v=y(()=>{let a=0;return Ue(e.pageCount)?Ue(e.total)||(a=Math.max(1,Math.ceil(e.total/g.value))):a=e.pageCount,a}),m=y({get:()=>Ue(e.currentPage)?d.value:e.currentPage,set(t){let l=t;t<1?l=1:t>v.value&&(l=v.value),Ue(e.currentPage)&&(d.value=l),r&&(a("update:current-page",l),a("current-change",l))}});function f(e){m.value=e}function h(){e.disabled||(m.value-=1,a("prev-click",m.value))}function _(){e.disabled||(m.value+=1,a("next-click",m.value))}function S(e,a){e&&(e.props||(e.props={}),e.props.class=[e.props.class,a].join(" "))}return M(v,e=>{m.value>e&&(m.value=e)}),M([m,g],e=>{a(U,...e)},{flush:"post"}),X(Se,{pageCount:v,disabled:y(()=>e.disabled),currentPage:m,changeEvent:f,handleSizeChange:function(e){g.value=e;const a=v.value;m.value>a&&(m.value=a)}}),()=>{var a,s;if(!c.value)return Z(Je,l("el.pagination.deprecationWarning")),null;if(!e.layout)return null;if(e.hideOnSinglePage&&v.value<=1)return null;const i=[],r=[],u=ee("div",{class:n.e("rightwrapper")},r),p={prev:ee(xe,{disabled:e.disabled,currentPage:m.value,prevText:e.prevText,prevIcon:e.prevIcon,onClick:h}),jumper:ee(De,{size:o.value}),pager:ee(Fe,{currentPage:m.value,pageCount:v.value,pagerCount:e.pagerCount,onChange:f,disabled:e.disabled}),next:ee(we,{disabled:e.disabled,currentPage:m.value,pageCount:v.value,nextText:e.nextText,nextIcon:e.nextIcon,onClick:_}),sizes:ee(Ie,{pageSize:g.value,pageSizes:e.pageSizes,popperClass:e.popperClass,popperStyle:e.popperStyle,disabled:e.disabled,teleported:e.teleported,size:o.value,appendSizeTo:e.appendSizeTo}),slot:null!=(s=null==(a=null==t?void 0:t.default)?void 0:a.call(t))?s:null,total:ee(Le,{total:Ue(e.total)?0:e.total})},d=e.layout.split(",").map(e=>e.trim());let b=!1;return d.forEach(e=>{"->"!==e?b?r.push(p[e]):i.push(p[e]):b=!0}),S(i[0],n.is("first")),S(i[i.length-1],n.is("last")),b&&r.length>0&&(S(r[0],n.is("first")),S(r[r.length-1],n.is("last")),i.push(u)),ee("div",{class:[n.b(),n.is("background",e.background),n.m(o.value)]},i)}}})),Re=g({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:T([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:T([String,Object,Array])}}),Ye=f({name:"ElStatistic"});const Ve=ne(m(f({...Ye,props:Re,setup(e,{expose:a}){const t=e,l=$("statistic"),n=y(()=>{const{value:e,formatter:a,precision:l,decimalSeparator:n,groupSeparator:s}=t;if(se(a))return a(e);if(!V(e)||Number.isNaN(e))return e;let[i,o=""]=String(e).split(".");return o=o.padEnd(l,"0").slice(0,l>0?l:0),i=i.replace(/\B(?=(\d{3})+(?!\d))/g,s),[i,o].join(o?n:"")});return a({displayValue:n}),(e,a)=>(_(),h("div",{class:O(x(l).b())},[e.$slots.title||e.title?(_(),h("div",{key:0,class:O(x(l).e("head"))},[ie(e.$slots,"title",{},()=>[oe(j(e.title),1)])],2)):H("v-if",!0),A("div",{class:O(x(l).e("content"))},[e.$slots.prefix||e.prefix?(_(),h("div",{key:0,class:O(x(l).e("prefix"))},[ie(e.$slots,"prefix",{},()=>[A("span",null,j(e.prefix),1)])],2)):H("v-if",!0),A("span",{class:O(x(l).e("number")),style:re(e.valueStyle)},j(x(n)),7),e.$slots.suffix||e.suffix?(_(),h("div",{key:1,class:O(x(l).e("suffix"))},[ie(e.$slots,"suffix",{},()=>[A("span",null,j(e.suffix),1)])],2)):H("v-if",!0)],2)],2))}}),[["__file","statistic.vue"]])),Ge=f({name:"ElTimeline",setup(e,{slots:a}){const t=$("timeline");return X("timeline",a),()=>ee("ul",{class:[t.b()]},[ie(a,"default")])}}),Qe=g({timestamp:{type:String,default:""},hideTimestamp:Boolean,center:Boolean,placement:{type:String,values:["top","bottom"],default:"bottom"},type:{type:String,values:["primary","success","warning","danger","info"],default:""},color:{type:String,default:""},size:{type:String,values:["normal","large"],default:"normal"},icon:{type:v},hollow:Boolean}),We=f({name:"ElTimelineItem"});var Xe=m(f({...We,props:Qe,setup(e){const a=e,t=$("timeline-item"),l=y(()=>[t.e("node"),t.em("node",a.size||""),t.em("node",a.type||""),t.is("hollow",a.hollow)]);return(e,a)=>(_(),h("li",{class:O([x(t).b(),{[x(t).e("center")]:e.center}])},[A("div",{class:O(x(t).e("tail"))},null,2),e.$slots.dot?H("v-if",!0):(_(),h("div",{key:0,class:O(x(l)),style:re({backgroundColor:e.color})},[e.icon?(_(),S(x(C),{key:0,class:O(x(t).e("icon"))},{default:k(()=>[(_(),S(P(e.icon)))]),_:1},8,["class"])):H("v-if",!0)],6)),e.$slots.dot?(_(),h("div",{key:1,class:O(x(t).e("dot"))},[ie(e.$slots,"dot")],2)):H("v-if",!0),A("div",{class:O(x(t).e("wrapper"))},[e.hideTimestamp||"top"!==e.placement?H("v-if",!0):(_(),h("div",{key:0,class:O([x(t).e("timestamp"),x(t).is("top")])},j(e.timestamp),3)),A("div",{class:O(x(t).e("content"))},[ie(e.$slots,"default")],2),e.hideTimestamp||"bottom"!==e.placement?H("v-if",!0):(_(),h("div",{key:1,class:O([x(t).e("timestamp"),x(t).is("bottom")])},j(e.timestamp),3))],2)],2))}}),[["__file","timeline-item.vue"]]);const Ze=ne(Ge,{TimelineItem:Xe}),ea=ue(Xe),aa=ce("project",()=>{const e=I(null),a=I([]),t=I(!1),l=I(null),n=I({page:1,pageSize:10,total:0}),s=y(()=>{var a;return(null==(a=e.value)?void 0:a.id)||null}),i=y(()=>{var a;return(null==(a=e.value)?void 0:a.name)||""}),o=y(()=>{var a;return(null==(a=e.value)?void 0:a.project_number)||""}),r=y(()=>{var a;return(null==(a=e.value)?void 0:a.status)||null}),u=y(()=>!!e.value),c=y(()=>a.value.length),p=y(()=>a.value.map(e=>({label:`${e.name} (${e.project_number})`,value:e.id}))),d=y(()=>Math.ceil(n.value.total/n.value.pageSize));function g(a){e.value=a,b()}function v(){e.value=null,localStorage.removeItem("current_project")}async function m(e){t.value=!0,l.value=null,(null==e?void 0:e.page)&&(n.value.page=e.page),(null==e?void 0:e.page_size)&&(n.value.pageSize=e.page_size);try{const e=await _e.getProjects({page:n.value.page,page_size:n.value.pageSize});e.success&&e.data&&(a.value=e.data.items||e.data,n.value.total=e.data.total||a.value.length)}catch(s){l.value=s.message||"获取项目列表失败"}finally{t.value=!1}}async function f(e){t.value=!0,l.value=null;try{const t=await _e.getProject(e);if(t.success&&t.data){const l=a.value.findIndex(a=>a.id===e);return-1!==l&&Object.assign(a.value[l],{name:t.data.name,status:t.data.status,project_number:t.data.project_number}),t.data}return l.value=t.message||"获取项目详情失败",null}catch(n){return l.value=n.message||"获取项目详情失败",null}finally{t.value=!1}}function b(){try{e.value&&localStorage.setItem("current_project",JSON.stringify(e.value))}catch(a){}}return{currentProject:e,projects:a,loading:t,error:l,pagination:n,projectId:s,projectName:i,projectNumber:o,projectStatus:r,hasCurrentProject:u,projectsCount:c,projectsOptions:p,totalPages:d,setCurrentProject:g,setCurrentProjectById:async function(e){t.value=!0,l.value=null;try{const a=await _e.getProject(e);return a.success&&a.data?(g(a.data),!0):(l.value=a.message||"获取项目详情失败",!1)}catch(a){return l.value=a.message||"获取项目详情失败",!1}finally{t.value=!1}},clearCurrentProject:v,fetchProjects:m,fetchProject:f,createProject:async function(e){t.value=!0,l.value=null;try{const t=await _e.createProject(e);return t.success&&t.data?(a.value.unshift(t.data),n.value.total+=1,t.data):(l.value=t.message||"创建项目失败",null)}catch(s){return l.value=s.message||"创建项目失败",null}finally{t.value=!1}},updateProject:async function(n,s){var i;t.value=!0,l.value=null;try{const t=await _e.updateProject(n,s);if(t.success&&t.data){const l=a.value.findIndex(e=>e.id===n);return-1!==l&&Object.assign(a.value[l],t.data),(null==(i=e.value)?void 0:i.id)===n&&(Object.assign(e.value,t.data),b()),!0}return l.value=t.message||"更新项目失败",!1}catch(o){return l.value=o.message||"更新项目失败",!1}finally{t.value=!1}},deleteProject:async function(s){var i;t.value=!0,l.value=null;try{const t=await _e.deleteProject(s);return t.success?(a.value=a.value.filter(e=>e.id!==s),n.value.total=Math.max(0,n.value.total-1),(null==(i=e.value)?void 0:i.id)===s&&v(),!0):(l.value=t.message||"删除项目失败",!1)}catch(o){return l.value=o.message||"删除项目失败",!1}finally{t.value=!1}},refreshCurrentProject:async function(){var a;if(!(null==(a=e.value)?void 0:a.id))return;const t=await f(e.value.id);t&&(e.value=t,b())},setPagination:function(e,a){n.value.page=e,n.value.pageSize=a},nextPage:async function(){n.value.page<d.value&&(n.value.page+=1,await m())},prevPage:async function(){n.value.page>1&&(n.value.page-=1,await m())},restoreFromStorage:function(){try{const a=localStorage.getItem("current_project");a&&(e.value=JSON.parse(a))}catch(a){}},saveToStorage:b,$reset:function(){e.value=null,a.value=[],t.value=!1,l.value=null,n.value={page:1,pageSize:10,total:0},localStorage.removeItem("current_project")}}}),ta=["disabled"],la=e(f({__name:"IconButton",props:{icon:{default:"bi-question-circle"},tooltip:{default:""},tooltipPlacement:{default:"top"},type:{default:"default"},size:{default:"default"},circle:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},badge:{default:""},badgeMax:{default:99},badgeType:{default:"danger"}},emits:["click"],setup(e,{emit:a}){const t=e,l=a,s=y(()=>({[`icon-button--${t.type}`]:!0,[`icon-button--${t.size}`]:!0,"icon-button--circle":t.circle,"is-disabled":t.disabled,"is-loading":t.loading})),i=y(()=>({large:20,default:18,small:16}[t.size])),o=y(()=>({fontSize:`${i.value}px`}));function r(e){t.disabled||t.loading||l("click",e)}return(a,t)=>{const l=C,u=pe,c=n;return _(),S(c,{content:e.tooltip,placement:e.tooltipPlacement,disabled:!e.tooltip},{default:k(()=>[B(u,{value:e.badge,hidden:!e.badge,max:e.badgeMax,type:e.badgeType},{default:k(()=>[A("button",{class:O(["icon-button",s.value]),disabled:e.disabled||e.loading,onClick:r},[e.loading?(_(),S(l,{key:0,class:"is-loading",size:i.value},{default:k(()=>[(_(),S(P(x(de))))]),_:1},8,["size"])):(_(),h("i",{key:1,class:O([e.icon,"icon-button-icon"]),style:re(o.value)},null,6))],10,ta)]),_:1},8,["value","hidden","max","type"])]),_:1},8,["content","placement","disabled"])}}}),[["__scopeId","data-v-628ec5f8"]]),na={class:"dashboard-page"},sa={class:"quick-actions"},ia=["onClick"],oa={class:"action-label"},ra={class:"pagination-wrapper"},ua={class:"activity-content"},ca=e(f({__name:"Dashboard",setup(e){const t=fe(),l=aa(),{success:n,error:d,confirm:g}=ge(),v=I(!1),m=I(!1),f=I(!1),b=I({totalProjects:0,inProgressProjects:0,wonThisMonth:0,pendingTasks:0}),y=I([]),P=I(1),C=I(10),z=I(0),w=I([]),T=[{name:"start-tender",label:"开始投标",icon:"bi bi-play-circle-fill",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",route:"/tender-management"},{name:"business-response",label:"商务应答",icon:"bi bi-briefcase-fill",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",route:"/business-response"},{name:"point-to-point",label:"点对点应答",icon:"bi bi-arrow-left-right",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",route:"/point-to-point"},{name:"tech-proposal",label:"技术方案",icon:"bi bi-file-code-fill",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",route:"/tech-proposal"},{name:"tender-scoring",label:"标书评分",icon:"bi bi-star-fill",color:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",route:"/tender-scoring"},{name:"knowledge",label:"知识中心",icon:"bi bi-book-fill",color:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",route:"/knowledge/company-library"}];async function N(){m.value=!0;try{const e=await _e.getProjects({page:P.value,page_size:C.value});e.success&&e.data&&(Array.isArray(e.data)?(y.value=e.data,z.value=e.data.length):e.data.items&&(y.value=e.data.items,z.value=e.data.total||0))}catch(e){d("加载项目列表失败: "+e.message)}finally{m.value=!1}}async function $(){await N(),n("刷新成功")}function M(){t.push("/tender-management")}function L(e){l.setCurrentProject(e),t.push(`/tender-processing/${e.id}`)}function q(e){C.value=e,P.value=1,N()}function F(e){P.value=e,N()}function U(e){return{pending:"待处理",in_progress:"进行中",completed:"已完成",won:"已中标",lost:"未中标",archived:"已归档"}[e]||e}function H(e){return{document_upload:"bi bi-file-earmark-arrow-up",business_response:"bi bi-briefcase-fill",tech_proposal:"bi bi-file-code-fill",project_won:"bi bi-trophy-fill",project_lost:"bi bi-x-circle-fill"}[e]||"bi bi-circle-fill"}function J(e){return e?p(e).format("YYYY-MM-DD HH:mm"):"-"}return ve(()=>{!async function(){v.value=!0;try{setTimeout(()=>{b.value={totalProjects:156,inProgressProjects:23,wonThisMonth:8,pendingTasks:12},v.value=!1},500)}catch(e){d("加载统计数据失败: "+e.message),v.value=!1}}(),N(),async function(){f.value=!0;try{setTimeout(()=>{w.value=[{id:1,type:"document_upload",description:"上传了招标文档《某市政府采购项目招标文件.pdf》",created_at:new Date(Date.now()-72e5).toISOString()},{id:2,type:"business_response",description:"商务应答文档生成完成",created_at:new Date(Date.now()-18e6).toISOString()},{id:3,type:"tech_proposal",description:"技术方案已提交审核",created_at:new Date(Date.now()-864e5).toISOString()},{id:4,type:"project_won",description:'项目"智慧城市建设项目"中标',created_at:new Date(Date.now()-1728e5).toISOString()}],f.value=!1},300)}catch(e){d("加载活动记录失败: "+e.message),f.value=!1}}()}),(e,p)=>{const I=me,K=Ve,R=c,Y=u,V=s,G=r,Q=a,W=o,X=Ke,Z=ea,ee=Ze;return _(),h("div",na,[B(x(be),{title:"工作台",description:"欢迎使用AI智能标书生成平台"},{actions:k(()=>[B(I,{type:"primary",icon:"Plus",onClick:M},{default:k(()=>[...p[2]||(p[2]=[oe(" 新建项目 ",-1)])]),_:1})]),_:1}),B(Y,{gutter:16,class:"kpi-cards"},{default:k(()=>[B(R,{xs:12,sm:12,md:6,lg:6},{default:k(()=>[B(x(ye),{shadow:"hover",loading:v.value},{default:k(()=>[B(K,{title:"总项目数",value:b.value.totalProjects},{prefix:k(()=>[...p[3]||(p[3]=[A("i",{class:"bi bi-folder-fill statistic-icon",style:{color:"#409eff"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),B(R,{xs:12,sm:12,md:6,lg:6},{default:k(()=>[B(x(ye),{shadow:"hover",loading:v.value},{default:k(()=>[B(K,{title:"进行中项目",value:b.value.inProgressProjects},{prefix:k(()=>[...p[4]||(p[4]=[A("i",{class:"bi bi-clock-fill statistic-icon",style:{color:"#e6a23c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),B(R,{xs:12,sm:12,md:6,lg:6},{default:k(()=>[B(x(ye),{shadow:"hover",loading:v.value},{default:k(()=>[B(K,{title:"本月中标",value:b.value.wonThisMonth},{prefix:k(()=>[...p[5]||(p[5]=[A("i",{class:"bi bi-trophy-fill statistic-icon",style:{color:"#67c23a"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),B(R,{xs:12,sm:12,md:6,lg:6},{default:k(()=>[B(x(ye),{shadow:"hover",loading:v.value},{default:k(()=>[B(K,{title:"待处理任务",value:b.value.pendingTasks},{prefix:k(()=>[...p[6]||(p[6]=[A("i",{class:"bi bi-list-task statistic-icon",style:{color:"#f56c6c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1})]),_:1}),B(x(ye),{title:"快捷入口",class:"quick-actions-card"},{default:k(()=>[A("div",sa,[(_(),h(D,null,E(T,e=>A("div",{key:e.name,class:"action-item",onClick:a=>function(e){t.push(e.route)}(e)},[A("div",{class:"action-icon",style:re({background:e.color})},[A("i",{class:O(e.icon)},null,2)],4),A("div",oa,j(e.label),1)],8,ia)),64))])]),_:1}),B(x(ye),{title:"进行中的项目",class:"projects-card"},{actions:k(()=>[B(x(la),{icon:"bi-arrow-clockwise",tooltip:"刷新",onClick:$})]),default:k(()=>[m.value?(_(),S(x(i),{key:0,visible:!0,fullscreen:!1,text:"加载项目列表..."})):0===y.value.length?(_(),S(x(he),{key:1,type:"no-data",description:"暂无进行中的项目"},{action:k(()=>[B(I,{type:"primary",onClick:M},{default:k(()=>[...p[7]||(p[7]=[oe("创建第一个项目",-1)])]),_:1})]),_:1})):(_(),h(D,{key:2},[B(W,{data:y.value,stripe:"",style:{width:"100%"}},{default:k(()=>[B(G,{prop:"name",label:"项目名称","min-width":"200"},{default:k(({row:e})=>[B(V,{type:"primary",onClick:a=>L(e)},{default:k(()=>[oe(j(e.name),1)]),_:2},1032,["onClick"])]),_:1}),B(G,{prop:"project_number",label:"项目编号",width:"150"}),B(G,{prop:"status",label:"状态",width:"120"},{default:k(({row:e})=>{return[B(Q,{type:(a=e.status,{pending:"info",in_progress:"warning",completed:"success",won:"success",lost:"danger",archived:"info"}[a]||"info")},{default:k(()=>[oe(j(U(e.status)),1)]),_:2},1032,["type"])];var a}),_:1}),B(G,{prop:"company_name",label:"关联企业",width:"200"}),B(G,{prop:"created_at",label:"创建时间",width:"180"},{default:k(({row:e})=>[oe(j(J(e.created_at)),1)]),_:1}),B(G,{label:"操作",width:"200",fixed:"right"},{default:k(({row:e})=>[B(x(la),{icon:"bi-eye",type:"primary",tooltip:"查看详情",onClick:a=>L(e)},null,8,["onClick"]),B(x(la),{icon:"bi-play-circle",type:"success",tooltip:"继续处理",onClick:a=>{return n=e,l.setCurrentProject(n),void t.push(`/tender-processing/${n.id}`);var n}},null,8,["onClick"]),B(x(la),{icon:"bi-archive",type:"warning",tooltip:"归档",onClick:a=>async function(e){if(await g(`确定要归档项目"${e.name}"吗?`,"归档项目","归档后项目将不再显示在进行中列表"))try{await l.updateProject(e.id,{status:"archived"}),n("项目已归档"),await N()}catch(a){d("归档失败: "+a.message)}}(e)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),A("div",ra,[B(X,{"current-page":P.value,"onUpdate:currentPage":p[0]||(p[0]=e=>P.value=e),"page-size":C.value,"onUpdate:pageSize":p[1]||(p[1]=e=>C.value=e),total:z.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:F},null,8,["current-page","page-size","total"])])],64))]),_:1}),B(x(ye),{title:"最近活动",class:"activities-card"},{default:k(()=>[f.value?(_(),S(x(i),{key:0,visible:!0,fullscreen:!1,text:"加载活动记录..."})):0===w.value.length?(_(),S(x(he),{key:1,type:"no-data",description:"暂无活动记录"})):(_(),S(ee,{key:2},{default:k(()=>[(_(!0),h(D,null,E(w.value,e=>{return _(),S(Z,{key:e.id,timestamp:J(e.created_at),type:(a=e.type,{document_upload:"primary",business_response:"success",tech_proposal:"warning",project_won:"success",project_lost:"danger"}[a]||"primary"),placement:"top"},{default:k(()=>[A("div",ua,[A("i",{class:O([H(e.type),"activity-icon"])},null,2),A("span",null,j(e.description),1)])]),_:2},1032,["timestamp","type"]);var a}),128))]),_:1}))]),_:1})])}}}),[["__scopeId","data-v-3261048a"]]);export{ca as default};
