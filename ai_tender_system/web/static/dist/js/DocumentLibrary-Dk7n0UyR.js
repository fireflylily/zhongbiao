import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";/* empty css                    */import{P as t,C as a,E as s}from"./IconButton.vue_vue_type_style_index_0_scoped_628ec5f8_lang-BLOjLzl-.js";import{af as l,an as o,ar as i,m as n,n as r,bU as u,au as c,_ as d,d as p,K as f,v,bJ as m,r as y,x as g,B as h,o as b,w as k,c as _,C as w,a8 as x,aC as F,j as R,F as S,I as E,a3 as T,e as $,h as C,g as L,H as U,c7 as B,t as j,D as P,c8 as D,c9 as O,ca as z,cb as A,cc as M,cd as q,N as H,aV as I,b4 as K,aJ as J,ce as N,aS as X,cf as W,A as G,ax as Q,S as V,M as Y,W as Z,a4 as ee,Q as te,J as ae,cg as se,k as le,l as oe,aB as ie,a as ne}from"./index.js";import{E as re}from"./index-B7TJi9dg.js";import{e as ue}from"./_baseClone-DZGxnlWo.js";/* empty css                   */import"./el-tag-CIDvEaT7.js";function ce(e){return ue(e,5)}const de=Symbol("uploadContextKey");class pe extends Error{constructor(e,t,a,s){super(e),this.name="UploadAjaxError",this.status=t,this.method=a,this.url=s}}function fe(e,t,a){let s;return s=a.response?`${a.response.error||a.response}`:a.responseText?`${a.responseText}`:`fail to ${t.method} ${e} ${a.status}`,new pe(s,a.status,t.method,e)}const ve=["text","picture","picture-card"];let me=1;const ye=()=>Date.now()+me++,ge=n({action:{type:String,default:"#"},headers:{type:r(Object)},method:{type:String,default:"post"},data:{type:r([Object,Function,Promise]),default:()=>c({})},multiple:Boolean,name:{type:String,default:"file"},drag:Boolean,withCredentials:Boolean,showFileList:{type:Boolean,default:!0},accept:{type:String,default:""},fileList:{type:r(Array),default:()=>c([])},autoUpload:{type:Boolean,default:!0},listType:{type:String,values:ve,default:"text"},httpRequest:{type:r(Function),default:e=>{"undefined"==typeof XMLHttpRequest&&l("ElUpload","XMLHttpRequest is undefined");const t=new XMLHttpRequest,a=e.action;t.upload&&t.upload.addEventListener("progress",t=>{const a=t;a.percent=t.total>0?t.loaded/t.total*100:0,e.onProgress(a)});const s=new FormData;if(e.data)for(const[l,i]of Object.entries(e.data))o(i)&&i.length?s.append(l,...i):s.append(l,i);s.append(e.filename,e.file,e.file.name),t.addEventListener("error",()=>{e.onError(fe(a,e,t))}),t.addEventListener("load",()=>{if(t.status<200||t.status>=300)return e.onError(fe(a,e,t));e.onSuccess(function(e){const t=e.responseText||e.response;if(!t)return t;try{return JSON.parse(t)}catch(a){return t}}(t))}),t.open(e.method,a,!0),e.withCredentials&&"withCredentials"in t&&(t.withCredentials=!0);const n=e.headers||{};if(n instanceof Headers)n.forEach((e,a)=>t.setRequestHeader(a,e));else for(const[l,o]of Object.entries(n))i(o)||t.setRequestHeader(l,String(o));return t.send(s),t}},disabled:Boolean,limit:Number}),he=n({...ge,beforeUpload:{type:r(Function),default:u},beforeRemove:{type:r(Function)},onRemove:{type:r(Function),default:u},onChange:{type:r(Function),default:u},onPreview:{type:r(Function),default:u},onSuccess:{type:r(Function),default:u},onProgress:{type:r(Function),default:u},onError:{type:r(Function),default:u},onExceed:{type:r(Function),default:u},crossorigin:{type:r(String)}}),be=n({files:{type:r(Array),default:()=>c([])},disabled:Boolean,handlePreview:{type:r(Function),default:u},listType:{type:String,values:ve,default:"text"},crossorigin:{type:r(String)}}),ke=p({name:"ElUploadList"});var _e=d(p({...ke,props:be,emits:{remove:e=>!!e},setup(e,{emit:t}){const a=e,{t:s}=f(),l=v("upload"),o=v("icon"),i=v("list"),n=m(),r=y(!1),u=g(()=>[l.b("list"),l.bm("list",a.listType),l.is("disabled",a.disabled)]),c=e=>{t("remove",e)};return(e,t)=>(b(),h(q,{tag:"ul",class:E(S(u)),name:S(i).b()},{default:k(()=>[(b(!0),_(x,null,F(e.files,(t,a)=>(b(),_("li",{key:t.uid||t.name,class:E([S(l).be("list","item"),S(l).is(t.status),{focusing:r.value}]),tabindex:"0",onKeydown:R(e=>!S(n)&&c(t),["delete"]),onFocus:e=>r.value=!0,onBlur:e=>r.value=!1,onClick:e=>r.value=!1},[w(e.$slots,"default",{file:t,index:a},()=>["picture"===e.listType||"uploading"!==t.status&&"picture-card"===e.listType?(b(),_("img",{key:0,class:E(S(l).be("list","item-thumbnail")),src:t.url,crossorigin:e.crossorigin,alt:""},null,10,["src","crossorigin"])):T("v-if",!0),"uploading"===t.status||"picture-card"!==e.listType?(b(),_("div",{key:1,class:E(S(l).be("list","item-info"))},[$("a",{class:E(S(l).be("list","item-name")),onClick:C(a=>e.handlePreview(t),["prevent"])},[L(S(U),{class:E(S(o).m("document"))},{default:k(()=>[L(S(B))]),_:1},8,["class"]),$("span",{class:E(S(l).be("list","item-file-name")),title:t.name},j(t.name),11,["title"])],10,["onClick"]),"uploading"===t.status?(b(),h(S(re),{key:0,type:"picture-card"===e.listType?"circle":"line","stroke-width":"picture-card"===e.listType?6:2,percentage:Number(t.percentage),style:P("picture-card"===e.listType?"":"margin-top: 0.5rem")},null,8,["type","stroke-width","percentage","style"])):T("v-if",!0)],2)):T("v-if",!0),$("label",{class:E(S(l).be("list","item-status-label"))},["text"===e.listType?(b(),h(S(U),{key:0,class:E([S(o).m("upload-success"),S(o).m("circle-check")])},{default:k(()=>[L(S(D))]),_:1},8,["class"])):["picture-card","picture"].includes(e.listType)?(b(),h(S(U),{key:1,class:E([S(o).m("upload-success"),S(o).m("check")])},{default:k(()=>[L(S(O))]),_:1},8,["class"])):T("v-if",!0)],2),S(n)?T("v-if",!0):(b(),h(S(U),{key:2,class:E(S(o).m("close")),onClick:e=>c(t)},{default:k(()=>[L(S(z))]),_:2},1032,["class","onClick"])),T(" Due to close btn only appears when li gets focused disappears after li gets blurred, thus keyboard navigation can never reach close btn"),T(" This is a bug which needs to be fixed "),T(" TODO: Fix the incorrect navigation interaction "),S(n)?T("v-if",!0):(b(),_("i",{key:3,class:E(S(o).m("close-tip"))},j(S(s)("el.upload.deleteTip")),3)),"picture-card"===e.listType?(b(),_("span",{key:4,class:E(S(l).be("list","item-actions"))},[$("span",{class:E(S(l).be("list","item-preview")),onClick:a=>e.handlePreview(t)},[L(S(U),{class:E(S(o).m("zoom-in"))},{default:k(()=>[L(S(A))]),_:1},8,["class"])],10,["onClick"]),S(n)?T("v-if",!0):(b(),_("span",{key:0,class:E(S(l).be("list","item-delete")),onClick:e=>c(t)},[L(S(U),{class:E(S(o).m("delete"))},{default:k(()=>[L(S(M))]),_:1},8,["class"])],10,["onClick"]))],2)):T("v-if",!0)])],42,["onKeydown","onFocus","onBlur","onClick"]))),128)),w(e.$slots,"append")]),_:3},8,["class","name"]))}}),[["__file","upload-list.vue"]]);const we=n({disabled:Boolean}),xe={file:e=>o(e)},Fe="ElUploadDrag",Re=p({name:Fe});var Se=d(p({...Re,props:we,emits:xe,setup(e,{emit:t}){H(de)||l(Fe,"usage: <el-upload><el-upload-dragger /></el-upload>");const a=v("upload"),s=y(!1),o=m(),i=e=>{if(o.value)return;s.value=!1,e.stopPropagation();const a=Array.from(e.dataTransfer.files),l=e.dataTransfer.items||[];a.forEach((e,t)=>{var a;const s=l[t],o=null==(a=null==s?void 0:s.webkitGetAsEntry)?void 0:a.call(s);o&&(e.isDirectory=o.isDirectory)}),t("file",a)},n=()=>{o.value||(s.value=!0)},r=e=>{e.currentTarget.contains(e.relatedTarget)||(s.value=!1)};return(e,t)=>(b(),_("div",{class:E([S(a).b("dragger"),S(a).is("dragover",s.value)]),onDrop:C(i,["prevent"]),onDragover:C(n,["prevent"]),onDragleave:C(r,["prevent"])},[w(e.$slots,"default")],42,["onDrop","onDragover","onDragleave"]))}}),[["__file","upload-dragger.vue"]]);const Ee=n({...ge,beforeUpload:{type:r(Function),default:u},onRemove:{type:r(Function),default:u},onStart:{type:r(Function),default:u},onSuccess:{type:r(Function),default:u},onProgress:{type:r(Function),default:u},onError:{type:r(Function),default:u},onExceed:{type:r(Function),default:u}}),Te=p({name:"ElUploadContent",inheritAttrs:!1});var $e=d(p({...Te,props:Ee,setup(e,{expose:t}){const a=e,s=v("upload"),l=m(),o=I({}),i=I(),n=e=>{if(0===e.length)return;const{autoUpload:t,limit:s,fileList:l,multiple:o,onStart:i,onExceed:n}=a;if(s&&l.length+e.length>s)n(e,l);else{o||(e=e.slice(0,1));for(const a of e){const e=a;e.uid=ye(),i(e),t&&r(e)}}},r=async e=>{if(i.value.value="",!a.beforeUpload)return u(e);let t,s={};try{const l=a.data,o=a.beforeUpload(e);s=K(a.data)?ce(a.data):a.data,t=await o,K(a.data)&&J(l,s)&&(s=ce(a.data))}catch(o){t=!1}if(!1===t)return void a.onRemove(e);let l=e;t instanceof Blob&&(l=t instanceof File?t:new File([t],e.name,{type:e.type})),u(Object.assign(l,{uid:e.uid}),s)},u=async(e,t)=>{const{headers:s,data:l,method:i,withCredentials:n,name:r,action:u,onProgress:c,onSuccess:d,onError:p,httpRequest:f}=a;try{t=await(async(e,t)=>X(e)?e(t):e)(null!=t?t:l,e)}catch(g){return void a.onRemove(e)}const{uid:v}=e,m={headers:s||{},withCredentials:n,file:e,data:t,method:i,filename:r,action:u,onProgress:t=>{c(t,e)},onSuccess:t=>{d(t,e),delete o.value[v]},onError:t=>{p(t,e),delete o.value[v]}},y=f(m);o.value[v]=y,y instanceof Promise&&y.then(m.onSuccess,m.onError)},c=e=>{const t=e.target.files;t&&n(Array.from(t))},d=()=>{l.value||(i.value.value="",i.value.click())},p=()=>{d()};return t({abort:e=>{N(o.value).filter(e?([t])=>String(e.uid)===t:()=>!0).forEach(([e,t])=>{t instanceof XMLHttpRequest&&t.abort(),delete o.value[e]})},upload:r}),(e,t)=>(b(),_("div",{class:E([S(s).b(),S(s).m(e.listType),S(s).is("drag",e.drag),S(s).is("disabled",S(l))]),tabindex:S(l)?"-1":"0",onClick:d,onKeydown:R(C(p,["self"]),["enter","space"])},[e.drag?(b(),h(Se,{key:0,disabled:S(l),onFile:n},{default:k(()=>[w(e.$slots,"default")]),_:3},8,["disabled"])):w(e.$slots,"default",{key:1}),$("input",{ref_key:"inputRef",ref:i,class:E(S(s).e("input")),name:e.name,disabled:S(l),multiple:e.multiple,accept:e.accept,type:"file",onChange:c,onClick:C(()=>{},["stop"])},null,42,["name","disabled","multiple","accept","onClick"])],42,["tabindex","onKeydown"]))}}),[["__file","upload-content.vue"]]);const Ce="ElUpload",Le=e=>{var t;(null==(t=e.url)?void 0:t.startsWith("blob:"))&&URL.revokeObjectURL(e.url)},Ue=p({name:"ElUpload"});const Be=ae(d(p({...Ue,props:he,setup(e,{expose:t}){const a=e,s=m(),o=I(),{abort:n,submit:r,clearFiles:u,uploadFiles:c,handleStart:d,handleError:p,handleRemove:f,handleSuccess:v,handleProgress:y,revokeFileObjectURL:x}=((e,t)=>{const a=W(e,"fileList",void 0,{passive:!0}),s=e=>a.value.find(t=>t.uid===e.uid);function o(e){var a;null==(a=t.value)||a.abort(e)}function n(e){a.value=a.value.filter(t=>t.uid!==e.uid)}return G(()=>e.listType,t=>{"picture-card"!==t&&"picture"!==t||(a.value=a.value.map(t=>{const{raw:s,url:l}=t;if(!l&&s)try{t.url=URL.createObjectURL(s)}catch(o){e.onError(o,t,a.value)}return t}))}),G(a,e=>{for(const t of e)t.uid||(t.uid=ye()),t.status||(t.status="success")},{immediate:!0,deep:!0}),{uploadFiles:a,abort:o,clearFiles:function(e=["ready","uploading","success","fail"]){a.value=a.value.filter(t=>!e.includes(t.status))},handleError:(t,l)=>{const o=s(l);o&&(o.status="fail",n(o),e.onError(t,o,a.value),e.onChange(o,a.value))},handleProgress:(t,l)=>{const o=s(l);o&&(e.onProgress(t,o,a.value),o.status="uploading",o.percentage=Math.round(t.percent))},handleStart:t=>{i(t.uid)&&(t.uid=ye());const s={name:t.name,percentage:0,status:"ready",size:t.size,raw:t,uid:t.uid};if("picture-card"===e.listType||"picture"===e.listType)try{s.url=URL.createObjectURL(t)}catch(l){Q(Ce,l.message),e.onError(l,s,a.value)}a.value=[...a.value,s],e.onChange(s,a.value)},handleSuccess:(t,l)=>{const o=s(l);o&&(o.status="success",o.response=t,e.onSuccess(t,o,a.value),e.onChange(o,a.value))},handleRemove:async t=>{const i=t instanceof File?s(t):t;i||l(Ce,"file to be removed not found");const r=t=>{o(t),n(t),e.onRemove(t,a.value),Le(t)};e.beforeRemove?!1!==await e.beforeRemove(i,a.value)&&r(i):r(i)},submit:function(){a.value.filter(({status:e})=>"ready"===e).forEach(({raw:e})=>{var a;return e&&(null==(a=t.value)?void 0:a.upload(e))})},revokeFileObjectURL:Le}})(a,o),F=g(()=>"picture-card"===a.listType),R=g(()=>({...a,fileList:c.value,onStart:d,onProgress:y,onSuccess:v,onError:p,onRemove:f}));return V(()=>{c.value.forEach(x)}),Y(de,{accept:Z(a,"accept")}),t({abort:n,submit:r,clearFiles:u,handleStart:d,handleRemove:f}),(e,t)=>(b(),_("div",null,[S(F)&&e.showFileList?(b(),h(_e,{key:0,disabled:S(s),"list-type":e.listType,files:S(c),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:S(f)},ee({append:k(()=>[L($e,te({ref_key:"uploadRef",ref:o},S(R)),{default:k(()=>[e.$slots.trigger?w(e.$slots,"trigger",{key:0}):T("v-if",!0),!e.$slots.trigger&&e.$slots.default?w(e.$slots,"default",{key:1}):T("v-if",!0)]),_:3},16)]),_:2},[e.$slots.file?{name:"default",fn:k(({file:t,index:a})=>[w(e.$slots,"file",{file:t,index:a})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):T("v-if",!0),!S(F)||S(F)&&!e.showFileList?(b(),h($e,te({key:1,ref_key:"uploadRef",ref:o},S(R)),{default:k(()=>[e.$slots.trigger?w(e.$slots,"trigger",{key:0}):T("v-if",!0),!e.$slots.trigger&&e.$slots.default?w(e.$slots,"default",{key:1}):T("v-if",!0)]),_:3},16)):T("v-if",!0),e.$slots.trigger?w(e.$slots,"default",{key:2}):T("v-if",!0),w(e.$slots,"tip"),!S(F)&&e.showFileList?(b(),h(_e,{key:3,disabled:S(s),"list-type":e.listType,files:S(c),crossorigin:e.crossorigin,"handle-preview":e.onPreview,onRemove:S(f)},ee({_:2},[e.$slots.file?{name:"default",fn:k(({file:t,index:a})=>[w(e.$slots,"file",{file:t,index:a})])}:void 0]),1032,["disabled","list-type","files","crossorigin","handle-preview","onRemove"])):T("v-if",!0)]))}}),[["__file","upload.vue"]])),je={class:"upload-button"},Pe={key:1,class:"upload-drag-area"},De={class:"drag-text"},Oe={class:"drag-hint"},ze={class:"upload-tip"},Ae={key:0,class:"upload-progress"},Me=e(p({__name:"UploadButton",props:{action:{default:"/api/upload"},headers:{default:()=>({})},data:{default:()=>({})},multiple:{type:Boolean,default:!1},accept:{default:"*"},limit:{default:1},maxSize:{default:100},buttonText:{default:"上传文件"},buttonType:{default:"primary"},buttonIcon:{default:se},tip:{default:""},showFileList:{type:Boolean,default:!0},showProgress:{type:Boolean,default:!0},drag:{type:Boolean,default:!1},autoUpload:{type:Boolean,default:!0}},emits:["success","error","progress","remove","exceed"],setup(e,{expose:t,emit:a}){const s=e,l=a,o=y(),i=y([]),n=y(!1),r=y(0),u=g(()=>{if(s.tip)return s.tip;const e=[];return s.accept&&"*"!==s.accept&&e.push(`支持${s.accept}格式`),s.maxSize&&e.push(`大小不超过${s.maxSize}MB`),e.join("，")});function c(e){if(s.maxSize){if(!(e.size/1024/1024<s.maxSize))return ie.error(`文件大小不能超过 ${s.maxSize}MB!`),!1}if(s.accept&&"*"!==s.accept){const t=s.accept.split(",").map(e=>e.trim()),a=e.name.substring(e.name.lastIndexOf("."));if(!t.some(t=>t===a||t===e.type))return ie.error(`只支持 ${s.accept} 格式的文件！`),!1}return n.value=!0,r.value=0,!0}function d(e,t){n.value=!1,r.value=100,setTimeout(()=>{r.value=0},1e3),ie.success("上传成功"),l("success",e,t)}function p(e,t){n.value=!1,r.value=0,ie.error("上传失败: "+e.message),l("error",e,t)}function f(e,t){r.value=Math.round(e.percent),l("progress",e,t)}function v(e){ie.warning(`最多只能上传 ${s.limit} 个文件！`),l("exceed",e)}function m(e){l("remove",e)}return t({clearFiles:function(){var e;null==(e=o.value)||e.clearFiles()},submit:function(){var e;null==(e=o.value)||e.submit()}}),(t,a)=>{const s=oe,l=Be,y=re;return b(),_("div",je,[L(l,{ref_key:"uploadRef",ref:o,action:e.action,headers:e.headers,data:e.data,multiple:e.multiple,accept:e.accept,limit:e.limit,"file-list":i.value,"before-upload":c,"on-success":d,"on-error":p,"on-progress":f,"on-exceed":v,"on-remove":m,"show-file-list":e.showFileList,drag:e.drag,"auto-upload":e.autoUpload},ee({default:k(()=>[e.drag?(b(),_("div",Pe,[a[1]||(a[1]=$("i",{class:"bi bi-cloud-upload drag-icon"},null,-1)),$("div",De,[a[0]||(a[0]=$("p",{class:"drag-title"},[le("拖拽文件到此处或"),$("em",null,"点击上传")],-1)),$("p",Oe,j(u.value),1)])])):(b(),h(s,{key:0,type:e.buttonType,icon:e.buttonIcon,loading:n.value},{default:k(()=>[le(j(e.buttonText),1)]),_:1},8,["type","icon","loading"]))]),_:2},[e.tip&&!e.drag?{name:"tip",fn:k(()=>[$("div",ze,j(e.tip),1)]),key:"0"}:void 0]),1032,["action","headers","data","multiple","accept","limit","file-list","show-file-list","drag","auto-upload"]),e.showProgress&&r.value>0&&r.value<100?(b(),_("div",Ae,[L(y,{percentage:r.value,"stroke-width":6},null,8,["percentage"])])):T("",!0)])}}}),[["__scopeId","data-v-7e6c62a3"]]),qe={class:"document-library"},He=e(p({__name:"DocumentLibrary",setup(e){const{success:l}=ne(),o=e=>{l("上传文档",`已选择文件: ${e.name}`)};return(e,l)=>{const i=oe;return b(),_("div",qe,[L(S(t),{title:"文档库",description:"管理企业知识文档"},{actions:k(()=>[L(S(Me),{"auto-upload":!1,accept:".pdf,.doc,.docx",onChange:o},{default:k(()=>[L(i,{type:"primary",icon:"Upload"},{default:k(()=>[...l[0]||(l[0]=[le("上传文档",-1)])]),_:1})]),_:1})]),_:1}),L(S(a),{title:"文档列表"},{default:k(()=>[L(S(s),{type:"no-data",description:"暂无文档数据"})]),_:1})])}}}),[["__scopeId","data-v-affe32a7"]]);export{He as default};
