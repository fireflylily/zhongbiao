import{aA as e,T as a,aE as l,aD as t,aC as o,aF as n,a6 as i,aG as s,bb as r,aL as u,aN as d,_ as c,u as p,aR as v,aH as m,aP as f,aO as g,ax as h,b2 as y,$ as w,w as b,O as _,e as x,s as V,d as k,Q as j,R as S,bY as F,bJ as C,F as E,D as M,y as I,J as P,i as B,q as D}from"./index.js";/* empty css                   *//* empty css                                                        *//* empty css                             *//* empty css                    *//* empty css                     *//* empty css               */import{E as T}from"./el-tree-Bn3igbCZ.js";import"./el-text-BBUgZhzi.js";/* empty css                                                                          *//* empty css                */import{E as z}from"./el-input-number-2mbv5o4I.js";import{E as $,a as N}from"./el-select-DZeK41OH.js";import{bH as L,cj as U,bQ as O,an as A,ao as X,ap as Y,aF as R,am as W,bu as q,bA as H,au as J,ar as K,ax as G,as as Q,aw as Z,aB as ee,ay as ae,aC as le,aT as te,bC as oe,bB as ne,c9 as ie,aX as se,bR as re,aq as ue,av as de,az as ce,aA as pe,aV as ve,aD as me,at as fe,aW as ge}from"./editor-CkQC1Uq_.js";/* empty css                */import{S as he}from"./SSEStreamViewer-o_lAL5yg.js";import{D as ye}from"./DocumentUploader-Cp0a7KJm.js";import{_ as we}from"./DocumentPreview.vue_vue_type_script_setup_true_lang-vqvsu1-m.js";import{R as be}from"./RichTextEditor-lCTUu7yA.js";import{u as _e,S as xe,d as Ve}from"./helpers-xdhHlSij.js";/* empty css                */import{t as ke}from"./tender-DY5X_q7i.js";import{u as je}from"./useProjectDocuments-C6DN99-z.js";import{d as Se}from"./index-C1LY3n9p.js";import{c as Fe}from"./clamp-HmQ8FArD.js";import{a as Ce,E as Ee}from"./index-lVhqCxeU.js";import{E as Me}from"./index-CPjPqG6g.js";import{E as Ie}from"./index-DzllSHb7.js";import{a as Pe,E as Be}from"./index-MMbAUZZE.js";import{E as De}from"./index-Jdk3-L3D.js";import{E as Te,a as ze}from"./index-Ct_FIOsr.js";import{v as $e}from"./directive-BoVrmPHi.js";import{E as Ne}from"./index-CwbKUXgF.js";import"./index-DE7eCqN4.js";import"./index-B_fegSBy.js";import"./index-DO7-lxyV.js";import"./strings-DygAwr0H.js";import"./_baseFindIndex-BTqrMG7V.js";import"./_baseIteratee-CwtmDzoV.js";import"./imageCompressor-CTkRt5bg.js";import"./index-ZlCuKr4C.js";import"./cloneDeep-syPWYH98.js";import"./index-Dk4OhDm6.js";import"./index-CwhopI9-.js";import"./project-77ADDdE9.js";import"./toNumber-B_atpBHU.js";import"./flatMap-D7uPVDtS.js";import"./map-B_SlaKiF.js";import"./_baseEach-V8knk74i.js";import"./raf-BZHcGSIv.js";const Le=Symbol("sliderContextKey"),Ue=a({modelValue:{type:i([Number,Array]),default:0},id:{type:String,default:void 0},min:{type:Number,default:0},max:{type:Number,default:100},step:{type:Number,default:1},showInput:Boolean,showInputControls:{type:Boolean,default:!0},size:s,inputSize:s,showStops:Boolean,showTooltip:{type:Boolean,default:!0},formatTooltip:{type:i(Function),default:void 0},disabled:Boolean,range:Boolean,vertical:Boolean,height:String,rangeStartLabel:{type:String,default:void 0},rangeEndLabel:{type:String,default:void 0},formatValueText:{type:i(Function),default:void 0},tooltipClass:{type:String,default:void 0},placement:{type:String,values:U,default:"top"},marks:{type:i(Object)},validateEvent:{type:Boolean,default:!0},persistent:{type:Boolean,default:!0},...n(["ariaLabel"])}),Oe=a=>e(a)||L(a)&&a.every(e),Ae={[o]:Oe,[t]:Oe,[l]:Oe},Xe=a({modelValue:{type:Number,default:0},vertical:Boolean,tooltipClass:String,placement:{type:String,values:U,default:"top"}}),Ye={[o]:a=>e(a)},Re=(e,a,l)=>{const{disabled:t,min:n,max:i,step:s,showTooltip:c,persistent:p,precision:v,sliderSize:m,formatTooltip:f,emitChange:g,resetSize:h,updateDragging:y}=O(Le),{tooltip:w,tooltipVisible:b,formatValue:_,displayTooltip:x,hideTooltip:V}=((e,a,l)=>{const t=A(),o=A(!1),n=X(()=>a.value instanceof Function),i=X(()=>n.value&&a.value(e.modelValue)||e.modelValue),s=Se(()=>{l.value&&(o.value=!0)},50),r=Se(()=>{l.value&&(o.value=!1)},50);return{tooltip:t,tooltipVisible:o,formatValue:i,displayTooltip:s,hideTooltip:r}})(e,f,c),k=A(),j=X(()=>(e.modelValue-n.value)/(i.value-n.value)*100+"%"),S=X(()=>e.vertical?{bottom:j.value}:{left:j.value}),F=e=>{t.value||(e.preventDefault(),M(e),window.addEventListener("mousemove",I),window.addEventListener("touchmove",I),window.addEventListener("mouseup",P),window.addEventListener("touchend",P),window.addEventListener("contextmenu",P),k.value.focus())},C=e=>{t.value||(a.newPosition=Number.parseFloat(j.value)+e/(i.value-n.value)*100,B(a.newPosition),g())},E=e=>{let a,l;return e.type.startsWith("touch")?(l=e.touches[0].clientY,a=e.touches[0].clientX):(l=e.clientY,a=e.clientX),{clientX:a,clientY:l}},M=l=>{a.dragging=!0,a.isClick=!0;const{clientX:t,clientY:o}=E(l);e.vertical?a.startY=o:a.startX=t,a.startPosition=Number.parseFloat(j.value),a.newPosition=a.startPosition},I=l=>{if(a.dragging){let t;a.isClick=!1,x(),h();const{clientX:o,clientY:n}=E(l);e.vertical?(a.currentY=n,t=(a.startY-a.currentY)/m.value*100):(a.currentX=o,t=(a.currentX-a.startX)/m.value*100),a.newPosition=a.startPosition+t,B(a.newPosition)}},P=()=>{a.dragging&&(setTimeout(()=>{a.dragging=!1,a.hovering||V(),a.isClick||B(a.newPosition),g()},0),window.removeEventListener("mousemove",I),window.removeEventListener("touchmove",I),window.removeEventListener("mouseup",P),window.removeEventListener("touchend",P),window.removeEventListener("contextmenu",P))},B=async t=>{if(null===t||Number.isNaN(+t))return;t=Fe(t,0,100);const r=Math.floor((i.value-n.value)/s.value),u=r*s.value/(i.value-n.value)*100,d=u+(100-u)/2;let c;if(t<u){const e=u/r,a=Math.round(t/e);c=n.value+a*s.value}else c=t<d?n.value+r*s.value:i.value;c=Number.parseFloat(c.toFixed(v.value)),c!==e.modelValue&&l(o,c),a.dragging||e.modelValue===a.oldValue||(a.oldValue=e.modelValue),await R(),a.dragging&&x(),w.value.updatePopper()};return Y(()=>a.dragging,e=>{y(e)}),r(k,"touchstart",F,{passive:!1}),{disabled:t,button:k,tooltip:w,tooltipVisible:b,showTooltip:c,persistent:p,wrapperStyle:S,formatValue:_,handleMouseEnter:()=>{a.hovering=!0,x()},handleMouseLeave:()=>{a.hovering=!1,a.dragging||V()},onButtonDown:F,onKeyDown:e=>{let a=!0;switch(u(e)){case d.left:case d.down:C(-s.value);break;case d.right:case d.up:C(s.value);break;case d.home:t.value||(B(0),g());break;case d.end:t.value||(B(100),g());break;case d.pageDown:C(4*-s.value);break;case d.pageUp:C(4*s.value);break;default:a=!1}a&&e.preventDefault()},setPosition:B}},We=W({name:"ElSliderButton"});var qe=c(W({...We,props:Xe,emits:Ye,setup(e,{expose:a,emit:l}){const t=e,o=p("slider"),n=q({hovering:!1,dragging:!1,isClick:!1,startX:0,currentX:0,startY:0,currentY:0,startPosition:0,newPosition:0,oldValue:t.modelValue}),i=X(()=>!!d.value&&c.value),{disabled:s,button:r,tooltip:u,showTooltip:d,persistent:c,tooltipVisible:m,wrapperStyle:f,formatValue:g,handleMouseEnter:h,handleMouseLeave:y,onButtonDown:w,onKeyDown:b,setPosition:_}=Re(t,n,l),{hovering:x,dragging:V}=H(n);return a({onButtonDown:w,onKeyDown:b,setPosition:_,hovering:x,dragging:V}),(e,a)=>(K(),J("div",{ref_key:"button",ref:r,class:ee([ae(o).e("button-wrapper"),{hover:ae(x),dragging:ae(V)}]),style:te(ae(f)),tabindex:ae(s)?-1:0,onMouseenter:ae(h),onMouseleave:ae(y),onMousedown:ae(w),onFocus:ae(h),onBlur:ae(y),onKeydown:ae(b)},[G(ae(v),{ref_key:"tooltip",ref:u,visible:ae(m),placement:e.placement,"fallback-placements":["top","bottom","right","left"],"stop-popper-mouse-event":!1,"popper-class":e.tooltipClass,disabled:!ae(d),persistent:ae(i)},{content:Q(()=>[Z("span",null,le(ae(g)),1)]),default:Q(()=>[Z("div",{class:ee([ae(o).e("button"),{hover:ae(x),dragging:ae(V)}])},null,2)]),_:1},8,["visible","placement","popper-class","disabled","persistent"])],46,["tabindex","onMouseenter","onMouseleave","onMousedown","onFocus","onBlur","onKeydown"]))}}),[["__file","button.vue"]]);var He=W({name:"ElSliderMarker",props:a({mark:{type:i([String,Object]),default:void 0}}),setup(e){const a=p("slider"),l=X(()=>oe(e.mark)?e.mark:e.mark.label),t=X(()=>oe(e.mark)?void 0:e.mark.style);return()=>ne("div",{class:a.e("marks-text"),style:t.value},l.value)}});const Je=(e,a,n)=>{const{form:i,formItem:s}=m(),r=ie(),u=A(),d=A(),c={firstButton:u,secondButton:d},p=X(()=>e.disabled||(null==i?void 0:i.disabled)||!1),v=X(()=>Math.min(a.firstValue,a.secondValue)),f=X(()=>Math.max(a.firstValue,a.secondValue)),g=X(()=>e.range?100*(f.value-v.value)/(e.max-e.min)+"%":100*(a.firstValue-e.min)/(e.max-e.min)+"%"),h=X(()=>e.range?100*(v.value-e.min)/(e.max-e.min)+"%":"0%"),y=X(()=>e.vertical?{height:e.height}:{}),w=X(()=>e.vertical?{height:g.value,bottom:h.value}:{width:g.value,left:h.value}),b=()=>{if(r.value){const l=r.value.getBoundingClientRect();a.sliderSize=l[e.vertical?"height":"width"]}},_=l=>{const t=(l=>{const t=e.min+l*(e.max-e.min)/100;if(!e.range)return u;let o;return o=Math.abs(v.value-t)<Math.abs(f.value-t)?a.firstValue<a.secondValue?"firstButton":"secondButton":a.firstValue>a.secondValue?"firstButton":"secondButton",c[o]})(l);return t.value.setPosition(l),t},x=e=>{n(o,e),n(t,e)},V=async()=>{await R(),n(l,e.range?[v.value,f.value]:e.modelValue)},k=l=>{var t,o,n,i,s,u;if(p.value||a.dragging)return;b();let d=0;if(e.vertical){const e=null!=(n=null==(o=null==(t=l.touches)?void 0:t.item(0))?void 0:o.clientY)?n:l.clientY;d=(r.value.getBoundingClientRect().bottom-e)/a.sliderSize*100}else{d=((null!=(u=null==(s=null==(i=l.touches)?void 0:i.item(0))?void 0:s.clientX)?u:l.clientX)-r.value.getBoundingClientRect().left)/a.sliderSize*100}return d<0||d>100?void 0:_(d)};return{elFormItem:s,slider:r,firstButton:u,secondButton:d,sliderDisabled:p,minValue:v,maxValue:f,runwayStyle:y,barStyle:w,resetSize:b,setPosition:_,emitChange:V,onSliderWrapperPrevent:e=>{var a,l;((null==(a=c.firstButton.value)?void 0:a.dragging)||(null==(l=c.secondButton.value)?void 0:l.dragging))&&e.preventDefault()},onSliderClick:e=>{k(e)&&V()},onSliderDown:async e=>{const a=k(e);a&&(await R(),a.value.onButtonDown(e))},onSliderMarkerDown:e=>{if(p.value||a.dragging)return;_(e)&&V()},setFirstValue:l=>{a.firstValue=null!=l?l:e.min,x(e.range?[v.value,f.value]:null!=l?l:e.min)},setSecondValue:l=>{a.secondValue=l,e.range&&x([v.value,f.value])}}},Ke=W({name:"ElSlider"});const Ge=b(c(W({...Ke,props:Ue,emits:Ae,setup(a,{expose:l,emit:n}){const i=a,s=p("slider"),{t:u}=h(),d=q({firstValue:0,secondValue:0,oldValue:0,dragging:!1,sliderSize:1}),{elFormItem:c,slider:v,firstButton:m,secondButton:b,sliderDisabled:_,minValue:x,maxValue:V,runwayStyle:k,barStyle:j,resetSize:S,emitChange:F,onSliderWrapperPrevent:C,onSliderClick:E,onSliderDown:M,onSliderMarkerDown:I,setFirstValue:P,setSecondValue:B}=Je(i,d,n),{stops:D,getStopStyle:T}=((e,a,l,t)=>({stops:X(()=>{if(!e.showStops||e.min>e.max)return[];if(0===e.step)return[];const o=Math.ceil((e.max-e.min)/e.step),n=100*e.step/(e.max-e.min),i=Array.from({length:o-1}).map((e,a)=>(a+1)*n);return e.range?i.filter(a=>a<100*(l.value-e.min)/(e.max-e.min)||a>100*(t.value-e.min)/(e.max-e.min)):i.filter(l=>l>100*(a.firstValue-e.min)/(e.max-e.min))}),getStopStyle:a=>e.vertical?{bottom:`${a}%`}:{left:`${a}%`}}))(i,d,x,V),{inputId:$,isLabeledByFormItem:N}=y(i,{formItemContext:c}),U=w(),O=X(()=>i.inputSize||U.value),W=X(()=>i.ariaLabel||u("el.slider.defaultLabel",{min:i.min,max:i.max})),Q=X(()=>i.range?i.rangeStartLabel||u("el.slider.defaultRangeStartLabel"):W.value),le=X(()=>i.formatValueText?i.formatValueText(he.value):`${he.value}`),oe=X(()=>i.rangeEndLabel||u("el.slider.defaultRangeEndLabel")),ne=X(()=>i.formatValueText?i.formatValueText(ye.value):`${ye.value}`),ie=X(()=>[s.b(),s.m(U.value),s.is("vertical",i.vertical),{[s.m("with-input")]:i.showInput}]),me=(e=>X(()=>e.marks?Object.keys(e.marks).map(Number.parseFloat).sort((e,a)=>e-a).filter(a=>a<=e.max&&a>=e.min).map(a=>({point:a,position:100*(a-e.min)/(e.max-e.min),mark:e.marks[a]})):[]))(i);((a,l,n,i,s,r)=>{const u=e=>{s(o,e),s(t,e)},d=()=>a.range?![n.value,i.value].every((e,a)=>e===l.oldValue[a]):a.modelValue!==l.oldValue,c=()=>{var t,o;a.min>a.max&&f("Slider","min should not be greater than max.");const n=a.modelValue;a.range&&L(n)?n[1]<a.min?u([a.min,a.min]):n[0]>a.max?u([a.max,a.max]):n[0]<a.min?u([a.min,n[1]]):n[1]>a.max?u([n[0],a.max]):(l.firstValue=n[0],l.secondValue=n[1],d()&&(a.validateEvent&&(null==(t=null==r?void 0:r.validate)||t.call(r,"change").catch(e=>g())),l.oldValue=n.slice())):a.range||!e(n)||Number.isNaN(n)||(n<a.min?u(a.min):n>a.max?u(a.max):(l.firstValue=n,d()&&(a.validateEvent&&(null==(o=null==r?void 0:r.validate)||o.call(r,"change").catch(e=>g())),l.oldValue=n)))};c(),Y(()=>l.dragging,e=>{e||c()}),Y(()=>a.modelValue,(e,a)=>{l.dragging||L(e)&&L(a)&&e.every((e,l)=>e===a[l])&&l.firstValue===e[0]&&l.secondValue===e[1]||c()},{deep:!0}),Y(()=>[a.min,a.max],()=>{c()})})(i,d,x,V,n,c);const fe=X(()=>{const e=[i.min,i.max,i.step].map(e=>{const a=`${e}`.split(".")[1];return a?a.length:0});return Math.max.apply(null,e)}),{sliderWrapper:ge}=((a,l,t)=>{const o=A();return se(async()=>{a.range?(L(a.modelValue)?(l.firstValue=Math.max(a.min,a.modelValue[0]),l.secondValue=Math.min(a.max,a.modelValue[1])):(l.firstValue=a.min,l.secondValue=a.max),l.oldValue=[l.firstValue,l.secondValue]):(!e(a.modelValue)||Number.isNaN(a.modelValue)?l.firstValue=a.min:l.firstValue=Math.min(a.max,Math.max(a.min,a.modelValue)),l.oldValue=l.firstValue),r(window,"resize",t),await R(),t()}),{sliderWrapper:o}})(i,d,S),{firstValue:he,secondValue:ye,sliderSize:we}=H(d);return r(ge,"touchstart",C,{passive:!1}),r(ge,"touchmove",C,{passive:!1}),re(Le,{...H(i),sliderSize:we,disabled:_,precision:fe,emitChange:F,resetSize:S,updateDragging:e=>{d.dragging=e}}),l({onSliderClick:E}),(e,a)=>{var l,t;return K(),J("div",{id:e.range?ae($):void 0,ref_key:"sliderWrapper",ref:ge,class:ee(ae(ie)),role:e.range?"group":void 0,"aria-label":e.range&&!ae(N)?ae(W):void 0,"aria-labelledby":e.range&&ae(N)?null==(l=ae(c))?void 0:l.labelId:void 0},[Z("div",{ref_key:"slider",ref:v,class:ee([ae(s).e("runway"),{"show-input":e.showInput&&!e.range},ae(s).is("disabled",ae(_))]),style:te(ae(k)),onMousedown:ae(M),onTouchstartPassive:ae(M)},[Z("div",{class:ee(ae(s).e("bar")),style:te(ae(j))},null,6),G(qe,{id:e.range?void 0:ae($),ref_key:"firstButton",ref:m,"model-value":ae(he),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":e.range||!ae(N)?ae(Q):void 0,"aria-labelledby":!e.range&&ae(N)?null==(t=ae(c))?void 0:t.labelId:void 0,"aria-valuemin":e.min,"aria-valuemax":e.range?ae(ye):e.max,"aria-valuenow":ae(he),"aria-valuetext":ae(le),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":ae(_),"onUpdate:modelValue":ae(P)},null,8,["id","model-value","vertical","tooltip-class","placement","aria-label","aria-labelledby","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"]),e.range?(K(),ue(qe,{key:0,ref_key:"secondButton",ref:b,"model-value":ae(ye),vertical:e.vertical,"tooltip-class":e.tooltipClass,placement:e.placement,role:"slider","aria-label":ae(oe),"aria-valuemin":ae(he),"aria-valuemax":e.max,"aria-valuenow":ae(ye),"aria-valuetext":ae(ne),"aria-orientation":e.vertical?"vertical":"horizontal","aria-disabled":ae(_),"onUpdate:modelValue":ae(B)},null,8,["model-value","vertical","tooltip-class","placement","aria-label","aria-valuemin","aria-valuemax","aria-valuenow","aria-valuetext","aria-orientation","aria-disabled","onUpdate:modelValue"])):de("v-if",!0),e.showStops?(K(),J("div",{key:1},[(K(!0),J(ce,null,pe(ae(D),(e,a)=>(K(),J("div",{key:a,class:ee(ae(s).e("stop")),style:te(ae(T)(e))},null,6))),128))])):de("v-if",!0),ae(me).length>0?(K(),J(ce,{key:2},[Z("div",null,[(K(!0),J(ce,null,pe(ae(me),(e,a)=>(K(),J("div",{key:a,style:te(ae(T)(e.position)),class:ee([ae(s).e("stop"),ae(s).e("marks-stop")])},null,6))),128))]),Z("div",{class:ee(ae(s).e("marks"))},[(K(!0),J(ce,null,pe(ae(me),(e,a)=>(K(),ue(ae(He),{key:a,mark:e.mark,style:te(ae(T)(e.position)),onMousedown:ve(a=>ae(I)(e.position),["stop"])},null,8,["mark","style","onMousedown"]))),128))],2)],64)):de("v-if",!0)],46,["onMousedown","onTouchstartPassive"]),e.showInput&&!e.range?(K(),ue(ae(z),{key:0,ref:"input","model-value":ae(he),class:ee(ae(s).e("input")),step:e.step,disabled:ae(_),controls:e.showInputControls,min:e.min,max:e.max,precision:ae(fe),size:ae(O),"onUpdate:modelValue":ae(P),onChange:ae(F)},null,8,["model-value","class","step","disabled","controls","min","max","precision","size","onUpdate:modelValue","onChange"])):de("v-if",!0)],10,["id","role","aria-label","aria-labelledby"])}}}),[["__file","slider.vue"]])),Qe={class:"tech-proposal"},Ze={class:"panel-row project-row"},ea={class:"row-item"},aa={class:"row-item"},la={class:"panel-row project-row document-row"},ta={class:"row-item"},oa={key:0,class:"file-chip file-chip--success"},na=["title"],ia={key:1,class:"file-chip file-chip--info"},sa=["title"],ra={key:2,class:"file-placeholder"},ua={class:"config-section"},da={class:"panel-row project-row"},ca={class:"row-item"},pa={class:"row-item"},va={class:"panel-row project-row"},ma={class:"row-item"},fa={key:0,class:"row-item"},ga={key:1,class:"row-item"},ha={class:"panel-row project-row"},ya={class:"row-item slider-row"},wa={class:"slider-wrapper"},ba={class:"page-hint"},_a={class:"panel-row project-row"},xa={class:"row-item"},Va={class:"row-item"},ka={class:"panel-row project-row"},ja={class:"row-item"},Sa={class:"row-item"},Fa={class:"panel-actions"},Ca={class:"card-header"},Ea={class:"card-header"},Ma={class:"requirement-categories"},Ia={class:"category-title"},Pa={class:"category-content"},Ba={key:0,class:"category-summary"},Da={key:1,class:"category-keywords"},Ta={key:2,class:"category-points"},za={class:"card-header"},$a={class:"ç« èŠ‚ç»“æ„"},Na={class:"tree-node"},La={class:"node-title"},Ua={key:2,class:"node-desc"},Oa={class:"card-header"},Aa={class:"header-actions"},Xa={class:"result-content"},Ya={class:"output-files"},Ra={class:"file-buttons"},Wa={class:"collapse-header"},qa={class:"filename-cell"},Ha=D(W({__name:"TechProposal",setup(e){const{projects:a,selectedProject:l,loadProjects:t,handleProjectChange:o,restoreProjectFromStore:n}=je(),{useHitlFile:i,hitlFileInfo:s,syncing:r,synced:u,loadFromHITL:d,cancelHitlFile:c,syncToHitl:p}=_e({onFileLoaded:()=>{w.value.tenderFiles=[]}}),v=A([]),m=A(!1),f=A([]),g=async()=>{if(w.value.projectId){m.value=!0;try{const e=await fetch(`/api/tech-proposal/files?project_id=${w.value.projectId}`),a=await e.json();if(!a.success)throw new Error(a.error||"åŠ è½½å¤±è´¥");v.value=a.data||[]}catch(e){B.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{m.value=!1}}else v.value=[]},h=e=>{const a=["B","KB","MB","GB"];let l=e,t=0;for(;l>=1024&&t<a.length-1;)l/=1024,t++;return`${l.toFixed(1)} ${a[t]}`},y=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}},w=A({projectId:null,tenderFiles:[]}),b=A({outputPrefix:"æŠ€æœ¯æ–¹æ¡ˆ",aiModel:"shihuang-gpt4o-mini",generationMode:"æŒ‰æ‹›æ ‡ä¹¦ç›®å½•å†™",templateName:"æ”¿åºœé‡‡è´­æ ‡å‡†",pageCount:200,contentStyle:{tables:"é€‚é‡",flowcharts:"æµç¨‹å›¾",images:"å°‘é‡"},additionalOutputs:["includeAnalysis","includeMapping","includeSummary"]}),D=A(!1),z=A(0),L=A(""),U=A(null),O=A(!0),Y=A(null),R=A(!0),W=A(null),q=A(null),H=A(!1),ee=A(""),te=A(""),oe=A(!1),ne=A(null),ie=A(""),re=A(!1),Se=A(!1),Fe=X(()=>{var e;return(null==(e=Y.value)?void 0:e.chapters)?Y.value.chapters:[]}),Le=X(()=>w.value.projectId&&(i.value||w.value.tenderFiles.length>0)),Ue=async e=>{var a;const{file:t,onSuccess:o,onError:n}=e;if(!w.value.projectId){return n(new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")),void B.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")}if(!(null==(a=l.value)?void 0:a.company_id)){return n(new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")),void B.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")}try{const e=new FormData;e.append("file",t),e.append("company_id",l.value.company_id.toString()),e.append("project_id",w.value.projectId.toString());const a=await ke.parseDocumentStructure(e);if(!a.success)throw new Error(a.message||"ä¸Šä¼ å¤±è´¥");o(a.data),B.success("æŠ€æœ¯éœ€æ±‚æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(i){n(i),B.error(i.message||"æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},Oe=()=>{B.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},Ae=async()=>{await o(w.value.projectId,{onClear:()=>{w.value.tenderFiles=[],U.value=null,Y.value=null,W.value=null,q.value=null,L.value="",oe.value=!1,ie.value="",v.value=[],i.value&&c()},onDocumentsLoaded:e=>{e.technicalFile&&d(e,"technicalFile"),e.techProposalFile&&(q.value=e.techProposalFile)}}),w.value.projectId&&await g()},Xe=async()=>{var e;if(Le.value){D.value=!0,z.value=0,L.value="",U.value=null,W.value=null,oe.value=!1,ie.value="";try{const a=new FormData;if(i.value&&s.value)a.append("use_hitl_technical_file","true"),a.append("project_id",w.value.projectId.toString());else{if(!(null==(e=w.value.tenderFiles[0])?void 0:e.raw))throw new Error("è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");a.append("tender_file",w.value.tenderFiles[0].raw)}a.append("outputPrefix",b.value.outputPrefix),a.append("companyId",l.value.company_id.toString()),a.append("projectName",l.value.project_name||""),a.append("projectId",w.value.projectId.toString()),a.append("aiModel",b.value.aiModel),b.value.generationMode&&(a.append("generation_mode",b.value.generationMode),a.append("page_count",b.value.pageCount.toString()),a.append("content_style",JSON.stringify(b.value.contentStyle)),"ç¼–å†™ä¸“é¡¹ç« èŠ‚"===b.value.generationMode&&b.value.templateName&&a.append("template_name",b.value.templateName)),a.append("includeAnalysis",b.value.additionalOutputs.includes("includeAnalysis")?"true":"false"),a.append("includeMapping",b.value.additionalOutputs.includes("includeMapping")?"true":"false"),a.append("includeSummary",b.value.additionalOutputs.includes("includeSummary")?"true":"false"),await Ye(a),B.success("æŠ€æœ¯æ–¹æ¡ˆç”Ÿæˆå®Œæˆ")}catch(a){B.error(a.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{D.value=!1}}else B.warning("è¯·é€‰æ‹©é¡¹ç›®å¹¶ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£")},Ye=async e=>{var a,l,t;const o=!!b.value.generationMode?"/api/agent/generate":"/api/generate-proposal-stream-v2",n=await fetch(o,{method:"POST",body:e});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const i=null==(a=n.body)?void 0:a.getReader();if(!i)throw new Error("æ— æ³•è¯»å–å“åº”æµ");const s=new TextDecoder;let r="";const u={};let d="",c=null;const v=()=>{c&&clearTimeout(c),c=setTimeout(()=>{Re(u)},500)};for(;;){const{done:e,value:a}=await i.read();if(e)break;r+=s.decode(a,{stream:!0});const o=r.split("\n");r=o.pop()||"";for(const n of o)if(n.startsWith("data: "))try{const e=JSON.parse(n.slice(6));if(void 0!==e.progress&&(z.value=e.progress),e.message&&(L.value+=e.message+"\n"),"analysis_completed"===e.stage&&e.analysis_result&&(U.value=e.analysis_result),"outline_completed"===e.stage&&e.outline_data&&(Y.value=e.outline_data),"content_generation"===e.stage)if("chapter_start"===e.event)d=e.chapter_number||"",u[d]="",L.value+=`\n\n## ${e.chapter_number} ${e.chapter_title}\n\n`,oe.value||(oe.value=!0);else if("content_chunk"===e.event){const a=e.chapter_number||d;a&&(u[a]=(u[a]||"")+(e.content||""),v())}else"chapter_end"===e.event&&(c&&clearTimeout(c),Re(u),L.value+=`\nâœ“ ${e.chapter_title||"ç« èŠ‚"} ç”Ÿæˆå®Œæˆ\n`);if("completed"===e.stage&&e.success&&(W.value=e,q.value={outputFile:e.output_file,downloadUrl:null==(l=e.output_files)?void 0:l.proposal,stats:{requirements_count:e.requirements_count,sections_count:e.sections_count,matches_count:e.matches_count},message:"æŠ€æœ¯æ–¹æ¡ˆå·²ç”Ÿæˆ"},oe.value=!0,e.output_file&&await Ha(e.output_file),e.output_file&&w.value.projectId&&await p(w.value.projectId,e.output_file,"tech_proposal")),"error"===e.stage)throw L.value+=`\nâŒ é”™è¯¯: ${e.error||e.message}\n`,new Error(e.error||e.message||"ç”Ÿæˆå¤±è´¥")}catch(m){if(!(null==(t=m.message)?void 0:t.includes("JSON")))throw m}}},Re=e=>{var a;if(null==(a=Y.value)?void 0:a.chapters){let a="";const l=t=>{for(const o of t){const t=o.chapter_number,n=e[t]||"",i=o.level||1,s=`ch-${t.replace(/\./g,"-")}`;a+=`<h${i} id="${s}">${t} ${o.title}</h${i}>\n`,o.description&&(a+=`<div style="padding: 12px; background: #E8F4FD; border-left: 4px solid #409EFF; margin: 12px 0;">\n            <strong>ã€æœ¬ç« è¯´æ˜ã€‘</strong> ${o.description}\n          </div>\n`),o.response_strategy&&(a+=`<div style="padding: 12px; background: #F0F9FF; border-left: 4px solid #67C23A; margin: 12px 0;">\n            <strong>ã€åº”ç­”ç­–ç•¥ã€‘</strong> ${o.response_strategy}\n          </div>\n`),o.content_hints&&o.content_hints.length>0&&(a+=`<div style="padding: 12px; background: #FFF7E6; border-left: 4px solid #E6A23C; margin: 12px 0;">\n            <strong>ã€å†…å®¹æç¤ºã€‘</strong>\n            <ul style="margin: 8px 0; padding-left: 24px;">\n              ${o.content_hints.map(e=>`<li>${e}</li>`).join("")}\n            </ul>\n          </div>\n`),o.response_tips&&o.response_tips.length>0&&(a+=`<div style="padding: 12px; background: #FEF0F0; border-left: 4px solid #F56C6C; margin: 12px 0;">\n            <strong>ã€åº”ç­”å»ºè®®ã€‘</strong>\n            <ul style="margin: 8px 0; padding-left: 24px;">\n              ${o.response_tips.map(e=>`<li>${e}</li>`).join("")}\n            </ul>\n          </div>\n`),n?(a+='<div style="padding: 12px; background: #F0FFF4; border-left: 4px solid #52C41A; margin: 12px 0;">\n            <strong style="color: #52C41A;">ã€AIç”Ÿæˆå†…å®¹ã€‘</strong>\n          </div>\n',a+=`<div style="line-height: 1.8; margin: 12px 0;">${n.replace(/\n/g,"<br>")}</div>\n`):t in e&&(a+='<div style="padding: 12px; background: #F5F5F5; border: 1px dashed #D9D9D9; margin: 12px 0; color: #999;">\n            <em>æ­£åœ¨ç”Ÿæˆå†…å®¹...</em>\n          </div>\n'),o.subsections&&o.subsections.length>0&&l(o.subsections)}};l(Y.value.chapters),ie.value=a}else{let a="";const l=Object.entries(e).sort((e,a)=>{const[l]=e,[t]=a;return l.localeCompare(t,"zh-CN")});for(const[e,t]of l)a+=`<h2>${e}</h2>\n`,t&&(a+=`<div style="line-height: 1.8;">${t.replace(/\n/g,"<br>")}</div>\n`);ie.value=a}},We=()=>{D.value=!1,B.info("å·²åœæ­¢ç”Ÿæˆ")},qe=e=>{var a,l;if(!(null==(l=null==(a=W.value)?void 0:a.output_files)?void 0:l[e]))return void B.warning("æ–‡ä»¶ä¸å­˜åœ¨");const t=W.value.output_files[e];let o=t.split("/").pop()||`æŠ€æœ¯æ–¹æ¡ˆ_${e}.docx`;o=o.split("?")[0],Ve(t,o),B.success("ä¸‹è½½å·²å¼€å§‹")},He=()=>{var e,a,t;(null==(a=null==(e=W.value)?void 0:e.output_files)?void 0:a.proposal)?(ee.value=W.value.output_files.proposal,te.value=`æŠ€æœ¯æ–¹æ¡ˆ-${(null==(t=l.value)?void 0:t.project_name)||"æ–‡æ¡£"}.docx`,H.value=!0):B.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},Je=async()=>{var e;(null==(e=W.value)?void 0:e.output_file)?w.value.projectId?await p(w.value.projectId,W.value.output_file,"tech_proposal"):B.error("é¡¹ç›®IDæ— æ•ˆ"):B.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},Ke=async e=>{var a;if(null==(a=W.value)?void 0:a.output_file)try{Se.value=!0;const a=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:w.value.projectId,document_type:"tech_proposal",original_file:W.value.output_file})}),l=await a.json();if(!l.success)throw new Error(l.error||"ä¿å­˜å¤±è´¥");B.success("æŠ€æœ¯æ–¹æ¡ˆå†…å®¹å·²ä¿å­˜"),l.output_file&&(W.value.output_file=l.output_file,l.download_url&&W.value.output_files&&(W.value.output_files.proposal=l.download_url)),l.output_file&&w.value.projectId&&await p(w.value.projectId,l.output_file,"tech_proposal")}catch(l){throw l}finally{Se.value=!1}else B.warning("æ²¡æœ‰å¯ä¿å­˜çš„æ–‡ä»¶")},Ha=async e=>{try{re.value=!0,ie.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const a=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),l=await a.json();if(!l.success||!l.html_content)throw new Error(l.error||"è½¬æ¢å¤±è´¥");ie.value=l.html_content,ne.value&&ne.value.setContent(l.html_content)}catch(a){ie.value=`\n      <h1>ğŸ“„ æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${a.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"é¢„è§ˆWord"æˆ–"ä¸‹è½½"æŒ‰é’®æŸ¥çœ‹åŸå§‹æ–‡æ¡£</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,B.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨é¢„è§ˆæˆ–ä¸‹è½½åŠŸèƒ½")}finally{re.value=!1}};return se(async()=>{await t();const e=await n({onClear:()=>{w.value.tenderFiles=[],U.value=null,Y.value=null,W.value=null,q.value=null,i.value&&c()},onDocumentsLoaded:e=>{e.technicalFile&&d(e,"technicalFile"),e.techProposalFile&&(q.value=e.techProposalFile)}});e&&(w.value.projectId=e)}),(e,t)=>{const o=N,n=$,d=_,p=x,A=k,X=S,q=j,se=Ge,_e=Ee,ke=Ce,je=Me,Ye=Ie,Re=De,Ha=Be,Ja=Pe,Ka=T,Ga=ze,Qa=Te,Za=Ne,el=$e;return K(),J("div",Qe,[G(je,{class:"main-panel",shadow:"never"},{default:Q(()=>{var e,r,u;return[Z("div",Ze,[Z("div",ea,[t[22]||(t[22]=Z("label",{class:"row-label"},"é€‰æ‹©é¡¹ç›®",-1)),G(n,{modelValue:w.value.projectId,"onUpdate:modelValue":t[0]||(t[0]=e=>w.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:Ae,class:"row-select"},{default:Q(()=>[(K(!0),J(ce,null,pe(ae(a),e=>(K(),ue(o,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),Z("div",aa,[t[23]||(t[23]=Z("label",{class:"row-label"},"åº”ç­”å…¬å¸",-1)),G(d,{value:(null==(e=ae(l))?void 0:e.company_name)||"-",disabled:"",class:"row-input"},null,8,["value"])])]),Z("div",la,[Z("div",ta,[t[29]||(t[29]=Z("label",{class:"row-label"},"æŠ€æœ¯æ–‡æ¡£",-1)),ae(i)?(K(),J("div",oa,[G(p,{class:"file-chip-icon"},{default:Q(()=>[G(ae(V))]),_:1}),Z("span",{class:"file-chip-name",title:null==(r=ae(s))?void 0:r.filename},le((null==(u=ae(s))?void 0:u.filename)||"æœªçŸ¥æ–‡ä»¶"),9,na),t[25]||(t[25]=Z("span",{class:"file-chip-tag"},"å·²åŠ è½½",-1)),G(A,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:ae(c)},{default:Q(()=>[...t[24]||(t[24]=[me("Ã—",-1)])]),_:1},8,["onClick"])])):w.value.tenderFiles.length>0?(K(),J("div",ia,[G(p,{class:"file-chip-icon"},{default:Q(()=>[G(ae(V))]),_:1}),Z("span",{class:"file-chip-name",title:w.value.tenderFiles[0].name},le(w.value.tenderFiles[0].name),9,sa),t[27]||(t[27]=Z("span",{class:"file-chip-tag"},"å·²ä¸Šä¼ ",-1)),G(A,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:t[1]||(t[1]=e=>w.value.tenderFiles=[])},{default:Q(()=>[...t[26]||(t[26]=[me("Ã—",-1)])]),_:1})])):(K(),J("div",ra,[t[28]||(t[28]=Z("span",{class:"placeholder-text"},"è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",-1)),G(ae(ye),{modelValue:w.value.tenderFiles,"onUpdate:modelValue":t[2]||(t[2]=e=>w.value.tenderFiles=e),"http-request":Ue,accept:".pdf,.doc,.docx",limit:1,"max-size":50,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:Oe},null,8,["modelValue"])]))])]),Z("div",ua,[Z("div",da,[Z("div",ca,[t[30]||(t[30]=Z("label",{class:"row-label"},"è¾“å‡ºå‰ç¼€",-1)),G(d,{modelValue:b.value.outputPrefix,"onUpdate:modelValue":t[3]||(t[3]=e=>b.value.outputPrefix=e),placeholder:"æŠ€æœ¯æ–¹æ¡ˆ",class:"row-input"},null,8,["modelValue"])]),Z("div",pa,[t[31]||(t[31]=Z("label",{class:"row-label"},"AIæ¨¡å‹",-1)),G(n,{modelValue:b.value.aiModel,"onUpdate:modelValue":t[4]||(t[4]=e=>b.value.aiModel=e),class:"row-select"},{default:Q(()=>[G(o,{label:"GPT5ï¼ˆæœ€å¼ºæ¨ç†ï¼‰",value:"shihuang-gpt5"}),G(o,{label:"Claude Sonnet 4.5ï¼ˆæ ‡ä¹¦ä¸“ç”¨ï¼‰",value:"shihuang-claude-sonnet-45"}),G(o,{label:"GPT4o Miniï¼ˆæ¨è-é»˜è®¤ï¼‰",value:"shihuang-gpt4o-mini"})]),_:1},8,["modelValue"])])]),Z("div",va,[Z("div",ma,[t[35]||(t[35]=Z("label",{class:"row-label"},"ç”Ÿæˆæ¨¡å¼",-1)),G(q,{modelValue:b.value.generationMode,"onUpdate:modelValue":t[5]||(t[5]=e=>b.value.generationMode=e),class:"row-radio-group"},{default:Q(()=>[G(X,{value:"æŒ‰è¯„åˆ†ç‚¹å†™"},{default:Q(()=>[...t[32]||(t[32]=[me("æŒ‰è¯„åˆ†ç‚¹å†™",-1)])]),_:1}),G(X,{value:"æŒ‰æ‹›æ ‡ä¹¦ç›®å½•å†™"},{default:Q(()=>[...t[33]||(t[33]=[me("æŒ‰æ‹›æ ‡ä¹¦ç›®å½•å†™ï¼ˆæ¨èï¼‰",-1)])]),_:1}),G(X,{value:"ç¼–å†™ä¸“é¡¹ç« èŠ‚"},{default:Q(()=>[...t[34]||(t[34]=[me("ä½¿ç”¨å›ºå®šæ¨¡æ¿",-1)])]),_:1})]),_:1},8,["modelValue"])]),"ç¼–å†™ä¸“é¡¹ç« èŠ‚"===b.value.generationMode?(K(),J("div",fa,[t[36]||(t[36]=Z("label",{class:"row-label"},"é€‰æ‹©æ¨¡æ¿",-1)),G(n,{modelValue:b.value.templateName,"onUpdate:modelValue":t[6]||(t[6]=e=>b.value.templateName=e),placeholder:"è¯·é€‰æ‹©æ¨¡æ¿",class:"row-select"},{default:Q(()=>[G(o,{label:"æ”¿åºœé‡‡è´­æ ‡å‡†ï¼ˆ5ç« ï¼‰",value:"æ”¿åºœé‡‡è´­æ ‡å‡†"}),G(o,{label:"è½¯ä»¶å¼€å‘é¡¹ç›®ï¼ˆ8ç« ï¼‰",value:"è½¯ä»¶å¼€å‘é¡¹ç›®"}),G(o,{label:"ISOè´¨é‡ä½“ç³»ï¼ˆ6ç« ï¼‰",value:"ISOè´¨é‡ä½“ç³»"})]),_:1},8,["modelValue"])])):(K(),J("div",ga))]),Z("div",ha,[Z("div",ya,[t[37]||(t[37]=Z("label",{class:"row-label"},"é¡µæ•°æ§åˆ¶",-1)),Z("div",wa,[G(se,{modelValue:b.value.pageCount,"onUpdate:modelValue":t[7]||(t[7]=e=>b.value.pageCount=e),min:50,max:400,step:10,marks:{50:"50é¡µ",100:"100é¡µ",200:"200é¡µ",300:"300é¡µ",400:"400é¡µ"},"show-input":"","show-input-controls":!1},null,8,["modelValue"])]),Z("span",ba,"çº¦ "+le(Math.round(700*b.value.pageCount*.8).toLocaleString())+" - "+le(Math.round(700*b.value.pageCount).toLocaleString())+" å­—",1)])]),Z("div",_a,[Z("div",xa,[t[38]||(t[38]=Z("label",{class:"row-label"},"è¡¨æ ¼æ•°é‡",-1)),G(n,{modelValue:b.value.contentStyle.tables,"onUpdate:modelValue":t[8]||(t[8]=e=>b.value.contentStyle.tables=e),class:"row-select"},{default:Q(()=>[G(o,{label:"æ— ",value:"æ— "}),G(o,{label:"å°‘é‡",value:"å°‘é‡"}),G(o,{label:"é€‚é‡ï¼ˆæ¨èï¼‰",value:"é€‚é‡"}),G(o,{label:"å¤§é‡",value:"å¤§é‡"})]),_:1},8,["modelValue"])]),Z("div",Va,[t[39]||(t[39]=Z("label",{class:"row-label"},"æµç¨‹å›¾",-1)),G(n,{modelValue:b.value.contentStyle.flowcharts,"onUpdate:modelValue":t[9]||(t[9]=e=>b.value.contentStyle.flowcharts=e),class:"row-select"},{default:Q(()=>[G(o,{label:"æ— ",value:"æ— "}),G(o,{label:"æµç¨‹å›¾ï¼ˆæ¨èï¼‰",value:"æµç¨‹å›¾"}),G(o,{label:"SmartArt",value:"SmartArt"})]),_:1},8,["modelValue"])])]),Z("div",ka,[Z("div",ja,[t[40]||(t[40]=Z("label",{class:"row-label"},"å›¾ç‰‡æ•°é‡",-1)),G(n,{modelValue:b.value.contentStyle.images,"onUpdate:modelValue":t[10]||(t[10]=e=>b.value.contentStyle.images=e),class:"row-select"},{default:Q(()=>[G(o,{label:"æ— ",value:"æ— "}),G(o,{label:"å°‘é‡ï¼ˆæ¨èï¼‰",value:"å°‘é‡"}),G(o,{label:"å¤§é‡",value:"å¤§é‡"})]),_:1},8,["modelValue"])]),Z("div",Sa,[t[44]||(t[44]=Z("label",{class:"row-label"},"é™„åŠ è¾“å‡º",-1)),G(ke,{modelValue:b.value.additionalOutputs,"onUpdate:modelValue":t[11]||(t[11]=e=>b.value.additionalOutputs=e),class:"row-checkbox-group"},{default:Q(()=>[G(_e,{label:"includeAnalysis"},{default:Q(()=>[...t[41]||(t[41]=[me("éœ€æ±‚åˆ†æ",-1)])]),_:1}),G(_e,{label:"includeMapping"},{default:Q(()=>[...t[42]||(t[42]=[me("åŒ¹é…è¡¨",-1)])]),_:1}),G(_e,{label:"includeSummary"},{default:Q(()=>[...t[43]||(t[43]=[me("æ€»ç»“æŠ¥å‘Š",-1)])]),_:1})]),_:1},8,["modelValue"])])])]),Z("div",Fa,[G(A,{type:"primary",size:"large",disabled:!Le.value,loading:D.value,onClick:Xe},{default:Q(()=>[G(p,null,{default:Q(()=>[G(ae(F))]),_:1}),t[45]||(t[45]=me(" ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1},8,["disabled","loading"])])]}),_:1}),D.value?(K(),ue(je,{key:0,class:"generation-output",shadow:"never"},{header:Q(()=>[Z("div",Ca,[t[46]||(t[46]=Z("span",null,"AIæ­£åœ¨ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ...",-1)),G(Ye,{percentage:z.value,status:100===z.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:Q(()=>[G(ae(he),{content:L.value,"is-streaming":D.value,onStop:We},null,8,["content","is-streaming"])]),_:1})):de("",!0),U.value?(K(),ue(je,{key:1,class:"analysis-section",shadow:"never"},{header:Q(()=>[Z("div",Ea,[t[47]||(t[47]=Z("span",null,"éœ€æ±‚åˆ†æç»“æœ",-1)),G(A,{size:"small",onClick:t[12]||(t[12]=e=>O.value=!O.value)},{default:Q(()=>[me(le(O.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:Q(()=>[fe(Z("div",null,[G(ae(xe),{title:"æ–‡æ¡£æ‘˜è¦",stats:U.value.document_summary||{},"stat-items":[{key:"total_requirements",label:"æ€»éœ€æ±‚æ•°",suffix:"é¡¹"},{key:"mandatory_count",label:"å¼ºåˆ¶éœ€æ±‚",suffix:"é¡¹"},{key:"optional_count",label:"å¯é€‰éœ€æ±‚",suffix:"é¡¹"}]},null,8,["stats"]),Z("div",Ma,[t[50]||(t[50]=Z("h4",null,"éœ€æ±‚åˆ†ç±»",-1)),G(Ja,{accordion:""},{default:Q(()=>[(K(!0),J(ce,null,pe(U.value.requirement_categories,(e,a)=>(K(),ue(Ha,{key:a,name:a},{title:Q(()=>{return[Z("div",Ia,[Z("span",null,le(e.category),1),G(Re,{type:(a=e.priority,{"é«˜":"danger",high:"danger","ä¸­":"warning",medium:"warning","ä½":"info",low:"info"}[a]||"info"),size:"small"},{default:Q(()=>[me(le(e.priority),1)]),_:2},1032,["type"]),G(Re,{type:"info",size:"small"},{default:Q(()=>[me(le(e.requirements_count||0)+"é¡¹ ",1)]),_:2},1024)])];var a}),default:Q(()=>[Z("div",Pa,[e.summary?(K(),J("p",Ba,le(e.summary),1)):de("",!0),e.keywords&&e.keywords.length>0?(K(),J("div",Da,[t[48]||(t[48]=Z("strong",null,"å…³é”®è¯ï¼š",-1)),(K(!0),J(ce,null,pe(e.keywords,e=>(K(),ue(Re,{key:e,size:"small",style:{"margin-right":"8px"}},{default:Q(()=>[me(le(e),1)]),_:2},1024))),128))])):de("",!0),e.key_points&&e.key_points.length>0?(K(),J("div",Ta,[t[49]||(t[49]=Z("strong",null,"è¦ç‚¹ï¼š",-1)),Z("ul",null,[(K(!0),J(ce,null,pe(e.key_points,(e,a)=>(K(),J("li",{key:a},le(e),1))),128))])])):de("",!0)])]),_:2},1032,["name"]))),128))]),_:1})])],512),[[ge,O.value]])]),_:1})):de("",!0),Y.value?(K(),ue(je,{key:2,class:"outline-section",shadow:"never"},{header:Q(()=>[Z("div",za,[t[51]||(t[51]=Z("span",null,"æŠ€æœ¯æ–¹æ¡ˆå¤§çº²",-1)),G(A,{size:"small",onClick:t[13]||(t[13]=e=>R.value=!R.value)},{default:Q(()=>[me(le(R.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:Q(()=>[fe(Z("div",null,[G(ae(xe),{title:"å¤§çº²æ¦‚è§ˆ",stats:Y.value,"stat-items":[{key:"total_chapters",label:"æ€»ç« èŠ‚æ•°",suffix:"ç« "},{key:"estimated_pages",label:"é¢„è®¡é¡µæ•°",suffix:"é¡µ"}],span:12},null,8,["stats"]),Z("div",$a,[t[52]||(t[52]=Z("h4",null,"ç« èŠ‚ç»“æ„",-1)),G(Ka,{data:Fe.value,props:{label:"title",children:"subsections"},"default-expand-all":"","node-key":"chapter_number"},{default:Q(({node:e,data:a})=>[Z("span",Na,[1===a.level?(K(),ue(p,{key:0},{default:Q(()=>[G(ae(C))]),_:1})):(K(),ue(p,{key:1},{default:Q(()=>[G(ae(V))]),_:1})),Z("span",La,le(a.chapter_number)+" "+le(a.title),1),a.description?(K(),J("span",Ua,le(a.description),1)):de("",!0)])]),_:1},8,["data"])])],512),[[ge,R.value]])]),_:1})):de("",!0),oe.value?(K(),ue(je,{key:3,class:"editor-section",shadow:"never"},{default:Q(()=>[G(ae(be),{ref_key:"editorRef",ref:ne,modelValue:ie.value,"onUpdate:modelValue":t[14]||(t[14]=e=>ie.value=e),title:"æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£",height:1e3,loading:re.value,saving:Se.value,onSave:Ke},null,8,["modelValue","loading","saving"])]),_:1})):de("",!0),W.value?(K(),ue(je,{key:4,class:"result-section",shadow:"never"},{header:Q(()=>[Z("div",Oa,[t[58]||(t[58]=Z("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),Z("div",Aa,[G(A,{type:"primary",icon:ae(M),onClick:He},{default:Q(()=>[...t[53]||(t[53]=[me(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),G(A,{type:"success",icon:ae(E),onClick:t[15]||(t[15]=e=>qe("proposal"))},{default:Q(()=>[...t[54]||(t[54]=[me(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1)])]),_:1},8,["icon"]),ae(u)?(K(),ue(Re,{key:1,type:"success",size:"large"},{default:Q(()=>[...t[56]||(t[56]=[me(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(K(),ue(A,{key:0,type:"info",icon:ae(I),loading:ae(r),onClick:Je},{default:Q(()=>[...t[55]||(t[55]=[me(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),G(A,{type:"primary",icon:ae(P),onClick:Xe},{default:Q(()=>[...t[57]||(t[57]=[me(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:Q(()=>{var e,a,l,o;return[Z("div",Xa,[G(ae(xe),{title:"ç”Ÿæˆç»Ÿè®¡",stats:W.value,"stat-items":[{key:"requirements_count",label:"éœ€æ±‚æ•°é‡",suffix:"é¡¹"},{key:"sections_count",label:"ç« èŠ‚æ•°é‡",suffix:"ç« "},{key:"matches_count",label:"åŒ¹é…æ•°é‡",suffix:"é¡¹"}]},null,8,["stats"]),Z("div",Ya,[t[63]||(t[63]=Z("h4",null,"è¾“å‡ºæ–‡ä»¶",-1)),Z("div",Ra,[(null==(e=W.value.output_files)?void 0:e.proposal)?(K(),ue(A,{key:0,type:"success",onClick:t[16]||(t[16]=e=>qe("proposal"))},{default:Q(()=>[G(p,null,{default:Q(()=>[G(ae(E))]),_:1}),t[59]||(t[59]=me(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1})):de("",!0),(null==(a=W.value.output_files)?void 0:a.analysis)?(K(),ue(A,{key:1,type:"primary",onClick:t[17]||(t[17]=e=>qe("analysis"))},{default:Q(()=>[G(p,null,{default:Q(()=>[G(ae(E))]),_:1}),t[60]||(t[60]=me(" ä¸‹è½½éœ€æ±‚åˆ†æ ",-1))]),_:1})):de("",!0),(null==(l=W.value.output_files)?void 0:l.mapping)?(K(),ue(A,{key:2,type:"info",onClick:t[18]||(t[18]=e=>qe("mapping"))},{default:Q(()=>[G(p,null,{default:Q(()=>[G(ae(E))]),_:1}),t[61]||(t[61]=me(" ä¸‹è½½åŒ¹é…è¡¨ ",-1))]),_:1})):de("",!0),(null==(o=W.value.output_files)?void 0:o.summary)?(K(),ue(A,{key:3,type:"warning",onClick:t[19]||(t[19]=e=>qe("summary"))},{default:Q(()=>[G(p,null,{default:Q(()=>[G(ae(E))]),_:1}),t[62]||(t[62]=me(" ä¸‹è½½ç”ŸæˆæŠ¥å‘Š ",-1))]),_:1})):de("",!0)])])])]}),_:1})):de("",!0),w.value.projectId?(K(),ue(Ja,{key:5,modelValue:f.value,"onUpdate:modelValue":t[20]||(t[20]=e=>f.value=e),class:"history-collapse"},{default:Q(()=>[G(Ha,{name:"history"},{title:Q(()=>[Z("div",Wa,[Z("span",null,"ğŸ“‚ æœ¬é¡¹ç›®å†å²æ–‡ä»¶ ("+le(v.value.length)+")",1),f.value?(K(),ue(A,{key:0,type:"primary",size:"small",loading:m.value,onClick:ve(g,["stop"]),style:{"margin-left":"16px"}},{default:Q(()=>[...t[64]||(t[64]=[me(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):de("",!0)])]),default:Q(()=>[G(je,{shadow:"never",style:{border:"none"}},{default:Q(()=>[fe((K(),ue(Qa,{data:v.value,border:"",stripe:"","max-height":"400"},{default:Q(()=>[G(Ga,{type:"index",label:"åºå·",width:"60"}),G(Ga,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:Q(({row:e})=>[Z("div",qa,[G(p,null,{default:Q(()=>[G(ae(V))]),_:1}),Z("span",null,le(e.filename),1)])]),_:1}),G(Ga,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:Q(({row:e})=>[me(le(h(e.size)),1)]),_:1}),G(Ga,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:Q(({row:e})=>[me(le(y(e.process_time)),1)]),_:1}),G(Ga,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:Q(({row:e})=>[G(A,{type:"primary",size:"small",onClick:a=>{return l=e,ee.value=l.file_path||l.outputFile,te.value=l.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx",void(H.value=!0);var l}},{default:Q(()=>[...t[65]||(t[65]=[me(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),G(A,{type:"success",size:"small",onClick:a=>(async e=>{try{if(!e.download_url)return void B.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const a=e.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx";Ve(e.download_url,a),B.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(a){B.error(a.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}})(e)},{default:Q(()=>[...t[66]||(t[66]=[me(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[el,m.value]]),m.value||0!==v.value.length?de("",!0):(K(),ue(Za,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"])):de("",!0),G(ae(we),{modelValue:H.value,"onUpdate:modelValue":t[21]||(t[21]=e=>H.value=e),"file-url":ee.value,"file-name":te.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-29ff1357"]]);export{Ha as default};
