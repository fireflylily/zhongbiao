import{aA as e,T as a,aC as l,aE as t,aF as o,aG as s,aX as d,a6 as r,b0 as u,U as n,b1 as i,_ as c,$ as p,u as v,b2 as m,e as f,aL as _,aN as b,b3 as y,b4 as h,w as g,M as x,L as w,s as V,am as j,b5 as k,O as C,S as U,d as z,y as E,P as T,N as S,Q as $,R as B,h as I,G as M,q as D}from"./index.js";/* empty css                             */import{E as F}from"./el-date-picker-panel-BFWaZmWo.js";/* empty css                     *//* empty css                                                                          *//* empty css                *//* empty css                    */import{a as P,E as L}from"./el-tab-pane-Dwr03H4K.js";import{E as q}from"./el-pagination-DLlNht_A.js";/* empty css               */import{E as H,a as A}from"./el-select-DZeK41OH.js";/* empty css                */import{am as N,bQ as O,an as R,ao as Y,bH as G,bD as K,bV as Q,bC as X,ap as J,au as W,ar as Z,av as ee,az as ae,aA as le,aB as te,ay as oe,ax as se,as as de,at as re,aq as ue,aU as ne,aW as ie,aT as ce,aC as pe,bu as ve,aX as me,aw as fe,bw as _e,aD as be}from"./editor-CkQC1Uq_.js";import{L as ye}from"./Loading-BVHBNKFx.js";import{E as he}from"./Empty-D5VnJphi.js";/* empty css                                                        *//* empty css                   *//* empty css                */import{E as ge}from"./index-CPjPqG6g.js";import{E as xe,a as we}from"./index-Ct_FIOsr.js";import{E as Ve}from"./index-Jdk3-L3D.js";import{E as je}from"./index-lVhqCxeU.js";import{c as ke}from"./clamp-HmQ8FArD.js";import{E as Ce}from"./index-ZlCuKr4C.js";import{E as Ue,a as ze}from"./index-BgJNQ3LN.js";import"./advancedFormat-Cpf37SL5.js";import"./index-DO7-lxyV.js";import"./index-B_fegSBy.js";import"./index-C1LY3n9p.js";import"./toNumber-B_atpBHU.js";import"./raf-BZHcGSIv.js";import"./strings-DygAwr0H.js";import"./_baseFindIndex-BTqrMG7V.js";import"./_baseIteratee-CwtmDzoV.js";import"./index-DzllSHb7.js";import"./flatMap-D7uPVDtS.js";import"./map-B_SlaKiF.js";import"./_baseEach-V8knk74i.js";import"./cloneDeep-syPWYH98.js";const Ee=a({modelValue:{type:Number,default:0},id:{type:String,default:void 0},lowThreshold:{type:Number,default:2},highThreshold:{type:Number,default:4},max:{type:Number,default:5},colors:{type:r([Array,Object]),default:()=>d(["","",""])},voidColor:{type:String,default:""},disabledVoidColor:{type:String,default:""},icons:{type:r([Array,Object]),default:()=>[u,u,u]},voidIcon:{type:n,default:()=>i},disabledVoidIcon:{type:n,default:()=>u},disabled:Boolean,allowHalf:Boolean,showText:Boolean,showScore:Boolean,textColor:{type:String,default:""},texts:{type:r(Array),default:()=>d(["Extremely bad","Disappointed","Fair","Satisfied","Surprise"])},scoreTemplate:{type:String,default:"{value}"},size:s,clearable:Boolean,...o(["ariaLabel"])}),Te={[t]:a=>e(a),[l]:a=>e(a)},Se=N({name:"ElRate"});const $e=g(c(N({...Se,props:Ee,emits:Te,setup(e,{expose:a,emit:o}){const s=e;function d(e,a){const l=e=>K(e),t=Object.keys(a).map(e=>+e).filter(t=>{const o=a[t];return!!l(o)&&o.excluded?e<t:e<=t}).sort((e,a)=>e-a),o=a[t[0]];return l(o)&&o.value||o}const r=O(y,void 0),u=O(h,void 0),n=p(),i=v("rate"),{inputId:c,isLabeledByFormItem:g}=m(s,{formItemContext:u}),x=R(s.modelValue),w=R(-1),V=R(!0),j=R([]),k=Y(()=>j.value.map(e=>e.$el.clientWidth)),C=Y(()=>[i.b(),i.m(n.value)]),U=Y(()=>s.disabled||(null==r?void 0:r.disabled)),z=Y(()=>i.cssVarBlock({"void-color":s.voidColor,"disabled-void-color":s.disabledVoidColor,"fill-color":$.value})),E=Y(()=>{let e="";return s.showScore?e=s.scoreTemplate.replace(/\{\s*value\s*\}/,U.value?`${s.modelValue}`:`${x.value}`):s.showText&&(e=s.texts[Math.ceil(x.value)-1]),e}),T=Y(()=>100*s.modelValue-100*Math.floor(s.modelValue)),S=Y(()=>G(s.colors)?{[s.lowThreshold]:s.colors[0],[s.highThreshold]:{value:s.colors[1],excluded:!0},[s.max]:s.colors[2]}:s.colors),$=Y(()=>{const e=d(x.value,S.value);return K(e)?"":e}),B=Y(()=>{let e="";return U.value?e=`${T.value}%`:s.allowHalf&&(e="50%"),{color:$.value,width:e}}),I=Y(()=>{let e=G(s.icons)?[...s.icons]:{...s.icons};return e=Q(e),G(e)?{[s.lowThreshold]:e[0],[s.highThreshold]:{value:e[1],excluded:!0},[s.max]:e[2]}:e}),M=Y(()=>d(s.modelValue,I.value)),D=Y(()=>U.value?X(s.disabledVoidIcon)?s.disabledVoidIcon:Q(s.disabledVoidIcon):X(s.voidIcon)?s.voidIcon:Q(s.voidIcon)),F=Y(()=>d(x.value,I.value));function P(e){const a=U.value&&T.value>0&&e-1<s.modelValue&&e>s.modelValue,l=s.allowHalf&&V.value&&e-.5<=x.value&&e>x.value;return a||l}function L(e){s.clearable&&e===s.modelValue&&(e=0),o(l,e),s.modelValue!==e&&o(t,e)}function q(e){if(U.value)return;const a=_(e),d=s.allowHalf?.5:1;let r=x.value;switch(a){case b.up:case b.right:r+=d;break;case b.left:case b.down:r-=d}return r=ke(r,0,s.max),r!==x.value?(e.stopPropagation(),e.preventDefault(),o(l,r),o(t,r),r):void 0}function H(e,a){U.value||(s.allowHalf&&a?(V.value=2*a.offsetX<=k.value[e-1],x.value=V.value?e-.5:e):x.value=e,w.value=e)}function A(){U.value||(s.allowHalf&&(V.value=s.modelValue!==Math.floor(s.modelValue)),x.value=s.modelValue,w.value=-1)}return J(()=>s.modelValue,e=>{x.value=e,V.value=s.modelValue!==Math.floor(s.modelValue)}),s.modelValue||o(l,0),a({setCurrentValue:H,resetCurrentValue:A}),(e,a)=>{var l;return Z(),W("div",{id:oe(c),class:te([oe(C),oe(i).is("disabled",oe(U))]),role:"slider","aria-label":oe(g)?void 0:e.ariaLabel||"rating","aria-labelledby":oe(g)?null==(l=oe(u))?void 0:l.labelId:void 0,"aria-valuenow":x.value,"aria-valuetext":oe(E)||void 0,"aria-valuemin":"0","aria-valuemax":e.max,tabindex:"0",style:ce(oe(z)),onKeydown:q},[(Z(!0),W(ae,null,le(e.max,(e,a)=>(Z(),W("span",{key:a,class:te(oe(i).e("item")),onMousemove:a=>H(e,a),onMouseleave:A,onClick:a=>{return l=e,void(U.value||(s.allowHalf&&V.value?L(x.value):L(l)));var l}},[se(oe(f),{ref_for:!0,ref_key:"iconRefs",ref:j,class:te([oe(i).e("icon"),{hover:w.value===e},oe(i).is("active",e<=x.value),oe(i).is("focus-visible",e===Math.ceil(x.value||1))])},{default:de(()=>[re((Z(),ue(ne(oe(F)),null,null,512)),[[ie,!P(e)&&e<=x.value]]),re((Z(),ue(ne(oe(D)),null,null,512)),[[ie,!P(e)&&e>x.value]]),re((Z(),ue(ne(oe(D)),{class:te([oe(i).em("decimal","box")])},null,8,["class"])),[[ie,P(e)]]),re(se(oe(f),{style:ce(oe(B)),class:te([oe(i).e("icon"),oe(i).e("decimal")])},{default:de(()=>[(Z(),ue(ne(oe(M))))]),_:2},1032,["style","class"]),[[ie,P(e)]])]),_:2},1032,["class"])],42,["onMousemove","onClick"]))),128)),e.showText||e.showScore?(Z(),W("span",{key:0,class:te(oe(i).e("text")),style:ce({color:e.textColor})},pe(oe(E)),7)):ee("v-if",!0)],46,["id","aria-label","aria-labelledby","aria-valuenow","aria-valuetext","aria-valuemax"])}}}),[["__file","rate.vue"]])),Be={class:"tender-library"},Ie={class:"stats-bar"},Me={class:"stat-content"},De={class:"stat-icon docs"},Fe={class:"stat-info"},Pe={class:"stat-value"},Le={class:"stat-content"},qe={class:"stat-icon excerpts"},He={class:"stat-info"},Ae={class:"stat-value"},Ne={class:"stat-content"},Oe={class:"stat-icon won"},Re={class:"stat-info"},Ye={class:"stat-value"},Ge={class:"tab-toolbar"},Ke={key:3,class:"pagination-wrapper"},Qe={class:"tab-toolbar"},Xe={key:2,class:"excerpts-list"},Je={class:"excerpt-header"},We={class:"excerpt-title"},Ze={class:"chapter-title"},ea={class:"excerpt-meta"},aa={class:"doc-name"},la={class:"excerpt-content"},ta={class:"excerpt-footer"},oa={class:"excerpt-tags"},sa={class:"excerpt-actions"},da={key:3,class:"pagination-wrapper"},ra={class:"excerpt-full-content"},ua={class:"content-box"},na="/api/tender-library",ia=D(N({__name:"TenderLibrary",setup(e){const{success:a,error:l}=x(),t=w(),o=Y(()=>t.currentCompanyId||1),s=ve({docCount:0,excerptCount:0,wonCount:0}),d=R("documents"),r=R(!1),u=R([]),n=R(""),i=R(""),c=R(1),p=R(10),v=R(0),m=R(!1),_=R([]),b=R(""),y=R(""),h=R(!1),g=R(1),D=R(10),N=R(0),O=R(!1),G=R(),K=R(),Q=ve({file:null,project_name:"",bid_result:"待定",bid_date:"",notes:""}),X={project_name:[{required:!0,message:"请输入项目名称",trigger:"blur"}]},te=R(!1),re=R(!1),ne=ve({tender_doc_id:null,project_name:"",bid_result:"",bid_date:"",notes:""}),ie=R(!1),ce=R(!1),ke=R("view"),Ee=R(null),Te=ve({excerpt_id:null,chapter_title:"",category:"",quality_score:0,tags:"",content:""}),Se=async()=>{r.value=!0;try{const e=new URLSearchParams({company_id:String(o.value),page:String(c.value),page_size:String(p.value)});n.value&&e.append("keyword",n.value),i.value&&e.append("bid_result",i.value);const a=await fetch(`${na}/documents?${e}`),t=await a.json();t.success?(u.value=t.data||[],v.value=t.total||0,s.docCount=v.value,s.wonCount=u.value.filter(e=>"中标"===e.bid_result).length):l("加载失败",t.error||"未知错误")}catch(e){l("加载失败",e instanceof Error?e.message:"未知错误")}finally{r.value=!1}},ia=async()=>{m.value=!0;try{const e=new URLSearchParams({company_id:String(o.value),page:String(g.value),page_size:String(D.value)});b.value&&e.append("keyword",b.value),y.value&&e.append("category",y.value),h.value&&e.append("won_only","true");const a=await fetch(`${na}/excerpts?${e}`),t=await a.json();t.success?(_.value=t.data||[],N.value=t.total||0,s.excerptCount=N.value):l("加载失败",t.error||"未知错误")}catch(e){l("加载失败",e instanceof Error?e.message:"未知错误")}finally{m.value=!1}},ca=()=>{Q.file=null,Q.project_name="",Q.bid_result="待定",Q.bid_date="",Q.notes="",G.value&&G.value.clearFiles(),O.value=!0},pa=(e,a)=>{e&&e.raw&&(Q.file=e.raw)},va=()=>{Q.file=null},ma=async()=>{if(Q.file){te.value=!0;try{const e=new FormData;e.append("file",Q.file),e.append("company_id",String(o.value)),e.append("project_name",Q.project_name),e.append("bid_result",Q.bid_result),Q.bid_date&&e.append("bid_date",Q.bid_date),Q.notes&&e.append("notes",Q.notes);const t=await fetch(`${na}/documents/upload`,{method:"POST",body:e}),s=await t.json();s.success?(a("上传成功",s.message),O.value=!1,Se()):l("上传失败",s.error||"未知错误")}catch(e){l("上传失败",e instanceof Error?e.message:"未知错误")}finally{te.value=!1}}else l("请选择文件")},fa=async()=>{ie.value=!0;try{const e=await fetch(`${na}/documents/${ne.tender_doc_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ne)}),t=await e.json();t.success?(a("保存成功"),re.value=!1,Se()):l("保存失败",t.error||"未知错误")}catch(e){l("保存失败",e instanceof Error?e.message:"未知错误")}finally{ie.value=!1}},_a=async()=>{ie.value=!0;try{const e=await fetch(`${na}/excerpts/${Te.excerpt_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(Te)}),t=await e.json();t.success?(a("保存成功"),ce.value=!1,ia()):l("保存失败",t.error||"未知错误")}catch(e){l("保存失败",e instanceof Error?e.message:"未知错误")}finally{ie.value=!1}},ba=e=>"中标"===e?"success":"未中标"===e?"danger":"info";return me(()=>{Se(),ia()}),J(d,e=>{"documents"===e?Se():ia()}),J(o,()=>{Se(),ia()}),(e,t)=>{const o=f,x=ge,w=C,R=A,Y=H,J=z,ve=we,me=Ve,ya=xe,ha=q,ga=P,xa=je,wa=$e,Va=L,ja=Ce,ka=S,Ca=B,Ua=$,za=F,Ea=T,Ta=I,Sa=ze,$a=Ue;return Z(),W("div",Be,[fe("div",Ie,[se(x,{class:"stat-card"},{default:de(()=>[fe("div",Me,[fe("div",De,[se(o,{size:32,color:"#409eff"},{default:de(()=>[se(oe(V))]),_:1})]),fe("div",Fe,[t[30]||(t[30]=fe("div",{class:"stat-label"},"标书文档",-1)),fe("div",Pe,pe(s.docCount),1)])])]),_:1}),se(x,{class:"stat-card"},{default:de(()=>[fe("div",Le,[fe("div",qe,[se(o,{size:32,color:"#67c23a"},{default:de(()=>[se(oe(j))]),_:1})]),fe("div",He,[t[31]||(t[31]=fe("div",{class:"stat-label"},"素材片段",-1)),fe("div",Ae,pe(s.excerptCount),1)])])]),_:1}),se(x,{class:"stat-card"},{default:de(()=>[fe("div",Ne,[fe("div",Oe,[se(o,{size:32,color:"#e6a23c"},{default:de(()=>[se(oe(k))]),_:1})]),fe("div",Re,[t[32]||(t[32]=fe("div",{class:"stat-label"},"中标标书",-1)),fe("div",Ye,pe(s.wonCount),1)])])]),_:1})]),se(Va,{modelValue:d.value,"onUpdate:modelValue":t[9]||(t[9]=e=>d.value=e),type:"border-card"},{default:de(()=>[se(ga,{label:"标书文档",name:"documents"},{default:de(()=>[fe("div",Ge,[se(w,{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=e=>n.value=e),placeholder:"搜索文档名称...",clearable:"",style:{width:"200px"},onKeyup:_e(Se,["enter"])},{prefix:de(()=>[se(o,null,{default:de(()=>[se(oe(U))]),_:1})]),_:1},8,["modelValue"]),se(Y,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value=e),placeholder:"投标结果",clearable:"",style:{width:"120px"},onChange:Se},{default:de(()=>[se(R,{label:"全部",value:""}),se(R,{label:"中标",value:"中标"}),se(R,{label:"未中标",value:"未中标"}),se(R,{label:"待定",value:"待定"})]),_:1},8,["modelValue"]),se(J,{type:"primary",onClick:ca},{default:de(()=>[se(o,null,{default:de(()=>[se(oe(E))]),_:1}),t[33]||(t[33]=be(" 上传标书 ",-1))]),_:1})]),r.value?(Z(),ue(oe(ye),{key:0,text:"加载中..."})):u.value.length?(Z(),ue(ya,{key:2,data:u.value,stripe:""},{default:de(()=>[se(ve,{prop:"doc_name",label:"文档名称","min-width":"200","show-overflow-tooltip":""}),se(ve,{prop:"project_name",label:"项目名称",width:"180","show-overflow-tooltip":""}),se(ve,{prop:"bid_result",label:"投标结果",width:"100",align:"center"},{default:de(({row:e})=>[se(me,{type:ba(e.bid_result)},{default:de(()=>[be(pe(e.bid_result||"待定"),1)]),_:2},1032,["type"])]),_:1}),se(ve,{prop:"excerpt_count",label:"片段数",width:"80",align:"center"}),se(ve,{prop:"bid_date",label:"投标日期",width:"120"}),se(ve,{prop:"created_at",label:"上传时间",width:"160"}),se(ve,{label:"操作",width:"200",fixed:"right"},{default:de(({row:e})=>[se(J,{link:"",type:"primary",size:"small",onClick:a=>{return l=e,void window.open(`/api/documents/${l.doc_id}/preview`,"_blank");var l}},{default:de(()=>[...t[34]||(t[34]=[be(" 查看 ",-1)])]),_:1},8,["onClick"]),se(J,{link:"",type:"success",size:"small",onClick:t=>(async e=>{try{await M.confirm(`确定要从 "${e.doc_name}" 提取素材片段吗？`,"提取素材",{confirmButtonText:"确定",cancelButtonText:"取消",type:"info"})}catch{return}try{const t=await fetch(`${na}/documents/${e.tender_doc_id}/extract`,{method:"POST"}),o=await t.json();o.success?(a("提取完成",`成功提取 ${o.extracted_count||0} 个片段`),Se(),ia()):l("提取失败",o.error||"未知错误")}catch(t){l("提取失败",t instanceof Error?t.message:"未知错误")}})(e)},{default:de(()=>[...t[35]||(t[35]=[be(" 提取 ",-1)])]),_:1},8,["onClick"]),se(J,{link:"",type:"warning",size:"small",onClick:a=>{return l=e,ne.tender_doc_id=l.tender_doc_id,ne.project_name=l.project_name||"",ne.bid_result=l.bid_result||"待定",ne.bid_date=l.bid_date||"",ne.notes=l.notes||"",void(re.value=!0);var l}},{default:de(()=>[...t[36]||(t[36]=[be(" 编辑 ",-1)])]),_:1},8,["onClick"]),se(J,{link:"",type:"danger",size:"small",onClick:t=>(async e=>{try{await M.confirm(`确定要删除 "${e.doc_name}" 吗？关联的素材片段也会被删除。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"})}catch{return}try{const t=await fetch(`${na}/documents/${e.tender_doc_id}`,{method:"DELETE"}),o=await t.json();o.success?(a("删除成功"),Se(),ia()):l("删除失败",o.error||"未知错误")}catch(t){l("删除失败",t instanceof Error?t.message:"未知错误")}})(e)},{default:de(()=>[...t[37]||(t[37]=[be(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(Z(),ue(oe(he),{key:1,type:"no-data",description:"暂无标书文档"})),v.value>p.value?(Z(),W("div",Ke,[se(ha,{"current-page":c.value,"onUpdate:currentPage":t[2]||(t[2]=e=>c.value=e),"page-size":p.value,"onUpdate:pageSize":t[3]||(t[3]=e=>p.value=e),total:v.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:Se,onCurrentChange:Se},null,8,["current-page","page-size","total"])])):ee("",!0)]),_:1}),se(ga,{label:"素材片段",name:"excerpts"},{default:de(()=>[fe("div",Qe,[se(w,{modelValue:b.value,"onUpdate:modelValue":t[4]||(t[4]=e=>b.value=e),placeholder:"搜索素材内容...",clearable:"",style:{width:"250px"},onKeyup:_e(ia,["enter"])},{prefix:de(()=>[se(o,null,{default:de(()=>[se(oe(U))]),_:1})]),_:1},8,["modelValue"]),se(Y,{modelValue:y.value,"onUpdate:modelValue":t[5]||(t[5]=e=>y.value=e),placeholder:"分类",clearable:"",style:{width:"120px"},onChange:ia},{default:de(()=>[se(R,{label:"全部",value:""}),se(R,{label:"技术方案",value:"技术方案"}),se(R,{label:"项目管理",value:"项目管理"}),se(R,{label:"售后服务",value:"售后服务"}),se(R,{label:"企业资质",value:"企业资质"}),se(R,{label:"团队介绍",value:"团队介绍"})]),_:1},8,["modelValue"]),se(xa,{modelValue:h.value,"onUpdate:modelValue":t[6]||(t[6]=e=>h.value=e),onChange:ia},{default:de(()=>[...t[38]||(t[38]=[be("仅中标",-1)])]),_:1},8,["modelValue"])]),m.value?(Z(),ue(oe(ye),{key:0,text:"加载中..."})):_.value.length?(Z(),W("div",Xe,[(Z(!0),W(ae,null,le(_.value,e=>(Z(),ue(x,{key:e.excerpt_id,class:"excerpt-card",shadow:"hover"},{header:de(()=>{return[fe("div",Je,[fe("div",We,[fe("span",Ze,pe(e.chapter_title||"无标题"),1),se(me,{size:"small",type:(a=e.category,{"技术方案":"primary","项目管理":"success","售后服务":"warning","企业资质":"info","团队介绍":""}[a]||"info")},{default:de(()=>[be(pe(e.category||"未分类"),1)]),_:2},1032,["type"]),"中标"===e.bid_result?(Z(),ue(me,{key:0,size:"small",type:"success"},{default:de(()=>[...t[39]||(t[39]=[be(" 中标 ",-1)])]),_:1})):ee("",!0)]),fe("div",ea,[fe("span",aa,pe(e.doc_name),1),se(wa,{modelValue:e.quality_score,"onUpdate:modelValue":a=>e.quality_score=a,disabled:"",max:5,size:"small",colors:["#99A9BF","#F7BA2A","#FF9900"]},null,8,["modelValue","onUpdate:modelValue"])])])];var a}),default:de(()=>{var o,s;return[fe("div",la,pe(null==(o=e.content)?void 0:o.substring(0,300))+pe((null==(s=e.content)?void 0:s.length)>300?"...":""),1),fe("div",ta,[fe("div",oa,[(Z(!0),W(ae,null,le((e.tags||"").split(",").filter(Boolean).slice(0,3),e=>(Z(),ue(me,{key:e,size:"small",type:"info"},{default:de(()=>[be(pe(e),1)]),_:2},1024))),128))]),fe("div",sa,[se(J,{link:"",type:"primary",size:"small",onClick:a=>(e=>{Ee.value=e,ke.value="view",ce.value=!0})(e)},{default:de(()=>[...t[40]||(t[40]=[be(" 查看全文 ",-1)])]),_:1},8,["onClick"]),se(J,{link:"",type:"primary",size:"small",onClick:t=>(async e=>{try{await navigator.clipboard.writeText(e.content||""),a("已复制到剪贴板")}catch(t){l("复制失败")}})(e)},{default:de(()=>[...t[41]||(t[41]=[be(" 复制 ",-1)])]),_:1},8,["onClick"]),se(J,{link:"",type:"warning",size:"small",onClick:a=>(e=>{Ee.value=e,Te.excerpt_id=e.excerpt_id,Te.chapter_title=e.chapter_title||"",Te.category=e.category||"",Te.quality_score=e.quality_score||0,Te.tags=e.tags||"",Te.content=e.content||"",ke.value="edit",ce.value=!0})(e)},{default:de(()=>[...t[42]||(t[42]=[be(" 编辑 ",-1)])]),_:1},8,["onClick"]),se(J,{link:"",type:"danger",size:"small",onClick:t=>(async e=>{try{await M.confirm(`确定要删除素材片段 "${e.chapter_title||"未命名"}" 吗？`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"})}catch{return}try{const t=await fetch(`${na}/excerpts/${e.excerpt_id}`,{method:"DELETE"}),o=await t.json();o.success?(a("删除成功"),ia()):l("删除失败",o.error||"未知错误")}catch(t){l("删除失败",t instanceof Error?t.message:"未知错误")}})(e)},{default:de(()=>[...t[43]||(t[43]=[be(" 删除 ",-1)])]),_:1},8,["onClick"])])])]}),_:2},1024))),128))])):(Z(),ue(oe(he),{key:1,type:"no-data",description:"暂无素材片段"})),N.value>D.value?(Z(),W("div",da,[se(ha,{"current-page":g.value,"onUpdate:currentPage":t[7]||(t[7]=e=>g.value=e),"page-size":D.value,"onUpdate:pageSize":t[8]||(t[8]=e=>D.value=e),total:N.value,"page-sizes":[10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:ia,onCurrentChange:ia},null,8,["current-page","page-size","total"])])):ee("",!0)]),_:1})]),_:1},8,["modelValue"]),se(Ta,{modelValue:O.value,"onUpdate:modelValue":t[15]||(t[15]=e=>O.value=e),title:"上传标书文档",width:"600px"},{footer:de(()=>[se(J,{onClick:t[14]||(t[14]=e=>O.value=!1)},{default:de(()=>[...t[49]||(t[49]=[be("取消",-1)])]),_:1}),se(J,{type:"primary",onClick:ma,loading:te.value},{default:de(()=>[...t[50]||(t[50]=[be(" 上传 ",-1)])]),_:1},8,["loading"])]),default:de(()=>[se(Ea,{model:Q,rules:X,ref_key:"uploadFormRef",ref:K,"label-width":"100px"},{default:de(()=>[se(ka,{label:"文档文件",prop:"file"},{default:de(()=>[se(ja,{ref_key:"uploadRef",ref:G,"auto-upload":!1,limit:1,"on-change":pa,"on-remove":va,accept:".docx,.doc,.pdf"},{trigger:de(()=>[se(J,{type:"primary"},{default:de(()=>[...t[44]||(t[44]=[be("选择文件",-1)])]),_:1})]),tip:de(()=>[...t[45]||(t[45]=[fe("div",{class:"el-upload__tip"},"支持 .docx, .doc, .pdf 格式",-1)])]),_:1},512)]),_:1}),se(ka,{label:"项目名称",prop:"project_name"},{default:de(()=>[se(w,{modelValue:Q.project_name,"onUpdate:modelValue":t[10]||(t[10]=e=>Q.project_name=e),placeholder:"投标项目名称"},null,8,["modelValue"])]),_:1}),se(ka,{label:"投标结果",prop:"bid_result"},{default:de(()=>[se(Ua,{modelValue:Q.bid_result,"onUpdate:modelValue":t[11]||(t[11]=e=>Q.bid_result=e)},{default:de(()=>[se(Ca,{label:"中标"},{default:de(()=>[...t[46]||(t[46]=[be("中标",-1)])]),_:1}),se(Ca,{label:"未中标"},{default:de(()=>[...t[47]||(t[47]=[be("未中标",-1)])]),_:1}),se(Ca,{label:"待定"},{default:de(()=>[...t[48]||(t[48]=[be("待定",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),se(ka,{label:"投标日期",prop:"bid_date"},{default:de(()=>[se(za,{modelValue:Q.bid_date,"onUpdate:modelValue":t[12]||(t[12]=e=>Q.bid_date=e),type:"date",placeholder:"选择日期","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),se(ka,{label:"备注",prop:"notes"},{default:de(()=>[se(w,{modelValue:Q.notes,"onUpdate:modelValue":t[13]||(t[13]=e=>Q.notes=e),type:"textarea",rows:2,placeholder:"可选备注信息"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),se(Ta,{modelValue:re.value,"onUpdate:modelValue":t[21]||(t[21]=e=>re.value=e),title:"编辑标书信息",width:"500px"},{footer:de(()=>[se(J,{onClick:t[20]||(t[20]=e=>re.value=!1)},{default:de(()=>[...t[54]||(t[54]=[be("取消",-1)])]),_:1}),se(J,{type:"primary",onClick:fa,loading:ie.value},{default:de(()=>[...t[55]||(t[55]=[be(" 保存 ",-1)])]),_:1},8,["loading"])]),default:de(()=>[se(Ea,{model:ne,"label-width":"100px"},{default:de(()=>[se(ka,{label:"项目名称"},{default:de(()=>[se(w,{modelValue:ne.project_name,"onUpdate:modelValue":t[16]||(t[16]=e=>ne.project_name=e)},null,8,["modelValue"])]),_:1}),se(ka,{label:"投标结果"},{default:de(()=>[se(Ua,{modelValue:ne.bid_result,"onUpdate:modelValue":t[17]||(t[17]=e=>ne.bid_result=e)},{default:de(()=>[se(Ca,{label:"中标"},{default:de(()=>[...t[51]||(t[51]=[be("中标",-1)])]),_:1}),se(Ca,{label:"未中标"},{default:de(()=>[...t[52]||(t[52]=[be("未中标",-1)])]),_:1}),se(Ca,{label:"待定"},{default:de(()=>[...t[53]||(t[53]=[be("待定",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),se(ka,{label:"投标日期"},{default:de(()=>[se(za,{modelValue:ne.bid_date,"onUpdate:modelValue":t[18]||(t[18]=e=>ne.bid_date=e),type:"date","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),se(ka,{label:"备注"},{default:de(()=>[se(w,{modelValue:ne.notes,"onUpdate:modelValue":t[19]||(t[19]=e=>ne.notes=e),type:"textarea",rows:2},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),se(Ta,{modelValue:ce.value,"onUpdate:modelValue":t[29]||(t[29]=e=>ce.value=e),title:"view"===ke.value?"素材详情":"编辑素材",width:"700px"},{footer:de(()=>[se(J,{onClick:t[27]||(t[27]=e=>ce.value=!1)},{default:de(()=>[...t[57]||(t[57]=[be("关闭",-1)])]),_:1}),"view"===ke.value?(Z(),ue(J,{key:0,type:"primary",onClick:t[28]||(t[28]=e=>ke.value="edit")},{default:de(()=>[...t[58]||(t[58]=[be(" 编辑 ",-1)])]),_:1})):(Z(),ue(J,{key:1,type:"primary",onClick:_a,loading:ie.value},{default:de(()=>[...t[59]||(t[59]=[be(" 保存 ",-1)])]),_:1},8,["loading"]))]),default:de(()=>{var e;return["view"===ke.value?(Z(),W(ae,{key:0},[se($a,{column:2,border:""},{default:de(()=>[se(Sa,{label:"章节标题",span:2},{default:de(()=>{var e;return[be(pe(null==(e=Ee.value)?void 0:e.chapter_title),1)]}),_:1}),se(Sa,{label:"分类"},{default:de(()=>{var e;return[be(pe((null==(e=Ee.value)?void 0:e.category)||"未分类"),1)]}),_:1}),se(Sa,{label:"质量评分"},{default:de(()=>{var e;return[se(wa,{"model-value":null==(e=Ee.value)?void 0:e.quality_score,disabled:"",max:5},null,8,["model-value"])]}),_:1}),se(Sa,{label:"来源文档",span:2},{default:de(()=>{var e;return[be(pe(null==(e=Ee.value)?void 0:e.doc_name),1)]}),_:1}),se(Sa,{label:"投标结果"},{default:de(()=>{var e;return[se(me,{type:ba(null==(e=Ee.value)?void 0:e.bid_result)},{default:de(()=>{var e;return[be(pe((null==(e=Ee.value)?void 0:e.bid_result)||"待定"),1)]}),_:1},8,["type"])]}),_:1}),se(Sa,{label:"标签"},{default:de(()=>{var e;return[be(pe((null==(e=Ee.value)?void 0:e.tags)||"无"),1)]}),_:1})]),_:1}),fe("div",ra,[t[56]||(t[56]=fe("h4",null,"素材内容",-1)),fe("div",ua,pe(null==(e=Ee.value)?void 0:e.content),1)])],64)):(Z(),ue(Ea,{key:1,model:Te,"label-width":"100px"},{default:de(()=>[se(ka,{label:"章节标题"},{default:de(()=>[se(w,{modelValue:Te.chapter_title,"onUpdate:modelValue":t[22]||(t[22]=e=>Te.chapter_title=e)},null,8,["modelValue"])]),_:1}),se(ka,{label:"分类"},{default:de(()=>[se(Y,{modelValue:Te.category,"onUpdate:modelValue":t[23]||(t[23]=e=>Te.category=e),style:{width:"100%"}},{default:de(()=>[se(R,{label:"技术方案",value:"技术方案"}),se(R,{label:"项目管理",value:"项目管理"}),se(R,{label:"售后服务",value:"售后服务"}),se(R,{label:"企业资质",value:"企业资质"}),se(R,{label:"团队介绍",value:"团队介绍"})]),_:1},8,["modelValue"])]),_:1}),se(ka,{label:"质量评分"},{default:de(()=>[se(wa,{modelValue:Te.quality_score,"onUpdate:modelValue":t[24]||(t[24]=e=>Te.quality_score=e),max:5},null,8,["modelValue"])]),_:1}),se(ka,{label:"标签"},{default:de(()=>[se(w,{modelValue:Te.tags,"onUpdate:modelValue":t[25]||(t[25]=e=>Te.tags=e),placeholder:"逗号分隔的标签"},null,8,["modelValue"])]),_:1}),se(ka,{label:"内容"},{default:de(()=>[se(w,{modelValue:Te.content,"onUpdate:modelValue":t[26]||(t[26]=e=>Te.content=e),type:"textarea",rows:10},null,8,["modelValue"])]),_:1})]),_:1},8,["model"]))]}),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-6dd56761"]]);export{ia as default};
