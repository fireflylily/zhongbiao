import{e,E as a,n as l,R as t,P as o,Q as s,q as n,g as i,ak as r,C as u,D as d,x as p,L as c,r as m,_ as v}from"./index.js";/* empty css                   *//* empty css                                                                          *//* empty css                             *//* empty css                *//* empty css                    *//* empty css                     */import{E as f}from"./el-text-Cbr1aI-6.js";/* empty css               *//* empty css                */import{E as _,a as y}from"./el-select-BRmwHaPV.js";import{aq as h,am as j,an as w,aV as g,aw as b,as as F,au as x,ar as I,aK as k,at as V,aS as C,aX as E,aY as D,ay as P,av as z,aR as R,aJ as S,aT as U}from"./editor-B2OO2pov.js";/* empty css                *//* empty css                                                                        */import{D as q}from"./DocumentUploader-BlFhosNM.js";import{D as T}from"./DocumentPreview-By4_Zaxt.js";import{R as N}from"./RichTextEditor-CO2_Eyir.js";import{u as $,H,S as L,d as B}from"./helpers-Cpqdodjs.js";import{t as J}from"./tender-Bln5F12J.js";import{c as W}from"./company-CgN_f2mJ.js";import{u as M}from"./project-CTyJA4Mq.js";import{u as O}from"./useProjectDocuments-CWPtTqxz.js";import{a as A,E as G}from"./index-D4leEHxh.js";import{E as K}from"./index-DOF8wyI3.js";import{E as Q,a as X}from"./index-CCp-mfyB.js";import{E as Y,a as Z}from"./index-DV_tRJ6B.js";import{E as ee}from"./index-nzMCCPZ_.js";import{E as ae,a as le}from"./index-N8cx6dDB.js";import{E as te}from"./index-BnBGxagZ.js";import{v as oe}from"./directive-nXjVAqB7.js";import{E as se}from"./index-CVQCSiPO.js";import"./index-C2wRk8Ho.js";import"./strings-AttvWK4d.js";import"./index-C3Wd-RFA.js";import"./toNumber-BHhAPexX.js";import"./_baseFindIndex-BTqrMG7V.js";import"./_baseIteratee-C8pVAKYE.js";import"./imageCompressor-CTkRt5bg.js";import"./index-BqOFd9Zn.js";import"./index-2BvDutB9.js";import"./cloneDeep-syPWYH98.js";import"./index-BGcrlS83.js";import"./index-DdajWaCy.js";import"./index-Bf5f8z6I.js";import"./flatMap-IaJ8K9rw.js";import"./map-DjkI9_xQ.js";import"./_baseEach-CJbh0AmI.js";import"./index-DxEuAmkt.js";import"./raf-B6jWGkGX.js";const ne={async processBusinessResponse(a){const l=new FormData;return l.append("company_id",a.company_id.toString()),l.append("project_name",a.project_name),a.tender_no&&l.append("tender_no",a.tender_no),a.date_text&&l.append("date_text",a.date_text),l.append("hitl_file_path",a.hitl_file_path),l.append("use_mcp",!1!==a.use_mcp?"true":"false"),e.post("/process-business-response",l,{headers:{"Content-Type":"multipart/form-data"}})}},ie={class:"business-response"},re={class:"upload-item"},ue={class:"upload-item"},de={class:"generation-controls"},pe={class:"card-header"},ce={class:"header-actions"},me={class:"result-content"},ve={key:0,class:"qualifications-details-section"},fe={style:{margin:"8px 0 0 20px",padding:"0"}},_e={class:"file-info-section"},ye={class:"collapse-header"},he={class:"filename-cell"},je=v(h({__name:"Response",setup(e){M();const{projects:v,selectedProject:h,loadProjects:je,handleProjectChange:we,restoreProjectFromStore:ge}=O(),{useHitlFile:be,hitlFileInfo:Fe,syncing:xe,synced:Ie,loadFromHITL:ke,cancelHitlFile:Ve,syncToHitl:Ce}=$({onFileLoaded:()=>{Re.value.templateFiles=[]}}),{useHitlFile:Ee,hitlFileInfo:De,loadFromHITL:Pe,cancelHitlFile:ze}=$({onFileLoaded:()=>{Re.value.tenderFiles=[]}}),Re=j({projectId:null,companyId:null,projectName:"æ–°é¡¹ç›®",projectNumber:`PRJ-${Date.now()}`,tenderFiles:[],templateFiles:[]}),Se=j([]);w(()=>Se.value.find(e=>e.company_id===Re.value.companyId));const Ue=w(()=>Re.value.projectId&&(Re.value.templateFiles.length>0||be.value)),qe=j(!1),Te=j(0),Ne=j(""),$e=j(null),He=j(!1),Le=j(null),Be=j(""),Je=j(!1),We=j(!1),Me=j(""),Oe=j(""),Ae=j([]),Ge=j([]),Ke=j(!1),Qe=j([]),Xe=async e=>{const{file:l,onSuccess:t,onError:o}=e;try{if(!Re.value.projectId){if(!Re.value.companyId)throw new Error("è¯·å…ˆé€‰æ‹©å…¬å¸");a.info("æ­£åœ¨åˆ›å»ºæ–°é¡¹ç›®...");const e=await J.createProject({company_id:Re.value.companyId,project_name:Re.value.projectName||"æ–°é¡¹ç›®",project_number:Re.value.projectNumber||`PRJ-${Date.now()}`});Re.value.projectId=e.project_id,await je(),a.success("æ–°é¡¹ç›®å·²åˆ›å»º"),await ea()}const e=await J.uploadBusinessTemplate(Re.value.projectId,l);if(!e.success)throw new Error(e.message||"ä¸Šä¼ å¤±è´¥");t(e.data),a.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")}catch(s){o(s),a.error(s.message||"æ¨¡æ¿ä¸Šä¼ å¤±è´¥")}},Ye=async e=>{var l;const{file:t,onSuccess:o,onError:s}=e;try{if(!Re.value.projectId){if(!Re.value.companyId)throw new Error("è¯·å…ˆé€‰æ‹©å…¬å¸");a.info("æ­£åœ¨åˆ›å»ºæ–°é¡¹ç›®...");const e=await J.createProject({company_id:Re.value.companyId,project_name:Re.value.projectName||"æ–°é¡¹ç›®",project_number:Re.value.projectNumber||`PRJ-${Date.now()}`});Re.value.projectId=e.project_id,await je(),a.success("æ–°é¡¹ç›®å·²åˆ›å»º"),await ea()}const e=null==(l=h.value)?void 0:l.company_id;if(!e)throw new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸");const s=new FormData;s.append("file",t),s.append("company_id",e.toString()),s.append("project_id",Re.value.projectId.toString());const n=await J.parseDocumentStructure(s);if(!n.success)throw new Error(n.message||"ä¸Šä¼ å¤±è´¥");o(n.data),a.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(n){s(n),a.error(n.message||"æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},Ze=async()=>{try{const e=await W.getCompanies();Se.value=e.data||[]}catch(e){a.error("åŠ è½½å…¬å¸åˆ—è¡¨å¤±è´¥")}},ea=async()=>{await we(Re.value.projectId,{onClear:()=>{$e.value=null,Ne.value="",Re.value.tenderFiles=[],Re.value.templateFiles=[],He.value=!1,Be.value="",Ae.value=[],Ge.value=[],be.value&&Ve(),Ee.value&&ze()},onDocumentsLoaded:e=>{e.tenderFile&&Pe(e,"tenderFile"),e.templateFile&&ke(e,"templateFile"),e.businessResponseFile&&($e.value=e.businessResponseFile,He.value=!1,a.info('æ£€æµ‹åˆ°å†å²å•†åŠ¡åº”ç­”æ–‡ä»¶ï¼Œç‚¹å‡»"åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€"å¯ç¼–è¾‘'))}}),Re.value.projectId&&await da(),Re.value.projectId||(Re.value.projectNumber=`PRJ-${Date.now()}`)},aa=()=>{a.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},la=()=>{a.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")},ta=async()=>{var e;if(Re.value.projectId){qe.value=!0,Te.value=0,Ne.value="",$e.value=null,He.value=!0,Be.value='<h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1><p style="color: #909399;">AIæ­£åœ¨ç”Ÿæˆå†…å®¹ï¼Œè¯·ç¨å€™...</p>',setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100);try{Ne.value="æ­£åœ¨åŠ è½½é¡¹ç›®ä¿¡æ¯...\n";const l=(await J.getProject(Re.value.projectId)).data,t=null==(e=l.step1_data)?void 0:e.response_file_path;if(!t)throw new Error("æœªæ‰¾åˆ°å•†åŠ¡åº”ç­”æ¨¡æ¿æ–‡ä»¶è·¯å¾„ï¼Œè¯·å…ˆåœ¨æ ‡ä¹¦ç®¡ç†ä¸­ä¸Šä¼ æ¨¡æ¿");Ne.value+="æ­£åœ¨å¤„ç†å•†åŠ¡åº”ç­”æ–‡æ¡£...\n",Te.value=30;const o=await ne.processBusinessResponse({company_id:l.company_id,project_name:l.project_name,tender_no:l.project_number||"",date_text:l.bidding_time||"",hitl_file_path:t,use_mcp:!0});Te.value=80,Ne.value+="å¤„ç†å®Œæˆï¼Œæ­£åœ¨ç”Ÿæˆç»“æœ...\n";const s=o.data?o.data:o;if(!s.success)throw new Error(s.message||s.error||"å¤„ç†å¤±è´¥");Te.value=100,Ne.value+=s.message+"\n",$e.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:s.stats||{},message:s.message},await oa(s.output_file),a.success("å•†åŠ¡åº”ç­”ç”Ÿæˆå®Œæˆï¼å¯ä»¥ç¼–è¾‘äº†"),s.output_file&&Re.value.projectId&&await Ce(Re.value.projectId,s.output_file,"business_response")}catch(l){Ne.value+=`\nâŒ é”™è¯¯: ${l.message}\n`,Le.value&&Le.value.appendContent(`<p style="color: red;">âŒ é”™è¯¯: ${l.message}</p>`),a.error(l.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{qe.value=!1,Te.value<100&&(Te.value=0)}}else a.warning("è¯·å…ˆé€‰æ‹©é¡¹ç›®")},oa=async e=>{try{Be.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const a=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),l=await a.json();if(!l.success||!l.html_content)throw new Error(l.error||"è½¬æ¢å¤±è´¥");Be.value=l.html_content,Le.value&&Le.value.setContent(l.html_content)}catch(l){Be.value=`\n      <h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${l.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"ä¸‹è½½Wordæ–‡æ¡£æŸ¥çœ‹</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,a.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨ä¸‹è½½åŠŸèƒ½æˆ–æ‰‹åŠ¨è¾“å…¥")}},sa=async e=>{var l,t;if(Re.value.projectId){Je.value=!0;try{const a=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:Re.value.projectId,document_type:"business_response",original_file:null==(l=$e.value)?void 0:l.outputFile})}),o=await a.json();if(!o.success)throw new Error(o.error||"ä¿å­˜å¤±è´¥");$e.value={success:!0,outputFile:o.output_file,downloadUrl:o.download_url,stats:(null==(t=$e.value)?void 0:t.stats)||{},message:"æ–‡æ¡£å·²ä¿å­˜"},o.output_file&&await Ce(Re.value.projectId,o.output_file,"business_response")}catch(o){throw o}finally{Je.value=!1}}else a.error("é¡¹ç›®IDæ— æ•ˆ")},na=()=>{$e.value?$e.value.downloadUrl?We.value=!0:a.warning("æ–‡æ¡£åœ°å€æ— æ•ˆ"):a.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},ia=async()=>{var e;if($e.value)try{const l=$e.value.downloadUrl,t=`å•†åŠ¡åº”ç­”-${(null==(e=h.value)?void 0:e.project_name)||"æ–‡æ¡£"}-${Date.now()}.docx`;await B(l,t),a.success("Wordæ–‡æ¡£ä¸‹è½½æˆåŠŸ")}catch(l){a.error(l.message||"æ–‡æ¡£ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}else a.warning("æš‚æ— æ–‡æ¡£å¯ä¸‹è½½")},ra=async()=>{var e;(null==(e=$e.value)?void 0:e.outputFile)?Re.value.projectId?await Ce(Re.value.projectId,$e.value.outputFile,"business_response"):a.error("é¡¹ç›®IDæ— æ•ˆ"):a.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},ua=e=>{if(!e)return"-";let a=e;try{a=decodeURIComponent(e)}catch{}const l=a.split("/");return l[l.length-1]||"-"},da=async()=>{if(Re.value.projectId){Ke.value=!0;try{const e=await fetch(`/api/business-files?project_id=${Re.value.projectId}`),a=await e.json();if(!a.success)throw new Error(a.error||"åŠ è½½å¤±è´¥");Ge.value=a.data||[]}catch(e){a.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{Ke.value=!1}}else Ge.value=[]},pa=e=>{const a=["B","KB","MB","GB"];let l=e,t=0;for(;l>=1024&&t<a.length-1;)l/=1024,t++;return`${l.toFixed(1)} ${a[t]}`},ca=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}};return g(async()=>{await Promise.all([je(),Ze()]);const e=await ge({onClear:()=>{$e.value=null,Ne.value="",Re.value.tenderFiles=[],Re.value.templateFiles=[],He.value=!1,Be.value="",be.value&&Ve(),Ee.value&&ze()},onDocumentsLoaded:e=>{e.tenderFile&&Pe(e,"tenderFile"),e.templateFile&&ke(e,"templateFile"),e.businessResponseFile&&($e.value=e.businessResponseFile,He.value=!1,a.info('æ£€æµ‹åˆ°å†å²å•†åŠ¡åº”ç­”æ–‡ä»¶ï¼Œç‚¹å‡»"åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€"å¯ç¼–è¾‘'))}});e&&(Re.value.projectId=e)}),(e,j)=>{const w=l,g=y,$=_,J=o,W=G,M=s,O=A,ne=t,je=K,we=n,ge=ee,ke=Z,Ce=f,Pe=i,Te=Y,Ne=le,Je=te,Ze=ae,oa=Q,ma=X,va=se,fa=oe;return F(),b("div",ie,[x(je,{class:"project-section",shadow:"never"},{default:V(()=>[x(w,{type:"info",closable:!1,style:{"margin-bottom":"16px"}},{default:V(()=>[...j[12]||(j[12]=[C(" ğŸ’¡ æç¤ºï¼šå¯é€‰æ‹©ç°æœ‰é¡¹ç›®ï¼Œæˆ–é€‰æ‹©å…¬å¸åæ–°å»ºé¡¹ç›®å¹¶ä¸Šä¼ æ–‡æ¡£ ",-1)])]),_:1}),x(ne,{model:Re.value,"label-width":"100px"},{default:V(()=>[x(O,{gutter:20},{default:V(()=>[x(W,{span:12},{default:V(()=>[x(J,{label:"é¡¹ç›®"},{default:V(()=>[x($,{modelValue:Re.value.projectId,"onUpdate:modelValue":j[0]||(j[0]=e=>Re.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®æˆ–ç›´æ¥æ–°å»º",filterable:"",clearable:"",onChange:ea,style:{width:"100%"}},{default:V(()=>[(F(!0),b(E,null,D(P(v),e=>(F(),I(g,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),x(W,{span:12},{default:V(()=>[x(J,{label:"å…¬å¸"},{default:V(()=>{var e;return[Re.value.projectId?(F(),I(M,{key:0,value:(null==(e=P(h))?void 0:e.company_name)||"-",disabled:""},null,8,["value"])):(F(),I($,{key:1,modelValue:Re.value.companyId,"onUpdate:modelValue":j[1]||(j[1]=e=>Re.value.companyId=e),placeholder:"è¯·é€‰æ‹©å…¬å¸ï¼ˆå¿…å¡«ï¼‰",filterable:"",style:{width:"100%"}},{default:V(()=>[(F(!0),b(E,null,D(Se.value,e=>(F(),I(g,{key:e.company_id,label:e.company_name,value:e.company_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]}),_:1})]),_:1})]),_:1}),Re.value.projectId?k("",!0):(F(),I(O,{key:0,gutter:20},{default:V(()=>[x(W,{span:12},{default:V(()=>[x(J,{label:"é¡¹ç›®åç§°"},{default:V(()=>[x(M,{modelValue:Re.value.projectName,"onUpdate:modelValue":j[2]||(j[2]=e=>Re.value.projectName=e),placeholder:"æ–°é¡¹ç›®"},null,8,["modelValue"])]),_:1})]),_:1}),x(W,{span:12},{default:V(()=>[x(J,{label:"é¡¹ç›®ç¼–å·"},{default:V(()=>[x(M,{modelValue:Re.value.projectNumber,"onUpdate:modelValue":j[3]||(j[3]=e=>Re.value.projectNumber=e),placeholder:"PRJ-..."},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}))]),_:1},8,["model"])]),_:1}),x(je,{class:"upload-section",shadow:"never"},{default:V(()=>[x(O,{gutter:20},{default:V(()=>[x(W,{span:12},{default:V(()=>{var e;return[z("div",re,[j[13]||(j[13]=z("h4",null,[C("å•†åŠ¡åº”ç­”æ¨¡æ¿ "),z("span",{class:"required"},"*")],-1)),P(be)?(F(),I(P(H),{key:0,"file-info":P(Fe),label:"å•†åŠ¡åº”ç­”æ¨¡æ¿:",onCancel:P(Ve)},null,8,["file-info","onCancel"])):Re.value.templateFiles.length>0?(F(),I(P(H),{key:1,"file-info":{filename:Re.value.templateFiles[0].name,file_path:(null==(e=Re.value.templateFiles[0].response)?void 0:e.file_path)||"",file_size:Re.value.templateFiles[0].size},label:"å•†åŠ¡åº”ç­”æ¨¡æ¿:","show-tag":!1,type:"info","cancel-text":"åˆ é™¤æ–‡ä»¶",onCancel:j[4]||(j[4]=e=>Re.value.templateFiles=[])},null,8,["file-info"])):(F(),I(P(q),{key:2,modelValue:Re.value.templateFiles,"onUpdate:modelValue":j[5]||(j[5]=e=>Re.value.templateFiles=e),"http-request":Xe,accept:".doc,.docx",limit:1,"max-size":100,drag:"","tip-text":"å¿…é¡»ä¸Šä¼ å•†åŠ¡åº”ç­”æ¨¡æ¿ï¼Œç”¨äºç”Ÿæˆåº”ç­”æ–‡æ¡£",onSuccess:la},null,8,["modelValue"]))])]}),_:1}),x(W,{span:12},{default:V(()=>{var e;return[z("div",ue,[j[14]||(j[14]=z("h4",null,"æ‹›æ ‡æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰",-1)),P(Ee)?(F(),I(P(H),{key:0,"file-info":P(De),label:"æ‹›æ ‡æ–‡æ¡£:",onCancel:P(ze)},null,8,["file-info","onCancel"])):Re.value.tenderFiles.length>0?(F(),I(P(H),{key:1,"file-info":{filename:Re.value.tenderFiles[0].name,file_path:(null==(e=Re.value.tenderFiles[0].response)?void 0:e.file_path)||"",file_size:Re.value.tenderFiles[0].size},label:"æ‹›æ ‡æ–‡æ¡£:","show-tag":!1,type:"info","cancel-text":"åˆ é™¤æ–‡ä»¶",onCancel:j[6]||(j[6]=e=>Re.value.tenderFiles=[])},null,8,["file-info"])):(F(),I(P(q),{key:2,modelValue:Re.value.tenderFiles,"onUpdate:modelValue":j[7]||(j[7]=e=>Re.value.tenderFiles=e),"http-request":Ye,accept:".pdf,.doc,.docx",limit:5,"max-size":50,drag:"","tip-text":"å¯é€‰ä¸Šä¼ æ‹›æ ‡æ–‡æ¡£ä½œä¸ºå‚è€ƒï¼Œæ”¯æŒPDFã€Wordæ ¼å¼ï¼Œæœ€å¤§50MB",onSuccess:aa},null,8,["modelValue"]))])]}),_:1})]),_:1}),z("div",de,[x(we,{type:"primary",size:"large",disabled:!Ue.value,loading:qe.value,onClick:ta},{default:V(()=>[...j[15]||(j[15]=[C(" å¼€å§‹ç”Ÿæˆå•†åŠ¡åº”ç­” ",-1)])]),_:1},8,["disabled","loading"])])]),_:1}),He.value?(F(),I(je,{key:0,class:"editor-section",shadow:"never"},{default:V(()=>[x(P(N),{ref_key:"editorRef",ref:Le,modelValue:Be.value,"onUpdate:modelValue":j[8]||(j[8]=e=>Be.value=e),title:"å•†åŠ¡åº”ç­”æ–‡æ¡£",streaming:qe.value,height:1e3,onSave:sa,onPreview:na,onExport:ia},null,8,["modelValue","streaming"])]),_:1})):k("",!0),He.value&&$e.value?(F(),I(ma,{key:1,modelValue:Ae.value,"onUpdate:modelValue":j[9]||(j[9]=e=>Ae.value=e),class:"result-collapse"},{default:V(()=>[x(oa,{name:"result",title:"ğŸ“„ æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"},{default:V(()=>[x(je,{class:"result-section",shadow:"never"},{header:V(()=>[z("div",pe,[z("span",null,R($e.value.isHistory?"ğŸ“„ å†å²åº”ç­”æ–‡ä»¶":"âœ… ç”Ÿæˆç»“æœ"),1),z("div",ce,[x(we,{type:"primary",icon:P(u),onClick:na},{default:V(()=>[...j[16]||(j[16]=[C(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),x(we,{type:"success",icon:P(d),onClick:ia},{default:V(()=>[...j[17]||(j[17]=[C(" ä¸‹è½½Wordæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),P(Ie)?(F(),I(ge,{key:1,type:"success",size:"large"},{default:V(()=>[...j[19]||(j[19]=[C(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(F(),I(we,{key:0,type:"info",icon:P(p),loading:P(xe),onClick:ra},{default:V(()=>[...j[18]||(j[18]=[C(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),x(we,{type:"primary",icon:P(c),onClick:ta},{default:V(()=>[...j[20]||(j[20]=[C(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:V(()=>{var e,a,l,t;return[z("div",me,[x(w,{type:$e.value.isHistory?"info":"success",title:$e.value.message,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["type","title"]),x(P(L),{title:"å¤„ç†ç»Ÿè®¡",stats:$e.value.stats},null,8,["stats"]),(null==(a=null==(e=$e.value.stats)?void 0:e.qualifications_details)?void 0:a.length)>0?(F(),b("div",ve,[j[23]||(j[23]=z("h4",null,"ğŸ“‹ èµ„è´¨å¤„ç†è¯¦æƒ…",-1)),x(Te,{data:$e.value.stats.qualifications_details,border:"",stripe:"",style:{"margin-top":"16px"}},{default:V(()=>[x(ke,{type:"index",label:"#",width:"60",align:"center"}),x(ke,{prop:"display_title",label:"èµ„è´¨åç§°","min-width":"200"},{default:V(({row:e})=>[z("div",null,[z("strong",null,R(e.display_title),1),"id_card"===e.resource_type?(F(),I(ge,{key:0,type:"info",size:"small",style:{"margin-left":"8px"}},{default:V(()=>[...j[21]||(j[21]=[C(" èº«ä»½è¯ ",-1)])]),_:1})):k("",!0)])]),_:1}),x(ke,{prop:"qual_name",label:"ç±»åˆ«",width:"120",align:"center"},{default:V(({row:e})=>{return[x(ge,{type:(a=e.qual_name,{"åŸºæœ¬èµ„è´¨":"danger","ä¿¡ç”¨è¯æ˜":"success","èº«ä»½è¯æ˜":"primary","è´¢åŠ¡æ–‡ä»¶":"warning","ä¿¡æ¯å®‰å…¨":"info","ç”µä¿¡èµ„è´¨":"warning","ITæœåŠ¡":"info","è´¨é‡ç®¡ç†":"success","è½¯ä»¶èƒ½åŠ›":"info","è¡Œä¸šèµ„è´¨":"warning","çŸ¥è¯†äº§æƒ":""}[a]||""),size:"small"},{default:V(()=>[C(R(e.qual_name),1)]),_:2},1032,["type"])];var a}),_:1}),x(ke,{prop:"total_pages",label:"å›¾ç‰‡æ•°",width:"100",align:"center"},{default:V(({row:e})=>[x(Ce,{type:"primary",size:"large"},{default:V(()=>[z("strong",null,R(e.total_pages),1),C(" "+R("id_card"===e.resource_type?"é¢":"é¡µ"),1)]),_:2},1024)]),_:1}),x(ke,{label:"çŠ¶æ€",width:"80",align:"center"},{default:V(()=>[x(Pe,{color:"#67c23a",size:20},{default:V(()=>[x(P(r))]),_:1})]),_:1})]),_:1},8,["data"]),(null==(t=null==(l=$e.value.stats)?void 0:l.missing_qualifications)?void 0:t.length)>0?(F(),I(w,{key:0,type:"warning",closable:!1,style:{"margin-top":"16px"}},{title:V(()=>[...j[22]||(j[22]=[C(" ä»¥ä¸‹èµ„è´¨æ¨¡æ¿æœ‰å ä½ç¬¦ä½†æœªä¸Šä¼ æ–‡ä»¶ ",-1)])]),default:V(()=>[z("ul",fe,[(F(!0),b(E,null,D($e.value.stats.missing_qualifications,(e,a)=>(F(),b("li",{key:a},R(e.qual_name||e.qual_key),1))),128))])]),_:1})):k("",!0)])):k("",!0),z("div",_e,[j[24]||(j[24]=z("h4",null,"ç”Ÿæˆæ–‡ä»¶",-1)),x(Ze,{column:2,border:""},{default:V(()=>[x(Ne,{label:"æ–‡ä»¶å"},{default:V(()=>[C(R(ua($e.value.outputFile)),1)]),_:1}),x(Ne,{label:"ä¸‹è½½åœ°å€"},{default:V(()=>[x(Je,{href:$e.value.downloadUrl,type:"primary"},{default:V(()=>[C(R(ua($e.value.downloadUrl)),1)]),_:1},8,["href"])]),_:1})]),_:1})])])]}),_:1})]),_:1})]),_:1},8,["modelValue"])):k("",!0),Re.value.projectId?(F(),I(ma,{key:2,modelValue:Qe.value,"onUpdate:modelValue":j[10]||(j[10]=e=>Qe.value=e),class:"history-collapse"},{default:V(()=>[x(oa,{name:"history"},{title:V(()=>[z("div",ye,[z("span",null,"ğŸ“‚ æœ¬é¡¹ç›®å†å²æ–‡ä»¶ ("+R(Ge.value.length)+")",1),Qe.value?(F(),I(we,{key:0,type:"primary",size:"small",loading:Ke.value,onClick:U(da,["stop"]),style:{"margin-left":"16px"}},{default:V(()=>[...j[25]||(j[25]=[C(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):k("",!0)])]),default:V(()=>[x(je,{shadow:"never",style:{border:"none"}},{default:V(()=>[S((F(),I(Te,{data:Ge.value,border:"",stripe:"","max-height":"400"},{default:V(()=>[x(ke,{type:"index",label:"åºå·",width:"60"}),x(ke,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:V(({row:e})=>[z("div",he,[x(Pe,null,{default:V(()=>[x(P(m))]),_:1}),z("span",null,R(e.filename),1)])]),_:1}),x(ke,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:V(({row:e})=>[C(R(pa(e.size)),1)]),_:1}),x(ke,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:V(({row:e})=>[C(R(ca(e.process_time)),1)]),_:1}),x(ke,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:V(({row:e})=>[x(we,{type:"primary",size:"small",onClick:l=>{var t;(t=e).file_path?(Me.value=t.file_path,Oe.value=t.filename,We.value=!0):a.warning("æ— æ³•è·å–æ–‡ä»¶ä¿¡æ¯")}},{default:V(()=>[...j[26]||(j[26]=[C(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),x(we,{type:"success",size:"small",onClick:l=>(async e=>{try{if(!e.download_url)return void a.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const l=e.filename||"å•†åŠ¡åº”ç­”.docx";B(e.download_url,l),a.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(l){a.error(l.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}})(e)},{default:V(()=>[...j[27]||(j[27]=[C(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[fa,Ke.value]]),Ke.value||0!==Ge.value.length?k("",!0):(F(),I(va,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"])):k("",!0),x(P(T),{modelValue:We.value,"onUpdate:modelValue":j[11]||(j[11]=e=>We.value=e),"file-url":Me.value,"file-name":Oe.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-991f7496"]]);export{je as default};
