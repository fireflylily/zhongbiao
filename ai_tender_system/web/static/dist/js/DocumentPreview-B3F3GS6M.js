import{bT as e,aK as t,bX as a,aR as s,aN as l,aS as o,a_ as i,b5 as d,cy as r,aU as n,b2 as p,bY as u,av as g,aw as m,bd as v,b3 as f,aL as y,aM as h,aQ as c,ch as w,aO as b,cj as x,bp as _,b6 as H,aZ as T}from"./index.js";/* empty css                   */import{r as B}from"./DocumentPreview.vue_vue_type_style_index_0_scoped_056f7814_lang-Cvhffcax.js";import{v as P}from"./directive-BQ8mY-Bz.js";const E=t({name:"ElCollapseTransition"});const W=u(e(t({...E,setup(e){const t=a("collapse-transition"),u=e=>{e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom},g={beforeEnter(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.style.height&&(e.dataset.elExistsHeight=e.style.height),e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0},enter(e){requestAnimationFrame(()=>{e.dataset.oldOverflow=e.style.overflow,e.dataset.elExistsHeight?e.style.maxHeight=e.dataset.elExistsHeight:0!==e.scrollHeight?e.style.maxHeight=`${e.scrollHeight}px`:e.style.maxHeight=0,e.style.paddingTop=e.dataset.oldPaddingTop,e.style.paddingBottom=e.dataset.oldPaddingBottom,e.style.overflow="hidden"})},afterEnter(e){e.style.maxHeight="",e.style.overflow=e.dataset.oldOverflow},enterCancelled(e){u(e)},beforeLeave(e){e.dataset||(e.dataset={}),e.dataset.oldPaddingTop=e.style.paddingTop,e.dataset.oldPaddingBottom=e.style.paddingBottom,e.dataset.oldOverflow=e.style.overflow,e.style.maxHeight=`${e.scrollHeight}px`,e.style.overflow="hidden"},leave(e){0!==e.scrollHeight&&(e.style.maxHeight=0,e.style.paddingTop=0,e.style.paddingBottom=0)},afterLeave(e){u(e)},leaveCancelled(e){u(e)}};return(e,a)=>(l(),s(p,d({name:n(t).b()},r(g)),{default:o(()=>[i(e.$slots,"default")]),_:3},16,["name"]))}}),[["__file","collapse-transition.vue"]])),k={"element-loading-text":"正在加载文档...",class:"preview-container"},V=T(t({__name:"DocumentPreview",props:{modelValue:{type:Boolean,default:!1},fileUrl:{default:""},fileName:{default:"文档预览"}},emits:["update:modelValue"],setup(e,{emit:t}){const a=e,i=t,d=g(!1),r=g(""),n=g(null),p=m({get:()=>a.modelValue,set:e=>i("update:modelValue",e)}),u=m(()=>`文档预览 - ${a.fileName||"未命名文档"}`),T=()=>{p.value=!1};return v(()=>a.modelValue,async e=>{e&&a.fileUrl?(await _(),(async()=>{if(a.fileUrl){d.value=!0,r.value="";try{const e=(e=>{if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/api/"))return e;if(e.startsWith("/download/"))return`/api/files/serve/download/${e.substring(10)}`;let t=e;const a=["/Users/lvhe/Downloads/zhongbiao/zhongbiao/","/var/www/ai-tender-system/"];for(const s of a)if(t.startsWith(s)){t=t.substring(s.length);break}return t.startsWith("ai_tender_system/data/")&&(t=t.substring(22)),t.startsWith("outputs/")&&(t="download/"+t.substring(8)),`/api/files/serve/${t}`})(a.fileUrl),t=await fetch(e);if(!t.ok)throw new Error(`HTTP错误: ${t.status}`);const s=await t.arrayBuffer();if(await _(),!n.value)throw new Error("预览容器未找到");n.value.innerHTML="",await B(s,n.value,void 0,{className:"docx-preview",inWrapper:!0,ignoreWidth:!1,ignoreHeight:!1,ignoreFonts:!1,breakPages:!0,ignoreLastRenderedPageBreak:!0,experimental:!0,trimXmlDeclaration:!0})}catch(e){r.value=`文档预览失败: ${e.message||"未知错误"}`,H.error("文档预览失败，请检查文件是否正确或尝试下载后查看")}finally{d.value=!1}}else r.value="文档地址不能为空"})()):(r.value="",n.value&&(n.value.innerHTML=""))}),(e,t)=>{const a=w,i=x,g=P;return l(),s(i,{modelValue:p.value,"onUpdate:modelValue":t[0]||(t[0]=e=>p.value=e),title:u.value,width:"80%","before-close":T,"destroy-on-close":""},{default:o(()=>[f((l(),y("div",k,[r.value?(l(),s(a,{key:0,type:"error",title:r.value,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["title"])):h("",!0),c("div",{ref_key:"previewContentRef",ref:n,class:"preview-content",style:b({display:r.value?"none":"block"})},null,4)])),[[g,d.value]])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-056f7814"]]);export{V as D,W as E};
