import{k as e,O as a,e as l,s as t,d as s,E as o,ah as i,D as r,F as n,y as u,J as c,i as d,q as p}from"./index.js";/* empty css                   *//* empty css                                                        *//* empty css                                                                          *//* empty css                             *//* empty css                *//* empty css                    *//* empty css                     */import{E as m}from"./el-text-BBUgZhzi.js";/* empty css               *//* empty css                */import{E as v,a as f}from"./el-select-DZeK41OH.js";import{am as _,an as h,ao as y,aX as w,au as j,ar as g,ax as b,aq as F,av as x,as as I,aw as k,az as V,aA as z,ay as C,aC as E,aD as P,at as N,aV as D}from"./editor-CkQC1Uq_.js";/* empty css                */import{D as U}from"./DocumentUploader-Cp0a7KJm.js";import{_ as S}from"./DocumentPreview.vue_vue_type_script_setup_true_lang-BHeot2x4.js";import{R}from"./RichTextEditor-lCTUu7yA.js";import{u as q,S as $,d as T}from"./helpers-xdhHlSij.js";import{t as H}from"./tender-DY5X_q7i.js";import{c as J}from"./company-CHa0NuIL.js";import{u as L}from"./project-77ADDdE9.js";import{u as B}from"./useProjectDocuments-C6DN99-z.js";import{E as W}from"./index-CPjPqG6g.js";import{E as O,a as M}from"./index-MMbAUZZE.js";import{E as A,a as G}from"./index-Ct_FIOsr.js";import{E as X}from"./index-Jdk3-L3D.js";import{E as K,a as Q}from"./index-BgJNQ3LN.js";import{E as Y}from"./index-ibLe784A.js";import{v as Z}from"./directive-BoVrmPHi.js";import{E as ee}from"./index-CwbKUXgF.js";import"./index-DO7-lxyV.js";import"./strings-DygAwr0H.js";import"./index-C1LY3n9p.js";import"./toNumber-B_atpBHU.js";import"./_baseFindIndex-BTqrMG7V.js";import"./_baseIteratee-CwtmDzoV.js";import"./imageCompressor-CTkRt5bg.js";import"./index-ZlCuKr4C.js";import"./index-DzllSHb7.js";import"./cloneDeep-syPWYH98.js";import"./index-Dk4OhDm6.js";import"./index-CwhopI9-.js";import"./index-DE7eCqN4.js";import"./flatMap-D7uPVDtS.js";import"./map-B_SlaKiF.js";import"./_baseEach-V8knk74i.js";import"./index-lVhqCxeU.js";import"./raf-BZHcGSIv.js";const ae={async processBusinessResponse(a){const l=new FormData;return l.append("company_id",a.company_id.toString()),l.append("project_name",a.project_name),a.tender_no&&l.append("tender_no",a.tender_no),a.date_text&&l.append("date_text",a.date_text),l.append("hitl_file_path",a.hitl_file_path),l.append("use_mcp",!1!==a.use_mcp?"true":"false"),e.post("/process-business-response",l,{headers:{"Content-Type":"multipart/form-data"}})}},le={class:"business-response"},te={class:"panel-row project-row"},se={class:"row-item"},oe={class:"row-item"},ie={class:"panel-row project-row"},re={class:"row-item"},ne={key:0,class:"panel-row project-row"},ue={class:"row-item"},ce={class:"row-item"},de={class:"panel-row project-row document-row"},pe={class:"row-item"},me={key:0,class:"file-chip file-chip--success"},ve=["title"],fe={key:1,class:"file-chip file-chip--info"},_e=["title"],he={key:2,class:"file-placeholder"},ye={class:"row-item"},we={key:0,class:"file-chip file-chip--success"},je=["title"],ge={key:1,class:"file-chip file-chip--info"},be=["title"],Fe={key:2,class:"file-placeholder"},xe={class:"panel-actions"},Ie={class:"card-header"},ke={class:"header-actions"},Ve={class:"result-content"},ze={key:0,class:"qualifications-details-section"},Ce={style:{margin:"8px 0 0 20px",padding:"0"}},Ee={class:"file-info-section"},Pe={class:"collapse-header"},Ne={class:"filename-cell"},De=p(_({__name:"Response",setup(e){L();const{projects:p,selectedProject:_,loadProjects:De,handleProjectChange:Ue,restoreProjectFromStore:Se}=B(),{useHitlFile:Re,hitlFileInfo:qe,syncing:$e,synced:Te,loadFromHITL:He,cancelHitlFile:Je,syncToHitl:Le}=q({onFileLoaded:()=>{Ae.value.templateFiles=[]}}),{useHitlFile:Be,hitlFileInfo:We,loadFromHITL:Oe,cancelHitlFile:Me}=q({onFileLoaded:()=>{Ae.value.tenderFiles=[]}}),Ae=h({projectId:null,companyId:null,projectName:"æ–°é¡¹ç›®",projectNumber:`PRJ-${Date.now()}`,tenderFiles:[],templateFiles:[],authorizedPersonName:""}),Ge=h([]);y(()=>Ge.value.find(e=>e.company_id===Ae.value.companyId));const Xe=y(()=>Ae.value.projectId&&(Ae.value.templateFiles.length>0||Re.value)),Ke=h(!1),Qe=h(0),Ye=h(""),Ze=h(null),ea=h(!1),aa=h(null),la=h(""),ta=h(!1),sa=h(!1),oa=h(""),ia=h(""),ra=h([]),na=h([]),ua=h(!1),ca=h([]),da=async e=>{const{file:a,onSuccess:l,onError:t}=e;try{if(!Ae.value.projectId){if(!Ae.value.companyId)throw new Error("è¯·å…ˆé€‰æ‹©å…¬å¸");d.info("æ­£åœ¨åˆ›å»ºæ–°é¡¹ç›®...");const e=await H.createProject({company_id:Ae.value.companyId,project_name:Ae.value.projectName||"æ–°é¡¹ç›®",project_number:Ae.value.projectNumber||`PRJ-${Date.now()}`});Ae.value.projectId=e.project_id,await De(),d.success("æ–°é¡¹ç›®å·²åˆ›å»º"),await va()}const e=await H.uploadBusinessTemplate(Ae.value.projectId,a);if(!e.success)throw new Error(e.message||"ä¸Šä¼ å¤±è´¥");l(e.data),d.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")}catch(s){t(s),d.error(s.message||"æ¨¡æ¿ä¸Šä¼ å¤±è´¥")}},pa=async e=>{var a;const{file:l,onSuccess:t,onError:s}=e;try{if(!Ae.value.projectId){if(!Ae.value.companyId)throw new Error("è¯·å…ˆé€‰æ‹©å…¬å¸");d.info("æ­£åœ¨åˆ›å»ºæ–°é¡¹ç›®...");const e=await H.createProject({company_id:Ae.value.companyId,project_name:Ae.value.projectName||"æ–°é¡¹ç›®",project_number:Ae.value.projectNumber||`PRJ-${Date.now()}`});Ae.value.projectId=e.project_id,await De(),d.success("æ–°é¡¹ç›®å·²åˆ›å»º"),await va()}const e=null==(a=_.value)?void 0:a.company_id;if(!e)throw new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸");const s=new FormData;s.append("file",l),s.append("company_id",e.toString()),s.append("project_id",Ae.value.projectId.toString());const o=await H.parseDocumentStructure(s);if(!o.success)throw new Error(o.message||"ä¸Šä¼ å¤±è´¥");t(o.data),d.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(o){s(o),d.error(o.message||"æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},ma=async()=>{try{const e=await J.getCompanies();Ge.value=e.data||[]}catch(e){d.error("åŠ è½½å…¬å¸åˆ—è¡¨å¤±è´¥")}},va=async()=>{var e;await Ue(Ae.value.projectId,{onClear:()=>{Ze.value=null,Ye.value="",Ae.value.tenderFiles=[],Ae.value.templateFiles=[],Ae.value.authorizedPersonName="",ea.value=!1,la.value="",ra.value=[],na.value=[],Re.value&&Je(),Be.value&&Me()},onDocumentsLoaded:e=>{e.tenderFile&&Oe(e,"tenderFile"),e.templateFile&&He(e,"templateFile"),e.businessResponseFile&&(Ze.value=e.businessResponseFile,ea.value=!1)}}),Ae.value.projectId&&(await xa(),(null==(e=_.value)?void 0:e.authorized_person_name)&&(Ae.value.authorizedPersonName=_.value.authorized_person_name)),Ae.value.projectId||(Ae.value.projectNumber=`PRJ-${Date.now()}`)},fa=()=>{d.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},_a=()=>{d.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")},ha=async()=>{var e;if(Ae.value.projectId){Ke.value=!0,Qe.value=0,Ye.value="",Ze.value=null,ea.value=!0,la.value='<h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1><p style="color: #909399;">AIæ­£åœ¨ç”Ÿæˆå†…å®¹ï¼Œè¯·ç¨å€™...</p>',setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100);try{Ye.value="æ­£åœ¨åŠ è½½é¡¹ç›®ä¿¡æ¯...\n";const a=(await H.getProject(Ae.value.projectId)).data,l=null==(e=a.step1_data)?void 0:e.response_file_path;if(!l)throw new Error("æœªæ‰¾åˆ°å•†åŠ¡åº”ç­”æ¨¡æ¿æ–‡ä»¶è·¯å¾„ï¼Œè¯·å…ˆåœ¨æ ‡ä¹¦ç®¡ç†ä¸­ä¸Šä¼ æ¨¡æ¿");Ye.value+="æ­£åœ¨å¤„ç†å•†åŠ¡åº”ç­”æ–‡æ¡£...\n",Qe.value=30;const t=await ae.processBusinessResponse({company_id:a.company_id,project_name:a.project_name,tender_no:a.project_number||"",date_text:a.bidding_time||"",hitl_file_path:l,use_mcp:!0});Qe.value=80,Ye.value+="å¤„ç†å®Œæˆï¼Œæ­£åœ¨ç”Ÿæˆç»“æœ...\n";const s=t.data?t.data:t;if(!s.success)throw new Error(s.message||s.error||"å¤„ç†å¤±è´¥");Qe.value=100,Ye.value+=s.message+"\n",Ze.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:s.stats||{},message:s.message},await ya(s.output_file),d.success("å•†åŠ¡åº”ç­”ç”Ÿæˆå®Œæˆï¼å¯ä»¥ç¼–è¾‘äº†"),s.output_file&&Ae.value.projectId&&await Le(Ae.value.projectId,s.output_file,"business_response")}catch(a){Ye.value+=`\nâŒ é”™è¯¯: ${a.message}\n`,aa.value&&aa.value.appendContent(`<p style="color: red;">âŒ é”™è¯¯: ${a.message}</p>`),d.error(a.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{Ke.value=!1,Qe.value<100&&(Qe.value=0)}}else d.warning("è¯·å…ˆé€‰æ‹©é¡¹ç›®")},ya=async e=>{try{la.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const a=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),l=await a.json();if(!l.success||!l.html_content)throw new Error(l.error||"è½¬æ¢å¤±è´¥");la.value=l.html_content,aa.value&&aa.value.setContent(l.html_content)}catch(a){la.value=`\n      <h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${a.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"ä¸‹è½½Wordæ–‡æ¡£æŸ¥çœ‹</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,d.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨ä¸‹è½½åŠŸèƒ½æˆ–æ‰‹åŠ¨è¾“å…¥")}},wa=async e=>{var a,l;if(Ae.value.projectId){ta.value=!0;try{const t=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:Ae.value.projectId,document_type:"business_response",original_file:null==(a=Ze.value)?void 0:a.outputFile})}),s=await t.json();if(!s.success)throw new Error(s.error||"ä¿å­˜å¤±è´¥");Ze.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:(null==(l=Ze.value)?void 0:l.stats)||{},message:"æ–‡æ¡£å·²ä¿å­˜"},s.output_file&&await Le(Ae.value.projectId,s.output_file,"business_response")}catch(t){throw t}finally{ta.value=!1}}else d.error("é¡¹ç›®IDæ— æ•ˆ")},ja=()=>{Ze.value?Ze.value.downloadUrl?sa.value=!0:d.warning("æ–‡æ¡£åœ°å€æ— æ•ˆ"):d.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},ga=async()=>{var e;if(Ze.value)try{const a=Ze.value.downloadUrl,l=`å•†åŠ¡åº”ç­”-${(null==(e=_.value)?void 0:e.project_name)||"æ–‡æ¡£"}-${Date.now()}.docx`;await T(a,l),d.success("Wordæ–‡æ¡£ä¸‹è½½æˆåŠŸ")}catch(a){d.error(a.message||"æ–‡æ¡£ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}else d.warning("æš‚æ— æ–‡æ¡£å¯ä¸‹è½½")},ba=async()=>{var e;(null==(e=Ze.value)?void 0:e.outputFile)?Ae.value.projectId?await Le(Ae.value.projectId,Ze.value.outputFile,"business_response"):d.error("é¡¹ç›®IDæ— æ•ˆ"):d.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},Fa=e=>{if(!e)return"-";let a=e;try{a=decodeURIComponent(e)}catch{}const l=a.split("/");return l[l.length-1]||"-"},xa=async()=>{if(Ae.value.projectId){ua.value=!0;try{const e=await fetch(`/api/business-files?project_id=${Ae.value.projectId}`),a=await e.json();if(!a.success)throw new Error(a.error||"åŠ è½½å¤±è´¥");na.value=a.data||[]}catch(e){d.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{ua.value=!1}}else na.value=[]},Ia=e=>{const a=["B","KB","MB","GB"];let l=e,t=0;for(;l>=1024&&t<a.length-1;)l/=1024,t++;return`${l.toFixed(1)} ${a[t]}`},ka=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}};return w(async()=>{var e;await Promise.all([De(),ma()]);const a=await Se({onClear:()=>{Ze.value=null,Ye.value="",Ae.value.tenderFiles=[],Ae.value.templateFiles=[],Ae.value.authorizedPersonName="",ea.value=!1,la.value="",Re.value&&Je(),Be.value&&Me()},onDocumentsLoaded:e=>{e.tenderFile&&Oe(e,"tenderFile"),e.templateFile&&He(e,"templateFile"),e.businessResponseFile&&(Ze.value=e.businessResponseFile,ea.value=!1)}});a&&(Ae.value.projectId=a,(null==(e=_.value)?void 0:e.authorized_person_name)&&(Ae.value.authorizedPersonName=_.value.authorized_person_name))}),(e,h)=>{const y=f,w=v,q=a,H=l,J=s,L=W,B=X,ae=o,De=G,Ue=m,Se=A,He=Q,Le=Y,Oe=K,Qe=O,Ye=M,ta=ee,ma=Z;return g(),j("div",le,[b(L,{class:"main-panel",shadow:"never"},{default:I(()=>{var e,a,l,s,o;return[k("div",te,[k("div",se,[h[13]||(h[13]=k("label",{class:"row-label"},"é€‰æ‹©é¡¹ç›®",-1)),b(w,{modelValue:Ae.value.projectId,"onUpdate:modelValue":h[0]||(h[0]=e=>Ae.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",clearable:"",onChange:va,class:"row-select"},{default:I(()=>[(g(!0),j(V,null,z(C(p),e=>(g(),F(y,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",oe,[h[14]||(h[14]=k("label",{class:"row-label"},"åº”ç­”å…¬å¸",-1)),Ae.value.projectId?(g(),F(q,{key:0,value:(null==(e=C(_))?void 0:e.company_name)||"-",disabled:"",class:"row-input"},null,8,["value"])):(g(),F(w,{key:1,modelValue:Ae.value.companyId,"onUpdate:modelValue":h[1]||(h[1]=e=>Ae.value.companyId=e),placeholder:"è¯·é€‰æ‹©å…¬å¸",filterable:"",class:"row-select"},{default:I(()=>[(g(!0),j(V,null,z(Ge.value,e=>(g(),F(y,{key:e.company_id,label:e.company_name,value:e.company_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])]),k("div",ie,[k("div",re,[h[15]||(h[15]=k("label",{class:"row-label"},"è¢«æˆæƒäºº",-1)),b(q,{modelValue:Ae.value.authorizedPersonName,"onUpdate:modelValue":h[2]||(h[2]=e=>Ae.value.authorizedPersonName=e),placeholder:"è¯·è¾“å…¥è¢«æˆæƒäºº",class:"row-input"},null,8,["modelValue"])])]),Ae.value.projectId?x("",!0):(g(),j("div",ne,[k("div",ue,[h[16]||(h[16]=k("label",{class:"row-label"},"é¡¹ç›®åç§°",-1)),b(q,{modelValue:Ae.value.projectName,"onUpdate:modelValue":h[3]||(h[3]=e=>Ae.value.projectName=e),placeholder:"æ–°é¡¹ç›®",class:"row-input"},null,8,["modelValue"])]),k("div",ce,[h[17]||(h[17]=k("label",{class:"row-label"},"é¡¹ç›®ç¼–å·",-1)),b(q,{modelValue:Ae.value.projectNumber,"onUpdate:modelValue":h[4]||(h[4]=e=>Ae.value.projectNumber=e),placeholder:"PRJ-...",class:"row-input"},null,8,["modelValue"])])])),k("div",de,[k("div",pe,[h[23]||(h[23]=k("label",{class:"row-label"},"åº”ç­”æ¨¡æ¿",-1)),C(Re)?(g(),j("div",me,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(C(t))]),_:1}),k("span",{class:"file-chip-name",title:null==(a=C(qe))?void 0:a.filename},E((null==(l=C(qe))?void 0:l.filename)||"æœªçŸ¥æ–‡ä»¶"),9,ve),h[19]||(h[19]=k("span",{class:"file-chip-tag"},"å·²åŠ è½½",-1)),b(J,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:C(Je)},{default:I(()=>[...h[18]||(h[18]=[P("Ã—",-1)])]),_:1},8,["onClick"])])):Ae.value.templateFiles.length>0?(g(),j("div",fe,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(C(t))]),_:1}),k("span",{class:"file-chip-name",title:Ae.value.templateFiles[0].name},E(Ae.value.templateFiles[0].name),9,_e),h[21]||(h[21]=k("span",{class:"file-chip-tag"},"å·²ä¸Šä¼ ",-1)),b(J,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:h[5]||(h[5]=e=>Ae.value.templateFiles=[])},{default:I(()=>[...h[20]||(h[20]=[P("Ã—",-1)])]),_:1})])):(g(),j("div",he,[h[22]||(h[22]=k("span",{class:"placeholder-text"},"è¯·ä¸Šä¼ åº”ç­”æ¨¡æ¿",-1)),b(C(U),{modelValue:Ae.value.templateFiles,"onUpdate:modelValue":h[6]||(h[6]=e=>Ae.value.templateFiles=e),"http-request":da,accept:".doc,.docx",limit:1,"max-size":100,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:_a},null,8,["modelValue"])]))]),k("div",ye,[h[29]||(h[29]=k("label",{class:"row-label"},"æ‹›æ ‡æ–‡æ¡£",-1)),C(Be)?(g(),j("div",we,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(C(t))]),_:1}),k("span",{class:"file-chip-name",title:null==(s=C(We))?void 0:s.filename},E((null==(o=C(We))?void 0:o.filename)||"æœªçŸ¥æ–‡ä»¶"),9,je),h[25]||(h[25]=k("span",{class:"file-chip-tag"},"å·²åŠ è½½",-1)),b(J,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:C(Me)},{default:I(()=>[...h[24]||(h[24]=[P("Ã—",-1)])]),_:1},8,["onClick"])])):Ae.value.tenderFiles.length>0?(g(),j("div",ge,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(C(t))]),_:1}),k("span",{class:"file-chip-name",title:Ae.value.tenderFiles[0].name},E(Ae.value.tenderFiles[0].name),9,be),h[27]||(h[27]=k("span",{class:"file-chip-tag"},"å·²ä¸Šä¼ ",-1)),b(J,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:h[7]||(h[7]=e=>Ae.value.tenderFiles=[])},{default:I(()=>[...h[26]||(h[26]=[P("Ã—",-1)])]),_:1})])):(g(),j("div",Fe,[h[28]||(h[28]=k("span",{class:"placeholder-text"},"ä¸Šä¼ æ‹›æ ‡æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰",-1)),b(C(U),{modelValue:Ae.value.tenderFiles,"onUpdate:modelValue":h[8]||(h[8]=e=>Ae.value.tenderFiles=e),"http-request":pa,accept:".pdf,.doc,.docx",limit:5,"max-size":50,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:fa},null,8,["modelValue"])]))])]),k("div",xe,[b(J,{type:"primary",size:"large",disabled:!Xe.value,loading:Ke.value,onClick:ha},{default:I(()=>[...h[30]||(h[30]=[P(" å¼€å§‹ç”Ÿæˆå•†åŠ¡åº”ç­” ",-1)])]),_:1},8,["disabled","loading"])])]}),_:1}),ea.value?(g(),F(L,{key:0,class:"editor-section",shadow:"never"},{default:I(()=>[b(C(R),{ref_key:"editorRef",ref:aa,modelValue:la.value,"onUpdate:modelValue":h[9]||(h[9]=e=>la.value=e),title:"å•†åŠ¡åº”ç­”æ–‡æ¡£",streaming:Ke.value,height:1e3,onSave:wa,onPreview:ja,onExport:ga},null,8,["modelValue","streaming"])]),_:1})):x("",!0),ea.value&&Ze.value?(g(),F(Ye,{key:1,modelValue:ra.value,"onUpdate:modelValue":h[10]||(h[10]=e=>ra.value=e),class:"result-collapse"},{default:I(()=>[b(Qe,{name:"result",title:"ğŸ“„ æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"},{default:I(()=>[b(L,{class:"result-section",shadow:"never"},{header:I(()=>[k("div",Ie,[k("span",null,E(Ze.value.isHistory?"ğŸ“„ å†å²åº”ç­”æ–‡ä»¶":"âœ… ç”Ÿæˆç»“æœ"),1),k("div",ke,[b(J,{type:"primary",icon:C(r),onClick:ja},{default:I(()=>[...h[31]||(h[31]=[P(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),b(J,{type:"success",icon:C(n),onClick:ga},{default:I(()=>[...h[32]||(h[32]=[P(" ä¸‹è½½Wordæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),C(Te)?(g(),F(B,{key:1,type:"success",size:"large"},{default:I(()=>[...h[34]||(h[34]=[P(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(g(),F(J,{key:0,type:"info",icon:C(u),loading:C($e),onClick:ba},{default:I(()=>[...h[33]||(h[33]=[P(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),b(J,{type:"primary",icon:C(c),onClick:ha},{default:I(()=>[...h[35]||(h[35]=[P(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:I(()=>{var e,a,l,t;return[k("div",Ve,[b(ae,{type:Ze.value.isHistory?"info":"success",title:Ze.value.message,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["type","title"]),b(C($),{title:"å¤„ç†ç»Ÿè®¡",stats:Ze.value.stats},null,8,["stats"]),(null==(a=null==(e=Ze.value.stats)?void 0:e.qualifications_details)?void 0:a.length)>0?(g(),j("div",ze,[h[38]||(h[38]=k("h4",null,"ğŸ“‹ èµ„è´¨å¤„ç†è¯¦æƒ…",-1)),b(Se,{data:Ze.value.stats.qualifications_details,border:"",stripe:"",style:{"margin-top":"16px"}},{default:I(()=>[b(De,{type:"index",label:"#",width:"60",align:"center"}),b(De,{prop:"display_title",label:"èµ„è´¨åç§°","min-width":"200"},{default:I(({row:e})=>[k("div",null,[k("strong",null,E(e.display_title),1),"id_card"===e.resource_type?(g(),F(B,{key:0,type:"info",size:"small",style:{"margin-left":"8px"}},{default:I(()=>[...h[36]||(h[36]=[P(" èº«ä»½è¯ ",-1)])]),_:1})):x("",!0)])]),_:1}),b(De,{prop:"qual_name",label:"ç±»åˆ«",width:"120",align:"center"},{default:I(({row:e})=>{return[b(B,{type:(a=e.qual_name,{"åŸºæœ¬èµ„è´¨":"danger","ä¿¡ç”¨è¯æ˜":"success","èº«ä»½è¯æ˜":"primary","è´¢åŠ¡æ–‡ä»¶":"warning","ä¿¡æ¯å®‰å…¨":"info","ç”µä¿¡èµ„è´¨":"warning","ITæœåŠ¡":"info","è´¨é‡ç®¡ç†":"success","è½¯ä»¶èƒ½åŠ›":"info","è¡Œä¸šèµ„è´¨":"warning","çŸ¥è¯†äº§æƒ":""}[a]||""),size:"small"},{default:I(()=>[P(E(e.qual_name),1)]),_:2},1032,["type"])];var a}),_:1}),b(De,{prop:"total_pages",label:"å›¾ç‰‡æ•°",width:"100",align:"center"},{default:I(({row:e})=>[b(Ue,{type:"primary",size:"large"},{default:I(()=>[k("strong",null,E(e.total_pages),1),P(" "+E("id_card"===e.resource_type?"é¢":"é¡µ"),1)]),_:2},1024)]),_:1}),b(De,{label:"çŠ¶æ€",width:"80",align:"center"},{default:I(()=>[b(H,{color:"#67c23a",size:20},{default:I(()=>[b(C(i))]),_:1})]),_:1})]),_:1},8,["data"]),(null==(t=null==(l=Ze.value.stats)?void 0:l.missing_qualifications)?void 0:t.length)>0?(g(),F(ae,{key:0,type:"warning",closable:!1,style:{"margin-top":"16px"}},{title:I(()=>[...h[37]||(h[37]=[P(" ä»¥ä¸‹èµ„è´¨æ¨¡æ¿æœ‰å ä½ç¬¦ä½†æœªä¸Šä¼ æ–‡ä»¶ ",-1)])]),default:I(()=>[k("ul",Ce,[(g(!0),j(V,null,z(Ze.value.stats.missing_qualifications,(e,a)=>(g(),j("li",{key:a},E(e.qual_name||e.qual_key),1))),128))])]),_:1})):x("",!0)])):x("",!0),k("div",Ee,[h[39]||(h[39]=k("h4",null,"ç”Ÿæˆæ–‡ä»¶",-1)),b(Oe,{column:2,border:""},{default:I(()=>[b(He,{label:"æ–‡ä»¶å"},{default:I(()=>[P(E(Fa(Ze.value.outputFile)),1)]),_:1}),b(He,{label:"ä¸‹è½½åœ°å€"},{default:I(()=>[b(Le,{href:Ze.value.downloadUrl,type:"primary"},{default:I(()=>[P(E(Fa(Ze.value.downloadUrl)),1)]),_:1},8,["href"])]),_:1})]),_:1})])])]}),_:1})]),_:1})]),_:1},8,["modelValue"])):x("",!0),Ae.value.projectId?(g(),F(Ye,{key:2,modelValue:ca.value,"onUpdate:modelValue":h[11]||(h[11]=e=>ca.value=e),class:"history-collapse"},{default:I(()=>[b(Qe,{name:"history"},{title:I(()=>[k("div",Pe,[k("span",null,"ğŸ“‚ æœ¬é¡¹ç›®å†å²æ–‡ä»¶ ("+E(na.value.length)+")",1),ca.value?(g(),F(J,{key:0,type:"primary",size:"small",loading:ua.value,onClick:D(xa,["stop"]),style:{"margin-left":"16px"}},{default:I(()=>[...h[40]||(h[40]=[P(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):x("",!0)])]),default:I(()=>[b(L,{shadow:"never",style:{border:"none"}},{default:I(()=>[N((g(),F(Se,{data:na.value,border:"",stripe:"","max-height":"400"},{default:I(()=>[b(De,{type:"index",label:"åºå·",width:"60"}),b(De,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:I(({row:e})=>[k("div",Ne,[b(H,null,{default:I(()=>[b(C(t))]),_:1}),k("span",null,E(e.filename),1)])]),_:1}),b(De,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:I(({row:e})=>[P(E(Ia(e.size)),1)]),_:1}),b(De,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:I(({row:e})=>[P(E(ka(e.process_time)),1)]),_:1}),b(De,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:I(({row:e})=>[b(J,{type:"primary",size:"small",onClick:a=>{var l;(l=e).file_path?(oa.value=l.file_path,ia.value=l.filename,sa.value=!0):d.warning("æ— æ³•è·å–æ–‡ä»¶ä¿¡æ¯")}},{default:I(()=>[...h[41]||(h[41]=[P(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),b(J,{type:"success",size:"small",onClick:a=>(async e=>{try{if(!e.download_url)return void d.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const a=e.filename||"å•†åŠ¡åº”ç­”.docx";T(e.download_url,a),d.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(a){d.error(a.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}})(e)},{default:I(()=>[...h[42]||(h[42]=[P(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ma,ua.value]]),ua.value||0!==na.value.length?x("",!0):(g(),F(ta,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"])):x("",!0),b(C(S),{modelValue:sa.value,"onUpdate:modelValue":h[12]||(h[12]=e=>sa.value=e),"file-url":oa.value,"file-name":ia.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-c3c4075c"]]);export{De as default};
