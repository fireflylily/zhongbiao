import{R as e,P as l,Q as a,n as t,q as n,g as s,aN as o,aO as i,s as u,F as r,D as d,y as p,M as c,E as v,_ as m}from"./index.js";import{E as f}from"./el-tree-CKub1VG8.js";/* empty css                    */import"./el-text-CIVxKMll.js";/* empty css                                                                          *//* empty css               *//* empty css                             */import{E as _}from"./el-divider-bvVE3iXX.js";/* empty css                */import{E as y,a as g}from"./el-select-C9o-AACO.js";/* empty css                     */import{ap as h,am as j,an as w,aW as x,av as b,ar as k,at as F,aq as C,aJ as E,as as I,aU as S,aV as P,ax as $,au as V,aR as D,aI as T,aQ as O,aT as M}from"./editor-CZjPbfOV.js";/* empty css                *//* empty css                                                                        */import{S as U}from"./SSEStreamViewer-DlRttVZA.js";import{D as A}from"./DocumentUploader-Uog00Y5M.js";import{D as q}from"./DocumentPreview-DZsr1SMJ.js";import{R as z}from"./RichTextEditor-B4vfat1z.js";import{u as N,H as R,S as H,a as L,E as W,b as J,d as G}from"./helpers-BbPuAodW.js";import{t as Q}from"./tender-ZYcn_VXM.js";import{u as B}from"./useProjectDocuments-BF5if9C5.js";import{a as Y,E as Z}from"./index-B_1bNbFG.js";import{E as K}from"./index-DgL8sT1k.js";import{a as X,E as ee}from"./index-DzFGJ3Ky.js";import{E as le}from"./index-CjQ1irBn.js";import{E as ae}from"./strings-DJcURSVo.js";import"./index-D5O2TROd.js";import"./index-DXP9jmAU.js";import"./toNumber-CU4OoPoC.js";import"./_baseIteratee--ghgRM4z.js";import"./imageCompressor-CTkRt5bg.js";import"./index-B-MyBJlZ.js";import"./cloneDeep-syPWYH98.js";/* empty css                   */import"./directive-Bx4Bncqq.js";import"./index-B_RVpXRM.js";import"./index-DWyHgBtB.js";/* empty css                */import"./index-qDoqLyIC.js";import"./index-BD95_Z3Y.js";import"./index-HBf7YtLN.js";import"./index-CMv7nVh-.js";import"./flatMap-MHcQtZLg.js";import"./map-TpIQimNd.js";import"./_baseEach-BmaHGmee.js";import"./raf-B6jWGkGX.js";import"./project-BV8XA5yV.js";const te={class:"tech-proposal"},ne={style:{display:"flex","justify-content":"space-between","align-items":"center"}},se={class:"action-controls"},oe={class:"card-header"},ie={class:"card-header"},ue={class:"requirement-categories"},re={class:"category-title"},de={class:"category-content"},pe={key:0,class:"category-summary"},ce={key:1,class:"category-keywords"},ve={key:2,class:"category-points"},me={class:"card-header"},fe={class:"ç« èŠ‚ç»“æ„"},_e={class:"tree-node"},ye={class:"node-title"},ge={key:2,class:"node-desc"},he={class:"card-header"},je={class:"header-actions"},we={class:"result-content"},xe={class:"output-files"},be={class:"file-buttons"},ke=m(h({__name:"TechProposal",setup(m){const{projects:h,selectedProject:ke,currentDocuments:Fe,loadProjects:Ce,handleProjectChange:Ee,restoreProjectFromStore:Ie}=B(),{useHitlFile:Se,hitlFileInfo:Pe,syncing:$e,synced:Ve,loadFromHITL:De,cancelHitlFile:Te,syncToHitl:Oe}=N({onFileLoaded:()=>{ze.value.tenderFiles=[]}}),Me=j([]),Ue=j(!1),Ae=async()=>{},qe=async e=>{try{if(!e.downloadUrl)return void v.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const l=e.filename||e.downloadUrl.split("/").pop()||"æŠ€æœ¯æ–¹æ¡ˆ.docx";G(e.downloadUrl,l),v.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(l){v.error(l.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}},ze=j({projectId:null,tenderFiles:[]}),Ne=j({outputPrefix:"æŠ€æœ¯æ–¹æ¡ˆ",aiModel:"shihuang-gpt4o-mini",additionalOutputs:["includeAnalysis","includeMapping","includeSummary"]}),Re=j(!1),He=j(0),Le=j(""),We=j(null),Je=j(!0),Ge=j(null),Qe=j(!0),Be=j(null),Ye=j(null),Ze=j(!1),Ke=j(""),Xe=j(""),el=j(!1),ll=j(null),al=j(""),tl=j(!1),nl=j(!1),sl=w(()=>{var e;return(null==(e=Ge.value)?void 0:e.chapters)?Ge.value.chapters:[]}),ol=w(()=>ze.value.projectId&&(Se.value||ze.value.tenderFiles.length>0)),il=async e=>{var l;const{file:a,onSuccess:t,onError:n}=e;if(!ze.value.projectId){return n(new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")),void v.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")}if(!(null==(l=ke.value)?void 0:l.company_id)){return n(new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")),void v.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")}try{const e=new FormData;e.append("file",a),e.append("company_id",ke.value.company_id.toString()),e.append("project_id",ze.value.projectId.toString());const l=await Q.parseDocumentStructure(e);if(!l.success)throw new Error(l.message||"ä¸Šä¼ å¤±è´¥");t(l.data),v.success("æŠ€æœ¯éœ€æ±‚æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(s){n(s),v.error(s.message||"æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},ul=()=>{v.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},rl=async()=>{await Ee(ze.value.projectId,{onClear:()=>{ze.value.tenderFiles=[],We.value=null,Ge.value=null,Be.value=null,Ye.value=null,Le.value="",el.value=!1,al.value="",Se.value&&Te()},onDocumentsLoaded:e=>{e.technicalFile&&De(e,"technicalFile"),e.techProposalFile&&(Ye.value=e.techProposalFile,v.success("å·²åŠ è½½å†å²æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶"))}})},dl=async()=>{var e;if(ol.value){Re.value=!0,He.value=0,Le.value="",We.value=null,Be.value=null,el.value=!1,al.value="";try{const l=new FormData;if(Se.value&&Pe.value)l.append("use_hitl_technical_file","true"),l.append("project_id",ze.value.projectId.toString());else{if(!(null==(e=ze.value.tenderFiles[0])?void 0:e.raw))throw new Error("è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");l.append("tender_file",ze.value.tenderFiles[0].raw)}l.append("outputPrefix",Ne.value.outputPrefix),l.append("companyId",ke.value.company_id.toString()),l.append("projectName",ke.value.project_name||""),l.append("projectId",ze.value.projectId.toString()),l.append("aiModel",Ne.value.aiModel),l.append("includeAnalysis",Ne.value.additionalOutputs.includes("includeAnalysis")?"true":"false"),l.append("includeMapping",Ne.value.additionalOutputs.includes("includeMapping")?"true":"false"),l.append("includeSummary",Ne.value.additionalOutputs.includes("includeSummary")?"true":"false"),await pl(l),v.success("æŠ€æœ¯æ–¹æ¡ˆç”Ÿæˆå®Œæˆ")}catch(l){v.error(l.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{Re.value=!1}}else v.warning("è¯·é€‰æ‹©é¡¹ç›®å¹¶ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£")},pl=async e=>{var l,a,t;const n=await fetch("/api/generate-proposal-stream-v2",{method:"POST",body:e});if(!n.ok)throw new Error(`HTTP ${n.status}: ${n.statusText}`);const s=null==(l=n.body)?void 0:l.getReader();if(!s)throw new Error("æ— æ³•è¯»å–å“åº”æµ");const o=new TextDecoder;let i="";const u={};let r="";for(;;){const{done:e,value:l}=await s.read();if(e)break;i+=o.decode(l,{stream:!0});const n=i.split("\n");i=n.pop()||"";for(const s of n)if(s.startsWith("data: "))try{const e=JSON.parse(s.slice(6));if(void 0!==e.progress&&(He.value=e.progress),e.message&&(Le.value+=e.message+"\n"),"analysis_completed"===e.stage&&e.analysis_result&&(We.value=e.analysis_result),"outline_completed"===e.stage&&e.outline_data&&(Ge.value=e.outline_data),"content_generation"===e.stage)if("chapter_start"===e.event)r=e.chapter_number||"",u[r]="",Le.value+=`\n\n## ${e.chapter_number} ${e.chapter_title}\n\n`,el.value||(el.value=!0);else if("content_chunk"===e.event){const l=e.chapter_number||r;l&&(u[l]=(u[l]||"")+(e.content||""),cl(u))}else"chapter_end"===e.event&&(Le.value+=`\nâœ“ ${e.chapter_title||"ç« èŠ‚"} ç”Ÿæˆå®Œæˆ\n`);if("completed"===e.stage&&e.success&&(Be.value=e,Ye.value={outputFile:e.output_file,downloadUrl:null==(a=e.output_files)?void 0:a.proposal,stats:{requirements_count:e.requirements_count,sections_count:e.sections_count,matches_count:e.matches_count},message:"æŠ€æœ¯æ–¹æ¡ˆå·²ç”Ÿæˆ"},el.value=!0,e.output_file&&ze.value.projectId&&await Oe(ze.value.projectId,e.output_file,"tech_proposal")),"error"===e.stage)throw Le.value+=`\nâŒ é”™è¯¯: ${e.error||e.message}\n`,new Error(e.error||e.message||"ç”Ÿæˆå¤±è´¥")}catch(d){if(!(null==(t=d.message)?void 0:t.includes("JSON")))throw d}}},cl=e=>{var l;if(null==(l=Ge.value)?void 0:l.chapters){let l="";const a=t=>{for(const n of t){const t=n.chapter_number,s=e[t]||"",o=n.level||1,i=`ch-${t.replace(/\./g,"-")}`;l+=`<h${o} id="${i}">${t} ${n.title}</h${o}>\n`,n.description&&(l+=`<div style="padding: 12px; background: #E8F4FD; border-left: 4px solid #409EFF; margin: 12px 0;">\n            <strong>ã€æœ¬ç« è¯´æ˜ã€‘</strong> ${n.description}\n          </div>\n`),n.response_strategy&&(l+=`<div style="padding: 12px; background: #F0F9FF; border-left: 4px solid #67C23A; margin: 12px 0;">\n            <strong>ã€åº”ç­”ç­–ç•¥ã€‘</strong> ${n.response_strategy}\n          </div>\n`),n.content_hints&&n.content_hints.length>0&&(l+=`<div style="padding: 12px; background: #FFF7E6; border-left: 4px solid #E6A23C; margin: 12px 0;">\n            <strong>ã€å†…å®¹æç¤ºã€‘</strong>\n            <ul style="margin: 8px 0; padding-left: 24px;">\n              ${n.content_hints.map(e=>`<li>${e}</li>`).join("")}\n            </ul>\n          </div>\n`),n.response_tips&&n.response_tips.length>0&&(l+=`<div style="padding: 12px; background: #FEF0F0; border-left: 4px solid #F56C6C; margin: 12px 0;">\n            <strong>ã€åº”ç­”å»ºè®®ã€‘</strong>\n            <ul style="margin: 8px 0; padding-left: 24px;">\n              ${n.response_tips.map(e=>`<li>${e}</li>`).join("")}\n            </ul>\n          </div>\n`),s?(l+='<div style="padding: 12px; background: #F0FFF4; border-left: 4px solid #52C41A; margin: 12px 0;">\n            <strong style="color: #52C41A;">ã€AIç”Ÿæˆå†…å®¹ã€‘</strong>\n          </div>\n',l+=`<div style="line-height: 1.8; margin: 12px 0;">${s.replace(/\n/g,"<br>")}</div>\n`):t in e&&(l+='<div style="padding: 12px; background: #F5F5F5; border: 1px dashed #D9D9D9; margin: 12px 0; color: #999;">\n            <em>æ­£åœ¨ç”Ÿæˆå†…å®¹...</em>\n          </div>\n'),n.subsections&&n.subsections.length>0&&a(n.subsections)}};a(Ge.value.chapters),al.value=l}else{let l="";const a=Object.entries(e).sort((e,l)=>{const[a]=e,[t]=l;return a.localeCompare(t,"zh-CN")});for(const[e,t]of a)l+=`<h2>${e}</h2>\n`,t&&(l+=`<div style="line-height: 1.8;">${t.replace(/\n/g,"<br>")}</div>\n`);al.value=l}},vl=()=>{Re.value=!1,v.info("å·²åœæ­¢ç”Ÿæˆ")},ml=e=>{var l,a;if(!(null==(a=null==(l=Be.value)?void 0:l.output_files)?void 0:a[e]))return void v.warning("æ–‡ä»¶ä¸å­˜åœ¨");const t=Be.value.output_files[e],n=t.split("/").pop()||`æŠ€æœ¯æ–¹æ¡ˆ_${e}.docx`;G(t,n),v.success("ä¸‹è½½å·²å¼€å§‹")},fl=()=>{var e,l,a;(null==(l=null==(e=Be.value)?void 0:e.output_files)?void 0:l.proposal)?(Ke.value=Be.value.output_files.proposal,Xe.value=`æŠ€æœ¯æ–¹æ¡ˆ-${(null==(a=ke.value)?void 0:a.project_name)||"æ–‡æ¡£"}.docx`,Ze.value=!0):v.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},_l=e=>{Ke.value=e.file_path||e.outputFile,Xe.value=e.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx",Ze.value=!0},yl=async()=>{var e;(null==(e=Be.value)?void 0:e.output_file)?ze.value.projectId?await Oe(ze.value.projectId,Be.value.output_file,"tech_proposal"):v.error("é¡¹ç›®IDæ— æ•ˆ"):v.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},gl=()=>{Ye.value=null,Be.value=null,We.value=null,Ge.value=null,el.value=!1,al.value="",v.info("è¯·é…ç½®å‚æ•°åé‡æ–°ç”Ÿæˆ")},hl=async e=>{var l;if(null==(l=Be.value)?void 0:l.output_file)try{nl.value=!0;const l=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:ze.value.projectId,document_type:"tech_proposal",original_file:Be.value.output_file})}),a=await l.json();if(!a.success)throw new Error(a.error||"ä¿å­˜å¤±è´¥");v.success("æŠ€æœ¯æ–¹æ¡ˆå†…å®¹å·²ä¿å­˜"),a.output_file&&(Be.value.output_file=a.output_file,a.download_url&&Be.value.output_files&&(Be.value.output_files.proposal=a.download_url)),a.output_file&&ze.value.projectId&&await Oe(ze.value.projectId,a.output_file,"tech_proposal")}catch(a){throw a}finally{nl.value=!1}else v.warning("æ²¡æœ‰å¯ä¿å­˜çš„æ–‡ä»¶")},jl=async()=>{var e;if(null==(e=Ye.value)?void 0:e.outputFile)try{el.value=!0,await(async e=>{try{tl.value=!0,al.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const l=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),a=await l.json();if(!a.success||!a.html_content)throw new Error(a.error||"è½¬æ¢å¤±è´¥");al.value=a.html_content,ll.value&&ll.value.setContent(a.html_content)}catch(l){al.value=`\n      <h1>ğŸ“„ æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${l.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"é¢„è§ˆWord"æˆ–"ä¸‹è½½"æŒ‰é’®æŸ¥çœ‹åŸå§‹æ–‡æ¡£</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,v.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨é¢„è§ˆæˆ–ä¸‹è½½åŠŸèƒ½")}finally{tl.value=!1}})(Ye.value.outputFile),v.success("å†å²æ–‡ä»¶å·²åŠ è½½åˆ°ç¼–è¾‘å™¨"),setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(l){v.error("æ‰“å¼€å†å²æ–‡ä»¶å¤±è´¥: "+l.message)}else v.error("å†å²æ–‡ä»¶ä¿¡æ¯æ— æ•ˆ")};return x(async()=>{await Ce();const e=await Ie({onClear:()=>{ze.value.tenderFiles=[],We.value=null,Ge.value=null,Be.value=null,Ye.value=null,Se.value&&Te()},onDocumentsLoaded:e=>{e.technicalFile&&De(e,"technicalFile"),e.techProposalFile&&(Ye.value=e.techProposalFile)}});e&&(ze.value.projectId=e)}),(v,m)=>{const j=g,w=y,x=l,N=Z,G=a,Q=Y,B=e,Ce=K,Ee=n,Ie=t,Oe=_,pl=ee,cl=X,wl=s,xl=le,bl=ae,kl=W,Fl=L,Cl=f;return k(),b("div",te,[F(Ce,{class:"project-section",shadow:"never"},{default:I(()=>[F(B,{model:ze.value,"label-width":"100px"},{default:I(()=>[F(Q,{gutter:20},{default:I(()=>[F(N,{span:12},{default:I(()=>[F(x,{label:"é¡¹ç›®"},{default:I(()=>[F(w,{modelValue:ze.value.projectId,"onUpdate:modelValue":m[0]||(m[0]=e=>ze.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:rl,style:{width:"100%"}},{default:I(()=>[(k(!0),b(S,null,P($(h),e=>(k(),C(j,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),F(N,{span:12},{default:I(()=>[F(x,{label:"å…¬å¸"},{default:I(()=>{var e;return[F(G,{value:(null==(e=$(ke))?void 0:e.company_name)||"-",disabled:""},null,8,["value"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),F(Ce,{class:"upload-section",shadow:"never"},{default:I(()=>[$(Fe).technicalFile&&!$(Se)?(k(),C(Ie,{key:0,type:"success",closable:!1,style:{"margin-bottom":"16px"}},{default:I(()=>[V("div",ne,[m[16]||(m[16]=V("span",null,"ğŸ’¡ æ£€æµ‹åˆ°è¯¥é¡¹ç›®å·²æœ‰æŠ€æœ¯éœ€æ±‚æ–‡ä»¶ï¼Œå¯ç›´æ¥ä½¿ç”¨",-1)),F(Ee,{type:"primary",size:"small",onClick:m[1]||(m[1]=e=>$(De)($(Fe),"technicalFile"))},{default:I(()=>[...m[15]||(m[15]=[D(" ä½¿ç”¨æŠ€æœ¯éœ€æ±‚æ–‡ä»¶ ",-1)])]),_:1})])]),_:1})):E("",!0),$(Se)?(k(),C($(R),{key:1,"file-info":$(Pe),label:"æŠ€æœ¯éœ€æ±‚æ–‡ä»¶:",onCancel:$(Te)},null,8,["file-info","onCancel"])):E("",!0),$(Se)?E("",!0):(k(),C($(A),{key:2,modelValue:ze.value.tenderFiles,"onUpdate:modelValue":m[2]||(m[2]=e=>ze.value.tenderFiles=e),"http-request":il,accept:".pdf,.doc,.docx",limit:1,"max-size":50,drag:"","tip-text":"ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",onSuccess:ul},null,8,["modelValue"])),F(Oe,null,{default:I(()=>[...m[17]||(m[17]=[D("ç”Ÿæˆé€‰é¡¹",-1)])]),_:1}),F(B,{model:Ne.value,"label-width":"140px",class:"config-form"},{default:I(()=>[F(Q,{gutter:20},{default:I(()=>[F(N,{span:12},{default:I(()=>[F(x,{label:"è¾“å‡ºæ–‡ä»¶å‰ç¼€"},{default:I(()=>[F(G,{modelValue:Ne.value.outputPrefix,"onUpdate:modelValue":m[3]||(m[3]=e=>Ne.value.outputPrefix=e),placeholder:"æŠ€æœ¯æ–¹æ¡ˆ"},null,8,["modelValue"])]),_:1})]),_:1}),F(N,{span:12},{default:I(()=>[F(x,{label:"AIæ¨¡å‹"},{default:I(()=>[F(w,{modelValue:Ne.value.aiModel,"onUpdate:modelValue":m[4]||(m[4]=e=>Ne.value.aiModel=e),style:{width:"100%"}},{default:I(()=>[F(j,{label:"GPT5ï¼ˆæœ€å¼ºæ¨ç†ï¼‰",value:"shihuang-gpt5"}),F(j,{label:"Claude Sonnet 4.5ï¼ˆæ ‡ä¹¦ä¸“ç”¨ï¼‰",value:"shihuang-claude-sonnet-45"}),F(j,{label:"GPT4o Miniï¼ˆæ¨è-é»˜è®¤ï¼‰",value:"shihuang-gpt4o-mini"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),F(x,{label:"é™„åŠ è¾“å‡º"},{default:I(()=>[F(cl,{modelValue:Ne.value.additionalOutputs,"onUpdate:modelValue":m[5]||(m[5]=e=>Ne.value.additionalOutputs=e)},{default:I(()=>[F(pl,{label:"includeAnalysis"},{default:I(()=>[...m[18]||(m[18]=[D("éœ€æ±‚åˆ†ææŠ¥å‘Š",-1)])]),_:1}),F(pl,{label:"includeMapping"},{default:I(()=>[...m[19]||(m[19]=[D("éœ€æ±‚åŒ¹é…è¡¨",-1)])]),_:1}),F(pl,{label:"includeSummary"},{default:I(()=>[...m[20]||(m[20]=[D("ç”Ÿæˆæ€»ç»“æŠ¥å‘Š",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),V("div",se,[F(Ee,{type:"primary",size:"large",disabled:!ol.value,loading:Re.value,onClick:dl},{default:I(()=>[F(wl,null,{default:I(()=>[F($(o))]),_:1}),m[21]||(m[21]=D(" ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1},8,["disabled","loading"])])]),_:1}),Re.value?(k(),C(Ce,{key:0,class:"generation-output",shadow:"never"},{header:I(()=>[V("div",oe,[m[22]||(m[22]=V("span",null,"AIæ­£åœ¨ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ...",-1)),F(xl,{percentage:He.value,status:100===He.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:I(()=>[F($(U),{content:Le.value,"is-streaming":Re.value,onStop:vl},null,8,["content","is-streaming"])]),_:1})):E("",!0),We.value?(k(),C(Ce,{key:1,class:"analysis-section",shadow:"never"},{header:I(()=>[V("div",ie,[m[23]||(m[23]=V("span",null,"éœ€æ±‚åˆ†æç»“æœ",-1)),F(Ee,{size:"small",onClick:m[6]||(m[6]=e=>Je.value=!Je.value)},{default:I(()=>[D(O(Je.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:I(()=>[T(V("div",null,[F($(H),{title:"æ–‡æ¡£æ‘˜è¦",stats:We.value.document_summary||{},"stat-items":[{key:"total_requirements",label:"æ€»éœ€æ±‚æ•°",suffix:"é¡¹"},{key:"mandatory_count",label:"å¼ºåˆ¶éœ€æ±‚",suffix:"é¡¹"},{key:"optional_count",label:"å¯é€‰éœ€æ±‚",suffix:"é¡¹"}]},null,8,["stats"]),V("div",ue,[m[26]||(m[26]=V("h4",null,"éœ€æ±‚åˆ†ç±»",-1)),F(Fl,{accordion:""},{default:I(()=>[(k(!0),b(S,null,P(We.value.requirement_categories,(e,l)=>(k(),C(kl,{key:l,name:l},{title:I(()=>{return[V("div",re,[V("span",null,O(e.category),1),F(bl,{type:(l=e.priority,{"é«˜":"danger",high:"danger","ä¸­":"warning",medium:"warning","ä½":"info",low:"info"}[l]||"info"),size:"small"},{default:I(()=>[D(O(e.priority),1)]),_:2},1032,["type"]),F(bl,{type:"info",size:"small"},{default:I(()=>[D(O(e.requirements_count||0)+"é¡¹ ",1)]),_:2},1024)])];var l}),default:I(()=>[V("div",de,[e.summary?(k(),b("p",pe,O(e.summary),1)):E("",!0),e.keywords&&e.keywords.length>0?(k(),b("div",ce,[m[24]||(m[24]=V("strong",null,"å…³é”®è¯ï¼š",-1)),(k(!0),b(S,null,P(e.keywords,e=>(k(),C(bl,{key:e,size:"small",style:{"margin-right":"8px"}},{default:I(()=>[D(O(e),1)]),_:2},1024))),128))])):E("",!0),e.key_points&&e.key_points.length>0?(k(),b("div",ve,[m[25]||(m[25]=V("strong",null,"è¦ç‚¹ï¼š",-1)),V("ul",null,[(k(!0),b(S,null,P(e.key_points,(e,l)=>(k(),b("li",{key:l},O(e),1))),128))])])):E("",!0)])]),_:2},1032,["name"]))),128))]),_:1})])],512),[[M,Je.value]])]),_:1})):E("",!0),Ge.value?(k(),C(Ce,{key:2,class:"outline-section",shadow:"never"},{header:I(()=>[V("div",me,[m[27]||(m[27]=V("span",null,"æŠ€æœ¯æ–¹æ¡ˆå¤§çº²",-1)),F(Ee,{size:"small",onClick:m[7]||(m[7]=e=>Qe.value=!Qe.value)},{default:I(()=>[D(O(Qe.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:I(()=>[T(V("div",null,[F($(H),{title:"å¤§çº²æ¦‚è§ˆ",stats:Ge.value,"stat-items":[{key:"total_chapters",label:"æ€»ç« èŠ‚æ•°",suffix:"ç« "},{key:"estimated_pages",label:"é¢„è®¡é¡µæ•°",suffix:"é¡µ"}],span:12},null,8,["stats"]),V("div",fe,[m[28]||(m[28]=V("h4",null,"ç« èŠ‚ç»“æ„",-1)),F(Cl,{data:sl.value,props:{label:"title",children:"subsections"},"default-expand-all":"","node-key":"chapter_number"},{default:I(({node:e,data:l})=>[V("span",_e,[1===l.level?(k(),C(wl,{key:0},{default:I(()=>[F($(i))]),_:1})):(k(),C(wl,{key:1},{default:I(()=>[F($(u))]),_:1})),V("span",ye,O(l.chapter_number)+" "+O(l.title),1),l.description?(k(),b("span",ge,O(l.description),1)):E("",!0)])]),_:1},8,["data"])])],512),[[M,Qe.value]])]),_:1})):E("",!0),el.value?(k(),C(Ce,{key:3,class:"editor-section",shadow:"never"},{default:I(()=>[F($(z),{ref_key:"editorRef",ref:ll,modelValue:al.value,"onUpdate:modelValue":m[8]||(m[8]=e=>al.value=e),title:"æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£",height:"calc(100vh - 250px)",loading:tl.value,saving:nl.value,onSave:hl},null,8,["modelValue","loading","saving"])]),_:1})):E("",!0),Be.value?(k(),C(Ce,{key:4,class:"result-section",shadow:"never"},{header:I(()=>[V("div",he,[m[34]||(m[34]=V("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),V("div",je,[F(Ee,{type:"primary",icon:$(d),onClick:fl},{default:I(()=>[...m[29]||(m[29]=[D(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),F(Ee,{type:"success",icon:$(r),onClick:m[9]||(m[9]=e=>ml("proposal"))},{default:I(()=>[...m[30]||(m[30]=[D(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1)])]),_:1},8,["icon"]),$(Ve)?(k(),C(bl,{key:1,type:"success",size:"large"},{default:I(()=>[...m[32]||(m[32]=[D(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(k(),C(Ee,{key:0,type:"info",icon:$(p),loading:$($e),onClick:yl},{default:I(()=>[...m[31]||(m[31]=[D(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),F(Ee,{type:"primary",icon:$(c),onClick:dl},{default:I(()=>[...m[33]||(m[33]=[D(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:I(()=>{var e,l,a,t;return[V("div",we,[F($(H),{title:"ç”Ÿæˆç»Ÿè®¡",stats:Be.value,"stat-items":[{key:"requirements_count",label:"éœ€æ±‚æ•°é‡",suffix:"é¡¹"},{key:"sections_count",label:"ç« èŠ‚æ•°é‡",suffix:"ç« "},{key:"matches_count",label:"åŒ¹é…æ•°é‡",suffix:"é¡¹"}]},null,8,["stats"]),V("div",xe,[m[39]||(m[39]=V("h4",null,"è¾“å‡ºæ–‡ä»¶",-1)),V("div",be,[(null==(e=Be.value.output_files)?void 0:e.proposal)?(k(),C(Ee,{key:0,type:"success",onClick:m[10]||(m[10]=e=>ml("proposal"))},{default:I(()=>[F(wl,null,{default:I(()=>[F($(r))]),_:1}),m[35]||(m[35]=D(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1})):E("",!0),(null==(l=Be.value.output_files)?void 0:l.analysis)?(k(),C(Ee,{key:1,type:"primary",onClick:m[11]||(m[11]=e=>ml("analysis"))},{default:I(()=>[F(wl,null,{default:I(()=>[F($(r))]),_:1}),m[36]||(m[36]=D(" ä¸‹è½½éœ€æ±‚åˆ†æ ",-1))]),_:1})):E("",!0),(null==(a=Be.value.output_files)?void 0:a.mapping)?(k(),C(Ee,{key:2,type:"info",onClick:m[12]||(m[12]=e=>ml("mapping"))},{default:I(()=>[F(wl,null,{default:I(()=>[F($(r))]),_:1}),m[37]||(m[37]=D(" ä¸‹è½½åŒ¹é…è¡¨ ",-1))]),_:1})):E("",!0),(null==(t=Be.value.output_files)?void 0:t.summary)?(k(),C(Ee,{key:3,type:"warning",onClick:m[13]||(m[13]=e=>ml("summary"))},{default:I(()=>[F(wl,null,{default:I(()=>[F($(r))]),_:1}),m[38]||(m[38]=D(" ä¸‹è½½ç”ŸæˆæŠ¥å‘Š ",-1))]),_:1})):E("",!0)])])])]}),_:1})):E("",!0),ze.value.projectId?(k(),C($(J),{key:5,title:"è¯¥é¡¹ç›®çš„æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶","current-file":Ye.value,"history-files":Me.value,loading:Ue.value,"show-stats":!1,"show-editor-open":!0,onPreview:_l,onDownload:qe,onRegenerate:gl,onRefresh:Ae,onOpenInEditor:jl},null,8,["current-file","history-files","loading"])):E("",!0),F($(q),{modelValue:Ze.value,"onUpdate:modelValue":m[14]||(m[14]=e=>Ze.value=e),"file-url":Ke.value,"file-name":Xe.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-dd351825"]]);export{ke as default};
