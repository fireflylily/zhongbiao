import{G as Z,H as ee,I as te,a as ae,J as oe,K as ne,n as le,p as se,L as ie}from"./element-plus-IkZgpaz4.js";import{bT as re,gi as ce,bt as i,bG as de,bU as S,bV as g,c8 as t,c0 as a,bv as l,bY as s,c7 as z,cC as ue,cf as pe,c2 as fe,c6 as k,b$ as D,c5 as w,cu as me}from"./vendor-CdA3MjAt.js";import{u as ge}from"./project-C4LB9E9r.js";import{a as _e,_ as be}from"./index.js";import{t as $}from"./tender-2TSD_jRl.js";import{L as ve}from"./Loading-CmykbBZp.js";import{E as he}from"./Empty-BNVBwC0L.js";/* empty css                                                                          */import{C as u}from"./Card-BYP2BB2j.js";import{I as C}from"./IconButton-Dlyej4ti.js";import"./umo-editor-BmhDOXHm.js";/* empty css                                                                        */import"./onnxruntime-DkHy2lK3.js";import"./mermaid-e-fO57px.js";import"./echarts-Cqw1j_Z-.js";const ye={class:"dashboard-page"},ke={class:"quick-actions"},we=["onClick"],Ce={class:"action-label"},Pe={class:"pagination-wrapper"},je=re({__name:"Dashboard",setup(xe){const _=ce(),P=ge(),{success:E,error:j,confirm:A}=_e(),r=i(!1),x=i(!1),p=i({totalProjects:0,inProgressProjects:0,wonThisMonth:0,pendingTasks:0}),b=i([]),f=i(1),v=i(10),T=i(0),B=[{name:"start-tender",label:"开始投标",icon:"bi bi-play-circle-fill",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",route:"/tender-management"},{name:"business-response",label:"商务应答",icon:"bi bi-briefcase-fill",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",route:"/business-response"},{name:"point-to-point",label:"点对点应答",icon:"bi bi-arrow-left-right",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",route:"/point-to-point"},{name:"tech-proposal",label:"技术方案",icon:"bi bi-file-code-fill",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",route:"/tech-proposal"},{name:"tender-scoring",label:"标书评分",icon:"bi bi-star-fill",color:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",route:"/tender-scoring"},{name:"knowledge",label:"知识中心",icon:"bi bi-book-fill",color:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",route:"/knowledge/company-library"}];async function L(){r.value=!0;try{const e=await $.getDashboardStatistics();e.success&&e.data&&(p.value={totalProjects:e.data.totalProjects,inProgressProjects:e.data.inProgressProjects,wonThisMonth:e.data.wonThisMonth,pendingTasks:e.data.pendingTasks})}catch(e){j("加载统计数据失败: "+e.message)}finally{r.value=!1}}async function m(){x.value=!0;try{const e=await $.getProjects({page:f.value,page_size:v.value});e.success&&e.data&&(Array.isArray(e.data)?(b.value=e.data,T.value=e.data.length):e.data.items&&(b.value=e.data.items,T.value=e.data.total||0))}catch(e){j("加载项目列表失败: "+e.message)}finally{x.value=!1}}async function V(){await m(),E("刷新成功")}function Y(e){_.push(e.route)}function I(){_.push("/tender-management")}function M(e){P.setCurrentProject(e),_.push({name:"TenderManagementDetail",params:{id:e.id}})}function N(e){P.setCurrentProject(e),_.push({name:"TenderManagementDetail",params:{id:e.id}})}async function q(e){if(await A(`确定要归档项目"${e.project_name}"吗?`,"归档项目","归档后项目将不再显示在进行中列表"))try{await P.updateProject(e.id,{status:"archived"}),E("项目已归档"),await m()}catch(c){j("归档失败: "+c.message)}}function H(e){v.value=e,f.value=1,m()}function U(e){f.value=e,m()}function G(e){return{pending:"info",in_progress:"warning",completed:"success",won:"success",lost:"danger",archived:"info"}[e]||"info"}function R(e){return{pending:"待处理",in_progress:"进行中",completed:"已完成",won:"已中标",lost:"未中标",archived:"已归档"}[e]||e}function F(e){return e?me(e).format("YYYY-MM-DD HH:mm"):"-"}return de(()=>{L(),m()}),(e,n)=>{const c=ee,h=Z,J=te,K=ae,Q=le,d=ne,O=se,W=oe,X=ie;return g(),S("div",ye,[t(J,{gutter:16,class:"kpi-cards"},{default:a(()=>[t(h,{xs:12,sm:12,md:6,lg:6},{default:a(()=>[t(l(u),{shadow:"hover",loading:r.value},{default:a(()=>[t(c,{title:"总项目数",value:p.value.totalProjects},{prefix:a(()=>[...n[2]||(n[2]=[s("i",{class:"bi bi-folder-fill statistic-icon",style:{color:"#409eff"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),t(h,{xs:12,sm:12,md:6,lg:6},{default:a(()=>[t(l(u),{shadow:"hover",loading:r.value},{default:a(()=>[t(c,{title:"进行中项目",value:p.value.inProgressProjects},{prefix:a(()=>[...n[3]||(n[3]=[s("i",{class:"bi bi-clock-fill statistic-icon",style:{color:"#e6a23c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),t(h,{xs:12,sm:12,md:6,lg:6},{default:a(()=>[t(l(u),{shadow:"hover",loading:r.value},{default:a(()=>[t(c,{title:"本月中标",value:p.value.wonThisMonth},{prefix:a(()=>[...n[4]||(n[4]=[s("i",{class:"bi bi-trophy-fill statistic-icon",style:{color:"#67c23a"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),t(h,{xs:12,sm:12,md:6,lg:6},{default:a(()=>[t(l(u),{shadow:"hover",loading:r.value},{default:a(()=>[t(c,{title:"待处理任务",value:p.value.pendingTasks},{prefix:a(()=>[...n[5]||(n[5]=[s("i",{class:"bi bi-list-task statistic-icon",style:{color:"#f56c6c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1})]),_:1}),t(l(u),{title:"快捷入口",class:"quick-actions-card"},{default:a(()=>[s("div",ke,[(g(),S(z,null,ue(B,o=>s("div",{key:o.name,class:"action-item",onClick:y=>Y(o)},[s("div",{class:"action-icon",style:pe({background:o.color})},[s("i",{class:fe(o.icon)},null,2)],4),s("div",Ce,k(o.label),1)],8,we)),64))])]),_:1}),t(l(u),{title:"进行中的项目",class:"projects-card"},{actions:a(()=>[t(l(C),{icon:"bi-arrow-clockwise",tooltip:"刷新",onClick:V})]),default:a(()=>[x.value?(g(),D(l(ve),{key:0,visible:!0,fullscreen:!1,text:"加载项目列表..."})):b.value.length===0?(g(),D(l(he),{key:1,type:"no-data",description:"暂无进行中的项目"},{action:a(()=>[t(K,{type:"primary",onClick:I},{default:a(()=>[...n[6]||(n[6]=[w("创建第一个项目",-1)])]),_:1})]),_:1})):(g(),S(z,{key:2},[t(W,{data:b.value,stripe:"",style:{width:"100%"}},{default:a(()=>[t(d,{prop:"project_name",label:"项目名称","min-width":"200"},{default:a(({row:o})=>[t(Q,{type:"primary",onClick:y=>M(o)},{default:a(()=>[w(k(o.project_name),1)]),_:2},1032,["onClick"])]),_:1}),t(d,{prop:"project_number",label:"项目编号",width:"150"}),t(d,{prop:"status",label:"状态",width:"120"},{default:a(({row:o})=>[t(O,{type:G(o.status)},{default:a(()=>[w(k(R(o.status)),1)]),_:2},1032,["type"])]),_:1}),t(d,{prop:"company_name",label:"关联企业",width:"200"}),t(d,{prop:"created_at",label:"创建时间",width:"180"},{default:a(({row:o})=>[w(k(F(o.created_at)),1)]),_:1}),t(d,{label:"操作",width:"200",fixed:"right"},{default:a(({row:o})=>[t(l(C),{icon:"bi-eye",type:"primary",tooltip:"查看详情",onClick:y=>M(o)},null,8,["onClick"]),t(l(C),{icon:"bi-play-circle",type:"success",tooltip:"继续处理",onClick:y=>N(o)},null,8,["onClick"]),t(l(C),{icon:"bi-archive",type:"warning",tooltip:"归档",onClick:y=>q(o)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),s("div",Pe,[t(X,{"current-page":f.value,"onUpdate:currentPage":n[0]||(n[0]=o=>f.value=o),"page-size":v.value,"onUpdate:pageSize":n[1]||(n[1]=o=>v.value=o),total:T.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:H,onCurrentChange:U},null,8,["current-page","page-size","total"])])],64))]),_:1})])}}}),He=be(je,[["__scopeId","data-v-6925dc07"]]);export{He as default};
