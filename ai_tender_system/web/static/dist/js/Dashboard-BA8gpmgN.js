import{d as a,M as e,r as t,S as i,e as l,o as s,f as o,w as n,ai as r,h as c,aj as d,n as u,ak as p,F as f,V as g,ac as m,U as v,t as _,k as b,g as h,p as y,al as w,am as k,Q as j,X as C,an as P,ao as x}from"./vendor-CDDpMtwV.js";import{u as T}from"./project-CjW4pBd6.js";import{a as M,_ as z}from"./index.js";import{t as D}from"./tender-ZYcn_VXM.js";import{L as S}from"./Loading-BuO92tsF.js";import{E as Y}from"./Empty-B0AR3JW0.js";/* empty css                                                                          */import{C as A}from"./Card-Cm-iyLJB.js";import{I as H}from"./IconButton-DEnliMcB.js";/* empty css                                                                        */const I={class:"dashboard-page"},U={class:"quick-actions"},q=["onClick"],B={class:"action-label"},E={class:"pagination-wrapper"},F=z(a({__name:"Dashboard",setup(a){const z=e(),F=T(),{success:L,error:Q,confirm:V}=M(),X=t(!1),$=t(!1),G=t({totalProjects:0,inProgressProjects:0,wonThisMonth:0,pendingTasks:0}),J=t([]),K=t(1),N=t(10),O=t(0),R=[{name:"start-tender",label:"开始投标",icon:"bi bi-play-circle-fill",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",route:"/tender-management"},{name:"business-response",label:"商务应答",icon:"bi bi-briefcase-fill",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",route:"/business-response"},{name:"point-to-point",label:"点对点应答",icon:"bi bi-arrow-left-right",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",route:"/point-to-point"},{name:"tech-proposal",label:"技术方案",icon:"bi bi-file-code-fill",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",route:"/tech-proposal"},{name:"tender-scoring",label:"标书评分",icon:"bi bi-star-fill",color:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",route:"/tender-scoring"},{name:"knowledge",label:"知识中心",icon:"bi bi-book-fill",color:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",route:"/knowledge/company-library"}];async function W(){$.value=!0;try{const a=await D.getProjects({page:K.value,page_size:N.value});a.success&&a.data&&(Array.isArray(a.data)?(J.value=a.data,O.value=a.data.length):a.data.items&&(J.value=a.data.items,O.value=a.data.total||0))}catch(a){Q("加载项目列表失败: "+a.message)}finally{$.value=!1}}async function Z(){await W(),L("刷新成功")}function aa(){z.push("/tender-management")}function ea(a){F.setCurrentProject(a),z.push({name:"TenderManagementDetail",params:{id:a.id}})}function ta(a){N.value=a,K.value=1,W()}function ia(a){K.value=a,W()}function la(a){return{pending:"待处理",in_progress:"进行中",completed:"已完成",won:"已中标",lost:"未中标",archived:"已归档"}[a]||a}return i(()=>{!async function(){X.value=!0;try{const a=await D.getDashboardStatistics();a.success&&a.data&&(G.value={totalProjects:a.data.totalProjects,inProgressProjects:a.data.inProgressProjects,wonThisMonth:a.data.wonThisMonth,pendingTasks:a.data.pendingTasks})}catch(a){Q("加载统计数据失败: "+a.message)}finally{X.value=!1}}(),W()}),(a,e)=>{const t=d,i=r,T=p,M=h,D=j,sa=k,oa=C,na=w,ra=P;return s(),l("div",I,[o(T,{gutter:16,class:"kpi-cards"},{default:n(()=>[o(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[o(c(A),{shadow:"hover",loading:X.value},{default:n(()=>[o(t,{title:"总项目数",value:G.value.totalProjects},{prefix:n(()=>[...e[2]||(e[2]=[u("i",{class:"bi bi-folder-fill statistic-icon",style:{color:"#409eff"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),o(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[o(c(A),{shadow:"hover",loading:X.value},{default:n(()=>[o(t,{title:"进行中项目",value:G.value.inProgressProjects},{prefix:n(()=>[...e[3]||(e[3]=[u("i",{class:"bi bi-clock-fill statistic-icon",style:{color:"#e6a23c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),o(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[o(c(A),{shadow:"hover",loading:X.value},{default:n(()=>[o(t,{title:"本月中标",value:G.value.wonThisMonth},{prefix:n(()=>[...e[4]||(e[4]=[u("i",{class:"bi bi-trophy-fill statistic-icon",style:{color:"#67c23a"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),o(i,{xs:12,sm:12,md:6,lg:6},{default:n(()=>[o(c(A),{shadow:"hover",loading:X.value},{default:n(()=>[o(t,{title:"待处理任务",value:G.value.pendingTasks},{prefix:n(()=>[...e[5]||(e[5]=[u("i",{class:"bi bi-list-task statistic-icon",style:{color:"#f56c6c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1})]),_:1}),o(c(A),{title:"快捷入口",class:"quick-actions-card"},{default:n(()=>[u("div",U,[(s(),l(f,null,g(R,a=>u("div",{key:a.name,class:"action-item",onClick:e=>function(a){z.push(a.route)}(a)},[u("div",{class:"action-icon",style:m({background:a.color})},[u("i",{class:v(a.icon)},null,2)],4),u("div",B,_(a.label),1)],8,q)),64))])]),_:1}),o(c(A),{title:"进行中的项目",class:"projects-card"},{actions:n(()=>[o(c(H),{icon:"bi-arrow-clockwise",tooltip:"刷新",onClick:Z})]),default:n(()=>[$.value?(s(),b(c(S),{key:0,visible:!0,fullscreen:!1,text:"加载项目列表..."})):0===J.value.length?(s(),b(c(Y),{key:1,type:"no-data",description:"暂无进行中的项目"},{action:n(()=>[o(M,{type:"primary",onClick:aa},{default:n(()=>[...e[6]||(e[6]=[y("创建第一个项目",-1)])]),_:1})]),_:1})):(s(),l(f,{key:2},[o(na,{data:J.value,stripe:"",style:{width:"100%"}},{default:n(()=>[o(sa,{prop:"project_name",label:"项目名称","min-width":"200"},{default:n(({row:a})=>[o(D,{type:"primary",onClick:e=>ea(a)},{default:n(()=>[y(_(a.project_name),1)]),_:2},1032,["onClick"])]),_:1}),o(sa,{prop:"project_number",label:"项目编号",width:"150"}),o(sa,{prop:"status",label:"状态",width:"120"},{default:n(({row:a})=>{return[o(oa,{type:(e=a.status,{pending:"info",in_progress:"warning",completed:"success",won:"success",lost:"danger",archived:"info"}[e]||"info")},{default:n(()=>[y(_(la(a.status)),1)]),_:2},1032,["type"])];var e}),_:1}),o(sa,{prop:"company_name",label:"关联企业",width:"200"}),o(sa,{prop:"created_at",label:"创建时间",width:"180"},{default:n(({row:a})=>{return[y(_((e=a.created_at,e?x(e).format("YYYY-MM-DD HH:mm"):"-")),1)];var e}),_:1}),o(sa,{label:"操作",width:"200",fixed:"right"},{default:n(({row:a})=>[o(c(H),{icon:"bi-eye",type:"primary",tooltip:"查看详情",onClick:e=>ea(a)},null,8,["onClick"]),o(c(H),{icon:"bi-play-circle",type:"success",tooltip:"继续处理",onClick:e=>{return t=a,F.setCurrentProject(t),void z.push({name:"TenderManagementDetail",params:{id:t.id}});var t}},null,8,["onClick"]),o(c(H),{icon:"bi-archive",type:"warning",tooltip:"归档",onClick:e=>async function(a){if(await V(`确定要归档项目"${a.project_name}"吗?`,"归档项目","归档后项目将不再显示在进行中列表"))try{await F.updateProject(a.id,{status:"archived"}),L("项目已归档"),await W()}catch(e){Q("归档失败: "+e.message)}}(a)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),u("div",E,[o(ra,{"current-page":K.value,"onUpdate:currentPage":e[0]||(e[0]=a=>K.value=a),"page-size":N.value,"onUpdate:pageSize":e[1]||(e[1]=a=>N.value=a),total:O.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:ta,onCurrentChange:ia},null,8,["current-page","page-size","total"])])],64))]),_:1})])}}}),[["__scopeId","data-v-6925dc07"]]);export{F as default};
