import{C as e,M as l,d as a,e as t,h as o,p as u,n as r,a as s,H as d,I as i,o as n,y as v,G as p,D as c,f as _,g as m,U as f,b as y,c as w,N as h}from"./vendor-element-plus-CEQaQHNc.js";import{d as b,b7 as g,r as V,a as k,b as C,P as x,M as j,O as U,c as L,N as D,I as R,R as z,L as F,H as E}from"./vendor-vue-DnBj6vzG.js";import{L as I}from"./Loading-fOFG7xAl.js";import{E as $}from"./Empty-BzPBqxja.js";/* empty css                                                                          */import{C as O}from"./Card-CKMHDauo.js";import{eK as P,c$ as M,eR as B,ey as G,eG as H,dn as N,es as X,eu as q}from"./vendor-other-CxXkF0Pk.js";import"./vendor-editor-CGvuleas.js";/* empty css                                                                        */import"./vendor-dayjs-CeOjnJlt.js";import{a as K,_ as Q}from"./index.js";import{k as A,f as J}from"./formatters-D-henrcx.js";import{v as S,a as T}from"./validators-BHjNrE0Y.js";import"./vendor-echarts-C00rBISf.js";import"./vendor-axios-BG7aBJwU.js";const W={class:"resume-library"},Y={class:"stats-bar"},Z={class:"stat-content"},ee={class:"stat-icon"},le={class:"stat-info"},ae={class:"stat-value"},te={class:"stat-content"},oe={class:"stat-icon"},ue={class:"stat-info"},re={class:"stat-value"},se={class:"stat-content"},de={class:"stat-icon"},ie={class:"stat-info"},ne={class:"stat-value"},ve={class:"filter-section"},pe=Q(b({__name:"ResumeLibrary",setup(b){const Q=g(),{success:pe,error:ce}=K(),_e=V(!1),me=V([]),fe=V({keyword:"",educationLevel:"",position:"",status:""}),ye=V(!1),we=V(!1),he=V(),be=V({name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""}),ge={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:50,message:"姓名长度在 2 到 50 个字符",trigger:"blur"}],phone:[{validator:T,trigger:"blur"}],email:[{validator:S,trigger:"blur"}]},Ve=V(!1),ke=V(!1),Ce=V(),xe=V([]),je=V(null),Ue=k(()=>{let e=[...me.value];if(fe.value.keyword){const l=fe.value.keyword.toLowerCase();e=e.filter(e=>{var a,t,o,u;return(null==(a=e.name)?void 0:a.toLowerCase().includes(l))||(null==(t=e.current_position)?void 0:t.toLowerCase().includes(l))||(null==(o=e.skills)?void 0:o.toLowerCase().includes(l))||(null==(u=e.major)?void 0:u.toLowerCase().includes(l))})}if(fe.value.educationLevel&&(e=e.filter(e=>e.education_level===fe.value.educationLevel)),fe.value.position){const l=fe.value.position.toLowerCase();e=e.filter(e=>{var a;return null==(a=e.current_position)?void 0:a.toLowerCase().includes(l)})}return fe.value.status&&(e=e.filter(e=>e.status===fe.value.status)),e}),Le=k(()=>me.value.filter(e=>"active"===e.status).length),De=k(()=>{const e=me.value.filter(e=>e.work_years&&e.work_years>0);if(0===e.length)return 0;return(e.reduce((e,l)=>e+(l.work_years||0),0)/e.length).toFixed(1)}),Re=async()=>{_e.value=!0;try{const e=await A.getResumes();if(e.success&&e.data){const l=e.data.resumes||e.data;me.value=l.map(e=>({...e,created_at:e.created_at?J(e.created_at):"-",updated_at:e.updated_at?J(e.updated_at):"-"}))}}catch(e){ce("加载失败",e instanceof Error?e.message:"未知错误")}finally{_e.value=!1}},ze=()=>{},Fe=()=>{fe.value.keyword="",fe.value.educationLevel="",fe.value.position="",fe.value.status=""},Ee=e=>{switch(e){case"active":return"success";case"inactive":return"warning";default:return"info"}},Ie=e=>{switch(e){case"active":return"活跃";case"inactive":return"离职";case"archived":return"已归档";default:return"-"}},$e=()=>{ye.value=!0},Oe=async()=>{he.value&&await he.value.validate(async e=>{if(e){we.value=!0;try{const e=await A.createResume({name:be.value.name,gender:be.value.gender||void 0,phone:be.value.phone||void 0,email:be.value.email||void 0,education_level:be.value.education_level||void 0,degree:be.value.degree||void 0,university:be.value.university||void 0,major:be.value.major||void 0,current_position:be.value.current_position||void 0,professional_title:be.value.professional_title||void 0,work_years:be.value.work_years,current_company:be.value.current_company||void 0,introduction:be.value.introduction||void 0,status:"active"});e.success?(pe("创建成功","简历创建成功"),ye.value=!1,await Re()):ce("创建失败",e.error||"未知错误")}catch(l){ce("创建失败",l instanceof Error?l.message:"未知错误")}finally{we.value=!1}}})},Pe=()=>{Ve.value=!0},Me=e=>{if(e.raw){const l=10485760;if(e.raw.size>l)return ce("文件过大","文件大小不能超过10MB"),xe.value=[],void(je.value=null);je.value=e.raw}},Be=()=>{je.value=null},Ge=async()=>{if(je.value){ke.value=!0;try{const e=await A.parseResumeFile(je.value,!0);e.success?(pe("导入成功","简历已自动解析并创建"),Ve.value=!1,await Re()):ce("导入失败",e.error||"解析失败")}catch(e){ce("导入失败",e instanceof Error?e.message:"未知错误")}finally{ke.value=!1}}else ce("请选择文件","请先选择要上传的简历文件")},He=()=>{xe.value=[],je.value=null},Ne=()=>{var e;be.value={name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""},null==(e=he.value)||e.resetFields()};return C(()=>{Re()}),(b,g)=>{const V=e,k=l,C=s,K=o,J=t,S=r,T=u,je=a,Xe=i,qe=n,Ke=d,Qe=v,Ae=c,Je=m,Se=_,Te=p,We=f,Ye=y,Ze=w,el=h;return j(),x("div",W,[U("div",Y,[L(k,{class:"stat-card"},{default:D(()=>[U("div",Z,[U("div",ee,[L(V,{size:32,color:"#409eff"},{default:D(()=>[L(R(P))]),_:1})]),U("div",le,[g[22]||(g[22]=U("div",{class:"stat-label"},"总简历数",-1)),U("div",ae,z(me.value.length),1)])])]),_:1}),L(k,{class:"stat-card"},{default:D(()=>[U("div",te,[U("div",oe,[L(V,{size:32,color:"#67c23a"},{default:D(()=>[L(R(M))]),_:1})]),U("div",ue,[g[23]||(g[23]=U("div",{class:"stat-label"},"活跃简历",-1)),U("div",re,z(Le.value),1)])])]),_:1}),L(k,{class:"stat-card"},{default:D(()=>[U("div",se,[U("div",de,[L(V,{size:32,color:"#e6a23c"},{default:D(()=>[L(R(B))]),_:1})]),U("div",ie,[g[24]||(g[24]=U("div",{class:"stat-label"},"平均工龄",-1)),U("div",ne,z(De.value)+"年",1)])])]),_:1})]),L(R(O),{title:"简历列表"},{actions:D(()=>[L(C,{type:"primary",onClick:$e},{default:D(()=>[L(V,null,{default:D(()=>[L(R(N))]),_:1}),g[25]||(g[25]=E(" 新建简历 ",-1))]),_:1}),L(C,{type:"success",onClick:Pe},{default:D(()=>[L(V,null,{default:D(()=>[L(R(X))]),_:1}),g[26]||(g[26]=E(" 智能导入 ",-1))]),_:1})]),default:D(()=>[U("div",ve,[L(je,{inline:!0,model:fe.value},{default:D(()=>[L(J,{label:"搜索"},{default:D(()=>[L(K,{modelValue:fe.value.keyword,"onUpdate:modelValue":g[0]||(g[0]=e=>fe.value.keyword=e),placeholder:"搜索姓名、职位、技能...",clearable:"",style:{width:"300px"},onInput:ze},{prefix:D(()=>[L(V,null,{default:D(()=>[L(R(G))]),_:1})]),_:1},8,["modelValue"])]),_:1}),L(J,{label:"学历"},{default:D(()=>[L(T,{modelValue:fe.value.educationLevel,"onUpdate:modelValue":g[1]||(g[1]=e=>fe.value.educationLevel=e),placeholder:"全部学历",clearable:"",style:{width:"120px"},onChange:ze},{default:D(()=>[L(S,{label:"全部学历",value:""}),L(S,{label:"博士",value:"博士"}),L(S,{label:"硕士",value:"硕士"}),L(S,{label:"本科",value:"本科"}),L(S,{label:"大专",value:"大专"}),L(S,{label:"高中",value:"高中"})]),_:1},8,["modelValue"])]),_:1}),L(J,{label:"职位"},{default:D(()=>[L(K,{modelValue:fe.value.position,"onUpdate:modelValue":g[2]||(g[2]=e=>fe.value.position=e),placeholder:"职位关键词",clearable:"",style:{width:"150px"},onInput:ze},null,8,["modelValue"])]),_:1}),L(J,{label:"状态"},{default:D(()=>[L(T,{modelValue:fe.value.status,"onUpdate:modelValue":g[3]||(g[3]=e=>fe.value.status=e),placeholder:"全部状态",clearable:"",style:{width:"120px"},onChange:ze},{default:D(()=>[L(S,{label:"全部状态",value:""}),L(S,{label:"活跃",value:"active"}),L(S,{label:"离职",value:"inactive"}),L(S,{label:"已归档",value:"archived"})]),_:1},8,["modelValue"])]),_:1}),L(J,null,{default:D(()=>[L(C,{onClick:Fe},{default:D(()=>[L(V,null,{default:D(()=>[L(R(H))]),_:1}),g[27]||(g[27]=E(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),_e.value?(j(),F(R(I),{key:0,text:"加载中..."})):Ue.value.length?(j(),F(Ke,{key:2,data:Ue.value,stripe:"",style:{width:"100%"}},{default:D(()=>[L(Xe,{prop:"resume_id",label:"ID",width:"70",fixed:""}),L(Xe,{prop:"name",label:"姓名",width:"100",fixed:""}),L(Xe,{prop:"gender",label:"性别",width:"60",align:"center"},{default:D(({row:e})=>[E(z(e.gender||"-"),1)]),_:1}),L(Xe,{prop:"education_level",label:"学历",width:"80"},{default:D(({row:e})=>{return[L(qe,{type:(l=e.education_level,l?"博士"===l?"danger":"硕士"===l?"warning":"本科"===l?"success":"info":"info"),size:"small"},{default:D(()=>[E(z(e.education_level||"-"),1)]),_:2},1032,["type"])];var l}),_:1}),L(Xe,{prop:"university",label:"毕业院校",width:"140","show-overflow-tooltip":""}),L(Xe,{prop:"major",label:"专业",width:"120","show-overflow-tooltip":""}),L(Xe,{prop:"current_position",label:"当前职位",width:"140","show-overflow-tooltip":""}),L(Xe,{prop:"professional_title",label:"职称",width:"100"}),L(Xe,{prop:"work_years",label:"工作年限",width:"90",align:"center"},{default:D(({row:e})=>[E(z(e.work_years?`${e.work_years}年`:"-"),1)]),_:1}),L(Xe,{prop:"current_company",label:"当前单位",width:"160","show-overflow-tooltip":""}),L(Xe,{prop:"phone",label:"联系电话",width:"120"}),L(Xe,{prop:"email",label:"邮箱",width:"180","show-overflow-tooltip":""}),L(Xe,{prop:"status",label:"状态",width:"80",align:"center"},{default:D(({row:e})=>[L(qe,{type:Ee(e.status),size:"small"},{default:D(()=>[E(z(Ie(e.status)),1)]),_:2},1032,["type"])]),_:1}),L(Xe,{prop:"created_at",label:"创建时间",width:"160","show-overflow-tooltip":""}),L(Xe,{label:"操作",width:"220",fixed:"right"},{default:D(({row:e})=>[L(C,{text:"",type:"primary",size:"small",onClick:l=>(e=>{Q.push(`/knowledge/resume/${e.resume_id}`)})(e)},{default:D(()=>[...g[28]||(g[28]=[E(" 查看详情 ",-1)])]),_:1},8,["onClick"]),L(C,{text:"",type:"warning",size:"small",onClick:l=>(e=>{Q.push(`/knowledge/resume/${e.resume_id}`)})(e)},{default:D(()=>[...g[29]||(g[29]=[E(" 编辑 ",-1)])]),_:1},8,["onClick"]),L(C,{text:"",type:"danger",size:"small",onClick:l=>(async e=>{try{if(!confirm(`确定要删除简历 "${e.name}" 吗？此操作不可恢复。`))return;const l=await A.deleteResume(e.resume_id);l.success?(pe("删除成功",`已删除简历: ${e.name}`),await Re()):ce("删除失败",l.error||"未知错误")}catch(l){ce("删除失败",l instanceof Error?l.message:"未知错误")}})(e)},{default:D(()=>[...g[30]||(g[30]=[E(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(j(),F(R($),{key:1,type:"no-data",description:"暂无简历数据"}))]),_:1}),L(Ye,{modelValue:ye.value,"onUpdate:modelValue":g[18]||(g[18]=e=>ye.value=e),title:"新建简历",width:"700px",onClose:Ne},{footer:D(()=>[L(C,{onClick:g[17]||(g[17]=e=>ye.value=!1)},{default:D(()=>[...g[36]||(g[36]=[E("取消",-1)])]),_:1}),L(C,{type:"primary",loading:we.value,onClick:Oe},{default:D(()=>[...g[37]||(g[37]=[E(" 确定 ",-1)])]),_:1},8,["loading"])]),default:D(()=>[L(je,{ref_key:"createFormRef",ref:he,model:be.value,rules:ge,"label-width":"120px"},{default:D(()=>[L(Qe,{"content-position":"left"},{default:D(()=>[...g[31]||(g[31]=[E("基本信息",-1)])]),_:1}),L(Te,{gutter:20},{default:D(()=>[L(Ae,{span:12},{default:D(()=>[L(J,{label:"姓名",prop:"name"},{default:D(()=>[L(K,{modelValue:be.value.name,"onUpdate:modelValue":g[4]||(g[4]=e=>be.value.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),L(Ae,{span:12},{default:D(()=>[L(J,{label:"性别",prop:"gender"},{default:D(()=>[L(Se,{modelValue:be.value.gender,"onUpdate:modelValue":g[5]||(g[5]=e=>be.value.gender=e)},{default:D(()=>[L(Je,{label:"男"},{default:D(()=>[...g[32]||(g[32]=[E("男",-1)])]),_:1}),L(Je,{label:"女"},{default:D(()=>[...g[33]||(g[33]=[E("女",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),L(Te,{gutter:20},{default:D(()=>[L(Ae,{span:12},{default:D(()=>[L(J,{label:"联系电话",prop:"phone"},{default:D(()=>[L(K,{modelValue:be.value.phone,"onUpdate:modelValue":g[6]||(g[6]=e=>be.value.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1})]),_:1}),L(Ae,{span:12},{default:D(()=>[L(J,{label:"邮箱",prop:"email"},{default:D(()=>[L(K,{modelValue:be.value.email,"onUpdate:modelValue":g[7]||(g[7]=e=>be.value.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),L(Qe,{"content-position":"left"},{default:D(()=>[...g[34]||(g[34]=[E("教育信息",-1)])]),_:1}),L(Te,{gutter:20},{default:D(()=>[L(Ae,{span:12},{default:D(()=>[L(J,{label:"学历",prop:"education_level"},{default:D(()=>[L(T,{modelValue:be.value.education_level,"onUpdate:modelValue":g[8]||(g[8]=e=>be.value.education_level=e),placeholder:"请选择学历",style:{width:"100%"}},{default:D(()=>[L(S,{label:"博士",value:"博士"}),L(S,{label:"硕士",value:"硕士"}),L(S,{label:"本科",value:"本科"}),L(S,{label:"大专",value:"大专"}),L(S,{label:"高中",value:"高中"}),L(S,{label:"中专",value:"中专"}),L(S,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),L(Ae,{span:12},{default:D(()=>[L(J,{label:"学位",prop:"degree"},{default:D(()=>[L(T,{modelValue:be.value.degree,"onUpdate:modelValue":g[9]||(g[9]=e=>be.value.degree=e),placeholder:"请选择学位",style:{width:"100%"}},{default:D(()=>[L(S,{label:"博士学位",value:"博士"}),L(S,{label:"硕士学位",value:"硕士"}),L(S,{label:"学士学位",value:"学士"}),L(S,{label:"无学位",value:"无"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),L(Te,{gutter:20},{default:D(()=>[L(Ae,{span:12},{default:D(()=>[L(J,{label:"毕业院校",prop:"university"},{default:D(()=>[L(K,{modelValue:be.value.university,"onUpdate:modelValue":g[10]||(g[10]=e=>be.value.university=e),placeholder:"请输入毕业院校"},null,8,["modelValue"])]),_:1})]),_:1}),L(Ae,{span:12},{default:D(()=>[L(J,{label:"专业",prop:"major"},{default:D(()=>[L(K,{modelValue:be.value.major,"onUpdate:modelValue":g[11]||(g[11]=e=>be.value.major=e),placeholder:"请输入专业"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),L(Qe,{"content-position":"left"},{default:D(()=>[...g[35]||(g[35]=[E("工作信息",-1)])]),_:1}),L(Te,{gutter:20},{default:D(()=>[L(Ae,{span:12},{default:D(()=>[L(J,{label:"当前职位",prop:"current_position"},{default:D(()=>[L(K,{modelValue:be.value.current_position,"onUpdate:modelValue":g[12]||(g[12]=e=>be.value.current_position=e),placeholder:"如：项目经理"},null,8,["modelValue"])]),_:1})]),_:1}),L(Ae,{span:12},{default:D(()=>[L(J,{label:"职称",prop:"professional_title"},{default:D(()=>[L(K,{modelValue:be.value.professional_title,"onUpdate:modelValue":g[13]||(g[13]=e=>be.value.professional_title=e),placeholder:"如：高级工程师"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),L(Te,{gutter:20},{default:D(()=>[L(Ae,{span:12},{default:D(()=>[L(J,{label:"工作年限",prop:"work_years"},{default:D(()=>[L(We,{modelValue:be.value.work_years,"onUpdate:modelValue":g[14]||(g[14]=e=>be.value.work_years=e),min:0,max:50,placeholder:"年",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),L(Ae,{span:12},{default:D(()=>[L(J,{label:"当前单位",prop:"current_company"},{default:D(()=>[L(K,{modelValue:be.value.current_company,"onUpdate:modelValue":g[15]||(g[15]=e=>be.value.current_company=e),placeholder:"请输入当前工作单位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),L(J,{label:"个人简介",prop:"introduction"},{default:D(()=>[L(K,{modelValue:be.value.introduction,"onUpdate:modelValue":g[16]||(g[16]=e=>be.value.introduction=e),type:"textarea",rows:3,placeholder:"请简要介绍个人经历、专长等"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),L(Ye,{modelValue:Ve.value,"onUpdate:modelValue":g[21]||(g[21]=e=>Ve.value=e),title:"智能导入简历",width:"500px",onClose:He},{footer:D(()=>[L(C,{onClick:g[20]||(g[20]=e=>Ve.value=!1)},{default:D(()=>[...g[40]||(g[40]=[E("取消",-1)])]),_:1}),L(C,{type:"primary",loading:ke.value,onClick:Ge},{default:D(()=>[...g[41]||(g[41]=[E(" 开始解析 ",-1)])]),_:1},8,["loading"])]),default:D(()=>[L(Ze,{title:"智能解析",type:"info",description:"上传PDF/DOC/DOCX格式的简历文件，系统将自动提取信息并创建简历记录",closable:!1,style:{"margin-bottom":"20px"}}),L(el,{ref_key:"uploadRef",ref:Ce,"file-list":xe.value,"onUpdate:fileList":g[19]||(g[19]=e=>xe.value=e),"auto-upload":!1,limit:1,accept:".pdf,.doc,.docx",drag:"","on-change":Me,"on-remove":Be},{tip:D(()=>[...g[38]||(g[38]=[U("div",{class:"el-upload__tip"}," 支持PDF、DOC、DOCX格式，文件大小不超过10MB ",-1)])]),default:D(()=>[L(V,{class:"el-icon--upload"},{default:D(()=>[L(R(q))]),_:1}),g[39]||(g[39]=U("div",{class:"el-upload__text"},[E(" 拖拽文件到这里 或 "),U("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d80ddb3a"]]);export{pe as default};
