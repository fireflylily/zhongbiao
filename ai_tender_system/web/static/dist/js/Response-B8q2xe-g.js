import{e,Q as a,g as l,r as t,q as s,n as o,ak as i,C as r,D as n,x as u,L as c,E as d,_ as p}from"./index.js";/* empty css                   *//* empty css                                                                          *//* empty css                             *//* empty css                *//* empty css                    *//* empty css                     */import{E as m}from"./el-text-S2UFytBJ.js";/* empty css               *//* empty css                */import{E as v,a as f}from"./el-select-DdF3cFxb.js";import{aq as _,am as y,an as h,aV as w,aw as j,as as g,au as b,ar as F,aK as x,at as I,av as k,aX as V,aY as C,ay as E,aR as D,aS as P,aJ as z,aT as S}from"./editor-BksuvsBo.js";/* empty css                *//* empty css                                                                        */import{D as U}from"./DocumentUploader-CM5b8yL_.js";import{D as R}from"./DocumentPreview-DB9ApMV8.js";import{R as q}from"./RichTextEditor-BSA6Wdxw.js";import{u as N,S as T,d as $}from"./helpers-DopMmGWm.js";import{t as H}from"./tender-Bln5F12J.js";import{c as L}from"./company-CgN_f2mJ.js";import{u as J}from"./project-B54dKqlu.js";import{u as B}from"./useProjectDocuments-CNNukbUU.js";import{E as W}from"./index-CaR2Xywu.js";import{E as O,a as M}from"./index-6lxmkW-L.js";import{E as A,a as G}from"./index-BQ1extYL.js";import{E as K}from"./index-CVN4vWqy.js";import{E as Q,a as X}from"./index-T-rzgWkp.js";import{E as Y}from"./index-Cta0JgjH.js";import{v as Z}from"./directive-ArrUQqUv.js";import{E as ee}from"./index-D3Fm_fS5.js";import"./index-DIagUHFq.js";import"./strings-DK8QLfUq.js";import"./index-CzDCqbWO.js";import"./toNumber-CaKcxK6u.js";import"./_baseFindIndex-BTqrMG7V.js";import"./_baseIteratee-CoZ4vtCr.js";import"./imageCompressor-CTkRt5bg.js";import"./index-DJhc04Ps.js";import"./index-BRJO3xF8.js";import"./cloneDeep-syPWYH98.js";import"./index-4AJA-Lo_.js";import"./index-BC8-jPfA.js";import"./index-TaNLZe78.js";import"./index-2_Cr1rF7.js";import"./flatMap-Cn50Lb61.js";import"./map-D9sy2acr.js";import"./_baseEach-C84OUv0l.js";import"./index-D9lgUf6z.js";import"./raf-B6jWGkGX.js";const ae={async processBusinessResponse(a){const l=new FormData;return l.append("company_id",a.company_id.toString()),l.append("project_name",a.project_name),a.tender_no&&l.append("tender_no",a.tender_no),a.date_text&&l.append("date_text",a.date_text),l.append("hitl_file_path",a.hitl_file_path),l.append("use_mcp",!1!==a.use_mcp?"true":"false"),e.post("/process-business-response",l,{headers:{"Content-Type":"multipart/form-data"}})}},le={class:"business-response"},te={class:"panel-row project-row"},se={class:"row-item"},oe={class:"row-item"},ie={key:0,class:"panel-row project-row"},re={class:"row-item"},ne={class:"row-item"},ue={class:"panel-row project-row document-row"},ce={class:"row-item"},de={key:0,class:"file-chip file-chip--success"},pe=["title"],me={key:1,class:"file-chip file-chip--info"},ve=["title"],fe={key:2,class:"file-placeholder"},_e={class:"row-item"},ye={key:0,class:"file-chip file-chip--success"},he=["title"],we={key:1,class:"file-chip file-chip--info"},je=["title"],ge={key:2,class:"file-placeholder"},be={class:"panel-actions"},Fe={class:"card-header"},xe={class:"header-actions"},Ie={class:"result-content"},ke={key:0,class:"qualifications-details-section"},Ve={style:{margin:"8px 0 0 20px",padding:"0"}},Ce={class:"file-info-section"},Ee={class:"collapse-header"},De={class:"filename-cell"},Pe=p(_({__name:"Response",setup(e){J();const{projects:p,selectedProject:_,loadProjects:Pe,handleProjectChange:ze,restoreProjectFromStore:Se}=B(),{useHitlFile:Ue,hitlFileInfo:Re,syncing:qe,synced:Ne,loadFromHITL:Te,cancelHitlFile:$e,syncToHitl:He}=N({onFileLoaded:()=>{Oe.value.templateFiles=[]}}),{useHitlFile:Le,hitlFileInfo:Je,loadFromHITL:Be,cancelHitlFile:We}=N({onFileLoaded:()=>{Oe.value.tenderFiles=[]}}),Oe=y({projectId:null,companyId:null,projectName:"æ–°é¡¹ç›®",projectNumber:`PRJ-${Date.now()}`,tenderFiles:[],templateFiles:[]}),Me=y([]);h(()=>Me.value.find(e=>e.company_id===Oe.value.companyId));const Ae=h(()=>Oe.value.projectId&&(Oe.value.templateFiles.length>0||Ue.value)),Ge=y(!1),Ke=y(0),Qe=y(""),Xe=y(null),Ye=y(!1),Ze=y(null),ea=y(""),aa=y(!1),la=y(!1),ta=y(""),sa=y(""),oa=y([]),ia=y([]),ra=y(!1),na=y([]),ua=async e=>{const{file:a,onSuccess:l,onError:t}=e;try{if(!Oe.value.projectId){if(!Oe.value.companyId)throw new Error("è¯·å…ˆé€‰æ‹©å…¬å¸");d.info("æ­£åœ¨åˆ›å»ºæ–°é¡¹ç›®...");const e=await H.createProject({company_id:Oe.value.companyId,project_name:Oe.value.projectName||"æ–°é¡¹ç›®",project_number:Oe.value.projectNumber||`PRJ-${Date.now()}`});Oe.value.projectId=e.project_id,await Pe(),d.success("æ–°é¡¹ç›®å·²åˆ›å»º"),await pa()}const e=await H.uploadBusinessTemplate(Oe.value.projectId,a);if(!e.success)throw new Error(e.message||"ä¸Šä¼ å¤±è´¥");l(e.data),d.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")}catch(s){t(s),d.error(s.message||"æ¨¡æ¿ä¸Šä¼ å¤±è´¥")}},ca=async e=>{var a;const{file:l,onSuccess:t,onError:s}=e;try{if(!Oe.value.projectId){if(!Oe.value.companyId)throw new Error("è¯·å…ˆé€‰æ‹©å…¬å¸");d.info("æ­£åœ¨åˆ›å»ºæ–°é¡¹ç›®...");const e=await H.createProject({company_id:Oe.value.companyId,project_name:Oe.value.projectName||"æ–°é¡¹ç›®",project_number:Oe.value.projectNumber||`PRJ-${Date.now()}`});Oe.value.projectId=e.project_id,await Pe(),d.success("æ–°é¡¹ç›®å·²åˆ›å»º"),await pa()}const e=null==(a=_.value)?void 0:a.company_id;if(!e)throw new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸");const s=new FormData;s.append("file",l),s.append("company_id",e.toString()),s.append("project_id",Oe.value.projectId.toString());const o=await H.parseDocumentStructure(s);if(!o.success)throw new Error(o.message||"ä¸Šä¼ å¤±è´¥");t(o.data),d.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(o){s(o),d.error(o.message||"æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},da=async()=>{try{const e=await L.getCompanies();Me.value=e.data||[]}catch(e){d.error("åŠ è½½å…¬å¸åˆ—è¡¨å¤±è´¥")}},pa=async()=>{await ze(Oe.value.projectId,{onClear:()=>{Xe.value=null,Qe.value="",Oe.value.tenderFiles=[],Oe.value.templateFiles=[],Ye.value=!1,ea.value="",oa.value=[],ia.value=[],Ue.value&&$e(),Le.value&&We()},onDocumentsLoaded:e=>{e.tenderFile&&Be(e,"tenderFile"),e.templateFile&&Te(e,"templateFile"),e.businessResponseFile&&(Xe.value=e.businessResponseFile,Ye.value=!1)}}),Oe.value.projectId&&await ba(),Oe.value.projectId||(Oe.value.projectNumber=`PRJ-${Date.now()}`)},ma=()=>{d.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},va=()=>{d.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")},fa=async()=>{var e;if(Oe.value.projectId){Ge.value=!0,Ke.value=0,Qe.value="",Xe.value=null,Ye.value=!0,ea.value='<h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1><p style="color: #909399;">AIæ­£åœ¨ç”Ÿæˆå†…å®¹ï¼Œè¯·ç¨å€™...</p>',setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100);try{Qe.value="æ­£åœ¨åŠ è½½é¡¹ç›®ä¿¡æ¯...\n";const a=(await H.getProject(Oe.value.projectId)).data,l=null==(e=a.step1_data)?void 0:e.response_file_path;if(!l)throw new Error("æœªæ‰¾åˆ°å•†åŠ¡åº”ç­”æ¨¡æ¿æ–‡ä»¶è·¯å¾„ï¼Œè¯·å…ˆåœ¨æ ‡ä¹¦ç®¡ç†ä¸­ä¸Šä¼ æ¨¡æ¿");Qe.value+="æ­£åœ¨å¤„ç†å•†åŠ¡åº”ç­”æ–‡æ¡£...\n",Ke.value=30;const t=await ae.processBusinessResponse({company_id:a.company_id,project_name:a.project_name,tender_no:a.project_number||"",date_text:a.bidding_time||"",hitl_file_path:l,use_mcp:!0});Ke.value=80,Qe.value+="å¤„ç†å®Œæˆï¼Œæ­£åœ¨ç”Ÿæˆç»“æœ...\n";const s=t.data?t.data:t;if(!s.success)throw new Error(s.message||s.error||"å¤„ç†å¤±è´¥");Ke.value=100,Qe.value+=s.message+"\n",Xe.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:s.stats||{},message:s.message},await _a(s.output_file),d.success("å•†åŠ¡åº”ç­”ç”Ÿæˆå®Œæˆï¼å¯ä»¥ç¼–è¾‘äº†"),s.output_file&&Oe.value.projectId&&await He(Oe.value.projectId,s.output_file,"business_response")}catch(a){Qe.value+=`\nâŒ é”™è¯¯: ${a.message}\n`,Ze.value&&Ze.value.appendContent(`<p style="color: red;">âŒ é”™è¯¯: ${a.message}</p>`),d.error(a.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{Ge.value=!1,Ke.value<100&&(Ke.value=0)}}else d.warning("è¯·å…ˆé€‰æ‹©é¡¹ç›®")},_a=async e=>{try{ea.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const a=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),l=await a.json();if(!l.success||!l.html_content)throw new Error(l.error||"è½¬æ¢å¤±è´¥");ea.value=l.html_content,Ze.value&&Ze.value.setContent(l.html_content)}catch(a){ea.value=`\n      <h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${a.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"ä¸‹è½½Wordæ–‡æ¡£æŸ¥çœ‹</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,d.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨ä¸‹è½½åŠŸèƒ½æˆ–æ‰‹åŠ¨è¾“å…¥")}},ya=async e=>{var a,l;if(Oe.value.projectId){aa.value=!0;try{const t=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:Oe.value.projectId,document_type:"business_response",original_file:null==(a=Xe.value)?void 0:a.outputFile})}),s=await t.json();if(!s.success)throw new Error(s.error||"ä¿å­˜å¤±è´¥");Xe.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:(null==(l=Xe.value)?void 0:l.stats)||{},message:"æ–‡æ¡£å·²ä¿å­˜"},s.output_file&&await He(Oe.value.projectId,s.output_file,"business_response")}catch(t){throw t}finally{aa.value=!1}}else d.error("é¡¹ç›®IDæ— æ•ˆ")},ha=()=>{Xe.value?Xe.value.downloadUrl?la.value=!0:d.warning("æ–‡æ¡£åœ°å€æ— æ•ˆ"):d.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},wa=async()=>{var e;if(Xe.value)try{const a=Xe.value.downloadUrl,l=`å•†åŠ¡åº”ç­”-${(null==(e=_.value)?void 0:e.project_name)||"æ–‡æ¡£"}-${Date.now()}.docx`;await $(a,l),d.success("Wordæ–‡æ¡£ä¸‹è½½æˆåŠŸ")}catch(a){d.error(a.message||"æ–‡æ¡£ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}else d.warning("æš‚æ— æ–‡æ¡£å¯ä¸‹è½½")},ja=async()=>{var e;(null==(e=Xe.value)?void 0:e.outputFile)?Oe.value.projectId?await He(Oe.value.projectId,Xe.value.outputFile,"business_response"):d.error("é¡¹ç›®IDæ— æ•ˆ"):d.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},ga=e=>{if(!e)return"-";let a=e;try{a=decodeURIComponent(e)}catch{}const l=a.split("/");return l[l.length-1]||"-"},ba=async()=>{if(Oe.value.projectId){ra.value=!0;try{const e=await fetch(`/api/business-files?project_id=${Oe.value.projectId}`),a=await e.json();if(!a.success)throw new Error(a.error||"åŠ è½½å¤±è´¥");ia.value=a.data||[]}catch(e){d.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{ra.value=!1}}else ia.value=[]},Fa=e=>{const a=["B","KB","MB","GB"];let l=e,t=0;for(;l>=1024&&t<a.length-1;)l/=1024,t++;return`${l.toFixed(1)} ${a[t]}`},xa=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}};return w(async()=>{await Promise.all([Pe(),da()]);const e=await Se({onClear:()=>{Xe.value=null,Qe.value="",Oe.value.tenderFiles=[],Oe.value.templateFiles=[],Ye.value=!1,ea.value="",Ue.value&&$e(),Le.value&&We()},onDocumentsLoaded:e=>{e.tenderFile&&Be(e,"tenderFile"),e.templateFile&&Te(e,"templateFile"),e.businessResponseFile&&(Xe.value=e.businessResponseFile,Ye.value=!1)}});e&&(Oe.value.projectId=e)}),(e,y)=>{const h=f,w=v,N=a,H=l,L=s,J=W,B=K,ae=o,Pe=G,ze=m,Se=A,Te=X,He=Y,Be=Q,Ke=O,Qe=M,aa=ee,da=Z;return g(),j("div",le,[b(J,{class:"main-panel",shadow:"never"},{default:I(()=>{var e,a,l,s,o;return[k("div",te,[k("div",se,[y[12]||(y[12]=k("label",{class:"row-label"},"é€‰æ‹©é¡¹ç›®",-1)),b(w,{modelValue:Oe.value.projectId,"onUpdate:modelValue":y[0]||(y[0]=e=>Oe.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",clearable:"",onChange:pa,class:"row-select"},{default:I(()=>[(g(!0),j(V,null,C(E(p),e=>(g(),F(h,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),k("div",oe,[y[13]||(y[13]=k("label",{class:"row-label"},"åº”ç­”å…¬å¸",-1)),Oe.value.projectId?(g(),F(N,{key:0,value:(null==(e=E(_))?void 0:e.company_name)||"-",disabled:"",class:"row-input"},null,8,["value"])):(g(),F(w,{key:1,modelValue:Oe.value.companyId,"onUpdate:modelValue":y[1]||(y[1]=e=>Oe.value.companyId=e),placeholder:"è¯·é€‰æ‹©å…¬å¸",filterable:"",class:"row-select"},{default:I(()=>[(g(!0),j(V,null,C(Me.value,e=>(g(),F(h,{key:e.company_id,label:e.company_name,value:e.company_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])]),Oe.value.projectId?x("",!0):(g(),j("div",ie,[k("div",re,[y[14]||(y[14]=k("label",{class:"row-label"},"é¡¹ç›®åç§°",-1)),b(N,{modelValue:Oe.value.projectName,"onUpdate:modelValue":y[2]||(y[2]=e=>Oe.value.projectName=e),placeholder:"æ–°é¡¹ç›®",class:"row-input"},null,8,["modelValue"])]),k("div",ne,[y[15]||(y[15]=k("label",{class:"row-label"},"é¡¹ç›®ç¼–å·",-1)),b(N,{modelValue:Oe.value.projectNumber,"onUpdate:modelValue":y[3]||(y[3]=e=>Oe.value.projectNumber=e),placeholder:"PRJ-...",class:"row-input"},null,8,["modelValue"])])])),k("div",ue,[k("div",ce,[y[21]||(y[21]=k("label",{class:"row-label"},"åº”ç­”æ¨¡æ¿",-1)),E(Ue)?(g(),j("div",de,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(E(t))]),_:1}),k("span",{class:"file-chip-name",title:null==(a=E(Re))?void 0:a.filename},D((null==(l=E(Re))?void 0:l.filename)||"æœªçŸ¥æ–‡ä»¶"),9,pe),y[17]||(y[17]=k("span",{class:"file-chip-tag"},"å·²åŠ è½½",-1)),b(L,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:E($e)},{default:I(()=>[...y[16]||(y[16]=[P("Ã—",-1)])]),_:1},8,["onClick"])])):Oe.value.templateFiles.length>0?(g(),j("div",me,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(E(t))]),_:1}),k("span",{class:"file-chip-name",title:Oe.value.templateFiles[0].name},D(Oe.value.templateFiles[0].name),9,ve),y[19]||(y[19]=k("span",{class:"file-chip-tag"},"å·²ä¸Šä¼ ",-1)),b(L,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:y[4]||(y[4]=e=>Oe.value.templateFiles=[])},{default:I(()=>[...y[18]||(y[18]=[P("Ã—",-1)])]),_:1})])):(g(),j("div",fe,[y[20]||(y[20]=k("span",{class:"placeholder-text"},"è¯·ä¸Šä¼ åº”ç­”æ¨¡æ¿",-1)),b(E(U),{modelValue:Oe.value.templateFiles,"onUpdate:modelValue":y[5]||(y[5]=e=>Oe.value.templateFiles=e),"http-request":ua,accept:".doc,.docx",limit:1,"max-size":100,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:va},null,8,["modelValue"])]))]),k("div",_e,[y[27]||(y[27]=k("label",{class:"row-label"},"æ‹›æ ‡æ–‡æ¡£",-1)),E(Le)?(g(),j("div",ye,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(E(t))]),_:1}),k("span",{class:"file-chip-name",title:null==(s=E(Je))?void 0:s.filename},D((null==(o=E(Je))?void 0:o.filename)||"æœªçŸ¥æ–‡ä»¶"),9,he),y[23]||(y[23]=k("span",{class:"file-chip-tag"},"å·²åŠ è½½",-1)),b(L,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:E(We)},{default:I(()=>[...y[22]||(y[22]=[P("Ã—",-1)])]),_:1},8,["onClick"])])):Oe.value.tenderFiles.length>0?(g(),j("div",we,[b(H,{class:"file-chip-icon"},{default:I(()=>[b(E(t))]),_:1}),k("span",{class:"file-chip-name",title:Oe.value.tenderFiles[0].name},D(Oe.value.tenderFiles[0].name),9,je),y[25]||(y[25]=k("span",{class:"file-chip-tag"},"å·²ä¸Šä¼ ",-1)),b(L,{class:"file-chip-close",type:"danger",text:"",size:"small",onClick:y[6]||(y[6]=e=>Oe.value.tenderFiles=[])},{default:I(()=>[...y[24]||(y[24]=[P("Ã—",-1)])]),_:1})])):(g(),j("div",ge,[y[26]||(y[26]=k("span",{class:"placeholder-text"},"ä¸Šä¼ æ‹›æ ‡æ–‡æ¡£ï¼ˆå¯é€‰ï¼‰",-1)),b(E(U),{modelValue:Oe.value.tenderFiles,"onUpdate:modelValue":y[7]||(y[7]=e=>Oe.value.tenderFiles=e),"http-request":ca,accept:".pdf,.doc,.docx",limit:5,"max-size":50,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:ma},null,8,["modelValue"])]))])]),k("div",be,[b(L,{type:"primary",size:"large",disabled:!Ae.value,loading:Ge.value,onClick:fa},{default:I(()=>[...y[28]||(y[28]=[P(" å¼€å§‹ç”Ÿæˆå•†åŠ¡åº”ç­” ",-1)])]),_:1},8,["disabled","loading"])])]}),_:1}),Ye.value?(g(),F(J,{key:0,class:"editor-section",shadow:"never"},{default:I(()=>[b(E(q),{ref_key:"editorRef",ref:Ze,modelValue:ea.value,"onUpdate:modelValue":y[8]||(y[8]=e=>ea.value=e),title:"å•†åŠ¡åº”ç­”æ–‡æ¡£",streaming:Ge.value,height:1e3,onSave:ya,onPreview:ha,onExport:wa},null,8,["modelValue","streaming"])]),_:1})):x("",!0),Ye.value&&Xe.value?(g(),F(Qe,{key:1,modelValue:oa.value,"onUpdate:modelValue":y[9]||(y[9]=e=>oa.value=e),class:"result-collapse"},{default:I(()=>[b(Ke,{name:"result",title:"ğŸ“„ æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"},{default:I(()=>[b(J,{class:"result-section",shadow:"never"},{header:I(()=>[k("div",Fe,[k("span",null,D(Xe.value.isHistory?"ğŸ“„ å†å²åº”ç­”æ–‡ä»¶":"âœ… ç”Ÿæˆç»“æœ"),1),k("div",xe,[b(L,{type:"primary",icon:E(r),onClick:ha},{default:I(()=>[...y[29]||(y[29]=[P(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),b(L,{type:"success",icon:E(n),onClick:wa},{default:I(()=>[...y[30]||(y[30]=[P(" ä¸‹è½½Wordæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),E(Ne)?(g(),F(B,{key:1,type:"success",size:"large"},{default:I(()=>[...y[32]||(y[32]=[P(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(g(),F(L,{key:0,type:"info",icon:E(u),loading:E(qe),onClick:ja},{default:I(()=>[...y[31]||(y[31]=[P(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),b(L,{type:"primary",icon:E(c),onClick:fa},{default:I(()=>[...y[33]||(y[33]=[P(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:I(()=>{var e,a,l,t;return[k("div",Ie,[b(ae,{type:Xe.value.isHistory?"info":"success",title:Xe.value.message,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["type","title"]),b(E(T),{title:"å¤„ç†ç»Ÿè®¡",stats:Xe.value.stats},null,8,["stats"]),(null==(a=null==(e=Xe.value.stats)?void 0:e.qualifications_details)?void 0:a.length)>0?(g(),j("div",ke,[y[36]||(y[36]=k("h4",null,"ğŸ“‹ èµ„è´¨å¤„ç†è¯¦æƒ…",-1)),b(Se,{data:Xe.value.stats.qualifications_details,border:"",stripe:"",style:{"margin-top":"16px"}},{default:I(()=>[b(Pe,{type:"index",label:"#",width:"60",align:"center"}),b(Pe,{prop:"display_title",label:"èµ„è´¨åç§°","min-width":"200"},{default:I(({row:e})=>[k("div",null,[k("strong",null,D(e.display_title),1),"id_card"===e.resource_type?(g(),F(B,{key:0,type:"info",size:"small",style:{"margin-left":"8px"}},{default:I(()=>[...y[34]||(y[34]=[P(" èº«ä»½è¯ ",-1)])]),_:1})):x("",!0)])]),_:1}),b(Pe,{prop:"qual_name",label:"ç±»åˆ«",width:"120",align:"center"},{default:I(({row:e})=>{return[b(B,{type:(a=e.qual_name,{"åŸºæœ¬èµ„è´¨":"danger","ä¿¡ç”¨è¯æ˜":"success","èº«ä»½è¯æ˜":"primary","è´¢åŠ¡æ–‡ä»¶":"warning","ä¿¡æ¯å®‰å…¨":"info","ç”µä¿¡èµ„è´¨":"warning","ITæœåŠ¡":"info","è´¨é‡ç®¡ç†":"success","è½¯ä»¶èƒ½åŠ›":"info","è¡Œä¸šèµ„è´¨":"warning","çŸ¥è¯†äº§æƒ":""}[a]||""),size:"small"},{default:I(()=>[P(D(e.qual_name),1)]),_:2},1032,["type"])];var a}),_:1}),b(Pe,{prop:"total_pages",label:"å›¾ç‰‡æ•°",width:"100",align:"center"},{default:I(({row:e})=>[b(ze,{type:"primary",size:"large"},{default:I(()=>[k("strong",null,D(e.total_pages),1),P(" "+D("id_card"===e.resource_type?"é¢":"é¡µ"),1)]),_:2},1024)]),_:1}),b(Pe,{label:"çŠ¶æ€",width:"80",align:"center"},{default:I(()=>[b(H,{color:"#67c23a",size:20},{default:I(()=>[b(E(i))]),_:1})]),_:1})]),_:1},8,["data"]),(null==(t=null==(l=Xe.value.stats)?void 0:l.missing_qualifications)?void 0:t.length)>0?(g(),F(ae,{key:0,type:"warning",closable:!1,style:{"margin-top":"16px"}},{title:I(()=>[...y[35]||(y[35]=[P(" ä»¥ä¸‹èµ„è´¨æ¨¡æ¿æœ‰å ä½ç¬¦ä½†æœªä¸Šä¼ æ–‡ä»¶ ",-1)])]),default:I(()=>[k("ul",Ve,[(g(!0),j(V,null,C(Xe.value.stats.missing_qualifications,(e,a)=>(g(),j("li",{key:a},D(e.qual_name||e.qual_key),1))),128))])]),_:1})):x("",!0)])):x("",!0),k("div",Ce,[y[37]||(y[37]=k("h4",null,"ç”Ÿæˆæ–‡ä»¶",-1)),b(Be,{column:2,border:""},{default:I(()=>[b(Te,{label:"æ–‡ä»¶å"},{default:I(()=>[P(D(ga(Xe.value.outputFile)),1)]),_:1}),b(Te,{label:"ä¸‹è½½åœ°å€"},{default:I(()=>[b(He,{href:Xe.value.downloadUrl,type:"primary"},{default:I(()=>[P(D(ga(Xe.value.downloadUrl)),1)]),_:1},8,["href"])]),_:1})]),_:1})])])]}),_:1})]),_:1})]),_:1},8,["modelValue"])):x("",!0),Oe.value.projectId?(g(),F(Qe,{key:2,modelValue:na.value,"onUpdate:modelValue":y[10]||(y[10]=e=>na.value=e),class:"history-collapse"},{default:I(()=>[b(Ke,{name:"history"},{title:I(()=>[k("div",Ee,[k("span",null,"ğŸ“‚ æœ¬é¡¹ç›®å†å²æ–‡ä»¶ ("+D(ia.value.length)+")",1),na.value?(g(),F(L,{key:0,type:"primary",size:"small",loading:ra.value,onClick:S(ba,["stop"]),style:{"margin-left":"16px"}},{default:I(()=>[...y[38]||(y[38]=[P(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):x("",!0)])]),default:I(()=>[b(J,{shadow:"never",style:{border:"none"}},{default:I(()=>[z((g(),F(Se,{data:ia.value,border:"",stripe:"","max-height":"400"},{default:I(()=>[b(Pe,{type:"index",label:"åºå·",width:"60"}),b(Pe,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:I(({row:e})=>[k("div",De,[b(H,null,{default:I(()=>[b(E(t))]),_:1}),k("span",null,D(e.filename),1)])]),_:1}),b(Pe,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:I(({row:e})=>[P(D(Fa(e.size)),1)]),_:1}),b(Pe,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:I(({row:e})=>[P(D(xa(e.process_time)),1)]),_:1}),b(Pe,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:I(({row:e})=>[b(L,{type:"primary",size:"small",onClick:a=>{var l;(l=e).file_path?(ta.value=l.file_path,sa.value=l.filename,la.value=!0):d.warning("æ— æ³•è·å–æ–‡ä»¶ä¿¡æ¯")}},{default:I(()=>[...y[39]||(y[39]=[P(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),b(L,{type:"success",size:"small",onClick:a=>(async e=>{try{if(!e.download_url)return void d.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const a=e.filename||"å•†åŠ¡åº”ç­”.docx";$(e.download_url,a),d.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(a){d.error(a.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}})(e)},{default:I(()=>[...y[40]||(y[40]=[P(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[da,ra.value]]),ra.value||0!==ia.value.length?x("",!0):(g(),F(aa,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"])):x("",!0),b(E(R),{modelValue:la.value,"onUpdate:modelValue":y[11]||(y[11]=e=>la.value=e),"file-url":ta.value,"file-name":sa.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-e118b176"]]);export{Pe as default};
