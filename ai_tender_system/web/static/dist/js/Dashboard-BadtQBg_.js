import{p as e,J as a,o as t,_ as i}from"./index.js";import{I as s,E as o}from"./IconButton-DmvMmevf.js";/* empty css               */import"./el-select-Cn9sh8Qz.js";/* empty css                     *//* empty css                             *//* empty css                    *//* empty css                *//* empty css                                                                          */import{u as l}from"./project-CG0CT_fq.js";import{t as r}from"./tender-ZYcn_VXM.js";import{ax as n,am as c,aX as d,aD as p,aA as u,aF as m,aB as f,aG as g,aP as v,aV as _,aW as b,aN as j,aO as h,aR as y,az as w,aS as k,bd as x}from"./editor-6w6Zv5fp.js";import{L as P}from"./Loading-BAlD57pu.js";import{E as C}from"./Empty-B97fjWsB.js";/* empty css                                                                   */import{C as T}from"./Card-LtaOuhzz.js";/* empty css                   *//* empty css                                                                        */import{E as D,a as E}from"./index-ogjNd1Mz.js";import{E as M}from"./index-BXcH_qfF.js";import{E as z,a as S}from"./index-C3xmRrQz.js";import{E as A}from"./index-CH79V0o1.js";import{E as H}from"./index-Cdh5ckaS.js";import"./strings-DTOtcONx.js";import"./toNumber-ue2IRhKK.js";import"./_baseIteratee-BmMFd7Ls.js";import"./index-BWGjdaux.js";import"./flatMap--8Pl3Vlu.js";import"./map-B_GrxJbZ.js";import"./_baseEach-B05miBPS.js";import"./index-DnERDalw.js";import"./raf-B6jWGkGX.js";const I={class:"dashboard-page"},Y={class:"quick-actions"},q=["onClick"],F={class:"action-label"},U={class:"pagination-wrapper"},B=i(n({__name:"Dashboard",setup(i){const n=e(),B=l(),{success:G,error:L,confirm:N}=a(),O=c(!1),R=c(!1),V=c({totalProjects:0,inProgressProjects:0,wonThisMonth:0,pendingTasks:0}),W=c([]),X=c(1),J=c(10),Q=c(0),$=[{name:"start-tender",label:"开始投标",icon:"bi bi-play-circle-fill",color:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",route:"/tender-management"},{name:"business-response",label:"商务应答",icon:"bi bi-briefcase-fill",color:"linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",route:"/business-response"},{name:"point-to-point",label:"点对点应答",icon:"bi bi-arrow-left-right",color:"linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)",route:"/point-to-point"},{name:"tech-proposal",label:"技术方案",icon:"bi bi-file-code-fill",color:"linear-gradient(135deg, #43e97b 0%, #38f9d7 100%)",route:"/tech-proposal"},{name:"tender-scoring",label:"标书评分",icon:"bi bi-star-fill",color:"linear-gradient(135deg, #fa709a 0%, #fee140 100%)",route:"/tender-scoring"},{name:"knowledge",label:"知识中心",icon:"bi bi-book-fill",color:"linear-gradient(135deg, #30cfd0 0%, #330867 100%)",route:"/knowledge/company-library"}];async function K(){R.value=!0;try{const e=await r.getProjects({page:X.value,page_size:J.value});e.success&&e.data&&(Array.isArray(e.data)?(W.value=e.data,Q.value=e.data.length):e.data.items&&(W.value=e.data.items,Q.value=e.data.total||0))}catch(e){L("加载项目列表失败: "+e.message)}finally{R.value=!1}}async function Z(){await K(),G("刷新成功")}function ee(){n.push("/tender-management")}function ae(e){B.setCurrentProject(e),n.push({name:"TenderManagementDetail",params:{id:e.id}})}function te(e){J.value=e,X.value=1,K()}function ie(e){X.value=e,K()}function se(e){return{pending:"待处理",in_progress:"进行中",completed:"已完成",won:"已中标",lost:"未中标",archived:"已归档"}[e]||e}return d(()=>{!async function(){O.value=!0;try{const e=await r.getDashboardStatistics();e.success&&e.data&&(V.value={totalProjects:e.data.totalProjects,inProgressProjects:e.data.inProgressProjects,wonThisMonth:e.data.wonThisMonth,pendingTasks:e.data.pendingTasks})}catch(e){L("加载统计数据失败: "+e.message)}finally{O.value=!1}}(),K()}),(e,a)=>{const i=M,l=D,r=E,c=t,d=A,oe=S,le=H,re=z,ne=o;return u(),p("div",I,[m(r,{gutter:16,class:"kpi-cards"},{default:f(()=>[m(l,{xs:12,sm:12,md:6,lg:6},{default:f(()=>[m(g(T),{shadow:"hover",loading:O.value},{default:f(()=>[m(i,{title:"总项目数",value:V.value.totalProjects},{prefix:f(()=>[...a[2]||(a[2]=[v("i",{class:"bi bi-folder-fill statistic-icon",style:{color:"#409eff"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),m(l,{xs:12,sm:12,md:6,lg:6},{default:f(()=>[m(g(T),{shadow:"hover",loading:O.value},{default:f(()=>[m(i,{title:"进行中项目",value:V.value.inProgressProjects},{prefix:f(()=>[...a[3]||(a[3]=[v("i",{class:"bi bi-clock-fill statistic-icon",style:{color:"#e6a23c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),m(l,{xs:12,sm:12,md:6,lg:6},{default:f(()=>[m(g(T),{shadow:"hover",loading:O.value},{default:f(()=>[m(i,{title:"本月中标",value:V.value.wonThisMonth},{prefix:f(()=>[...a[4]||(a[4]=[v("i",{class:"bi bi-trophy-fill statistic-icon",style:{color:"#67c23a"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1}),m(l,{xs:12,sm:12,md:6,lg:6},{default:f(()=>[m(g(T),{shadow:"hover",loading:O.value},{default:f(()=>[m(i,{title:"待处理任务",value:V.value.pendingTasks},{prefix:f(()=>[...a[5]||(a[5]=[v("i",{class:"bi bi-list-task statistic-icon",style:{color:"#f56c6c"}},null,-1)])]),_:1},8,["value"])]),_:1},8,["loading"])]),_:1})]),_:1}),m(g(T),{title:"快捷入口",class:"quick-actions-card"},{default:f(()=>[v("div",Y,[(u(),p(_,null,b($,e=>v("div",{key:e.name,class:"action-item",onClick:a=>function(e){n.push(e.route)}(e)},[v("div",{class:"action-icon",style:j({background:e.color})},[v("i",{class:h(e.icon)},null,2)],4),v("div",F,y(e.label),1)],8,q)),64))])]),_:1}),m(g(T),{title:"进行中的项目",class:"projects-card"},{actions:f(()=>[m(g(s),{icon:"bi-arrow-clockwise",tooltip:"刷新",onClick:Z})]),default:f(()=>[R.value?(u(),w(g(P),{key:0,visible:!0,fullscreen:!1,text:"加载项目列表..."})):0===W.value.length?(u(),w(g(C),{key:1,type:"no-data",description:"暂无进行中的项目"},{action:f(()=>[m(c,{type:"primary",onClick:ee},{default:f(()=>[...a[6]||(a[6]=[k("创建第一个项目",-1)])]),_:1})]),_:1})):(u(),p(_,{key:2},[m(re,{data:W.value,stripe:"",style:{width:"100%"}},{default:f(()=>[m(oe,{prop:"project_name",label:"项目名称","min-width":"200"},{default:f(({row:e})=>[m(d,{type:"primary",onClick:a=>ae(e)},{default:f(()=>[k(y(e.project_name),1)]),_:2},1032,["onClick"])]),_:1}),m(oe,{prop:"project_number",label:"项目编号",width:"150"}),m(oe,{prop:"status",label:"状态",width:"120"},{default:f(({row:e})=>{return[m(le,{type:(a=e.status,{pending:"info",in_progress:"warning",completed:"success",won:"success",lost:"danger",archived:"info"}[a]||"info")},{default:f(()=>[k(y(se(e.status)),1)]),_:2},1032,["type"])];var a}),_:1}),m(oe,{prop:"company_name",label:"关联企业",width:"200"}),m(oe,{prop:"created_at",label:"创建时间",width:"180"},{default:f(({row:e})=>{return[k(y((a=e.created_at,a?x(a).format("YYYY-MM-DD HH:mm"):"-")),1)];var a}),_:1}),m(oe,{label:"操作",width:"200",fixed:"right"},{default:f(({row:e})=>[m(g(s),{icon:"bi-eye",type:"primary",tooltip:"查看详情",onClick:a=>ae(e)},null,8,["onClick"]),m(g(s),{icon:"bi-play-circle",type:"success",tooltip:"继续处理",onClick:a=>{return t=e,B.setCurrentProject(t),void n.push({name:"TenderManagementDetail",params:{id:t.id}});var t}},null,8,["onClick"]),m(g(s),{icon:"bi-archive",type:"warning",tooltip:"归档",onClick:a=>async function(e){if(await N(`确定要归档项目"${e.project_name}"吗?`,"归档项目","归档后项目将不再显示在进行中列表"))try{await B.updateProject(e.id,{status:"archived"}),G("项目已归档"),await K()}catch(a){L("归档失败: "+a.message)}}(e)},null,8,["onClick"])]),_:1})]),_:1},8,["data"]),v("div",U,[m(ne,{"current-page":X.value,"onUpdate:currentPage":a[0]||(a[0]=e=>X.value=e),"page-size":J.value,"onUpdate:pageSize":a[1]||(a[1]=e=>J.value=e),total:Q.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:te,onCurrentChange:ie},null,8,["current-page","page-size","total"])])],64))]),_:1})])}}}),[["__scopeId","data-v-6925dc07"]]);export{B as default};
