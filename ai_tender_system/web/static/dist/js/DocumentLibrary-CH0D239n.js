import{P as e,C as a,E as t}from"./IconButton.vue_vue_type_style_index_0_scoped_628ec5f8_lang-u6gZwdjM.js";import{d as o,R as s,r as l,n as u,c as i,o as r,g as n,v as c,i as d,S as p,w as f,e as m,t as v,x as g,l as _,y,a as x,O as b}from"./index.js";import{_ as h}from"./_plugin-vue_export-helper-BCo6x5W8.js";const w={class:"upload-button"},B={key:1,class:"upload-drag-area"},k={class:"drag-text"},z={class:"drag-hint"},S={class:"upload-tip"},I={key:0,class:"upload-progress"},$=h(o({__name:"UploadButton",props:{action:{default:"/api/upload"},headers:{default:()=>({})},data:{default:()=>({})},multiple:{type:Boolean,default:!1},accept:{default:"*"},limit:{default:1},maxSize:{default:100},buttonText:{default:"上传文件"},buttonType:{default:"primary"},buttonIcon:{default:s},tip:{default:""},showFileList:{type:Boolean,default:!0},showProgress:{type:Boolean,default:!0},drag:{type:Boolean,default:!1},autoUpload:{type:Boolean,default:!0}},emits:["success","error","progress","remove","exceed"],setup(e,{expose:a,emit:t}){const o=e,s=t,x=l(),b=l([]),h=l(!1),$=l(0),T=u(()=>{if(o.tip)return o.tip;const e=[];return o.accept&&"*"!==o.accept&&e.push(`支持${o.accept}格式`),o.maxSize&&e.push(`大小不超过${o.maxSize}MB`),e.join("，")});function j(e){if(o.maxSize){if(!(e.size/1024/1024<o.maxSize))return y.error(`文件大小不能超过 ${o.maxSize}MB!`),!1}if(o.accept&&"*"!==o.accept){const a=o.accept.split(",").map(e=>e.trim()),t=e.name.substring(e.name.lastIndexOf("."));if(!a.some(a=>a===t||a===e.type))return y.error(`只支持 ${o.accept} 格式的文件！`),!1}return h.value=!0,$.value=0,!0}function F(e,a){h.value=!1,$.value=100,setTimeout(()=>{$.value=0},1e3),y.success("上传成功"),s("success",e,a)}function U(e,a){h.value=!1,$.value=0,y.error("上传失败: "+e.message),s("error",e,a)}function L(e,a){$.value=Math.round(e.percent),s("progress",e,a)}function M(e){y.warning(`最多只能上传 ${o.limit} 个文件！`),s("exceed",e)}function P(e){s("remove",e)}return a({clearFiles:function(){var e;null==(e=x.value)||e.clearFiles()},submit:function(){var e;null==(e=x.value)||e.submit()}}),(a,t)=>{const o=d("el-button"),s=d("el-upload"),l=d("el-progress");return r(),i("div",w,[n(s,{ref_key:"uploadRef",ref:x,action:e.action,headers:e.headers,data:e.data,multiple:e.multiple,accept:e.accept,limit:e.limit,"file-list":b.value,"before-upload":j,"on-success":F,"on-error":U,"on-progress":L,"on-exceed":M,"on-remove":P,"show-file-list":e.showFileList,drag:e.drag,"auto-upload":e.autoUpload},p({default:f(()=>[e.drag?(r(),i("div",B,[t[1]||(t[1]=m("i",{class:"bi bi-cloud-upload drag-icon"},null,-1)),m("div",k,[t[0]||(t[0]=m("p",{class:"drag-title"},[_("拖拽文件到此处或"),m("em",null,"点击上传")],-1)),m("p",z,v(T.value),1)])])):(r(),g(o,{key:0,type:e.buttonType,icon:e.buttonIcon,loading:h.value},{default:f(()=>[_(v(e.buttonText),1)]),_:1},8,["type","icon","loading"]))]),_:2},[e.tip&&!e.drag?{name:"tip",fn:f(()=>[m("div",S,v(e.tip),1)]),key:"0"}:void 0]),1032,["action","headers","data","multiple","accept","limit","file-list","show-file-list","drag","auto-upload"]),e.showProgress&&$.value>0&&$.value<100?(r(),i("div",I,[n(l,{percentage:$.value,"stroke-width":6},null,8,["percentage"])])):c("",!0)])}}}),[["__scopeId","data-v-7e6c62a3"]]),T={class:"document-library"},j=h(o({__name:"DocumentLibrary",setup(o){const{success:s}=x(),l=e=>{s("上传文档",`已选择文件: ${e.name}`)};return(o,s)=>{const u=d("el-button");return r(),i("div",T,[n(b(e),{title:"文档库",description:"管理企业知识文档"},{actions:f(()=>[n(b($),{"auto-upload":!1,accept:".pdf,.doc,.docx",onChange:l},{default:f(()=>[n(u,{type:"primary",icon:"Upload"},{default:f(()=>[...s[0]||(s[0]=[_("上传文档",-1)])]),_:1})]),_:1})]),_:1}),n(b(a),{title:"文档列表"},{default:f(()=>[n(b(t),{type:"no-data",description:"暂无文档数据"})]),_:1})])}}}),[["__scopeId","data-v-affe32a7"]]);export{j as default};
