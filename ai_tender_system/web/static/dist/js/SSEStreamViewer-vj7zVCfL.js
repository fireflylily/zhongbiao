import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";/* empty css                */import{d as t,r as a,x as n,A as s,c as o,o as r,I as c,g as i,a0 as l,w as d,e as u,H as p,F as m,aS as y,B as _,l as f,b5 as g,k as v,b6 as k,aT as w,aU as S,aA as b,W as h}from"./index.js";import{k as x}from"./DocumentUploader.vue_vue_type_style_index_0_scoped_1530a3ce_lang-kpO4p46J.js";import{E as j}from"./index-C4gi5RAB.js";const C=["innerHTML"],L={key:0,class:"streaming-indicator"},R={key:0,class:"stream-actions"},U=e(t({__name:"SSEStreamViewer",props:{content:{},isStreaming:{type:Boolean,default:!1},enableMarkdown:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0}},emits:["stop","regenerate"],setup(e,{emit:t}){const U=e,B=t,T=a(null),H=n(()=>{if(!U.content)return"";if(U.enableMarkdown)try{return x.parse(U.content)}catch(e){return U.content}return U.content.replace(/\n/g,"<br>")});s(()=>U.content,async()=>{U.autoScroll&&U.isStreaming&&(await h(),M())});const M=()=>{T.value&&(T.value.scrollTop=T.value.scrollHeight)},E=async()=>{try{await navigator.clipboard.writeText(U.content),b.success("内容已复制到剪贴板")}catch(e){b.error("复制失败，请手动复制")}},A=()=>{try{const e=new Blob([U.content],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(e),a=document.createElement("a");a.href=t,a.download=`ai-content-${Date.now()}.txt`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t),b.success("文档下载成功")}catch(e){b.error("下载失败，请重试")}};return(t,a)=>{const n=p,s=j,b=f;return r(),o("div",{class:c(["sse-stream-viewer",{"is-loading":e.isStreaming}])},[i(s,{class:"stream-content",shadow:"never"},{default:d(()=>[u("div",{ref_key:"contentRef",ref:T,class:"content-wrapper",innerHTML:H.value},null,8,C),e.isStreaming?(r(),o("div",L,[i(n,{class:"is-loading"},{default:d(()=>[i(m(y))]),_:1}),a[2]||(a[2]=u("span",null,"正在生成中...",-1))])):l("",!0)]),_:1}),e.content?(r(),o("div",R,[e.isStreaming?(r(),_(b,{key:0,type:"warning",icon:m(g),onClick:a[0]||(a[0]=e=>B("stop"))},{default:d(()=>[...a[3]||(a[3]=[v(" 停止生成 ",-1)])]),_:1},8,["icon"])):(r(),_(b,{key:1,type:"primary",icon:m(k),onClick:E},{default:d(()=>[...a[4]||(a[4]=[v(" 复制内容 ",-1)])]),_:1},8,["icon"])),!e.isStreaming&&e.content?(r(),_(b,{key:2,type:"success",icon:m(w),onClick:A},{default:d(()=>[...a[5]||(a[5]=[v(" 下载文档 ",-1)])]),_:1},8,["icon"])):l("",!0),!e.isStreaming&&e.content?(r(),_(b,{key:3,icon:m(S),onClick:a[1]||(a[1]=e=>B("regenerate"))},{default:d(()=>[...a[6]||(a[6]=[v(" 重新生成 ",-1)])]),_:1},8,["icon"])):l("",!0)])):l("",!0)],2)}}}),[["__scopeId","data-v-cba4d568"]]);export{U as S};
