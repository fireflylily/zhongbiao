import{k as e,e as a,t as l,v as t,bD as s,q as r,d as u,al as c,p as i,E as o,i as n,O as d,y as v,D as p,a3 as _,G as m}from"./index.js";/* empty css                                                        *//* empty css                             *//* empty css                    *//* empty css                     *//* empty css               *//* empty css                */import{E as f}from"./el-tree-NCdIeeOl.js";import"./el-text-CWjtNXXZ.js";import{E as h}from"./el-divider-7N2ILQuJ.js";/* empty css                                                                            *//* empty css                */import{C as y}from"./Card-Cv-82T4J.js";import{am as g,ao as k,cb as b,au as x,ar as w,aw as z,av as j,aB as C,aC as F,aq as V,as as $,ax as L,ay as R,az as T,aA as I,aS as A,an as S,aD as E,aW as G}from"./editor-TazJhAAN.js";import{_ as D}from"./DocumentPreview.vue_vue_type_script_setup_true_lang-De9yPCsp.js";/* empty css                   *//* empty css                */import{E as M}from"./strings-X7bymAdO.js";import{E as W}from"./index-IM9EhOrM.js";import{E as P,a as U}from"./el-select-OYnihe3P.js";import{E as B}from"./index-BIDBuuPD.js";import{E as q}from"./index-U-yLLGnn.js";import{E as H,a as N}from"./index-BPxxUWPk.js";import{E as O,a as Q}from"./index-CEGNKDhc.js";import"./index-CiR3ZaRO.js";import"./index-DYIGgvz_.js";import"./directive-BiPnxfY9.js";import"./index-ChK61zXh.js";import"./toNumber-C9XTs0cM.js";import"./_baseIteratee-DK-XCWub.js";import"./index-ByYpZ62U.js";import"./cloneDeep-syPWYH98.js";import"./flatMap-B556EPsX.js";import"./map-DlvCx75E.js";import"./_baseEach-uBBvXMMp.js";import"./raf-BZHcGSIv.js";const Y={uploadDocument:function(a){const l=new FormData;return l.append("file",a),e.post("/parser-debug/upload",l,{headers:{"Content-Type":"multipart/form-data"},timeout:3e5})},getTestResult:function(a){return e.get(`/parser-debug/${a}`)},saveGroundTruth:function(a,l,t="user"){return e.post(`/parser-debug/${a}/ground-truth`,{chapters:l,annotator:t})},getHistory:function(a){return e.get("/parser-debug/history",{params:a})},deleteTest:function(a){return e.delete(`/parser-debug/${a}/delete`)},exportReport:function(a){return e.get(`/parser-debug/export/${a}`,{responseType:"blob"})},parseSingleMethod:function(a,l){return e.post(`/parser-debug/parse-single/${a}/${l}`,{},{timeout:3e5})},parseSmart:function(a,l){return e.post(`/parser-debug/parse-smart/${a}`,l||{classify:!0},{timeout:3e5})},getPreviewInfo:function(a){return e.get(`/parser-debug/preview/${a}`)}},J={class:"chapter-title"},K={class:"chapter-info"},X={class:"word-count"},Z={key:0,class:"children"},ee=r(g({__name:"ChapterTreeItem",props:{chapter:{},groundTruth:{},level:{}},setup(e){const r=e,u=k(()=>{if(!r.groundTruth)return"unknown";const e=a=>{const l=[];for(const t of a)l.push(t),t.children&&t.children.length>0&&l.push(...e(t.children));return l},a=e(r.groundTruth),l=e=>e.replace(/^\d+\.\s*/,"").replace(/^\d+\.\d+\s*/,"").replace(/^ç¬¬[ä¸€äºŒä¸‰å››äº”å…­ä¸ƒå…«ä¹å\d]+[ç« èŠ‚éƒ¨åˆ†]\s*/,"").replace(/\s+/g,"").toLowerCase(),t=l(r.chapter.title);return a.some(e=>l(e.title)===t)?"matched":"false_positive"}),c=k(()=>({"status-matched":"matched"===u.value,"status-false-positive":"false_positive"===u.value,"status-unknown":"unknown"===u.value}));return(r,i)=>{const o=a,n=b("ChapterTreeItem",!0);return w(),x("div",{class:"chapter-tree-item",style:A({paddingLeft:20*e.level+"px"})},[z("div",{class:C(["chapter-row",c.value])},[z("span",{class:C(["level-badge",`level-${e.chapter.level}`])}," L"+F(e.chapter.level),3),z("span",J,F(e.chapter.title),1),z("span",K,[z("span",X,F(e.chapter.word_count)+"å­—",1),"matched"===u.value?(w(),V(o,{key:0,class:"match-icon success"},{default:$(()=>[L(R(l))]),_:1})):"missed"===u.value?(w(),V(o,{key:1,class:"match-icon error"},{default:$(()=>[L(R(t))]),_:1})):"false_positive"===u.value?(w(),V(o,{key:2,class:"match-icon warning"},{default:$(()=>[L(R(s))]),_:1})):j("",!0)])],2),e.chapter.children&&e.chapter.children.length>0?(w(),x("div",Z,[(w(!0),x(T,null,I(e.chapter.children,a=>(w(),V(n,{key:a.id,chapter:a,"ground-truth":e.groundTruth,level:e.level+1},null,8,["chapter","ground-truth","level"]))),128))])):j("",!0)],4)}}}),[["__scopeId","data-v-3e35c8e3"]]),ae={class:"card-header"},le={class:"card-body"},te={key:0,class:"start-parse-section"},se={key:1,class:"loading-section"},re={class:"statistics"},ue={class:"stat-item"},ce={class:"value"},ie={class:"stat-item"},oe={class:"value"},ne={class:"stat-item"},de={class:"value"},ve={key:0,class:"stat-item"},pe={class:"chapter-list"},_e={class:"chapter-list-header"},me={key:0,class:"error-message"},fe=r(g({__name:"MethodCard",props:{title:{},result:{},groundTruth:{},accuracy:{},color:{default:"#409EFF"},status:{default:"idle"}},emits:["start"],setup(e,{emit:l}){const t=e,s=l,r=S(!1),n=k(()=>"idle"===t.status?"info":"parsing"===t.status?"warning":"error"!==t.status&&t.result.success?t.accuracy?t.accuracy.f1_score>=.9?"success":t.accuracy.f1_score>=.7?"":t.accuracy.f1_score>=.5?"warning":"danger":"success":"danger"),d=k(()=>"idle"===t.status?"æœªå¼€å§‹":"parsing"===t.status?"è§£æžä¸­...":"error"===t.status?"å¤±è´¥":t.result.success?t.accuracy?`F1: ${(100*t.accuracy.f1_score).toFixed(1)}%`:"æˆåŠŸ":"å¤±è´¥"),v=()=>{s("start")},p=()=>{r.value=!r.value};return(l,t)=>{const s=M,_=u,m=a,f=o,h=W;return w(),V(h,{class:"method-card","body-style":{padding:"0"}},{header:$(()=>[z("div",ae,[z("span",{class:"method-title",style:A({color:e.color})},F(e.title),5),L(s,{type:n.value,size:"small"},{default:$(()=>[E(F(d.value),1)]),_:1},8,["type"])])]),default:$(()=>{var a,l,s,u,o;return[z("div",le,["idle"===e.status?(w(),x("div",te,[L(_,{type:"primary",onClick:v,icon:R(c)},{default:$(()=>[...t[0]||(t[0]=[E(" å¼€å§‹è§£æž ",-1)])]),_:1},8,["icon"]),t[1]||(t[1]=z("p",{class:"hint-text"},"ç‚¹å‡»æŒ‰é’®å¼€å§‹è¿è¡Œæ­¤æ–¹æ³•",-1))])):"parsing"===e.status?(w(),x("div",se,[L(m,{class:"is-loading",size:32},{default:$(()=>[L(R(i))]),_:1}),t[2]||(t[2]=z("p",null,"è§£æžä¸­ï¼Œè¯·ç¨å€™...",-1))])):(w(),x(T,{key:2},[z("div",re,[z("div",ue,[t[3]||(t[3]=z("span",{class:"label"},"è¯†åˆ«ç« èŠ‚:",-1)),z("span",ce,F((null==(a=e.result.chapters)?void 0:a.length)||0),1)]),z("div",ie,[t[4]||(t[4]=z("span",{class:"label"},"æ€»å­—æ•°:",-1)),z("span",oe,F((o=(null==(l=e.result.statistics)?void 0:l.total_words)||0,o>=1e4?`${(o/1e4).toFixed(1)}ä¸‡`:o.toString())),1)]),z("div",ne,[t[5]||(t[5]=z("span",{class:"label"},"è€—æ—¶:",-1)),z("span",de,F((null==(s=e.result.performance)?void 0:s.elapsed_formatted)||"-"),1)]),e.accuracy?(w(),x("div",ve,[t[6]||(t[6]=z("span",{class:"label"},"F1åˆ†æ•°:",-1)),z("span",{class:C(["value f1-score",(u=e.accuracy.f1_score,u>=.9?"excellent":u>=.7?"good":u>=.5?"fair":"poor")])},F((100*e.accuracy.f1_score).toFixed(1))+"% ",3)])):j("",!0)]),z("div",pe,[z("div",_e,[t[7]||(t[7]=z("span",null,"ç« èŠ‚åˆ—è¡¨",-1)),L(_,{size:"small",text:"",onClick:p},{default:$(()=>[E(F(r.value?"æ”¶èµ·":"å±•å¼€å…¨éƒ¨"),1)]),_:1})]),e.result.success?(w(),x("div",{key:1,class:C(["chapters-container",{collapsed:!r.value}])},[(w(!0),x(T,null,I(e.result.chapters,a=>(w(),V(ee,{key:a.id,chapter:a,"ground-truth":e.groundTruth,level:0},null,8,["chapter","ground-truth"]))),128))],2)):(w(),x("div",me,[L(f,{title:e.result.error||"è§£æžå¤±è´¥",type:"error",closable:!1},null,8,["title"])]))])],64))])]}),_:1})}}}),[["__scopeId","data-v-a93d47bb"]]),he={class:"card-header"},ye={key:1,class:"action-buttons"},ge={class:"card-body"},ke={key:0,class:"empty-state"},be={key:1,class:"editing-area"},xe={class:"template-selector mb-3"},we={class:"editable-list"},ze={key:2,class:"display-area"},je={class:"chapter-count"},Ce={class:"chapters-container"},Fe=r(g({__name:"GroundTruthCard",props:{modelValue:{},documentId:{},availableResults:{}},emits:["update:modelValue","save"],setup(e,{emit:a}){const l=e,t=a,s=S(!1),r=S([]),c=S(""),i=()=>{s.value=!0,l.modelValue?r.value=f(l.modelValue):r.value=[]},v=()=>{s.value=!1,r.value=[],c.value=""},p=()=>{if(0===r.value.length)return void n.warning("è¯·è‡³å°‘æ·»åŠ ä¸€ä¸ªç« èŠ‚");const e=r.value.map((e,a)=>({id:`gt_${a}`,level:e.level,title:e.title,para_start_idx:0,para_end_idx:0,word_count:0,preview_text:"",auto_selected:!1,skip_recommended:!1,children:[]}));t("update:modelValue",e),t("save",e),s.value=!1},_=e=>{if("manual"===e)return void(r.value=[]);if(!l.availableResults||!l.availableResults[e])return void n.warning("è¯¥æ–¹æ³•çš„ç»“æžœä¸å¯ç”¨");const a=l.availableResults[e];a.success&&a.chapters?(r.value=f(a.chapters),n.success(`å·²åŠ è½½${a.method_name}çš„ç»“æžœ`)):n.error("è¯¥æ–¹æ³•è§£æžå¤±è´¥")},m=()=>{r.value.push({title:"",level:1})},f=e=>{const a=[],l=e=>{for(const t of e)a.push({title:t.title,level:t.level}),t.children&&t.children.length>0&&l(t.children)};return l(e),a},h=e=>{if(!e)return 0;let a=0;const l=e=>{for(const t of e)a++,t.children&&t.children.length>0&&l(t.children)};return l(e),a};return(a,l)=>{const t=u,n=B,f=o,y=U,g=P,k=d,b=W;return w(),V(b,{class:"ground-truth-card"},{header:$(()=>[z("div",he,[l[3]||(l[3]=z("span",{class:"title"},"âœ… æ­£ç¡®ç­”æ¡ˆï¼ˆäººå·¥æ ‡æ³¨ï¼‰",-1)),s.value?(w(),x("div",ye,[L(t,{size:"small",onClick:v},{default:$(()=>[...l[1]||(l[1]=[E("å–æ¶ˆ",-1)])]),_:1}),L(t,{size:"small",type:"success",onClick:p},{default:$(()=>[...l[2]||(l[2]=[E("ä¿å­˜",-1)])]),_:1})])):(w(),V(t,{key:0,size:"small",type:"primary",onClick:i},{default:$(()=>[E(F(e.modelValue?"ç¼–è¾‘æ ‡æ³¨":"å¼€å§‹æ ‡æ³¨"),1)]),_:1}))])]),default:$(()=>[z("div",ge,[e.modelValue||s.value?s.value?(w(),x("div",be,[L(f,{title:"æ ‡æ³¨è¯´æ˜Ž",type:"info",closable:!1,class:"mb-3"},{default:$(()=>[...l[5]||(l[5]=[z("p",null,"è¯·ä»Žå·¦ä¾§é€‰æ‹©ä¸€ä¸ªæ–¹æ³•çš„ç»“æžœä½œä¸ºåŸºç¡€ï¼Œç„¶åŽè°ƒæ•´ç« èŠ‚åˆ—è¡¨ã€‚",-1),z("p",null,"æ‚¨ä¹Ÿå¯ä»¥æ‰‹åŠ¨æ·»åŠ ã€åˆ é™¤æˆ–ä¿®æ”¹ç« èŠ‚ã€‚",-1)])]),_:1}),z("div",xe,[l[6]||(l[6]=z("span",null,"åŸºäºŽæ–¹æ³•ç»“æžœ:",-1)),L(g,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=e=>c.value=e),placeholder:"é€‰æ‹©æ–¹æ³•",onChange:_},{default:$(()=>{var a,l,t,s,r,u,c,i,o,n;return[(null==(l=null==(a=e.availableResults)?void 0:a.gemini)?void 0:l.success)?(w(),V(y,{key:0,label:"Gemini AIè§£æžå™¨",value:"gemini"})):j("",!0),(null==(s=null==(t=e.availableResults)?void 0:t.docx_native)?void 0:s.success)?(w(),V(y,{key:1,label:"Wordå¤§çº²çº§åˆ«è¯†åˆ«",value:"docx_native"})):j("",!0),(null==(u=null==(r=e.availableResults)?void 0:r.toc_exact)?void 0:u.success)?(w(),V(y,{key:2,label:"ç²¾ç¡®åŒ¹é…(åŸºäºŽç›®å½•)",value:"toc_exact"})):j("",!0),(null==(i=null==(c=e.availableResults)?void 0:c.azure)?void 0:i.success)?(w(),V(y,{key:3,label:"Azure Form Recognizer",value:"azure"})):j("",!0),(null==(n=null==(o=e.availableResults)?void 0:o.llm_level)?void 0:n.success)?(w(),V(y,{key:4,label:"LLMæ™ºèƒ½å±‚çº§åˆ†æž",value:"llm_level"})):j("",!0),L(y,{label:"æ‰‹åŠ¨åˆ›å»º",value:"manual"})]}),_:1},8,["modelValue"])]),z("div",we,[L(t,{size:"small",onClick:m,class:"mb-2"},{default:$(()=>[...l[7]||(l[7]=[E(" + æ·»åŠ ç« èŠ‚ ",-1)])]),_:1}),(w(!0),x(T,null,I(r.value,(e,a)=>(w(),x("div",{key:a,class:"editable-chapter"},[L(k,{modelValue:e.title,"onUpdate:modelValue":a=>e.title=a,placeholder:"ç« èŠ‚æ ‡é¢˜",size:"small"},{prepend:$(()=>[L(g,{modelValue:e.level,"onUpdate:modelValue":a=>e.level=a,style:{width:"80px"},size:"small"},{default:$(()=>[L(y,{label:"L1",value:1}),L(y,{label:"L2",value:2}),L(y,{label:"L3",value:3})]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["modelValue","onUpdate:modelValue"]),L(t,{size:"small",type:"danger",text:"",onClick:e=>(e=>{r.value.splice(e,1)})(a)},{default:$(()=>[...l[8]||(l[8]=[E(" åˆ é™¤ ",-1)])]),_:1},8,["onClick"])]))),128))])])):(w(),x("div",ze,[z("div",je," å…± "+F(h(e.modelValue))+" ä¸ªç« èŠ‚ ",1),z("div",Ce,[(w(!0),x(T,null,I(e.modelValue,e=>(w(),V(ee,{key:e.id,chapter:e,level:0},null,8,["chapter"]))),128))])])):(w(),x("div",ke,[L(n,{description:"å°šæœªæ ‡æ³¨æ­£ç¡®ç­”æ¡ˆ"},{default:$(()=>[L(t,{type:"primary",onClick:i},{default:$(()=>[...l[4]||(l[4]=[E("å¼€å§‹æ ‡æ³¨",-1)])]),_:1})]),_:1})]))])]),_:1})}}}),[["__scopeId","data-v-1442b13a"]]),Ve={class:"parser-comparison"},$e={class:"upload-section"},Le={key:0,class:"selected-file"},Re={key:0,class:"smart-result-section"},Te={class:"smart-result-header"},Ie={class:"method-info"},Ae={class:"elapsed"},Se={key:0,class:"key-sections"},Ee={class:"section-tags"},Ge={key:0,class:"section-item"},De={key:1,class:"section-item"},Me={key:2,class:"section-item"},We={class:"chapters-tree"},Pe={class:"chapter-node"},Ue={class:"chapter-title"},Be={key:1,class:"doc-info"},qe={key:2,class:"comparison-grid"},He={key:3,class:"accuracy-section"},Ne={class:"best-method-summary"},Oe={class:"history-section"},Qe={class:"section-header"},Ye={key:0},Je={key:1,class:"text-muted"},Ke={key:1,class:"chapter-count"},Xe={key:3,class:"text-muted"},Ze={key:1,class:"chapter-count"},ea={key:3,class:"text-muted"},aa={key:1,class:"chapter-count"},la={key:3,class:"text-muted"},ta={key:1,class:"chapter-count"},sa={key:3,class:"text-muted"},ra={key:1,class:"chapter-count"},ua={key:3,class:"text-muted"},ca={key:0},ia={style:{"font-size":"12px","margin-top":"4px",color:"#606266"}},oa={key:1,class:"text-muted"},na={key:0,class:"empty-state"},da=r(g({__name:"ParserComparison",setup(e){const l=S(),t=S(null),s=S(!1),r=S(!1),c=S(!1),i=S(""),d=S(""),g=S(""),b=S(null),A=S(null),P=S(null),U=S(null),J=S(null),K=S(!1),X=S([]),Z=S({gemini:"idle",docx_native:"idle",toc_exact:"idle",azure:"idle",llm_level:"idle"}),ee=e=>{t.value=e.raw},ae=async()=>{var e,a;if(t.value){s.value=!0;try{const e=await Y.uploadDocument(t.value),a=e.data||e;if(!a||!a.success)return n.error((null==a?void 0:a.error)||"æ–‡ä»¶ä¸Šä¼ å¤±è´¥"),void(s.value=!1);g.value=a.document_id,b.value=a.document_info,A.value={toc_exact:{success:!1,chapters:[],method_name:"ç²¾ç¡®åŒ¹é…(åŸºäºŽç›®å½•)",performance:{elapsed:0,elapsed_formatted:"-"}},azure:{success:!1,chapters:[],method_name:"Azure Form Recognizer",performance:{elapsed:0,elapsed_formatted:"-"}},docx_native:{success:!1,chapters:[],method_name:"Wordå¤§çº²çº§åˆ«è¯†åˆ«",performance:{elapsed:0,elapsed_formatted:"-"}},gemini:{success:!1,chapters:[],method_name:"Gemini AIè§£æžå™¨",performance:{elapsed:0,elapsed_formatted:"-"}},llm_level:{success:!1,chapters:[],method_name:"LLMæ™ºèƒ½å±‚çº§åˆ†æž",performance:{elapsed:0,elapsed_formatted:"-"}}},Z.value={gemini:"idle",docx_native:"idle",toc_exact:"idle",azure:"idle",llm_level:"idle"},P.value=null,U.value=null,n.success('æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼è¯·ç‚¹å‡»å„æ–¹æ³•çš„"å¼€å§‹è§£æž"æŒ‰é’®'),s.value=!1}catch(l){n.error((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.error)||l.message||"ä¸Šä¼ å¤±è´¥"),s.value=!1}}else n.warning("è¯·å…ˆé€‰æ‹©æ–‡ä»¶")},le=async()=>{var e,a;if(g.value){r.value=!0,J.value=null;try{const e=await Y.parseSmart(g.value,{classify:!0}),a=e.data||e;a.success&&a.result?(J.value=a.result,n.success(`æ™ºèƒ½è§£æžå®Œæˆï¼ä½¿ç”¨æ–¹æ³•: ${a.result.method_used}`)):n.error(`æ™ºèƒ½è§£æžå¤±è´¥: ${a.error||"æœªçŸ¥é”™è¯¯"}`)}catch(l){n.error((null==(a=null==(e=l.response)?void 0:e.data)?void 0:a.error)||l.message||"æ™ºèƒ½è§£æžå¤±è´¥")}finally{r.value=!1}}else n.error("è¯·å…ˆä¸Šä¼ æ–‡ä»¶")},te=async()=>{var e,a,l;if(g.value)try{const a=await Y.getPreviewInfo(g.value),l=a.data||a;l.success?(i.value=l.file_path,d.value=l.filename||(null==(e=b.value)?void 0:e.filename)||"æ–‡æ¡£é¢„è§ˆ",c.value=!0):n.error(l.error||"èŽ·å–æ–‡æ¡£ä¿¡æ¯å¤±è´¥")}catch(t){n.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||t.message||"èŽ·å–æ–‡æ¡£é¢„è§ˆä¿¡æ¯å¤±è´¥")}else n.error("è¯·å…ˆä¸Šä¼ æ–‡ä»¶")},se=k(()=>{var e;if(!(null==(e=J.value)?void 0:e.chapters))return[];const a=e=>e.map(e=>({...e,label:e.title,children:e.children?a(e.children):[]}));return a(J.value.chapters)}),re=e=>({invitation:"æŠ•æ ‡é‚€è¯·",bidder_notice:"æŠ•æ ‡äººé¡»çŸ¥",evaluation:"è¯„æ ‡åŠžæ³•",contract_terms:"åˆåŒæ¡æ¬¾",contract_content:"åˆåŒå†…å®¹",business_response:"å•†åŠ¡åº”ç­”",technical_spec:"æŠ€æœ¯è§„èŒƒ",appendix:"é™„ä»¶",other:"å…¶ä»–"}[e]||e),ue=async e=>{var a,l;if(g.value){Z.value[e]="parsing";try{const a=await Y.parseSingleMethod(g.value,e),l=a.data||a;l.success&&l.result?(A.value&&(A.value[e]=l.result),Z.value[e]=l.result.success?"success":"error",l.result.success?n.success(`${l.result.method_name} è§£æžå®Œæˆï¼`):n.error(`${l.result.method_name} è§£æžå¤±è´¥: ${l.result.error||"æœªçŸ¥é”™è¯¯"}`),ie()):(Z.value[e]="error",n.error(`è§£æžå¤±è´¥: ${l.error||"æœªçŸ¥é”™è¯¯"}`))}catch(t){Z.value[e]="error",n.error((null==(l=null==(a=t.response)?void 0:a.data)?void 0:l.error)||t.message||"è§£æžå¤±è´¥")}}else n.error("è¯·å…ˆä¸Šä¼ æ–‡ä»¶")},ce=async e=>{if(g.value)try{const a=await Y.saveGroundTruth(g.value,e,"user");a.success&&(U.value=a.accuracy,n.success("æ ‡æ³¨å·²ä¿å­˜ï¼Œå‡†ç¡®çŽ‡å·²è®¡ç®—"))}catch(a){n.error("ä¿å­˜å¤±è´¥")}else n.error("æ²¡æœ‰å½“å‰æ–‡æ¡£")},ie=async()=>{try{const e=await Y.getHistory({limit:50});X.value=e.tests}catch(e){n.error("åŠ è½½åŽ†å²è®°å½•å¤±è´¥")}},oe=async()=>{await ie(),K.value=!0},ne=k(()=>{if(!U.value||!A.value)return[];return[{key:"gemini",name:"Gemini AIè§£æžå™¨"},{key:"docx_native",name:"Wordå¤§çº²çº§åˆ«è¯†åˆ«"},{key:"toc_exact",name:"ç²¾ç¡®åŒ¹é…(åŸºäºŽç›®å½•)"},{key:"azure",name:"Azure Form Recognizer"},{key:"llm_level",name:"LLMæ™ºèƒ½å±‚çº§åˆ†æž"}].filter(({key:e})=>A.value[e]).map(({key:e,name:a})=>{var l,t,s,r,u,c,i;return{method:a,precision:(null==(l=U.value[e])?void 0:l.precision)||0,recall:(null==(t=U.value[e])?void 0:t.recall)||0,f1:(null==(s=U.value[e])?void 0:s.f1_score)||0,detected:(null==(u=null==(r=A.value[e])?void 0:r.chapters)?void 0:u.length)||0,elapsed:(null==(i=null==(c=A.value[e])?void 0:c.performance)?void 0:i.elapsed_formatted)||"-",is_best:U.value.best_method===e}})}),de=e=>e>=.9?"score-excellent":e>=.7?"score-good":e>=.5?"score-fair":"score-poor",ve=()=>{var e;return{toc_exact:"ç²¾ç¡®åŒ¹é…(åŸºäºŽç›®å½•)",azure:"Azure Form Recognizer",docx_native:"Wordå¤§çº²çº§åˆ«è¯†åˆ«",gemini:"Gemini AIè§£æžå™¨",llm_level:"LLMæ™ºèƒ½å±‚çº§åˆ†æž"}[null==(e=U.value)?void 0:e.best_method]||"æœªçŸ¥"};return G(async()=>{await ie()}),(e,k)=>{const S=u,G=q,pe=h,_e=M,me=f,he=W,ye=N,ge=H,ke=Q,be=O,xe=o,we=B;return w(),x("div",Ve,[L(R(y),{title:"ðŸ“Š ç›®å½•è§£æžæ–¹æ³•å¯¹æ¯”å·¥å…·"},{extra:$(()=>[L(S,{onClick:oe,type:"text"},{default:$(()=>[...k[7]||(k[7]=[E("åŽ†å²è®°å½•",-1)])]),_:1})]),default:$(()=>{var e,u,c,i,o;return[z("div",$e,[L(G,{ref_key:"uploadRef",ref:l,"auto-upload":!1,"on-change":ee,"show-file-list":!1,accept:".docx"},{default:$(()=>[L(S,{type:"primary",icon:R(v)},{default:$(()=>[...k[8]||(k[8]=[E("é€‰æ‹©æ ‡ä¹¦æ–‡æ¡£ (.docx)",-1)])]),_:1},8,["icon"])]),_:1},512),t.value?(w(),x("span",Le," å·²é€‰æ‹©: "+F(t.value.name),1)):j("",!0),L(S,{onClick:ae,loading:s.value,disabled:!t.value,type:"success"},{default:$(()=>[...k[9]||(k[9]=[E(" å¼€å§‹è§£æžå¯¹æ¯” ",-1)])]),_:1},8,["loading","disabled"]),L(pe,{direction:"vertical"}),L(S,{onClick:le,loading:r.value,disabled:!g.value,type:"warning"},{default:$(()=>[...k[10]||(k[10]=[E(" ðŸ§  æ™ºèƒ½è¯†åˆ« ",-1)])]),_:1},8,["loading","disabled"]),L(pe,{direction:"vertical"}),L(S,{onClick:te,disabled:!g.value,type:"info",icon:R(p)},{default:$(()=>[...k[11]||(k[11]=[E(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["disabled","icon"])]),J.value?(w(),x("div",Re,[L(he,{shadow:"hover"},{header:$(()=>{var e;return[z("div",Te,[k[12]||(k[12]=z("span",{class:"title"},"ðŸ§  æ™ºèƒ½è¯†åˆ«ç»“æžœ",-1)),z("div",Ie,[L(_e,{type:"primary"},{default:$(()=>[E(F(J.value.method_used),1)]),_:1}),J.value.fallback_from?(w(),V(_e,{key:0,type:"warning"},{default:$(()=>[E(" å›žé€€è‡ª: "+F(J.value.fallback_from),1)]),_:1})):j("",!0),J.value.fallback_reason?(w(),V(_e,{key:1,type:"info"},{default:$(()=>[E(F(J.value.fallback_reason),1)]),_:1})):j("",!0),z("span",Ae,"è€—æ—¶: "+F((null==(e=J.value.performance)?void 0:e.elapsed_formatted)||"-"),1)])])]}),default:$(()=>{var e,a,l,t;return[J.value.key_sections?(w(),x("div",Se,[k[16]||(k[16]=z("h4",null,"ðŸ“Œ å…³é”®åŒºåŸŸ",-1)),z("div",Ee,[(null==(e=J.value.key_sections.business_response)?void 0:e.length)?(w(),x("div",Ge,[L(_e,{type:"primary",effect:"dark"},{default:$(()=>[...k[13]||(k[13]=[E("å•†åŠ¡åº”ç­”æ¨¡æ¿",-1)])]),_:1}),(w(!0),x(T,null,I(J.value.key_sections.business_response,e=>(w(),x("span",{key:e,class:"section-title"},F(e),1))),128))])):j("",!0),(null==(a=J.value.key_sections.technical_spec)?void 0:a.length)?(w(),x("div",De,[L(_e,{type:"success",effect:"dark"},{default:$(()=>[...k[14]||(k[14]=[E("æŠ€æœ¯è§„èŒƒ",-1)])]),_:1}),(w(!0),x(T,null,I(J.value.key_sections.technical_spec,e=>(w(),x("span",{key:e,class:"section-title"},F(e),1))),128))])):j("",!0),(null==(l=J.value.key_sections.contract_content)?void 0:l.length)?(w(),x("div",Me,[L(_e,{type:"warning",effect:"dark"},{default:$(()=>[...k[15]||(k[15]=[E("åˆåŒå†…å®¹",-1)])]),_:1}),(w(!0),x(T,null,I(J.value.key_sections.contract_content,e=>(w(),x("span",{key:e,class:"section-title"},F(e),1))),128))])):j("",!0)])])):j("",!0),z("div",We,[z("h4",null,"ðŸ“š ç« èŠ‚ç»“æž„ (å…± "+F((null==(t=J.value.chapters)?void 0:t.length)||0)+" ä¸ªä¸€çº§ç« èŠ‚)",1),L(me,{data:se.value,props:{label:"label",children:"children"},"default-expand-all":"","expand-on-click-node":!1},{default:$(({node:e,data:a})=>{return[z("span",Pe,[z("span",Ue,F(a.title),1),a.chapter_type?(w(),V(_e,{key:0,type:(l=a.chapter_type,{invitation:"info",bidder_notice:"info",evaluation:"",contract_terms:"",contract_content:"warning",business_response:"primary",technical_spec:"success",appendix:"info",other:"info"}[l]||"info"),size:"small"},{default:$(()=>[E(F(re(a.chapter_type)),1)]),_:2},1032,["type"])):j("",!0)])];var l}),_:1},8,["data"])])]}),_:1})])):j("",!0),b.value?(w(),x("div",Be,[L(ge,{column:4,border:""},{default:$(()=>[L(ye,{label:"æ–‡ä»¶å"},{default:$(()=>[E(F(b.value.filename),1)]),_:1}),L(ye,{label:"æ€»æ®µè½æ•°"},{default:$(()=>[E(F(b.value.total_paragraphs),1)]),_:1}),L(ye,{label:"ç›®å½•æ£€æµ‹"},{default:$(()=>[L(_e,{type:b.value.has_toc?"success":"warning"},{default:$(()=>[E(F(b.value.has_toc?`âœ“ æ£€æµ‹åˆ° (${b.value.toc_items_count}é¡¹)`:"âœ— æœªæ£€æµ‹åˆ°"),1)]),_:1},8,["type"])]),_:1}),L(ye,{label:"ä¸Šä¼ æ—¶é—´"},{default:$(()=>[E(F(b.value.upload_time||"-"),1)]),_:1})]),_:1})])):j("",!0),A.value?(w(),x("div",qe,[A.value.gemini?(w(),V(fe,{key:0,title:"æ–¹æ³•1: Gemini AIè§£æžå™¨",result:A.value.gemini,"ground-truth":P.value,accuracy:null==(e=U.value)?void 0:e.gemini,status:Z.value.gemini,color:"#FF6D00",onStart:k[0]||(k[0]=e=>ue("gemini"))},null,8,["result","ground-truth","accuracy","status"])):j("",!0),A.value.docx_native?(w(),V(fe,{key:1,title:"æ–¹æ³•2: Wordå¤§çº²çº§åˆ«è¯†åˆ«",result:A.value.docx_native,"ground-truth":P.value,accuracy:null==(u=U.value)?void 0:u.docx_native,status:Z.value.docx_native,color:"#9C27B0",onStart:k[1]||(k[1]=e=>ue("docx_native"))},null,8,["result","ground-truth","accuracy","status"])):j("",!0),A.value.toc_exact?(w(),V(fe,{key:2,title:"æ–¹æ³•3: ç²¾ç¡®åŒ¹é…(åŸºäºŽç›®å½•)",result:A.value.toc_exact,"ground-truth":P.value,accuracy:null==(c=U.value)?void 0:c.toc_exact,status:Z.value.toc_exact,color:"#F56C6C",onStart:k[2]||(k[2]=e=>ue("toc_exact"))},null,8,["result","ground-truth","accuracy","status"])):j("",!0),A.value.azure?(w(),V(fe,{key:3,title:"æ–¹æ³•4: Azure Form Recognizer",result:A.value.azure,"ground-truth":P.value,accuracy:null==(i=U.value)?void 0:i.azure,status:Z.value.azure,color:"#00B7C3",onStart:k[3]||(k[3]=e=>ue("azure"))},null,8,["result","ground-truth","accuracy","status"])):j("",!0),A.value.llm_level?(w(),V(fe,{key:4,title:"æ–¹æ³•5: LLMæ™ºèƒ½å±‚çº§åˆ†æž",result:A.value.llm_level,"ground-truth":P.value,accuracy:null==(o=U.value)?void 0:o.llm_level,status:Z.value.llm_level,color:"#10B981",onStart:k[4]||(k[4]=e=>ue("llm_level"))},null,8,["result","ground-truth","accuracy","status"])):j("",!0),L(Fe,{modelValue:P.value,"onUpdate:modelValue":k[5]||(k[5]=e=>P.value=e),"document-id":g.value,"available-results":A.value,onSave:ce},null,8,["modelValue","document-id","available-results"])])):j("",!0),U.value?(w(),x("div",He,[k[18]||(k[18]=z("h3",null,"å‡†ç¡®çŽ‡å¯¹æ¯”",-1)),L(be,{data:ne.value,border:"",stripe:""},{default:$(()=>[L(ke,{prop:"method",label:"è§£æžæ–¹æ³•",width:"180"}),L(ke,{prop:"precision",label:"ç²¾ç¡®çŽ‡ (P)",width:"120"},{default:$(({row:e})=>[z("span",{class:C(de(e.precision))},F((100*e.precision).toFixed(1))+"% ",3)]),_:1}),L(ke,{prop:"recall",label:"å¬å›žçŽ‡ (R)",width:"120"},{default:$(({row:e})=>[z("span",{class:C(de(e.recall))},F((100*e.recall).toFixed(1))+"% ",3)]),_:1}),L(ke,{prop:"f1",label:"F1åˆ†æ•°",width:"120"},{default:$(({row:e})=>{return[L(_e,{type:(a=e.f1,a>=.9?"success":a>=.7?"":a>=.5?"warning":"danger"),effect:"dark"},{default:$(()=>[E(F((100*e.f1).toFixed(1))+"% ",1)]),_:2},1032,["type"])];var a}),_:1}),L(ke,{prop:"detected",label:"è¯†åˆ«æ•°é‡",width:"100"}),L(ke,{prop:"elapsed",label:"è€—æ—¶",width:"100"}),L(ke,{label:"çŠ¶æ€",width:"100"},{default:$(({row:e})=>[e.is_best?(w(),V(_e,{key:0,type:"success"},{default:$(()=>[...k[17]||(k[17]=[E("æœ€ä½³",-1)])]),_:1})):j("",!0)]),_:1})]),_:1},8,["data"]),z("div",Ne,[L(xe,{title:`æœ€ä½³æ–¹æ³•: ${ve()} (F1åˆ†æ•°: ${(100*U.value.best_f1_score).toFixed(1)}%)`,type:"success",closable:!1},null,8,["title"])])])):j("",!0),z("div",Oe,[z("div",Qe,[k[20]||(k[20]=z("h3",null,"ðŸ“‹ åŽ†å²è§£æžè®°å½•",-1)),L(S,{onClick:ie,icon:R(v),size:"small"},{default:$(()=>[...k[19]||(k[19]=[E(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["icon"])]),L(be,{data:X.value,border:"",stripe:""},{default:$(()=>[L(ke,{label:"æ–‡ä»¶å","min-width":"200"},{default:$(({row:e})=>{return[(l=e.filename,!l||l.length<3||"docx"===l||".docx"===l||l.startsWith("-.")||l.startsWith("--")?(w(),x("span",Je,[L(R(a),null,{default:$(()=>[L(R(_))]),_:1}),k[21]||(k[21]=E(" (æ–‡ä»¶åå·²æŸå) ",-1))])):(w(),x("span",Ye,F(e.filename),1)))];var l}),_:1}),L(ke,{prop:"upload_time",label:"è§£æžæ—¶é—´",width:"180"}),L(ke,{label:"ç›®å½•æ£€æµ‹",width:"100",align:"center"},{default:$(({row:e})=>[L(_e,{type:e.has_toc?"success":"info",size:"small"},{default:$(()=>[E(F(e.has_toc?`âœ“ (${e.toc_items_count})`:"âœ—"),1)]),_:2},1032,["type"])]),_:1}),L(ke,{label:"ç²¾ç¡®åŒ¹é…",width:"110",align:"center"},{default:$(({row:e})=>[e.toc_exact_f1?(w(),x("div",{key:0,class:C(de(e.toc_exact_f1))},F((100*e.toc_exact_f1).toFixed(1))+"% ",3)):e.toc_exact_chapters_count>0?(w(),x("div",Ke,F(e.toc_exact_chapters_count)+"ç«  ",1)):void 0!==e.toc_exact_elapsed&&null!==e.toc_exact_elapsed?(w(),V(_e,{key:2,type:"danger",size:"small"},{default:$(()=>[...k[22]||(k[22]=[E("å¤±è´¥",-1)])]),_:1})):(w(),x("span",Xe,"-"))]),_:1}),L(ke,{label:"Azure",width:"110",align:"center"},{default:$(({row:e})=>[e.azure_f1?(w(),x("div",{key:0,class:C(de(e.azure_f1))},F((100*e.azure_f1).toFixed(1))+"% ",3)):e.azure_chapters_count>0?(w(),x("div",Ze,F(e.azure_chapters_count)+"ç«  ",1)):void 0!==e.azure_elapsed&&null!==e.azure_elapsed?(w(),V(_e,{key:2,type:"danger",size:"small"},{default:$(()=>[...k[23]||(k[23]=[E("å¤±è´¥",-1)])]),_:1})):(w(),x("span",ea,"-"))]),_:1}),L(ke,{label:"Wordå¤§çº²",width:"110",align:"center"},{default:$(({row:e})=>[e.docx_native_f1?(w(),x("div",{key:0,class:C(de(e.docx_native_f1))},F((100*e.docx_native_f1).toFixed(1))+"% ",3)):e.docx_native_chapters_count>0?(w(),x("div",aa,F(e.docx_native_chapters_count)+"ç«  ",1)):void 0!==e.docx_native_elapsed&&null!==e.docx_native_elapsed?(w(),V(_e,{key:2,type:"danger",size:"small"},{default:$(()=>[...k[24]||(k[24]=[E("å¤±è´¥",-1)])]),_:1})):(w(),x("span",la,"-"))]),_:1}),L(ke,{label:"Gemini AI",width:"110",align:"center"},{default:$(({row:e})=>[e.gemini_f1?(w(),x("div",{key:0,class:C(de(e.gemini_f1))},F((100*e.gemini_f1).toFixed(1))+"% ",3)):e.gemini_chapters_count>0?(w(),x("div",ta,F(e.gemini_chapters_count)+"ç«  ",1)):void 0!==e.gemini_elapsed&&null!==e.gemini_elapsed?(w(),V(_e,{key:2,type:"danger",size:"small"},{default:$(()=>[...k[25]||(k[25]=[E("å¤±è´¥",-1)])]),_:1})):(w(),x("span",sa,"-"))]),_:1}),L(ke,{label:"LLMå±‚çº§",width:"110",align:"center"},{default:$(({row:e})=>[e.llm_level_f1?(w(),x("div",{key:0,class:C(de(e.llm_level_f1))},F((100*e.llm_level_f1).toFixed(1))+"% ",3)):e.llm_level_chapters_count>0?(w(),x("div",ra,F(e.llm_level_chapters_count)+"ç«  ",1)):void 0!==e.llm_level_elapsed&&null!==e.llm_level_elapsed?(w(),V(_e,{key:2,type:"danger",size:"small"},{default:$(()=>[...k[26]||(k[26]=[E("å¤±è´¥",-1)])]),_:1})):(w(),x("span",ua,"-"))]),_:1}),L(ke,{label:"æœ€ä½³æ–¹æ³•",width:"150",align:"center"},{default:$(({row:e})=>[e.best_method?(w(),x("div",ca,[L(_e,{type:e.best_f1_score>=.9?"success":"primary",effect:"dark"},{default:$(()=>{return[E(F((a=e.best_method,{toc_exact:"ç²¾ç¡®åŒ¹é…",azure:"Azure",docx_native:"Wordå¤§çº²",gemini:"Gemini AI",llm_level:"LLMå±‚çº§"}[a]||a)),1)];var a}),_:2},1032,["type"]),z("div",ia," F1: "+F((100*e.best_f1_score).toFixed(1))+"% ",1)])):(w(),x("span",oa,"æœªæ ‡æ³¨"))]),_:1}),L(ke,{label:"æ“ä½œ",width:"150",fixed:"right",align:"center"},{default:$(({row:e})=>[L(S,{size:"small",type:"primary",onClick:a=>(async e=>{var a,l,t,s,r,u,c,i,o,d,v,p,_,m,f;try{const h=await Y.getTestResult(e);h.success&&(g.value=h.document_id,b.value=h.document_info,A.value=h.results,P.value=h.ground_truth||null,U.value=h.accuracy||null,Z.value={gemini:(null==(l=null==(a=A.value)?void 0:a.gemini)?void 0:l.success)?"success":(null==(t=A.value)?void 0:t.gemini)?"error":"idle",docx_native:(null==(r=null==(s=A.value)?void 0:s.docx_native)?void 0:r.success)?"success":(null==(u=A.value)?void 0:u.docx_native)?"error":"idle",toc_exact:(null==(i=null==(c=A.value)?void 0:c.toc_exact)?void 0:i.success)?"success":(null==(o=A.value)?void 0:o.toc_exact)?"error":"idle",azure:(null==(v=null==(d=A.value)?void 0:d.azure)?void 0:v.success)?"success":(null==(p=A.value)?void 0:p.azure)?"error":"idle",llm_level:(null==(m=null==(_=A.value)?void 0:_.llm_level)?void 0:m.success)?"success":(null==(f=A.value)?void 0:f.llm_level)?"error":"idle"},K.value=!1,n.success("æµ‹è¯•ç»“æžœå·²åŠ è½½"))}catch(h){n.error("åŠ è½½å¤±è´¥")}})(e.document_id)},{default:$(()=>[...k[27]||(k[27]=[E(" æŸ¥çœ‹ ",-1)])]),_:1},8,["onClick"]),L(S,{size:"small",type:"danger",onClick:a=>(async e=>{try{await m.confirm("ç¡®å®šè¦åˆ é™¤è¿™æ¡æµ‹è¯•è®°å½•å—ï¼Ÿ","ç¡®è®¤åˆ é™¤",{type:"warning"}),await Y.deleteTest(e),n.success("å·²åˆ é™¤"),oe()}catch(a){}})(e.document_id)},{default:$(()=>[...k[28]||(k[28]=[E(" åˆ é™¤ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"]),0===X.value.length?(w(),x("div",na,[L(we,{description:"æš‚æ— åŽ†å²è§£æžè®°å½•"})])):j("",!0)])]}),_:1}),L(R(D),{modelValue:c.value,"onUpdate:modelValue":k[6]||(k[6]=e=>c.value=e),"file-url":i.value,"file-name":d.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-147555d0"]]);export{da as default};
