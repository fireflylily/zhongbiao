import{K as e,M as a,e as l,ag as t,t as o,ah as u,P as r,N as s,O as i,S as d,d as n,aa as p,ab as c,y as v,Q as m,R as f,h as _,E as w,z as y,G as b,q as h}from"./index.js";/* empty css                         *//* empty css                    */import{E as g}from"./el-input-number-CnPBhObR.js";/* empty css                             */import{E as V}from"./el-divider-Deqft6C8.js";/* empty css                    *//* empty css                     *//* empty css               */import{E as j,a as k}from"./el-select-CldpbmUv.js";/* empty css                */import{L as x}from"./Loading-DJ2LU2Ls.js";import{E as C}from"./Empty-CwZAaoJK.js";/* empty css                */import{C as U}from"./Card-SJ5b36FP.js";/* empty css                                                        *//* empty css                                                                            */import{am as L,an as E,ao as z,aW as D,au as R,ar as F,aw as O,ax as P,as as I,ay as $,aC as B,aq as M,aD as T}from"./editor-Dt4gYtYt.js";/* empty css                   *//* empty css                */import{k as q}from"./knowledge-BR5smuxz.js";import{f as N}from"./formatters-CqsP5WAK.js";import{v as G,a as Q}from"./validators-BHjNrE0Y.js";import{E as S}from"./index-CzbDvFem.js";import{E as X,a as A}from"./index-IU_h0TRZ.js";import{E as J}from"./strings-BjAjE6k-.js";import{E as K,a as W}from"./index-BX21ihZ_.js";import{E as Y}from"./index-CzCnSpIZ.js";import"./index-DdGYlGy6.js";import"./index-CcWeoNg9.js";import"./toNumber-D5oObipZ.js";import"./_baseIteratee-BnEJjc-Z.js";import"./index-BgAfl9sI.js";import"./flatMap-B-HSJstM.js";import"./map-7mKJdJp1.js";import"./_baseEach-BT2EtZBY.js";import"./index-zLnbxgQE.js";import"./raf-BZHcGSIv.js";import"./cloneDeep-syPWYH98.js";const H={class:"resume-library"},Z={class:"stats-bar"},ee={class:"stat-content"},ae={class:"stat-icon"},le={class:"stat-info"},te={class:"stat-value"},oe={class:"stat-content"},ue={class:"stat-icon"},re={class:"stat-info"},se={class:"stat-value"},ie={class:"stat-content"},de={class:"stat-icon"},ne={class:"stat-info"},pe={class:"stat-value"},ce={class:"filter-section"},ve=h(L({__name:"ResumeLibrary",setup(h){const L=e(),{success:ve,error:me}=a(),fe=E(!1),_e=E([]),we=E({keyword:"",educationLevel:"",position:"",status:""}),ye=E(!1),be=E(!1),he=E(),ge=E({name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""}),Ve={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:50,message:"姓名长度在 2 到 50 个字符",trigger:"blur"}],phone:[{validator:Q,trigger:"blur"}],email:[{validator:G,trigger:"blur"}]},je=E(!1),ke=E(!1),xe=E(),Ce=E([]),Ue=E(null),Le=z(()=>{let e=[..._e.value];if(we.value.keyword){const a=we.value.keyword.toLowerCase();e=e.filter(e=>{var l,t,o,u;return(null==(l=e.name)?void 0:l.toLowerCase().includes(a))||(null==(t=e.current_position)?void 0:t.toLowerCase().includes(a))||(null==(o=e.skills)?void 0:o.toLowerCase().includes(a))||(null==(u=e.major)?void 0:u.toLowerCase().includes(a))})}if(we.value.educationLevel&&(e=e.filter(e=>e.education_level===we.value.educationLevel)),we.value.position){const a=we.value.position.toLowerCase();e=e.filter(e=>{var l;return null==(l=e.current_position)?void 0:l.toLowerCase().includes(a)})}return we.value.status&&(e=e.filter(e=>e.status===we.value.status)),e}),Ee=z(()=>_e.value.filter(e=>"active"===e.status).length),ze=z(()=>{const e=_e.value.filter(e=>e.work_years&&e.work_years>0);if(0===e.length)return 0;return(e.reduce((e,a)=>e+(a.work_years||0),0)/e.length).toFixed(1)}),De=async()=>{fe.value=!0;try{const e=await q.getResumes();if(e.success&&e.data){const a=e.data.resumes||e.data;_e.value=a.map(e=>({...e,created_at:e.created_at?N(e.created_at):"-",updated_at:e.updated_at?N(e.updated_at):"-"}))}}catch(e){me("加载失败",e instanceof Error?e.message:"未知错误")}finally{fe.value=!1}},Re=()=>{},Fe=()=>{we.value.keyword="",we.value.educationLevel="",we.value.position="",we.value.status=""},Oe=e=>{switch(e){case"active":return"success";case"inactive":return"warning";default:return"info"}},Pe=e=>{switch(e){case"active":return"活跃";case"inactive":return"离职";case"archived":return"已归档";default:return"-"}},Ie=()=>{ye.value=!0},$e=async()=>{he.value&&await he.value.validate(async e=>{if(e){be.value=!0;try{const e=await q.createResume({name:ge.value.name,gender:ge.value.gender||void 0,phone:ge.value.phone||void 0,email:ge.value.email||void 0,education_level:ge.value.education_level||void 0,degree:ge.value.degree||void 0,university:ge.value.university||void 0,major:ge.value.major||void 0,current_position:ge.value.current_position||void 0,professional_title:ge.value.professional_title||void 0,work_years:ge.value.work_years,current_company:ge.value.current_company||void 0,introduction:ge.value.introduction||void 0,status:"active"});e.success?(ve("创建成功","简历创建成功"),ye.value=!1,await De()):me("创建失败",e.error||"未知错误")}catch(a){me("创建失败",a instanceof Error?a.message:"未知错误")}finally{be.value=!1}}})},Be=()=>{je.value=!0},Me=e=>{if(e.raw){const a=10485760;if(e.raw.size>a)return me("文件过大","文件大小不能超过10MB"),Ce.value=[],void(Ue.value=null);Ue.value=e.raw}},Te=()=>{Ue.value=null},qe=async()=>{if(Ue.value){ke.value=!0;try{const e=await q.parseResumeFile(Ue.value,!0);e.success?(ve("导入成功","简历已自动解析并创建"),je.value=!1,await De()):me("导入失败",e.error||"解析失败")}catch(e){me("导入失败",e instanceof Error?e.message:"未知错误")}finally{ke.value=!1}}else me("请选择文件","请先选择要上传的简历文件")},Ne=()=>{Ce.value=[],Ue.value=null},Ge=()=>{var e;ge.value={name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""},null==(e=he.value)||e.resetFields()};return D(()=>{De()}),(e,a)=>{const h=l,E=S,z=n,D=i,N=s,G=k,Q=j,Ue=r,Qe=A,Se=J,Xe=X,Ae=V,Je=W,Ke=f,We=m,Ye=K,He=g,Ze=_,ea=w,aa=Y;return F(),R("div",H,[O("div",Z,[P(E,{class:"stat-card"},{default:I(()=>[O("div",ee,[O("div",ae,[P(h,{size:32,color:"#409eff"},{default:I(()=>[P($(t))]),_:1})]),O("div",le,[a[22]||(a[22]=O("div",{class:"stat-label"},"总简历数",-1)),O("div",te,B(_e.value.length),1)])])]),_:1}),P(E,{class:"stat-card"},{default:I(()=>[O("div",oe,[O("div",ue,[P(h,{size:32,color:"#67c23a"},{default:I(()=>[P($(o))]),_:1})]),O("div",re,[a[23]||(a[23]=O("div",{class:"stat-label"},"活跃简历",-1)),O("div",se,B(Ee.value),1)])])]),_:1}),P(E,{class:"stat-card"},{default:I(()=>[O("div",ie,[O("div",de,[P(h,{size:32,color:"#e6a23c"},{default:I(()=>[P($(u))]),_:1})]),O("div",ne,[a[24]||(a[24]=O("div",{class:"stat-label"},"平均工龄",-1)),O("div",pe,B(ze.value)+"年",1)])])]),_:1})]),P($(U),{title:"简历列表"},{actions:I(()=>[P(z,{type:"primary",onClick:Ie},{default:I(()=>[P(h,null,{default:I(()=>[P($(c))]),_:1}),a[25]||(a[25]=T(" 新建简历 ",-1))]),_:1}),P(z,{type:"success",onClick:Be},{default:I(()=>[P(h,null,{default:I(()=>[P($(v))]),_:1}),a[26]||(a[26]=T(" 智能导入 ",-1))]),_:1})]),default:I(()=>[O("div",ce,[P(Ue,{inline:!0,model:we.value},{default:I(()=>[P(N,{label:"搜索"},{default:I(()=>[P(D,{modelValue:we.value.keyword,"onUpdate:modelValue":a[0]||(a[0]=e=>we.value.keyword=e),placeholder:"搜索姓名、职位、技能...",clearable:"",style:{width:"300px"},onInput:Re},{prefix:I(()=>[P(h,null,{default:I(()=>[P($(d))]),_:1})]),_:1},8,["modelValue"])]),_:1}),P(N,{label:"学历"},{default:I(()=>[P(Q,{modelValue:we.value.educationLevel,"onUpdate:modelValue":a[1]||(a[1]=e=>we.value.educationLevel=e),placeholder:"全部学历",clearable:"",style:{width:"120px"},onChange:Re},{default:I(()=>[P(G,{label:"全部学历",value:""}),P(G,{label:"博士",value:"博士"}),P(G,{label:"硕士",value:"硕士"}),P(G,{label:"本科",value:"本科"}),P(G,{label:"大专",value:"大专"}),P(G,{label:"高中",value:"高中"})]),_:1},8,["modelValue"])]),_:1}),P(N,{label:"职位"},{default:I(()=>[P(D,{modelValue:we.value.position,"onUpdate:modelValue":a[2]||(a[2]=e=>we.value.position=e),placeholder:"职位关键词",clearable:"",style:{width:"150px"},onInput:Re},null,8,["modelValue"])]),_:1}),P(N,{label:"状态"},{default:I(()=>[P(Q,{modelValue:we.value.status,"onUpdate:modelValue":a[3]||(a[3]=e=>we.value.status=e),placeholder:"全部状态",clearable:"",style:{width:"120px"},onChange:Re},{default:I(()=>[P(G,{label:"全部状态",value:""}),P(G,{label:"活跃",value:"active"}),P(G,{label:"离职",value:"inactive"}),P(G,{label:"已归档",value:"archived"})]),_:1},8,["modelValue"])]),_:1}),P(N,null,{default:I(()=>[P(z,{onClick:Fe},{default:I(()=>[P(h,null,{default:I(()=>[P($(p))]),_:1}),a[27]||(a[27]=T(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),fe.value?(F(),M($(x),{key:0,text:"加载中..."})):Le.value.length?(F(),M(Xe,{key:2,data:Le.value,stripe:"",style:{width:"100%"}},{default:I(()=>[P(Qe,{prop:"resume_id",label:"ID",width:"70",fixed:""}),P(Qe,{prop:"name",label:"姓名",width:"100",fixed:""}),P(Qe,{prop:"gender",label:"性别",width:"60",align:"center"},{default:I(({row:e})=>[T(B(e.gender||"-"),1)]),_:1}),P(Qe,{prop:"education_level",label:"学历",width:"80"},{default:I(({row:e})=>{return[P(Se,{type:(a=e.education_level,a?"博士"===a?"danger":"硕士"===a?"warning":"本科"===a?"success":"info":"info"),size:"small"},{default:I(()=>[T(B(e.education_level||"-"),1)]),_:2},1032,["type"])];var a}),_:1}),P(Qe,{prop:"university",label:"毕业院校",width:"140","show-overflow-tooltip":""}),P(Qe,{prop:"major",label:"专业",width:"120","show-overflow-tooltip":""}),P(Qe,{prop:"current_position",label:"当前职位",width:"140","show-overflow-tooltip":""}),P(Qe,{prop:"professional_title",label:"职称",width:"100"}),P(Qe,{prop:"work_years",label:"工作年限",width:"90",align:"center"},{default:I(({row:e})=>[T(B(e.work_years?`${e.work_years}年`:"-"),1)]),_:1}),P(Qe,{prop:"current_company",label:"当前单位",width:"160","show-overflow-tooltip":""}),P(Qe,{prop:"phone",label:"联系电话",width:"120"}),P(Qe,{prop:"email",label:"邮箱",width:"180","show-overflow-tooltip":""}),P(Qe,{prop:"status",label:"状态",width:"80",align:"center"},{default:I(({row:e})=>[P(Se,{type:Oe(e.status),size:"small"},{default:I(()=>[T(B(Pe(e.status)),1)]),_:2},1032,["type"])]),_:1}),P(Qe,{prop:"created_at",label:"创建时间",width:"160","show-overflow-tooltip":""}),P(Qe,{label:"操作",width:"220",fixed:"right"},{default:I(({row:e})=>[P(z,{text:"",type:"primary",size:"small",onClick:a=>(e=>{L.push(`/knowledge/resume/${e.resume_id}`)})(e)},{default:I(()=>[...a[28]||(a[28]=[T(" 查看详情 ",-1)])]),_:1},8,["onClick"]),P(z,{text:"",type:"warning",size:"small",onClick:a=>(e=>{L.push(`/knowledge/resume/${e.resume_id}`)})(e)},{default:I(()=>[...a[29]||(a[29]=[T(" 编辑 ",-1)])]),_:1},8,["onClick"]),P(z,{text:"",type:"danger",size:"small",onClick:a=>(async e=>{try{await b.confirm(`确定要删除简历 "${e.name}" 吗？此操作不可恢复。`,"删除确认",{confirmButtonText:"确定删除",cancelButtonText:"取消",type:"warning"});const a=await q.deleteResume(e.resume_id);a.success?(ve("删除成功",`已删除简历: ${e.name}`),await De()):me("删除失败",a.error||"未知错误")}catch(a){me("删除失败",a instanceof Error?a.message:"未知错误")}})(e)},{default:I(()=>[...a[30]||(a[30]=[T(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(F(),M($(C),{key:1,type:"no-data",description:"暂无简历数据"}))]),_:1}),P(Ze,{modelValue:ye.value,"onUpdate:modelValue":a[18]||(a[18]=e=>ye.value=e),title:"新建简历",width:"700px",onClose:Ge},{footer:I(()=>[P(z,{onClick:a[17]||(a[17]=e=>ye.value=!1)},{default:I(()=>[...a[36]||(a[36]=[T("取消",-1)])]),_:1}),P(z,{type:"primary",loading:be.value,onClick:$e},{default:I(()=>[...a[37]||(a[37]=[T(" 确定 ",-1)])]),_:1},8,["loading"])]),default:I(()=>[P(Ue,{ref_key:"createFormRef",ref:he,model:ge.value,rules:Ve,"label-width":"120px"},{default:I(()=>[P(Ae,{"content-position":"left"},{default:I(()=>[...a[31]||(a[31]=[T("基本信息",-1)])]),_:1}),P(Ye,{gutter:20},{default:I(()=>[P(Je,{span:12},{default:I(()=>[P(N,{label:"姓名",prop:"name"},{default:I(()=>[P(D,{modelValue:ge.value.name,"onUpdate:modelValue":a[4]||(a[4]=e=>ge.value.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),P(Je,{span:12},{default:I(()=>[P(N,{label:"性别",prop:"gender"},{default:I(()=>[P(We,{modelValue:ge.value.gender,"onUpdate:modelValue":a[5]||(a[5]=e=>ge.value.gender=e)},{default:I(()=>[P(Ke,{label:"男"},{default:I(()=>[...a[32]||(a[32]=[T("男",-1)])]),_:1}),P(Ke,{label:"女"},{default:I(()=>[...a[33]||(a[33]=[T("女",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),P(Ye,{gutter:20},{default:I(()=>[P(Je,{span:12},{default:I(()=>[P(N,{label:"联系电话",prop:"phone"},{default:I(()=>[P(D,{modelValue:ge.value.phone,"onUpdate:modelValue":a[6]||(a[6]=e=>ge.value.phone=e),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1})]),_:1}),P(Je,{span:12},{default:I(()=>[P(N,{label:"邮箱",prop:"email"},{default:I(()=>[P(D,{modelValue:ge.value.email,"onUpdate:modelValue":a[7]||(a[7]=e=>ge.value.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),P(Ae,{"content-position":"left"},{default:I(()=>[...a[34]||(a[34]=[T("教育信息",-1)])]),_:1}),P(Ye,{gutter:20},{default:I(()=>[P(Je,{span:12},{default:I(()=>[P(N,{label:"学历",prop:"education_level"},{default:I(()=>[P(Q,{modelValue:ge.value.education_level,"onUpdate:modelValue":a[8]||(a[8]=e=>ge.value.education_level=e),placeholder:"请选择学历",style:{width:"100%"}},{default:I(()=>[P(G,{label:"博士",value:"博士"}),P(G,{label:"硕士",value:"硕士"}),P(G,{label:"本科",value:"本科"}),P(G,{label:"大专",value:"大专"}),P(G,{label:"高中",value:"高中"}),P(G,{label:"中专",value:"中专"}),P(G,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),P(Je,{span:12},{default:I(()=>[P(N,{label:"学位",prop:"degree"},{default:I(()=>[P(Q,{modelValue:ge.value.degree,"onUpdate:modelValue":a[9]||(a[9]=e=>ge.value.degree=e),placeholder:"请选择学位",style:{width:"100%"}},{default:I(()=>[P(G,{label:"博士学位",value:"博士"}),P(G,{label:"硕士学位",value:"硕士"}),P(G,{label:"学士学位",value:"学士"}),P(G,{label:"无学位",value:"无"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),P(Ye,{gutter:20},{default:I(()=>[P(Je,{span:12},{default:I(()=>[P(N,{label:"毕业院校",prop:"university"},{default:I(()=>[P(D,{modelValue:ge.value.university,"onUpdate:modelValue":a[10]||(a[10]=e=>ge.value.university=e),placeholder:"请输入毕业院校"},null,8,["modelValue"])]),_:1})]),_:1}),P(Je,{span:12},{default:I(()=>[P(N,{label:"专业",prop:"major"},{default:I(()=>[P(D,{modelValue:ge.value.major,"onUpdate:modelValue":a[11]||(a[11]=e=>ge.value.major=e),placeholder:"请输入专业"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),P(Ae,{"content-position":"left"},{default:I(()=>[...a[35]||(a[35]=[T("工作信息",-1)])]),_:1}),P(Ye,{gutter:20},{default:I(()=>[P(Je,{span:12},{default:I(()=>[P(N,{label:"当前职位",prop:"current_position"},{default:I(()=>[P(D,{modelValue:ge.value.current_position,"onUpdate:modelValue":a[12]||(a[12]=e=>ge.value.current_position=e),placeholder:"如：项目经理"},null,8,["modelValue"])]),_:1})]),_:1}),P(Je,{span:12},{default:I(()=>[P(N,{label:"职称",prop:"professional_title"},{default:I(()=>[P(D,{modelValue:ge.value.professional_title,"onUpdate:modelValue":a[13]||(a[13]=e=>ge.value.professional_title=e),placeholder:"如：高级工程师"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),P(Ye,{gutter:20},{default:I(()=>[P(Je,{span:12},{default:I(()=>[P(N,{label:"工作年限",prop:"work_years"},{default:I(()=>[P(He,{modelValue:ge.value.work_years,"onUpdate:modelValue":a[14]||(a[14]=e=>ge.value.work_years=e),min:0,max:50,placeholder:"年",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),P(Je,{span:12},{default:I(()=>[P(N,{label:"当前单位",prop:"current_company"},{default:I(()=>[P(D,{modelValue:ge.value.current_company,"onUpdate:modelValue":a[15]||(a[15]=e=>ge.value.current_company=e),placeholder:"请输入当前工作单位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),P(N,{label:"个人简介",prop:"introduction"},{default:I(()=>[P(D,{modelValue:ge.value.introduction,"onUpdate:modelValue":a[16]||(a[16]=e=>ge.value.introduction=e),type:"textarea",rows:3,placeholder:"请简要介绍个人经历、专长等"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),P(Ze,{modelValue:je.value,"onUpdate:modelValue":a[21]||(a[21]=e=>je.value=e),title:"智能导入简历",width:"500px",onClose:Ne},{footer:I(()=>[P(z,{onClick:a[20]||(a[20]=e=>je.value=!1)},{default:I(()=>[...a[40]||(a[40]=[T("取消",-1)])]),_:1}),P(z,{type:"primary",loading:ke.value,onClick:qe},{default:I(()=>[...a[41]||(a[41]=[T(" 开始解析 ",-1)])]),_:1},8,["loading"])]),default:I(()=>[P(ea,{title:"智能解析",type:"info",description:"上传PDF/DOC/DOCX格式的简历文件，系统将自动提取信息并创建简历记录",closable:!1,style:{"margin-bottom":"20px"}}),P(aa,{ref_key:"uploadRef",ref:xe,"file-list":Ce.value,"onUpdate:fileList":a[19]||(a[19]=e=>Ce.value=e),"auto-upload":!1,limit:1,accept:".pdf,.doc,.docx",drag:"","on-change":Me,"on-remove":Te},{tip:I(()=>[...a[38]||(a[38]=[O("div",{class:"el-upload__tip"}," 支持PDF、DOC、DOCX格式，文件大小不超过10MB ",-1)])]),default:I(()=>[P(h,{class:"el-icon--upload"},{default:I(()=>[P($(y))]),_:1}),a[39]||(a[39]=O("div",{class:"el-upload__text"},[T(" 拖拽文件到这里 或 "),O("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-3c9669a4"]]);export{ve as default};
