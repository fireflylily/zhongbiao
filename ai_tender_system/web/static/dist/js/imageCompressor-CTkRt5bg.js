const e={license:{maxWidth:1500,quality:.8,mimeType:"image/jpeg"},qualification:{maxWidth:1200,quality:.75,mimeType:"image/jpeg"},id_card:{maxWidth:1e3,quality:.7,mimeType:"image/jpeg"},seal:{maxWidth:800,quality:.85,mimeType:"image/jpeg"},photo:{maxWidth:800,quality:.75,mimeType:"image/jpeg"},default:{maxWidth:1200,quality:.75,mimeType:"image/jpeg"}},t=307200,i=1200,a=1200,n=102400,r=.1;async function m(m,o=e.default){try{const e=await function(e){return new Promise((t,i)=>{const a=new FileReader;a.onload=e=>{var a;const n=new Image;n.onload=()=>t(n),n.onerror=()=>i(new Error("图片加载失败")),n.src=null==(a=e.target)?void 0:a.result},a.onerror=()=>i(new Error("文件读取失败")),a.readAsDataURL(e)})}(m);if(!function(e,r){const{size:m,type:o}=e,{width:g,height:l}=r;return!(m<102400)&&(m>t||g>i||l>a||"image/png"===o&&m>n)}(m,e))return m;let{width:g,height:l}=e;const s=o.maxWidth||1200,d=o.maxHeight||s;if(g>s||l>d){const e=Math.min(s/g,d/l);g=Math.round(g*e),l=Math.round(l*e)}const p=document.createElement("canvas");p.width=g,p.height=l;const u=p.getContext("2d");u.fillStyle="#FFFFFF",u.fillRect(0,0,g,l),u.drawImage(e,0,0,g,l);const c=await new Promise((e,t)=>{p.toBlob(i=>{i?e(i):t(new Error("Canvas转Blob失败"))},o.mimeType||"image/jpeg",o.quality||.75)}),h=new File([c],m.name.replace(/\.(png|jpg|jpeg|gif|bmp)$/i,".jpg"),{type:o.mimeType||"image/jpeg",lastModified:Date.now()});return(m.size-h.size)/m.size<r?m:h}catch(g){return m}}async function o(t,i="default"){if(!t.type.startsWith("image/"))return t;return m(t,e[i]||e.default)}export{o as s};
