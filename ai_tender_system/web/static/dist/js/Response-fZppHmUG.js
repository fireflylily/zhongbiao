import{k as e,O as a,d as l,E as t,e as s,ae as o,D as i,F as r,y as n,J as u,s as d,i as c,q as p}from"./index.js";/* empty css                   *//* empty css                                                        *//* empty css                                                                            *//* empty css                             *//* empty css                *//* empty css                    *//* empty css                     */import{E as m}from"./el-text-Kv3Vn9-t.js";/* empty css               *//* empty css                */import{E as v,a as _}from"./el-select-CldpbmUv.js";import{am as f,an as y,ao as w,aW as h,au as j,ar as g,ax as b,aq as x,av as k,as as F,aw as I,az as C,aA as z,ay as V,aC as P,aD as E,at as N,aU as U}from"./editor-Dt4gYtYt.js";/* empty css                */import{D}from"./DocumentUploader-CxdT86Ko.js";import{_ as R}from"./DocumentPreview.vue_vue_type_script_setup_true_lang-CAKmezWj.js";import{R as $}from"./RichTextEditor-CIl5npix.js";import{u as q,S as T,d as S}from"./helpers-C1wuofaA.js";import{t as W}from"./tender-B2uBMreU.js";import{c as B}from"./company-CHa0NuIL.js";import{u as H}from"./project-Cff1E3wd.js";import{u as J}from"./useProjectDocuments-B5q-q_DN.js";import{E as L}from"./index-CzbDvFem.js";import{E as O,a as A}from"./index-CUA8F766.js";import{E as M,a as G}from"./index-IU_h0TRZ.js";import{E as K}from"./strings-BjAjE6k-.js";import{E as Q,a as X}from"./index-zK8U2JRv.js";import{E as Y}from"./index-d7yf_ss5.js";import{v as Z}from"./directive-CBGghap-.js";import{E as ee}from"./index-rLTqmg7l.js";import"./index-CcWeoNg9.js";import"./toNumber-D5oObipZ.js";import"./_baseIteratee-BnEJjc-Z.js";import"./imageCompressor-CTkRt5bg.js";import"./index-CzCnSpIZ.js";import"./index-BgAfl9sI.js";import"./cloneDeep-syPWYH98.js";import"./index-CFRmMOiB.js";import"./index-BX21ihZ_.js";import"./index-GOKzZPhn.js";import"./flatMap-B-HSJstM.js";import"./map-7mKJdJp1.js";import"./_baseEach-BT2EtZBY.js";import"./index-zLnbxgQE.js";import"./raf-BZHcGSIv.js";const ae={async processBusinessResponse(a){const l=new FormData;return l.append("company_id",a.company_id.toString()),l.append("project_name",a.project_name),a.tender_no&&l.append("tender_no",a.tender_no),a.date_text&&l.append("date_text",a.date_text),l.append("hitl_file_path",a.hitl_file_path),l.append("use_mcp",!1!==a.use_mcp?"true":"false"),e.post("/process-business-response",l,{headers:{"Content-Type":"multipart/form-data"}})}},le={class:"business-response"},te={class:"panel-row project-row"},se={class:"row-item"},oe={class:"row-item"},ie={class:"panel-row project-row"},re={class:"row-item"},ne={key:0,class:"panel-row project-row"},ue={class:"row-item"},de={class:"row-item"},ce={class:"panel-row project-row document-row"},pe={class:"row-item row-item--full"},me={key:0,class:"template-file-card"},ve={class:"template-file-card__info"},_e=["title"],fe={class:"template-file-card__actions"},ye={key:1,class:"template-file-card"},we={class:"template-file-card__info"},he=["title"],je={class:"template-file-card__actions"},ge={key:2,class:"file-placeholder"},be={class:"panel-actions"},xe={class:"card-header"},ke={class:"header-actions"},Fe={class:"result-content"},Ie={key:0,class:"qualifications-details-section"},Ce={style:{margin:"8px 0 0 20px",padding:"0"}},ze={class:"file-info-section"},Ve={class:"collapse-header"},Pe={class:"filename-cell"},Ee=p(f({__name:"Response",setup(e){H();const{projects:p,selectedProject:f,loadProjects:Ee,handleProjectChange:Ne,restoreProjectFromStore:Ue}=J(),{useHitlFile:De,hitlFileInfo:Re,syncing:$e,synced:qe,loadFromHITL:Te,cancelHitlFile:Se,syncToHitl:We}=q({onFileLoaded:()=>{Be.value.templateFiles=[]}}),Be=y({projectId:null,companyId:null,projectName:"æ–°é¡¹ç›®",projectNumber:`PRJ-${Date.now()}`,templateFiles:[],authorizedPersonName:""}),He=y([]);w(()=>He.value.find(e=>e.company_id===Be.value.companyId));const Je=w(()=>Be.value.projectId&&(Be.value.templateFiles.length>0||De.value)),Le=y(!1),Oe=y(0),Ae=y(""),Me=y(null),Ge=y(!1),Ke=y(null),Qe=y(""),Xe=y(!1),Ye=y(!1),Ze=y(""),ea=y(""),aa=y([]),la=y([]),ta=y(!1),sa=y([]),oa=async e=>{const{file:a,onSuccess:l,onError:t}=e;try{if(!Be.value.projectId){if(!Be.value.companyId)throw new Error("è¯·å…ˆé€‰æ‹©å…¬å¸");c.info("æ­£åœ¨åˆ›å»ºæ–°é¡¹ç›®...");const e=await W.createProject({company_id:Be.value.companyId,project_name:Be.value.projectName||"æ–°é¡¹ç›®",project_number:Be.value.projectNumber||`PRJ-${Date.now()}`});Be.value.projectId=e.project_id,await Ee(),c.success("æ–°é¡¹ç›®å·²åˆ›å»º"),await ra()}const e=await W.uploadBusinessTemplate(Be.value.projectId,a);if(!e.success)throw new Error(e.message||"ä¸Šä¼ å¤±è´¥");l(e.data),c.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")}catch(s){t(s),c.error(s.message||"æ¨¡æ¿ä¸Šä¼ å¤±è´¥")}},ia=async()=>{try{const e=await B.getCompanies();He.value=e.data||[]}catch(e){c.error("åŠ è½½å…¬å¸åˆ—è¡¨å¤±è´¥")}},ra=async()=>{var e;await Ne(Be.value.projectId,{onClear:()=>{Me.value=null,Ae.value="",Be.value.templateFiles=[],Be.value.authorizedPersonName="",Ge.value=!1,Qe.value="",aa.value=[],la.value=[],De.value&&Se()},onDocumentsLoaded:e=>{e.templateFile&&Te(e,"templateFile"),e.businessResponseFile&&(Me.value=e.businessResponseFile,Ge.value=!1)}}),Be.value.projectId&&(await ha(),(null==(e=f.value)?void 0:e.authorized_person_name)&&(Be.value.authorizedPersonName=f.value.authorized_person_name)),Be.value.projectId||(Be.value.projectNumber=`PRJ-${Date.now()}`)},na=()=>{c.success("å•†åŠ¡åº”ç­”æ¨¡æ¿ä¸Šä¼ æˆåŠŸ")},ua=()=>{var e;if(De.value&&Re.value)return{url:Re.value.url||"",name:Re.value.filename||"åº”ç­”æ¨¡æ¿"};if(Be.value.templateFiles.length>0){const a=Be.value.templateFiles[0];return{url:a.url||(null==(e=a.response)?void 0:e.url)||"",name:a.name||"åº”ç­”æ¨¡æ¿"}}return null},da=()=>{const e=ua();if(!(null==e?void 0:e.url))return void c.warning("æ— æ³•è·å–æ–‡ä»¶è·¯å¾„");const a=(e=>{if(!e)return"";if(e.startsWith("http://")||e.startsWith("https://")||e.startsWith("/api/"))return e;let a=e;return a.startsWith("ai_tender_system/data/")&&(a=a.substring(22)),a.startsWith("outputs/")&&(a="download/"+a.substring(8)),`/api/files/serve/${a}`})(e.url),l=document.createElement("a");l.href=a+"?download=true",l.download=e.name,document.body.appendChild(l),l.click(),document.body.removeChild(l),c.success("æ–‡ä»¶ä¸‹è½½å·²å¼€å§‹")},ca=()=>{const e=ua();(null==e?void 0:e.url)?(Ze.value=e.url,ea.value=e.name,Ye.value=!0):c.warning("æ— æ³•è·å–æ–‡ä»¶è·¯å¾„")},pa=async()=>{var e;if(Be.value.projectId){Le.value=!0,Oe.value=0,Ae.value="",Me.value=null,Ge.value=!0,Qe.value='<h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1><p style="color: #909399;">AIæ­£åœ¨ç”Ÿæˆå†…å®¹ï¼Œè¯·ç¨å€™...</p>',setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100);try{Ae.value="æ­£åœ¨åŠ è½½é¡¹ç›®ä¿¡æ¯...\n";const a=(await W.getProject(Be.value.projectId)).data,l=null==(e=a.step1_data)?void 0:e.response_file_path;if(!l)throw new Error("æœªæ‰¾åˆ°å•†åŠ¡åº”ç­”æ¨¡æ¿æ–‡ä»¶è·¯å¾„ï¼Œè¯·å…ˆåœ¨æ ‡ä¹¦ç®¡ç†ä¸­ä¸Šä¼ æ¨¡æ¿");Ae.value+="æ­£åœ¨å¤„ç†å•†åŠ¡åº”ç­”æ–‡æ¡£...\n",Oe.value=30;const t=await ae.processBusinessResponse({company_id:a.company_id,project_name:a.project_name,tender_no:a.project_number||"",date_text:a.bidding_time||"",hitl_file_path:l,use_mcp:!0});Oe.value=80,Ae.value+="å¤„ç†å®Œæˆï¼Œæ­£åœ¨ç”Ÿæˆç»“æœ...\n";const s=t.data?t.data:t;if(!s.success)throw new Error(s.message||s.error||"å¤„ç†å¤±è´¥");Oe.value=100,Ae.value+=s.message+"\n",Me.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:s.stats||{},message:s.message},await ma(s.output_file),c.success("å•†åŠ¡åº”ç­”ç”Ÿæˆå®Œæˆï¼å¯ä»¥ç¼–è¾‘äº†"),s.output_file&&Be.value.projectId&&await We(Be.value.projectId,s.output_file,"business_response")}catch(a){Ae.value+=`\nâŒ é”™è¯¯: ${a.message}\n`,Ke.value&&Ke.value.appendContent(`<p style="color: red;">âŒ é”™è¯¯: ${a.message}</p>`),c.error(a.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{Le.value=!1,Oe.value<100&&(Oe.value=0)}}else c.warning("è¯·å…ˆé€‰æ‹©é¡¹ç›®")},ma=async e=>{try{Qe.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const a=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),l=await a.json();if(!l.success||!l.html_content)throw new Error(l.error||"è½¬æ¢å¤±è´¥");Qe.value=l.html_content,Ke.value&&Ke.value.setContent(l.html_content)}catch(a){Qe.value=`\n      <h1>ğŸ“„ å•†åŠ¡åº”ç­”æ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${a.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"ä¸‹è½½Wordæ–‡æ¡£æŸ¥çœ‹</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,c.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨ä¸‹è½½åŠŸèƒ½æˆ–æ‰‹åŠ¨è¾“å…¥")}},va=async e=>{var a,l;if(Be.value.projectId){Xe.value=!0;try{const t=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:Be.value.projectId,document_type:"business_response",original_file:null==(a=Me.value)?void 0:a.outputFile})}),s=await t.json();if(!s.success)throw new Error(s.error||"ä¿å­˜å¤±è´¥");Me.value={success:!0,outputFile:s.output_file,downloadUrl:s.download_url,stats:(null==(l=Me.value)?void 0:l.stats)||{},message:"æ–‡æ¡£å·²ä¿å­˜"},s.output_file&&await We(Be.value.projectId,s.output_file,"business_response")}catch(t){throw t}finally{Xe.value=!1}}else c.error("é¡¹ç›®IDæ— æ•ˆ")},_a=()=>{Me.value?Me.value.downloadUrl?Ye.value=!0:c.warning("æ–‡æ¡£åœ°å€æ— æ•ˆ"):c.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},fa=async()=>{var e;if(Me.value)try{const a=Me.value.downloadUrl,l=`å•†åŠ¡åº”ç­”-${(null==(e=f.value)?void 0:e.project_name)||"æ–‡æ¡£"}-${Date.now()}.docx`;await S(a,l),c.success("Wordæ–‡æ¡£ä¸‹è½½æˆåŠŸ")}catch(a){c.error(a.message||"æ–‡æ¡£ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}else c.warning("æš‚æ— æ–‡æ¡£å¯ä¸‹è½½")},ya=async()=>{var e;(null==(e=Me.value)?void 0:e.outputFile)?Be.value.projectId?await We(Be.value.projectId,Me.value.outputFile,"business_response"):c.error("é¡¹ç›®IDæ— æ•ˆ"):c.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},wa=e=>{if(!e)return"-";let a=e;try{a=decodeURIComponent(e)}catch{}const l=a.split("/");return l[l.length-1]||"-"},ha=async()=>{if(Be.value.projectId){ta.value=!0;try{const e=await fetch(`/api/business-files?project_id=${Be.value.projectId}`),a=await e.json();if(!a.success)throw new Error(a.error||"åŠ è½½å¤±è´¥");la.value=a.data||[]}catch(e){c.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{ta.value=!1}}else la.value=[]},ja=e=>{const a=["B","KB","MB","GB"];let l=e,t=0;for(;l>=1024&&t<a.length-1;)l/=1024,t++;return`${l.toFixed(1)} ${a[t]}`},ga=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}};return h(async()=>{var e;await Promise.all([Ee(),ia()]);const a=await Ue({onClear:()=>{Me.value=null,Ae.value="",Be.value.templateFiles=[],Be.value.authorizedPersonName="",Ge.value=!1,Qe.value="",De.value&&Se()},onDocumentsLoaded:e=>{e.templateFile&&Te(e,"templateFile"),e.businessResponseFile&&(Me.value=e.businessResponseFile,Ge.value=!1)}});a&&(Be.value.projectId=a,(null==(e=f.value)?void 0:e.authorized_person_name)&&(Be.value.authorizedPersonName=f.value.authorized_person_name))}),(e,y)=>{const w=_,h=v,q=a,W=l,B=L,H=K,J=t,ae=G,Ee=m,Ne=s,Ue=M,Te=X,We=Y,Oe=Q,Ae=O,Xe=A,ia=ee,ua=Z;return g(),j("div",le,[b(B,{class:"main-panel",shadow:"never"},{default:F(()=>{var e,a,l;return[I("div",te,[I("div",se,[y[11]||(y[11]=I("label",{class:"row-label"},"é€‰æ‹©é¡¹ç›®",-1)),b(h,{modelValue:Be.value.projectId,"onUpdate:modelValue":y[0]||(y[0]=e=>Be.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",clearable:"",onChange:ra,class:"row-select"},{default:F(()=>[(g(!0),j(C,null,z(V(p),e=>(g(),x(w,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),I("div",oe,[y[12]||(y[12]=I("label",{class:"row-label"},"åº”ç­”å…¬å¸",-1)),Be.value.projectId?(g(),x(q,{key:0,value:(null==(e=V(f))?void 0:e.company_name)||"-",disabled:"",class:"row-input"},null,8,["value"])):(g(),x(h,{key:1,modelValue:Be.value.companyId,"onUpdate:modelValue":y[1]||(y[1]=e=>Be.value.companyId=e),placeholder:"è¯·é€‰æ‹©å…¬å¸",filterable:"",class:"row-select"},{default:F(()=>[(g(!0),j(C,null,z(He.value,e=>(g(),x(w,{key:e.company_id,label:e.company_name,value:e.company_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))])]),I("div",ie,[I("div",re,[y[13]||(y[13]=I("label",{class:"row-label"},"è¢«æˆæƒäºº",-1)),b(q,{modelValue:Be.value.authorizedPersonName,"onUpdate:modelValue":y[2]||(y[2]=e=>Be.value.authorizedPersonName=e),placeholder:"è¯·è¾“å…¥è¢«æˆæƒäºº",class:"row-input"},null,8,["modelValue"])])]),Be.value.projectId?k("",!0):(g(),j("div",ne,[I("div",ue,[y[14]||(y[14]=I("label",{class:"row-label"},"é¡¹ç›®åç§°",-1)),b(q,{modelValue:Be.value.projectName,"onUpdate:modelValue":y[3]||(y[3]=e=>Be.value.projectName=e),placeholder:"æ–°é¡¹ç›®",class:"row-input"},null,8,["modelValue"])]),I("div",de,[y[15]||(y[15]=I("label",{class:"row-label"},"é¡¹ç›®ç¼–å·",-1)),b(q,{modelValue:Be.value.projectNumber,"onUpdate:modelValue":y[4]||(y[4]=e=>Be.value.projectNumber=e),placeholder:"PRJ-...",class:"row-input"},null,8,["modelValue"])])])),I("div",ce,[I("div",pe,[y[25]||(y[25]=I("label",{class:"row-label"},"åº”ç­”æ¨¡æ¿",-1)),V(De)?(g(),j("div",me,[y[19]||(y[19]=I("div",{class:"template-file-card__icon"},[I("i",{class:"bi bi-file-word"})],-1)),I("div",ve,[I("div",{class:"template-file-card__name",title:null==(a=V(Re))?void 0:a.filename},P((null==(l=V(Re))?void 0:l.filename)||"æœªçŸ¥æ–‡ä»¶"),9,_e)]),I("div",fe,[b(W,{size:"small",onClick:da},{default:F(()=>[...y[16]||(y[16]=[I("i",{class:"bi bi-download"},null,-1),E(" ä¸‹è½½ ",-1)])]),_:1}),b(W,{size:"small",onClick:ca},{default:F(()=>[...y[17]||(y[17]=[I("i",{class:"bi bi-eye"},null,-1),E(" é¢„è§ˆ ",-1)])]),_:1}),b(W,{size:"small",type:"danger",plain:"",onClick:V(Se)},{default:F(()=>[...y[18]||(y[18]=[I("i",{class:"bi bi-x-lg"},null,-1),E(" å–æ¶ˆ ",-1)])]),_:1},8,["onClick"])])])):Be.value.templateFiles.length>0?(g(),j("div",ye,[y[23]||(y[23]=I("div",{class:"template-file-card__icon"},[I("i",{class:"bi bi-file-word"})],-1)),I("div",we,[I("div",{class:"template-file-card__name",title:Be.value.templateFiles[0].name},P(Be.value.templateFiles[0].name),9,he)]),I("div",je,[b(W,{size:"small",onClick:da},{default:F(()=>[...y[20]||(y[20]=[I("i",{class:"bi bi-download"},null,-1),E(" ä¸‹è½½ ",-1)])]),_:1}),b(W,{size:"small",onClick:ca},{default:F(()=>[...y[21]||(y[21]=[I("i",{class:"bi bi-eye"},null,-1),E(" é¢„è§ˆ ",-1)])]),_:1}),b(W,{size:"small",type:"danger",plain:"",onClick:y[5]||(y[5]=e=>Be.value.templateFiles=[])},{default:F(()=>[...y[22]||(y[22]=[I("i",{class:"bi bi-x-lg"},null,-1),E(" å–æ¶ˆ ",-1)])]),_:1})])])):(g(),j("div",ge,[y[24]||(y[24]=I("span",{class:"placeholder-text"},"è¯·ä¸Šä¼ åº”ç­”æ¨¡æ¿",-1)),b(V(D),{modelValue:Be.value.templateFiles,"onUpdate:modelValue":y[6]||(y[6]=e=>Be.value.templateFiles=e),"http-request":oa,accept:".doc,.docx",limit:1,"max-size":100,"show-file-list":!1,"trigger-text":"é€‰æ‹©æ–‡ä»¶",onSuccess:na},null,8,["modelValue"])]))])]),I("div",be,[b(W,{type:"primary",size:"large",disabled:!Je.value,loading:Le.value,onClick:pa},{default:F(()=>[...y[26]||(y[26]=[E(" å¼€å§‹ç”Ÿæˆå•†åŠ¡åº”ç­” ",-1)])]),_:1},8,["disabled","loading"])])]}),_:1}),Ge.value?(g(),x(B,{key:0,class:"editor-section",shadow:"never"},{default:F(()=>[b(V($),{ref_key:"editorRef",ref:Ke,modelValue:Qe.value,"onUpdate:modelValue":y[7]||(y[7]=e=>Qe.value=e),title:"å•†åŠ¡åº”ç­”æ–‡æ¡£",streaming:Le.value,height:1e3,onSave:va,onPreview:_a,onExport:fa},null,8,["modelValue","streaming"])]),_:1})):k("",!0),Ge.value&&Me.value?(g(),x(Xe,{key:1,modelValue:aa.value,"onUpdate:modelValue":y[8]||(y[8]=e=>aa.value=e),class:"result-collapse"},{default:F(()=>[b(Ae,{name:"result",title:"ğŸ“„ æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"},{default:F(()=>[b(B,{class:"result-section",shadow:"never"},{header:F(()=>[I("div",xe,[I("span",null,P(Me.value.isHistory?"ğŸ“„ å†å²åº”ç­”æ–‡ä»¶":"âœ… ç”Ÿæˆç»“æœ"),1),I("div",ke,[b(W,{type:"primary",icon:V(i),onClick:_a},{default:F(()=>[...y[27]||(y[27]=[E(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),b(W,{type:"success",icon:V(r),onClick:fa},{default:F(()=>[...y[28]||(y[28]=[E(" ä¸‹è½½Wordæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),V(qe)?(g(),x(H,{key:1,type:"success",size:"large"},{default:F(()=>[...y[30]||(y[30]=[E(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(g(),x(W,{key:0,type:"info",icon:V(n),loading:V($e),onClick:ya},{default:F(()=>[...y[29]||(y[29]=[E(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),b(W,{type:"primary",icon:V(u),onClick:pa},{default:F(()=>[...y[31]||(y[31]=[E(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:F(()=>{var e,a,l,t;return[I("div",Fe,[b(J,{type:Me.value.isHistory?"info":"success",title:Me.value.message,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["type","title"]),b(V(T),{title:"å¤„ç†ç»Ÿè®¡",stats:Me.value.stats},null,8,["stats"]),(null==(a=null==(e=Me.value.stats)?void 0:e.qualifications_details)?void 0:a.length)>0?(g(),j("div",Ie,[y[34]||(y[34]=I("h4",null,"ğŸ“‹ èµ„è´¨å¤„ç†è¯¦æƒ…",-1)),b(Ue,{data:Me.value.stats.qualifications_details,border:"",stripe:"",style:{"margin-top":"16px"}},{default:F(()=>[b(ae,{type:"index",label:"#",width:"60",align:"center"}),b(ae,{prop:"display_title",label:"èµ„è´¨åç§°","min-width":"200"},{default:F(({row:e})=>[I("div",null,[I("strong",null,P(e.display_title),1),"id_card"===e.resource_type?(g(),x(H,{key:0,type:"info",size:"small",style:{"margin-left":"8px"}},{default:F(()=>[...y[32]||(y[32]=[E(" èº«ä»½è¯ ",-1)])]),_:1})):k("",!0)])]),_:1}),b(ae,{prop:"qual_name",label:"ç±»åˆ«",width:"120",align:"center"},{default:F(({row:e})=>{return[b(H,{type:(a=e.qual_name,{"åŸºæœ¬èµ„è´¨":"danger","ä¿¡ç”¨è¯æ˜":"success","èº«ä»½è¯æ˜":"primary","è´¢åŠ¡æ–‡ä»¶":"warning","ä¿¡æ¯å®‰å…¨":"info","ç”µä¿¡èµ„è´¨":"warning","ITæœåŠ¡":"info","è´¨é‡ç®¡ç†":"success","è½¯ä»¶èƒ½åŠ›":"info","è¡Œä¸šèµ„è´¨":"warning","çŸ¥è¯†äº§æƒ":""}[a]||""),size:"small"},{default:F(()=>[E(P(e.qual_name),1)]),_:2},1032,["type"])];var a}),_:1}),b(ae,{prop:"total_pages",label:"å›¾ç‰‡æ•°",width:"100",align:"center"},{default:F(({row:e})=>[b(Ee,{type:"primary",size:"large"},{default:F(()=>[I("strong",null,P(e.total_pages),1),E(" "+P("id_card"===e.resource_type?"é¢":"é¡µ"),1)]),_:2},1024)]),_:1}),b(ae,{label:"çŠ¶æ€",width:"80",align:"center"},{default:F(()=>[b(Ne,{color:"#67c23a",size:20},{default:F(()=>[b(V(o))]),_:1})]),_:1})]),_:1},8,["data"]),(null==(t=null==(l=Me.value.stats)?void 0:l.missing_qualifications)?void 0:t.length)>0?(g(),x(J,{key:0,type:"warning",closable:!1,style:{"margin-top":"16px"}},{title:F(()=>[...y[33]||(y[33]=[E(" ä»¥ä¸‹èµ„è´¨æ¨¡æ¿æœ‰å ä½ç¬¦ä½†æœªä¸Šä¼ æ–‡ä»¶ ",-1)])]),default:F(()=>[I("ul",Ce,[(g(!0),j(C,null,z(Me.value.stats.missing_qualifications,(e,a)=>(g(),j("li",{key:a},P(e.qual_name||e.qual_key),1))),128))])]),_:1})):k("",!0)])):k("",!0),I("div",ze,[y[35]||(y[35]=I("h4",null,"ç”Ÿæˆæ–‡ä»¶",-1)),b(Oe,{column:2,border:""},{default:F(()=>[b(Te,{label:"æ–‡ä»¶å"},{default:F(()=>[E(P(wa(Me.value.outputFile)),1)]),_:1}),b(Te,{label:"ä¸‹è½½åœ°å€"},{default:F(()=>[b(We,{href:Me.value.downloadUrl,type:"primary"},{default:F(()=>[E(P(wa(Me.value.downloadUrl)),1)]),_:1},8,["href"])]),_:1})]),_:1})])])]}),_:1})]),_:1})]),_:1},8,["modelValue"])):k("",!0),Be.value.projectId?(g(),x(Xe,{key:2,modelValue:sa.value,"onUpdate:modelValue":y[9]||(y[9]=e=>sa.value=e),class:"history-collapse"},{default:F(()=>[b(Ae,{name:"history"},{title:F(()=>[I("div",Ve,[I("span",null,"ğŸ“‚ æœ¬é¡¹ç›®å†å²æ–‡ä»¶ ("+P(la.value.length)+")",1),sa.value?(g(),x(W,{key:0,type:"primary",size:"small",loading:ta.value,onClick:U(ha,["stop"]),style:{"margin-left":"16px"}},{default:F(()=>[...y[36]||(y[36]=[E(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):k("",!0)])]),default:F(()=>[b(B,{shadow:"never",style:{border:"none"}},{default:F(()=>[N((g(),x(Ue,{data:la.value,border:"",stripe:"","max-height":"400"},{default:F(()=>[b(ae,{type:"index",label:"åºå·",width:"60"}),b(ae,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:F(({row:e})=>[I("div",Pe,[b(Ne,null,{default:F(()=>[b(V(d))]),_:1}),I("span",null,P(e.filename),1)])]),_:1}),b(ae,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:F(({row:e})=>[E(P(ja(e.size)),1)]),_:1}),b(ae,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:F(({row:e})=>[E(P(ga(e.process_time)),1)]),_:1}),b(ae,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:F(({row:e})=>[b(W,{type:"primary",size:"small",onClick:a=>{var l;(l=e).file_path?(Ze.value=l.file_path,ea.value=l.filename,Ye.value=!0):c.warning("æ— æ³•è·å–æ–‡ä»¶ä¿¡æ¯")}},{default:F(()=>[...y[37]||(y[37]=[E(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),b(W,{type:"success",size:"small",onClick:a=>(async e=>{try{if(!e.download_url)return void c.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const a=e.filename||"å•†åŠ¡åº”ç­”.docx";S(e.download_url,a),c.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(a){c.error(a.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}})(e)},{default:F(()=>[...y[38]||(y[38]=[E(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[ua,ta.value]]),ta.value||0!==la.value.length?k("",!0):(g(),x(ia,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"])):k("",!0),b(V(R),{modelValue:Ye.value,"onUpdate:modelValue":y[10]||(y[10]=e=>Ye.value=e),"file-url":Ze.value,"file-name":ea.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-d592dab8"]]);export{Ee as default};
