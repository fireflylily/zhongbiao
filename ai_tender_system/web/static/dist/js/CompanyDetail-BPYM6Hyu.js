import{aL as e,bI as a,av as l,be as t,aM as i,aO as o,aZ as n,aV as s,aT as u,bO as d,bL as r,bM as c,b1 as p,b0 as _,aX as m,c$ as f,a_ as v,aw as y,aS as g,aR as h,aU as b,aY as k,aN as V,cY as w,b8 as z,bj as x,cX as q,bl as C,bm as j,bc as I,aQ as U,bf as E,cg as D,ca as $,cN as M,et as P,ch as S,eu as F,c7 as T,c_ as R,d0 as N,bG as Q,cb as O,e8 as L,ev as B}from"./index.js";/* empty css                */import{a as J,E as Y}from"./el-tab-pane-ocNzF7zx.js";/* empty css               */import{L as G}from"./Loading-Bv6brMA8.js";/* empty css                                                                          */import"./DocumentPreview.vue_vue_type_style_index_0_scoped_056f7814_lang-CJRCEOay.js";/* empty css                *//* empty css                             *//* empty css                    *//* empty css                     *//* empty css                */import{c as A}from"./company-CDLBTJzM.js";import{E as X}from"./el-input-number-Bu-msyPk.js";import{E as K,a as W}from"./el-select-2EPexRGo.js";import{E as Z}from"./el-date-picker-panel-9yKUIqOh.js";import{C as H}from"./Card-BT46z3St.js";import{a as ee,E as ae}from"./index-B-vavaW6.js";import{E as le}from"./el-text-ChDgdVoc.js";import{D as te}from"./DocumentUploader-Cjg8Ve8A.js";import{E as ie}from"./index-5dFIUF4u.js";import{E as oe}from"./index-D2m2pKqu.js";import{a as ne,E as se}from"./index-l-UpVxRy.js";import{E as ue}from"./index-DG0KKHwq.js";import"./raf-CSK_qRxG.js";import"./strings-CAibmfqB.js";import"./toNumber-D1BjzJ77.js";import"./index-Czx3rhy5.js";import"./index-BkTUUs11.js";import"./_baseIteratee-C8Rg9s0Y.js";import"./advancedFormat-BecPpoif.js";import"./imageCompressor-CTkRt5bg.js";import"./index-GkPVVSWW.js";import"./cloneDeep-BA-8E20e.js";import"./flatMap-B4N5JHLf.js";import"./map-BZ8YNrGe.js";import"./_baseEach-CWxoirs-.js";import"./index-CDJvaTFC.js";const de={class:"basic-info-tab"},re=v(e({__name:"BasicInfoTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:v}){const y=e,g=v,{success:h,error:b}=a(),k=l(),V=l(!1),w=l({company_name:"",establish_date:"",legal_representative:"",legal_representative_position:"",legal_representative_gender:"",legal_representative_age:void 0,social_credit_code:"",registered_capital:"",company_type:"",registered_address:"",fixed_phone:"",fax:"",postal_code:"",email:"",business_scope:"",description:""}),z={company_name:[{required:!0,message:"请输入企业名称",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],postal_code:[{pattern:/^\d{6}$/,message:"邮政编码必须是6位数字",trigger:"blur"}]};t(()=>y.companyData,e=>{e&&(w.value={company_name:e.company_name||"",establish_date:e.establish_date||"",legal_representative:e.legal_representative||"",legal_representative_position:e.legal_representative_position||"",legal_representative_gender:e.legal_representative_gender||"",legal_representative_age:e.legal_representative_age||void 0,social_credit_code:e.social_credit_code||"",registered_capital:e.registered_capital||"",company_type:e.company_type||"",registered_address:e.registered_address||"",fixed_phone:e.fixed_phone||"",fax:e.fax||"",postal_code:e.postal_code||"",email:e.email||"",business_scope:e.business_scope||"",description:e.description||""})},{immediate:!0,deep:!0});const x=async()=>{k.value&&await k.value.validate(async e=>{if(e){V.value=!0;try{(await A.updateCompany(y.companyId,{companyName:w.value.company_name,establishDate:w.value.establish_date,legalRepresentative:w.value.legal_representative,legalRepresentativePosition:w.value.legal_representative_position,legalRepresentativeGender:w.value.legal_representative_gender,legalRepresentativeAge:w.value.legal_representative_age,socialCreditCode:w.value.social_credit_code,registeredCapital:w.value.registered_capital,companyType:w.value.company_type,registeredAddress:w.value.registered_address,fixedPhone:w.value.fixed_phone,fax:w.value.fax,postalCode:w.value.postal_code,email:w.value.email,businessScope:w.value.business_scope,companyDescription:w.value.description})).success&&(h("保存成功","基础信息已更新"),g("update"))}catch(a){b("保存失败",a instanceof Error?a.message:"未知错误")}finally{V.value=!1}}})};return(e,a)=>{const l=c,t=r,v=ae,y=Z,g=ee,h=W,b=K,q=X,C=m,j=p,I=d;return o(),i("div",de,[n(s(H),{title:"基础信息"},{default:u(()=>[n(I,{ref_key:"formRef",ref:k,model:w.value,rules:z,"label-width":"140px",class:"basic-form"},{default:u(()=>[n(g,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"企业名称",prop:"company_name"},{default:u(()=>[n(l,{modelValue:w.value.company_name,"onUpdate:modelValue":a[0]||(a[0]=e=>w.value.company_name=e),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"成立日期",prop:"establish_date"},{default:u(()=>[n(y,{modelValue:w.value.establish_date,"onUpdate:modelValue":a[1]||(a[1]=e=>w.value.establish_date=e),type:"date",placeholder:"选择日期",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"法定代表人",prop:"legal_representative"},{default:u(()=>[n(l,{modelValue:w.value.legal_representative,"onUpdate:modelValue":a[2]||(a[2]=e=>w.value.legal_representative=e),placeholder:"请输入法定代表人"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"法定代表人职务",prop:"legal_representative_position"},{default:u(()=>[n(l,{modelValue:w.value.legal_representative_position,"onUpdate:modelValue":a[3]||(a[3]=e=>w.value.legal_representative_position=e),placeholder:"请输入职务"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"法定代表人性别",prop:"legal_representative_gender"},{default:u(()=>[n(b,{modelValue:w.value.legal_representative_gender,"onUpdate:modelValue":a[4]||(a[4]=e=>w.value.legal_representative_gender=e),placeholder:"请选择性别",style:{width:"100%"}},{default:u(()=>[n(h,{label:"男",value:"男"}),n(h,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"法定代表人年龄",prop:"legal_representative_age"},{default:u(()=>[n(q,{modelValue:w.value.legal_representative_age,"onUpdate:modelValue":a[5]||(a[5]=e=>w.value.legal_representative_age=e),min:18,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"统一社会信用代码",prop:"social_credit_code"},{default:u(()=>[n(l,{modelValue:w.value.social_credit_code,"onUpdate:modelValue":a[6]||(a[6]=e=>w.value.social_credit_code=e),placeholder:"请输入统一社会信用代码"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"注册资本",prop:"registered_capital"},{default:u(()=>[n(l,{modelValue:w.value.registered_capital,"onUpdate:modelValue":a[7]||(a[7]=e=>w.value.registered_capital=e),placeholder:"如：1000万元"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"企业类型",prop:"company_type"},{default:u(()=>[n(l,{modelValue:w.value.company_type,"onUpdate:modelValue":a[8]||(a[8]=e=>w.value.company_type=e),placeholder:"如：有限责任公司"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"注册地址",prop:"registered_address"},{default:u(()=>[n(l,{modelValue:w.value.registered_address,"onUpdate:modelValue":a[9]||(a[9]=e=>w.value.registered_address=e),placeholder:"请输入注册地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"联系电话",prop:"fixed_phone"},{default:u(()=>[n(l,{modelValue:w.value.fixed_phone,"onUpdate:modelValue":a[10]||(a[10]=e=>w.value.fixed_phone=e),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"传真",prop:"fax"},{default:u(()=>[n(l,{modelValue:w.value.fax,"onUpdate:modelValue":a[11]||(a[11]=e=>w.value.fax=e),placeholder:"请输入传真"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"邮政编码",prop:"postal_code"},{default:u(()=>[n(l,{modelValue:w.value.postal_code,"onUpdate:modelValue":a[12]||(a[12]=e=>w.value.postal_code=e),placeholder:"请输入邮政编码",maxlength:"6"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"电子邮箱",prop:"email"},{default:u(()=>[n(l,{modelValue:w.value.email,"onUpdate:modelValue":a[13]||(a[13]=e=>w.value.email=e),placeholder:"请输入电子邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,null,{default:u(()=>[n(v,{span:24},{default:u(()=>[n(t,{label:"经营范围",prop:"business_scope"},{default:u(()=>[n(l,{modelValue:w.value.business_scope,"onUpdate:modelValue":a[14]||(a[14]=e=>w.value.business_scope=e),type:"textarea",rows:5,placeholder:"请输入经营范围"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,null,{default:u(()=>[n(v,{span:24},{default:u(()=>[n(t,{label:"企业简介",prop:"description"},{default:u(()=>[n(l,{modelValue:w.value.description,"onUpdate:modelValue":a[15]||(a[15]=e=>w.value.description=e),type:"textarea",rows:5,placeholder:"请输入企业简介"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(g,null,{default:u(()=>[n(v,{span:24},{default:u(()=>[n(t,null,{default:u(()=>[n(j,{type:"primary",loading:V.value,onClick:x},{default:u(()=>[n(C,null,{default:u(()=>[n(s(f))]),_:1}),a[16]||(a[16]=_(" 保存基础信息 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),[["__scopeId","data-v-cf1705e1"]]),ce={class:"card-header"},pe={class:"qual-info"},_e={class:"qual-name"},me={class:"badges"},fe={key:0,class:"file-status"},ve={key:0,class:"single-file"},ye={class:"file-item"},ge={class:"file-details"},he={class:"file-name"},be={class:"file-meta"},ke={class:"file-actions"},Ve={key:1,class:"multiple-files"},we={class:"file-details"},ze={class:"file-name"},xe={class:"file-meta"},qe={class:"file-actions"},Ce={key:1,class:"no-file"},je={class:"card-footer"},Ie={class:"upload-section"},Ue={class:"upload-tips"},Ee=v(e({__name:"QualificationCard",props:{qualification:{},fileInfo:{},isCustom:{type:Boolean},onUpload:{type:Function}},emits:["upload","download","delete","remove-custom"],setup(e,{emit:a}){const t=e,d=a,r=l(),c=y(()=>!!t.fileInfo&&(t.fileInfo.allow_multiple_files?t.fileInfo.files&&t.fileInfo.files.length>0:!!t.fileInfo.original_filename)),f=y(()=>{var e,a;return(null==(e=t.fileInfo)?void 0:e.allow_multiple_files)&&(null==(a=t.fileInfo)?void 0:a.files)}),v=y(()=>"financial_audit_report"===t.qualification.key?".pdf,.xls,.xlsx,.jpg,.jpeg,.png":".pdf,.jpg,.jpeg,.png"),E=y(()=>{const e=t.qualification.key;return"business_license"===e?"license":e.includes("id")||"legal_id_front"===e||"legal_id_back"===e?"id_card":e.includes("seal")?"seal":e.includes("iso")||e.includes("cmmi")||e.includes("certificate")||e.includes("qualification")||e.includes("认证")?"qualification":"default"}),D=async e=>{const{file:a,onSuccess:l,onError:i}=e;try{t.onUpload?await t.onUpload(a):d("upload",a),l({success:!0})}catch(o){i(o)}},$=()=>{d("download",t.qualification.key)},M=()=>{d("delete",t.qualification.key)},P=e=>{if(!e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,a)*100)/100+" "+["B","KB","MB","GB"][a]},S=e=>{if(!e)return"";return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})};return(a,l)=>{const y=m,F=ie,T=p,R=le,N=oe;return o(),g(N,{class:U(["qualification-card",{required:e.qualification.required,"has-file":c.value}])},{default:u(()=>[h("div",ce,[h("div",pe,[n(y,{class:"qual-icon",size:20},{default:u(()=>[(o(),g(b(e.qualification.icon)))]),_:1}),h("span",_e,k(e.qualification.name),1)]),h("div",me,[e.qualification.required?(o(),g(F,{key:0,type:"warning",size:"small"},{default:u(()=>[...l[1]||(l[1]=[_("必需",-1)])]),_:1})):V("",!0),e.qualification.allowMultiple?(o(),g(F,{key:1,type:"info",size:"small"},{default:u(()=>[n(y,null,{default:u(()=>[n(s(w))]),_:1}),l[2]||(l[2]=_(" 多文件 ",-1))]),_:1})):V("",!0)])]),c.value?(o(),i("div",fe,[f.value?(o(),i("div",Ve,[(o(!0),i(C,null,j(e.fileInfo.files,e=>(o(),i("div",{key:e.qualification_id,class:"file-item"},[n(y,{class:"file-icon"},{default:u(()=>[n(s(z))]),_:1}),h("div",we,[h("div",ze,k(e.original_filename),1),h("div",xe,[h("span",null,k(P(e.file_size)),1),l[4]||(l[4]=h("span",{class:"divider"},"•",-1)),h("span",null,k(S(e.upload_time)),1)])]),h("div",qe,[n(T,{text:"",type:"primary",size:"small",onClick:a=>{return l=e.qualification_id,void d("download",t.qualification.key,l);var l}},{default:u(()=>[n(y,null,{default:u(()=>[n(s(x))]),_:1})]),_:1},8,["onClick"]),n(T,{text:"",type:"danger",size:"small",onClick:a=>{return l=e.qualification_id,void d("delete",t.qualification.key,l);var l}},{default:u(()=>[n(y,null,{default:u(()=>[n(s(q))]),_:1})]),_:1},8,["onClick"])])]))),128))])):(o(),i("div",ve,[h("div",ye,[n(y,{class:"file-icon"},{default:u(()=>[n(s(z))]),_:1}),h("div",ge,[h("div",he,k(e.fileInfo.original_filename),1),h("div",be,[h("span",null,k(P(e.fileInfo.file_size)),1),l[3]||(l[3]=h("span",{class:"divider"},"•",-1)),h("span",null,k(S(e.fileInfo.upload_time)),1)])]),h("div",ke,[n(T,{text:"",type:"primary",size:"small",onClick:$},{default:u(()=>[n(y,null,{default:u(()=>[n(s(x))]),_:1})]),_:1}),n(T,{text:"",type:"danger",size:"small",onClick:M},{default:u(()=>[n(y,null,{default:u(()=>[n(s(q))]),_:1})]),_:1})])])]))])):(o(),i("div",Ce,[n(R,{type:"info",size:"small"},{default:u(()=>[...l[5]||(l[5]=[_("未上传文件",-1)])]),_:1})])),h("div",je,[h("div",Ie,[n(s(te),{ref_key:"uploaderRef",ref:r,accept:v.value,multiple:e.qualification.allowMultiple,"show-file-list":!1,"http-request":D,"max-size":20,"auto-compress-image":!0,"image-type":E.value},{trigger:u(()=>[n(T,{type:"primary",size:"small"},{default:u(()=>[n(y,null,{default:u(()=>[n(s(I))]),_:1}),_(" "+k(e.qualification.allowMultiple?"批量上传":"上传文件"),1)]),_:1})]),_:1},8,["accept","multiple","image-type"]),e.isCustom?(o(),g(T,{key:0,type:"danger",size:"small",onClick:l[0]||(l[0]=e=>a.$emit("remove-custom"))},{default:u(()=>[n(y,null,{default:u(()=>[n(s(q))]),_:1}),l[6]||(l[6]=_(" 移除 ",-1))]),_:1})):V("",!0)]),h("div",Ue,[n(R,{type:"info",size:"small"},{default:u(()=>[...l[7]||(l[7]=[_(" 支持JPG、PNG、PDF格式 ",-1),h("span",{class:"pdf-tip"},"（PDF将自动转换为图片）",-1)])]),_:1})])])]),_:1},8,["class"])}}}),[["__scopeId","data-v-1923de96"]]),De={class:"qualification-tab"},$e={key:1},Me={class:"qualification-category"},Pe={class:"category-title text-secondary"},Se=v(e({__name:"QualificationTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:t}){const f=e,v=t,{success:y,error:b}=a(),w=l(!1),z=l({}),x=l([]),q=l(!1),I=l({name:""}),P=[{key:"basic",name:"基本证件资质",color:"primary"},{key:"iso",name:"ISO体系认证",color:"success"},{key:"credit",name:"信用资质证明",color:"info"},{key:"industry",name:"行业专业资质",color:"danger"}],S=[{key:"business_license",name:"营业执照",icon:"Document",category:"basic",required:!0},{key:"legal_id_front",name:"法人身份证(正面)",icon:"CreditCard",category:"basic",required:!0},{key:"legal_id_back",name:"法人身份证(反面)",icon:"CreditCard",category:"basic",required:!0},{key:"bank_account_permit",name:"银行开户许可证",icon:"CreditCard",category:"basic"},{key:"tax_registration",name:"税务登记证",icon:"DocumentChecked",category:"basic"},{key:"iso9001",name:"ISO 9001质量管理体系认证",icon:"Medal",category:"iso"},{key:"iso14001",name:"ISO 14001环境管理体系认证",icon:"Medal",category:"iso"},{key:"iso27001",name:"ISO 27001信息安全管理体系认证",icon:"Lock",category:"iso"},{key:"iso20000",name:"ISO 20000 IT服务管理体系认证",icon:"Monitor",category:"iso"},{key:"dishonest_executor",name:"失信被执行人名单（信用中国）",icon:"WarningFilled",category:"credit"},{key:"tax_violation_check",name:"重大税收违法案件当事人名单（信用中国）",icon:"WarningFilled",category:"credit"},{key:"gov_procurement_creditchina",name:"政府采购严重违法失信（信用中国）",icon:"Flag",category:"credit"},{key:"gov_procurement_ccgp",name:"政府采购严重违法失信行为信息记录（政府采购网）",icon:"CircleCheck",category:"credit"},{key:"basic_telecom_permit",name:"基础电信业务许可证",icon:"PhoneFilled",category:"industry"},{key:"value_added_telecom_permit",name:"增值电信业务许可证",icon:"PhoneFilled",category:"industry"},{key:"software_copyright",name:"软件著作权登记证书",icon:"Document",category:"industry",allowMultiple:!0},{key:"patent_certificate",name:"专利证书",icon:"TrophyBase",category:"industry",allowMultiple:!0},{key:"high_tech",name:"高新技术企业证书",icon:"Star",category:"industry"},{key:"software_enterprise",name:"软件企业认定证书",icon:"Monitor",category:"industry"},{key:"cmmi",name:"CMMI成熟度等级证书",icon:"Trophy",category:"industry"}],F=async()=>{w.value=!0;try{const e=await A.getCompanyQualifications(f.companyId);e.success&&e.data&&(z.value=e.data)}catch(e){b("加载失败",e instanceof Error?e.message:"未知错误")}finally{w.value=!1}},T=e=>a=>(async(e,a)=>{const l=S.find(a=>a.key===e)||x.value.find(a=>a.key===e);try{const t=await A.uploadQualification(f.companyId,e,a,{});if(!t.success)throw new Error(t.message||"上传失败");y("上传成功",`${(null==l?void 0:l.name)||"资质文件"}上传成功`),await F(),v("update")}catch(t){const e=t instanceof Error?t.message:"未知错误";throw b("上传失败",e),t}})(e,a),R=async(e,a)=>{try{a?await A.downloadQualification(a,""):window.open(`/api/companies/${f.companyId}/qualifications/${e}/download`)}catch(l){b("下载失败",l instanceof Error?l.message:"未知错误")}},N=async(e,a)=>{try{if(!confirm("确定要删除此资质文件吗？"))return;if(a)await A.deleteQualification(a);else{if(!(await fetch(`/api/companies/${f.companyId}/qualifications/${e}`,{method:"DELETE"})).ok)throw new Error("删除失败")}y("删除成功","资质文件已删除"),await F(),v("update")}catch(l){b("删除失败",l instanceof Error?l.message:"未知错误")}},Q=()=>{I.value.name="",q.value=!0},O=()=>{if(!I.value.name.trim())return void b("错误","请输入资质名称");const e=`custom_${Date.now()}`;x.value.push({key:e,name:I.value.name.trim(),icon:"Document",category:"custom"}),q.value=!1,y("添加成功","自定义资质已添加")};return E(()=>{F()}),(e,a)=>{const l=m,t=ae,f=ee,v=p,b=c,E=r,F=d,L=$;return o(),i("div",De,[n(s(H),{title:"资质信息管理"},{default:u(()=>[w.value?(o(),g(s(G),{key:0,text:"加载资质信息..."})):(o(),i("div",$e,[(o(),i(C,null,j(P,e=>h("div",{key:e.key,class:"qualification-category"},[h("h6",{class:U(["category-title",`text-${e.color}`])},[n(l,null,{default:u(()=>[n(s(M))]),_:1}),_(" "+k(e.name),1)],2),n(f,{gutter:16},{default:u(()=>{return[(o(!0),i(C,null,j((a=e.key,S.filter(e=>e.category===a)),e=>(o(),g(t,{key:e.key,span:12},{default:u(()=>[n(Ee,{qualification:e,"file-info":z.value[e.key],"on-upload":T(e.key),onDownload:R,onDelete:N},null,8,["qualification","file-info","on-upload"])]),_:2},1024))),128))];var a}),_:2},1024)])),64)),h("div",Me,[h("h6",Pe,[n(l,null,{default:u(()=>[n(s(D))]),_:1}),a[3]||(a[3]=_(" 自定义资质 ",-1))]),n(v,{type:"primary",onClick:Q},{default:u(()=>[n(l,null,{default:u(()=>[n(s(D))]),_:1}),a[4]||(a[4]=_(" 添加自定义资质 ",-1))]),_:1}),x.value.length>0?(o(),g(f,{key:0,gutter:16,class:"mt-3"},{default:u(()=>[(o(!0),i(C,null,j(x.value,(e,a)=>(o(),g(t,{key:e.key,span:12},{default:u(()=>[n(Ee,{qualification:e,"file-info":z.value[e.key],"is-custom":!0,"on-upload":T(e.key),onDownload:R,onDelete:N,onRemoveCustom:e=>(e=>{confirm("确定要移除此自定义资质吗？")&&(x.value.splice(e,1),y("移除成功","自定义资质已移除"))})(a)},null,8,["qualification","file-info","on-upload","onRemoveCustom"])]),_:2},1024))),128))]),_:1})):V("",!0)])]))]),_:1}),n(L,{modelValue:q.value,"onUpdate:modelValue":a[2]||(a[2]=e=>q.value=e),title:"添加自定义资质",width:"400px"},{footer:u(()=>[n(v,{onClick:a[1]||(a[1]=e=>q.value=!1)},{default:u(()=>[...a[5]||(a[5]=[_("取消",-1)])]),_:1}),n(v,{type:"primary",onClick:O},{default:u(()=>[...a[6]||(a[6]=[_("确定",-1)])]),_:1})]),default:u(()=>[n(F,{model:I.value,"label-width":"100px"},{default:u(()=>[n(E,{label:"资质名称"},{default:u(()=>[n(b,{modelValue:I.value.name,"onUpdate:modelValue":a[0]||(a[0]=e=>I.value.name=e),placeholder:"请输入资质名称",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d0a8e1b6"]]),Fe={class:"personnel-tab"},Te={class:"attachments-grid"},Re={class:"attachment-item"},Ne={class:"attachment-header"},Qe={key:0,class:"file-info"},Oe={class:"file-name"},Le={class:"file-actions"},Be={key:1,class:"no-file"},Je={class:"attachment-item"},Ye={class:"attachment-header"},Ge={key:0,class:"file-info"},Ae={class:"file-name"},Xe={class:"file-actions"},Ke={key:1,class:"no-file"},We={class:"attachment-item"},Ze={class:"attachment-header"},He={key:0,class:"file-info"},ea={class:"file-name"},aa={class:"file-actions"},la={key:1,class:"no-file"},ta={class:"attachment-item"},ia={class:"attachment-header"},oa={key:0,class:"file-info"},na={class:"file-name"},sa={class:"file-actions"},ua={key:1,class:"no-file"},da=v(e({__name:"PersonnelTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:v}){const y=e,g=v,{success:b,error:V}=a(),w=l(),C=l(!1),j=l({authorized_person_name:"",authorized_person_id:"",authorized_person_gender:"",authorized_person_age:void 0,authorized_person_position:"",authorized_person_title:""}),U=l({id_card_front:null,id_card_back:null,manager_resume:null,social_security:null}),D={authorized_person_id:[{pattern:/^[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/,message:"请输入正确的身份证号",trigger:"blur"}]};t(()=>y.companyData,e=>{e&&(j.value={authorized_person_name:e.authorized_person_name||"",authorized_person_id:e.authorized_person_id||"",authorized_person_gender:e.authorized_person_gender||"",authorized_person_age:e.authorized_person_age||void 0,authorized_person_position:e.authorized_person_position||"",authorized_person_title:e.authorized_person_title||""})},{immediate:!0,deep:!0});const $=async()=>{w.value&&await w.value.validate(async e=>{if(e){C.value=!0;try{(await A.updateCompany(y.companyId,{authorizedPersonName:j.value.authorized_person_name,authorizedPersonId:j.value.authorized_person_id,authorizedPersonGender:j.value.authorized_person_gender,authorizedPersonAge:j.value.authorized_person_age,authorizedPersonPosition:j.value.authorized_person_position,authorizedPersonTitle:j.value.authorized_person_title})).success&&(b("保存成功","被授权人信息已更新"),g("update"))}catch(a){V("保存失败",a instanceof Error?a.message:"未知错误")}finally{C.value=!1}}})},M=e=>async a=>{const{file:l,onSuccess:t,onError:i}=a;try{const a=await A.uploadQualification(y.companyId,e,l,{});if(!a.success)throw new Error(a.error||"上传失败");b("上传成功","附件上传成功"),N(),g("update"),t(a)}catch(o){const e=o instanceof Error?o.message:"未知错误";V("上传失败",e),i(o)}},T=e=>{window.open(`/api/companies/${y.companyId}/qualifications/${e}/download`)},R=async e=>{if(confirm("确定要删除此附件吗？"))try{if(!(await fetch(`/api/companies/${y.companyId}/qualifications/${e}`,{method:"DELETE"})).ok)throw new Error("删除失败");b("删除成功","附件已删除"),N(),g("update")}catch(a){V("删除失败",a instanceof Error?a.message:"未知错误")}},N=async()=>{try{const e=await A.getCompanyQualifications(y.companyId);if(e.success&&e.data){const a=e.data;U.value={id_card_front:a.id_card_front?{name:a.id_card_front.original_filename}:null,id_card_back:a.id_card_back?{name:a.id_card_back.original_filename}:null,manager_resume:a.manager_resume?{name:a.manager_resume.original_filename}:null,social_security:a.social_security?{name:a.social_security.original_filename}:null}}}catch(e){}};return E(()=>{N()}),(e,a)=>{const l=c,t=r,v=ae,y=ee,g=W,b=K,V=X,E=m,N=p,Q=d;return o(),i("div",Fe,[n(s(H),{title:"被授权人基本信息"},{default:u(()=>[n(Q,{ref_key:"formRef",ref:w,model:j.value,rules:D,"label-width":"140px",class:"personnel-form"},{default:u(()=>[n(y,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"姓名",prop:"authorized_person_name"},{default:u(()=>[n(l,{modelValue:j.value.authorized_person_name,"onUpdate:modelValue":a[0]||(a[0]=e=>j.value.authorized_person_name=e),placeholder:"请输入被授权人姓名"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"身份证号",prop:"authorized_person_id"},{default:u(()=>[n(l,{modelValue:j.value.authorized_person_id,"onUpdate:modelValue":a[1]||(a[1]=e=>j.value.authorized_person_id=e),placeholder:"请输入身份证号",maxlength:"18"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(y,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"性别",prop:"authorized_person_gender"},{default:u(()=>[n(b,{modelValue:j.value.authorized_person_gender,"onUpdate:modelValue":a[2]||(a[2]=e=>j.value.authorized_person_gender=e),placeholder:"请选择性别",style:{width:"100%"}},{default:u(()=>[n(g,{label:"男",value:"男"}),n(g,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"年龄",prop:"authorized_person_age"},{default:u(()=>[n(V,{modelValue:j.value.authorized_person_age,"onUpdate:modelValue":a[3]||(a[3]=e=>j.value.authorized_person_age=e),min:18,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(y,{gutter:20},{default:u(()=>[n(v,{span:12},{default:u(()=>[n(t,{label:"职位",prop:"authorized_person_position"},{default:u(()=>[n(l,{modelValue:j.value.authorized_person_position,"onUpdate:modelValue":a[4]||(a[4]=e=>j.value.authorized_person_position=e),placeholder:"请输入职位"},null,8,["modelValue"])]),_:1})]),_:1}),n(v,{span:12},{default:u(()=>[n(t,{label:"职称",prop:"authorized_person_title"},{default:u(()=>[n(l,{modelValue:j.value.authorized_person_title,"onUpdate:modelValue":a[5]||(a[5]=e=>j.value.authorized_person_title=e),placeholder:"请输入职称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(y,null,{default:u(()=>[n(v,{span:24},{default:u(()=>[n(t,null,{default:u(()=>[n(N,{type:"primary",loading:C.value,onClick:$},{default:u(()=>[n(E,null,{default:u(()=>[n(s(f))]),_:1}),a[14]||(a[14]=_(" 保存被授权人信息 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),n(s(H),{title:"相关附件",class:"mt-4"},{default:u(()=>[h("div",Te,[h("div",Re,[h("div",Ne,[n(E,{class:"icon"},{default:u(()=>[n(s(P))]),_:1}),a[15]||(a[15]=h("span",{class:"title"},"被授权人身份证（正面）",-1))]),U.value.id_card_front?(o(),i("div",Qe,[n(E,{class:"file-icon"},{default:u(()=>[n(s(z))]),_:1}),h("span",Oe,k(U.value.id_card_front.name),1),h("div",Le,[n(N,{text:"",type:"primary",size:"small",onClick:a[6]||(a[6]=e=>T("id_card_front"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(x))]),_:1})]),_:1}),n(N,{text:"",type:"danger",size:"small",onClick:a[7]||(a[7]=e=>R("id_card_front"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(q))]),_:1})]),_:1})])])):(o(),i("div",Be,"未上传")),n(s(te),{accept:".jpg,.jpeg,.png,.pdf","show-file-list":!1,"http-request":M("id_card_front"),"auto-compress-image":!0,"image-type":"id_card","max-size":10},{trigger:u(()=>[n(N,{size:"small"},{default:u(()=>[n(E,null,{default:u(()=>[n(s(I))]),_:1}),a[16]||(a[16]=_(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])]),h("div",Je,[h("div",Ye,[n(E,{class:"icon"},{default:u(()=>[n(s(P))]),_:1}),a[17]||(a[17]=h("span",{class:"title"},"被授权人身份证（反面）",-1))]),U.value.id_card_back?(o(),i("div",Ge,[n(E,{class:"file-icon"},{default:u(()=>[n(s(z))]),_:1}),h("span",Ae,k(U.value.id_card_back.name),1),h("div",Xe,[n(N,{text:"",type:"primary",size:"small",onClick:a[8]||(a[8]=e=>T("id_card_back"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(x))]),_:1})]),_:1}),n(N,{text:"",type:"danger",size:"small",onClick:a[9]||(a[9]=e=>R("id_card_back"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(q))]),_:1})]),_:1})])])):(o(),i("div",Ke,"未上传")),n(s(te),{accept:".jpg,.jpeg,.png,.pdf","show-file-list":!1,"http-request":M("id_card_back"),"auto-compress-image":!0,"image-type":"id_card","max-size":10},{trigger:u(()=>[n(N,{size:"small"},{default:u(()=>[n(E,null,{default:u(()=>[n(s(I))]),_:1}),a[18]||(a[18]=_(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])]),h("div",We,[h("div",Ze,[n(E,{class:"icon"},{default:u(()=>[n(s(S))]),_:1}),a[19]||(a[19]=h("span",{class:"title"},"项目经理简历",-1))]),U.value.manager_resume?(o(),i("div",He,[n(E,{class:"file-icon"},{default:u(()=>[n(s(z))]),_:1}),h("span",ea,k(U.value.manager_resume.name),1),h("div",aa,[n(N,{text:"",type:"primary",size:"small",onClick:a[10]||(a[10]=e=>T("manager_resume"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(x))]),_:1})]),_:1}),n(N,{text:"",type:"danger",size:"small",onClick:a[11]||(a[11]=e=>R("manager_resume"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(q))]),_:1})]),_:1})])])):(o(),i("div",la,"未上传")),n(s(te),{accept:".pdf,.doc,.docx","show-file-list":!1,"http-request":M("manager_resume"),"auto-compress-image":!1,"max-size":20},{trigger:u(()=>[n(N,{size:"small"},{default:u(()=>[n(E,null,{default:u(()=>[n(s(I))]),_:1}),a[20]||(a[20]=_(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])]),h("div",ta,[h("div",ia,[n(E,{class:"icon"},{default:u(()=>[n(s(F))]),_:1}),a[21]||(a[21]=h("span",{class:"title"},"社保证明",-1))]),U.value.social_security?(o(),i("div",oa,[n(E,{class:"file-icon"},{default:u(()=>[n(s(z))]),_:1}),h("span",na,k(U.value.social_security.name),1),h("div",sa,[n(N,{text:"",type:"primary",size:"small",onClick:a[12]||(a[12]=e=>T("social_security"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(x))]),_:1})]),_:1}),n(N,{text:"",type:"danger",size:"small",onClick:a[13]||(a[13]=e=>R("social_security"))},{default:u(()=>[n(E,null,{default:u(()=>[n(s(q))]),_:1})]),_:1})])])):(o(),i("div",ua,"未上传")),n(s(te),{accept:".pdf,.jpg,.jpeg,.png","show-file-list":!1,"http-request":M("social_security"),"auto-compress-image":!0,"image-type":"default","max-size":20},{trigger:u(()=>[n(N,{size:"small"},{default:u(()=>[n(E,null,{default:u(()=>[n(s(I))]),_:1}),a[22]||(a[22]=_(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])])])]),_:1})])}}}),[["__scopeId","data-v-0b3ffc62"]]),ra={class:"financial-tab"},ca={class:"shareholders-section"},pa={class:"section-header"},_a={class:"save-section"},ma=v(e({__name:"FinancialTab",props:{companyId:{},companyData:{}},emits:["update"],setup(e,{emit:v}){const y=e,b=v,{success:k,error:V}=a(),w=l(),x=l(),q=l(),I=l(),U=l(!1),M=l(!1),P=l([{key:"audit_report",name:"财务审计报告",icon:z,required:!1,allowMultiple:!0},{key:"taxpayer_certificate",name:"纳税人资格证明",icon:R,required:!1,allowMultiple:!1}]),S=l({}),F=l({bank_name:"",bank_account:""}),N=l({actual_controller:"",controlling_shareholder:""}),Q=l({managing_unit_name:"",managed_unit_name:""}),O=l([]),L=l(-1),B=l(-1),J=l(!1),Y=l(-1),G=l({name:"",type:"",ratio:""}),X={name:[{required:!0,message:"请输入股东名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],ratio:[{required:!0,message:"请输入出资比例",trigger:"blur"}]};t(()=>y.companyData,e=>{if(e){F.value={bank_name:e.bank_name||"",bank_account:e.bank_account||""},N.value={actual_controller:e.actual_controller||"",controlling_shareholder:e.controlling_shareholder||""},Q.value={managing_unit_name:e.managing_unit_name||"",managed_unit_name:e.managed_unit_name||""};try{const a=e.shareholders_info;a?(O.value="string"==typeof a?JSON.parse(a):a,L.value=O.value.findIndex(e=>!0===e.is_controlling),B.value=O.value.findIndex(e=>!0===e.is_actual_controller)):(O.value=[],L.value=-1,B.value=-1)}catch(a){O.value=[],L.value=-1,B.value=-1}}},{immediate:!0,deep:!0});const Z=()=>{Y.value=-1,G.value={name:"",type:"",ratio:""},J.value=!0},le=()=>{O.value.forEach(e=>{e.is_controlling=!1}),-1!==L.value&&(O.value[L.value].is_controlling=!0)},te=()=>{O.value.forEach(e=>{e.is_actual_controller=!1}),-1!==B.value&&(O.value[B.value].is_actual_controller=!0)},ie=async()=>{I.value&&await I.value.validate(e=>{if(e){if(-1===Y.value)O.value.push({...G.value,is_controlling:!1,is_actual_controller:!1}),k("添加成功","股东已添加，请点击保存按钮保存更改");else{const e=O.value[Y.value];O.value[Y.value]={...G.value,is_controlling:e.is_controlling||!1,is_actual_controller:e.is_actual_controller||!1},k("编辑成功","股东信息已更新，请点击保存按钮保存更改")}J.value=!1}})},oe=async()=>{try{M.value=!0;const e=await A.getCompanyQualifications(y.companyId);e.success&&(S.value=e.data||{})}catch(e){}finally{M.value=!1}},de=async(e,a)=>{try{let l;l=a?`/api/qualifications/${a}/download`:`/api/companies/${y.companyId}/qualifications/${e}/download`,window.open(l,"_blank")}catch(l){V("下载失败",l instanceof Error?l.message:"未知错误")}},re=async(e,a)=>{try{if(!confirm("确定要删除此资质文件吗？"))return;if(a)await A.deleteQualification(a);else{if(!(await fetch(`/api/companies/${y.companyId}/qualifications/${e}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("删除失败")}k("删除成功","资质文件已删除"),await oe(),b("update")}catch(l){V("删除失败",l instanceof Error?l.message:"未知错误")}},ce=async()=>{U.value=!0;try{(await A.updateCompany(y.companyId,{bank_name:F.value.bank_name,bank_account:F.value.bank_account,actual_controller:N.value.actual_controller,controlling_shareholder:N.value.controlling_shareholder,shareholders_info:JSON.stringify(O.value),managing_unit_name:Q.value.managing_unit_name,managed_unit_name:Q.value.managed_unit_name})).success&&(k("保存成功","财务信息已更新"),b("update"))}catch(e){V("保存失败",e instanceof Error?e.message:"未知错误")}finally{U.value=!1}};return E(()=>{oe()}),(e,a)=>{const l=ae,t=ee,v=c,z=r,E=d,M=m,R=p,A=ne,pe=T,_e=se,me=ue,fe=W,ve=K,ye=$;return o(),i("div",ra,[n(s(H),{title:"财务资质文件",class:"mb-4"},{default:u(()=>[n(t,{gutter:20},{default:u(()=>[(o(!0),i(C,null,j(P.value,e=>(o(),g(l,{key:e.key,span:12},{default:u(()=>[n(Ee,{qualification:e,"file-info":S.value[e.key],onUpload:a=>(async(e,a)=>{try{const l=P.value.find(a=>a.key===e);let t=null;if(null==l?void 0:l.allowMultiple){if(t=prompt(`请输入 "${a.name}" 的年份:\n例如：2023、2024`),null===t)return;if(!t.trim())return void V("上传失败","年份不能为空")}const i=new FormData;i.append(`qualifications[${e}]`,a),i.append("qualification_names",JSON.stringify({[e]:(null==l?void 0:l.name)||e})),t&&i.append("file_versions",JSON.stringify({[e]:t.trim()}));const o=await fetch(`/api/companies/${y.companyId}/qualifications/upload`,{method:"POST",body:i,credentials:"include",headers:{}});if(!o.ok){const e=o.headers.get("content-type");if(e&&e.includes("application/json")){const e=await o.json();throw new Error(e.error||`服务器错误: ${o.status}`)}throw new Error(`上传失败: 服务器返回错误 ${o.status}`)}const n=await o.json();if(!n.success)throw new Error(n.error||"上传失败");k("上传成功",`${(null==l?void 0:l.name)||"资质文件"}上传成功`),await oe(),b("update")}catch(l){V("上传失败",l instanceof Error?l.message:"未知错误")}})(e.key,a),onDownload:de,onDelete:re},null,8,["qualification","file-info","onUpload"])]),_:2},1024))),128))]),_:1})]),_:1}),n(s(H),{title:"银行账户信息"},{default:u(()=>[n(E,{ref_key:"bankFormRef",ref:w,model:F.value,"label-width":"140px",class:"bank-form"},{default:u(()=>[n(t,{gutter:20},{default:u(()=>[n(l,{span:12},{default:u(()=>[n(z,{label:"开户行全称"},{default:u(()=>[n(v,{modelValue:F.value.bank_name,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value.bank_name=e),placeholder:"请输入开户行全称"},null,8,["modelValue"])]),_:1})]),_:1}),n(l,{span:12},{default:u(()=>[n(z,{label:"银行账号"},{default:u(()=>[n(v,{modelValue:F.value.bank_account,"onUpdate:modelValue":a[1]||(a[1]=e=>F.value.bank_account=e),placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),n(s(H),{title:"股权结构信息",class:"mt-4"},{default:u(()=>[n(E,{ref_key:"equityFormRef",ref:x,model:N.value,"label-width":"140px",class:"equity-form"},{default:u(()=>[n(t,{gutter:20},{default:u(()=>[n(l,{span:12},{default:u(()=>[n(z,{label:"实际控制人"},{default:u(()=>[n(v,{modelValue:N.value.actual_controller,"onUpdate:modelValue":a[2]||(a[2]=e=>N.value.actual_controller=e),placeholder:"请输入实际控制人"},null,8,["modelValue"])]),_:1})]),_:1}),n(l,{span:12},{default:u(()=>[n(z,{label:"控股股东"},{default:u(()=>[n(v,{modelValue:N.value.controlling_shareholder,"onUpdate:modelValue":a[3]||(a[3]=e=>N.value.controlling_shareholder=e),placeholder:"请输入控股股东"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),h("div",ca,[h("div",pa,[a[14]||(a[14]=h("h6",null,"股东/投资人列表",-1)),n(R,{type:"primary",size:"small",onClick:Z},{default:u(()=>[n(M,null,{default:u(()=>[n(s(D))]),_:1}),a[13]||(a[13]=_(" 添加股东 ",-1))]),_:1})]),O.value.length>0?(o(),g(_e,{key:0,data:O.value,stripe:""},{default:u(()=>[n(A,{prop:"name",label:"股东名称","min-width":"150"}),n(A,{prop:"type",label:"类型",width:"100"}),n(A,{prop:"ratio",label:"出资比例",width:"120"}),n(A,{label:"控股股东",width:"100",align:"center"},{default:u(({$index:e})=>[n(pe,{modelValue:L.value,"onUpdate:modelValue":a[4]||(a[4]=e=>L.value=e),label:e,onChange:le},{default:u(()=>[...a[15]||(a[15]=[h("span",null,null,-1)])]),_:1},8,["modelValue","label"])]),_:1}),n(A,{label:"实际控制人",width:"110",align:"center"},{default:u(({$index:e})=>[n(pe,{modelValue:B.value,"onUpdate:modelValue":a[5]||(a[5]=e=>B.value=e),label:e,onChange:te},{default:u(()=>[...a[16]||(a[16]=[h("span",null,null,-1)])]),_:1},8,["modelValue","label"])]),_:1}),n(A,{label:"操作",width:"150"},{default:u(({row:e,$index:l})=>[n(R,{text:"",type:"primary",size:"small",onClick:e=>(e=>{Y.value=e;const a=O.value[e];G.value={name:a.name,type:a.type,ratio:a.ratio},J.value=!0})(l)},{default:u(()=>[...a[17]||(a[17]=[_(" 编辑 ",-1)])]),_:1},8,["onClick"]),n(R,{text:"",type:"danger",size:"small",onClick:e=>{return a=l,void(confirm("确定要删除此股东吗？")&&(a===L.value&&(L.value=-1),a===B.value&&(B.value=-1),O.value.splice(a,1),a<L.value&&L.value--,a<B.value&&B.value--,k("删除成功","股东已删除，请点击保存按钮保存更改")));var a}},{default:u(()=>[...a[18]||(a[18]=[_(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(o(),g(me,{key:1,description:"暂无股东信息","image-size":100}))])]),_:1}),n(s(H),{title:"管理关系信息",class:"mt-4"},{default:u(()=>[n(E,{ref_key:"managementFormRef",ref:q,model:Q.value,"label-width":"140px",class:"management-form"},{default:u(()=>[n(t,{gutter:20},{default:u(()=>[n(l,{span:12},{default:u(()=>[n(z,{label:"管理单位名称"},{default:u(()=>[n(v,{modelValue:Q.value.managing_unit_name,"onUpdate:modelValue":a[6]||(a[6]=e=>Q.value.managing_unit_name=e),placeholder:"如有管理单位请输入"},null,8,["modelValue"])]),_:1})]),_:1}),n(l,{span:12},{default:u(()=>[n(z,{label:"被管理单位名称"},{default:u(()=>[n(v,{modelValue:Q.value.managed_unit_name,"onUpdate:modelValue":a[7]||(a[7]=e=>Q.value.managed_unit_name=e),placeholder:"如有被管理单位请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),h("div",_a,[n(R,{type:"primary",size:"large",loading:U.value,onClick:ce},{default:u(()=>[n(M,null,{default:u(()=>[n(s(f))]),_:1}),a[19]||(a[19]=_(" 保存财务信息 ",-1))]),_:1},8,["loading"])]),n(ye,{modelValue:J.value,"onUpdate:modelValue":a[12]||(a[12]=e=>J.value=e),title:-1===Y.value?"添加股东":"编辑股东",width:"500px"},{footer:u(()=>[n(R,{onClick:a[11]||(a[11]=e=>J.value=!1)},{default:u(()=>[...a[20]||(a[20]=[_("取消",-1)])]),_:1}),n(R,{type:"primary",onClick:ie},{default:u(()=>[...a[21]||(a[21]=[_("确定",-1)])]),_:1})]),default:u(()=>[n(E,{ref_key:"shareholderFormRef",ref:I,model:G.value,rules:X,"label-width":"100px"},{default:u(()=>[n(z,{label:"股东名称",prop:"name"},{default:u(()=>[n(v,{modelValue:G.value.name,"onUpdate:modelValue":a[8]||(a[8]=e=>G.value.name=e),placeholder:"请输入股东名称"},null,8,["modelValue"])]),_:1}),n(z,{label:"类型",prop:"type"},{default:u(()=>[n(ve,{modelValue:G.value.type,"onUpdate:modelValue":a[9]||(a[9]=e=>G.value.type=e),placeholder:"请选择类型",style:{width:"100%"}},{default:u(()=>[n(fe,{label:"企业",value:"企业"}),n(fe,{label:"自然人",value:"自然人"})]),_:1},8,["modelValue"])]),_:1}),n(z,{label:"出资比例",prop:"ratio"},{default:u(()=>[n(v,{modelValue:G.value.ratio,"onUpdate:modelValue":a[10]||(a[10]=e=>G.value.ratio=e),placeholder:"如：30%"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-5b1f60f2"]]),fa={class:"company-detail"},va={class:"detail-header"},ya={class:"header-title"},ga={key:1,class:"detail-content"},ha={class:"tab-label"},ba={class:"tab-label"},ka={class:"tab-label"},Va={class:"tab-label"},wa=v(e({__name:"CompanyDetail",setup(e){const t=N(),d=Q(),{error:r}=a(),c=l(!1),f=l("basic"),v=l(0),y=l({}),b={technology:"科技",manufacturing:"制造业",finance:"金融",education:"教育",healthcare:"医疗",retail:"零售",construction:"建筑",other:"其他"},w=async()=>{c.value=!0;try{const e=await A.getCompany(v.value);e.success&&e.data?y.value=e.data:(r("加载失败","无法获取企业信息"),q())}catch(e){r("加载失败",e instanceof Error?e.message:"未知错误"),q()}finally{c.value=!1}},z=e=>{},x=async()=>{await w()},q=()=>{d.push("/knowledge/company")};return E(()=>{const e=t.params.id;if(e){if(v.value=parseInt(e,10),isNaN(v.value))return r("参数错误","无效的企业ID"),void q();w()}else r("参数错误","缺少企业ID"),q()}),(e,a)=>{const l=p,t=ie,d=m,r=J,w=Y;return o(),i("div",fa,[h("div",va,[n(l,{onClick:q,icon:"ArrowLeft"},{default:u(()=>[...a[1]||(a[1]=[_("返回列表",-1)])]),_:1}),h("div",ya,[h("h2",null,k(y.value.company_name||"企业详情"),1),y.value.industry_type?(o(),g(t,{key:0,type:"info"},{default:u(()=>{return[_(k((e=y.value.industry_type,b[e]||e)),1)];var e}),_:1})):V("",!0)])]),c.value?(o(),g(s(G),{key:0,text:"加载企业信息中..."})):(o(),i("div",ga,[n(w,{modelValue:f.value,"onUpdate:modelValue":a[0]||(a[0]=e=>f.value=e),class:"company-tabs",onTabChange:z},{default:u(()=>[n(r,{name:"basic"},{label:u(()=>[h("span",ha,[n(d,null,{default:u(()=>[n(s(O))]),_:1}),a[2]||(a[2]=_(" 基础信息 ",-1))])]),default:u(()=>[n(re,{"company-id":v.value,"company-data":y.value,onUpdate:x},null,8,["company-id","company-data"])]),_:1}),n(r,{name:"qualification"},{label:u(()=>[h("span",ba,[n(d,null,{default:u(()=>[n(s(L))]),_:1}),a[3]||(a[3]=_(" 资质信息 ",-1))])]),default:u(()=>[n(Se,{"company-id":v.value,"company-data":y.value,onUpdate:x},null,8,["company-id","company-data"])]),_:1}),n(r,{name:"personnel"},{label:u(()=>[h("span",ka,[n(d,null,{default:u(()=>[n(s(S))]),_:1}),a[4]||(a[4]=_(" 被授权人信息 ",-1))])]),default:u(()=>[n(da,{"company-id":v.value,"company-data":y.value,onUpdate:x},null,8,["company-id","company-data"])]),_:1}),n(r,{name:"financial"},{label:u(()=>[h("span",Va,[n(d,null,{default:u(()=>[n(s(B))]),_:1}),a[5]||(a[5]=_(" 财务信息 ",-1))])]),default:u(()=>[n(ma,{"company-id":v.value,"company-data":y.value,onUpdate:x},null,8,["company-id","company-data"])]),_:1})]),_:1},8,["modelValue"])]))])}}}),[["__scopeId","data-v-4557bbd0"]]);export{wa as default};
