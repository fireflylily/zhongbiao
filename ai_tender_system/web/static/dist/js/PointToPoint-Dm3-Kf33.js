import{aL as e,av as a,aw as l,be as t,bf as n,aM as s,aO as o,aZ as r,aS as i,aN as u,aT as d,bO as c,bL as p,bl as v,bm as m,aV as f,bM as y,aR as h,b0 as g,c6 as _,c7 as w,b1 as b,c8 as j,aY as x,bi as F,bj as k,bc as V,bv as I,aX as q,c9 as C,ca as S,b4 as U,b8 as E,b2 as $,b7 as z,a_ as P}from"./index.js";import"./DocumentPreview.vue_vue_type_style_index_0_scoped_056f7814_lang-CJRCEOay.js";/* empty css                                                                          *//* empty css                             *//* empty css                    *//* empty css                     *//* empty css               *//* empty css                *//* empty css                */import{E as M}from"./el-divider-gmgJgJtg.js";import{E as D,a as O}from"./el-select-CbXL8N14.js";import{S as T}from"./SSEStreamViewer-BTNiiTtV.js";import{D as R}from"./DocumentUploader-DYKSLbiT.js";import{v as L,D as N}from"./DocumentPreview-BVX8lDJX.js";import{R as W}from"./RichTextEditor-Dq_RwtDf.js";/* empty css                */import{u as H,a as A,H as B,E as G,S as J,b as K,c as Y}from"./HistoryFilesPanel-lmpl-QGq.js";import{t as Z}from"./tender-B2_G1CPt.js";import{d as Q}from"./helpers-BsogEk_7.js";import{a as X,E as ee}from"./index-B-vavaW6.js";import{E as ae}from"./index-D2m2pKqu.js";import{E as le}from"./index-Czx3rhy5.js";import{E as te,a as ne}from"./index-Bfmi5a2x.js";import{E as se}from"./index-CKL8-Dtp.js";import{E as oe}from"./index-5dFIUF4u.js";import{E as re,a as ie}from"./index-BAt828Vi.js";import{E as ue}from"./index-DG0KKHwq.js";import"./strings-CAibmfqB.js";import"./toNumber-D1BjzJ77.js";import"./_baseIteratee-BvG1DPGQ.js";import"./imageCompressor-CTkRt5bg.js";import"./index-DMS9dz3W.js";import"./cloneDeep-BA-8E20e.js";import"./project-D1NKtbTH.js";import"./index-CSVRQ7Lr.js";import"./flatMap-DpVyIUkZ.js";import"./map-C13Z-hJX.js";import"./_baseEach-CWxoirs-.js";import"./index-DuuVeZgf.js";import"./raf-CSK_qRxG.js";const de={class:"point-to-point"},ce={class:"card-header"},pe={class:"action-controls"},ve={class:"card-header"},me={class:"card-header"},fe={class:"header-actions"},ye={class:"result-content"},he={class:"file-info-section"},ge={class:"card-header"},_e={class:"header-actions"},we={class:"requirement-text"},be={class:"card-header"},je={class:"card-header"},xe={class:"header-actions"},Fe={class:"collapse-title"},ke={class:"requirement-preview"},Ve={class:"response-content"},Ie={class:"response-item"},qe={class:"requirement-detail"},Ce={class:"response-item"},Se={key:0,class:"response-item"},Ue={key:0,class:"response-dialog"},Ee={class:"dialog-section"},$e={class:"requirement-detail"},ze={class:"dialog-section"},Pe={key:0,class:"dialog-section"},Me={class:"collapse-header"},De={class:"filename-cell"},Oe=P(e({__name:"PointToPoint",setup(e){const{projects:P,selectedProject:Oe,currentDocuments:Te,loadProjects:Re,handleProjectChange:Le,restoreProjectFromStore:Ne}=H(),{useHitlFile:We,hitlFileInfo:He,syncing:Ae,synced:Be,loadFromHITL:Ge,cancelHitlFile:Je,syncToHitl:Ke}=A({onFileLoaded:()=>{Ye.value.tenderFiles=[]}}),Ye=a({projectId:null,tenderFiles:[]}),Ze=a({bidRole:"primary",responseFrequency:"every_paragraph",responseMode:"simple",aiModel:"shihuang-gpt4o-mini"}),Qe=a(!1),Xe=a(0),ea=a(""),aa=a([]),la=a([]),ta=a(""),na=a(""),sa=l(()=>{let e=aa.value;return ta.value&&(e=e.filter(e=>e.requirement.toLowerCase().includes(ta.value.toLowerCase()))),na.value&&(e=e.filter(e=>e.category===na.value)),e}),oa=a(!1),ra=a(0),ia=a(""),ua=a(""),da=a(""),ca=a(null),pa=a(null),va=a(!1),ma=a(null),fa=a(""),ya=a(!1),ha=a([]),ga=a(null),_a=a([]),wa=a(!1),ba=a([]),ja=a(!1),xa=a(""),Fa=a(""),ka=l(()=>aa.value.some(e=>e.response)),Va=a([]),Ia=a(!1),qa=a(null),Ca=l(()=>Ye.value.projectId&&(Ye.value.tenderFiles.length>0||We.value)),Sa=async e=>{var a;const{file:l,onSuccess:t,onError:n}=e;if(!Ye.value.projectId){return n(new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")),void z.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")}if(!(null==(a=Oe.value)?void 0:a.company_id)){return n(new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")),void z.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")}try{const e=new FormData;e.append("file",l),e.append("company_id",Oe.value.company_id.toString()),e.append("project_id",Ye.value.projectId.toString());const a=await Z.parseDocumentStructure(e);if(!a.success)throw new Error(a.message||"ä¸Šä¼ å¤±è´¥");t(a.data),z.success("æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(s){n(s),z.error(s.message||"æ‹›æ ‡æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},Ua=async()=>{await Le(Ye.value.projectId,{onClear:()=>{Ye.value.tenderFiles=[],aa.value=[],la.value=[],ga.value=null,pa.value=null,va.value=!1,fa.value="",ha.value=[],We.value&&Je()},onDocumentsLoaded:$a})},Ea=()=>{z.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},$a=e=>{e.technicalFile?Ge(e,"technicalFile"):e.tenderFile&&(Ye.value.tenderFiles=[e.tenderFile]),e.p2pResponseFile&&(ga.value=e.p2pResponseFile,va.value=!1,z.info('æ£€æµ‹åˆ°å†å²ç‚¹å¯¹ç‚¹åº”ç­”æ–‡ä»¶ï¼Œç‚¹å‡»"åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€"å¯ç¼–è¾‘'))},za=async()=>{Qe.value=!0,Xe.value=0,ea.value="",aa.value=[];try{await Pa(),z.success("æ‹›æ ‡è¦æ±‚æå–å®Œæˆ")}catch(e){z.error("æå–å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{Qe.value=!1}},Pa=async()=>new Promise(e=>{const a=[{progress:25,message:"æ­£åœ¨è§£ææ‹›æ ‡æ–‡æ¡£..."},{progress:50,message:"æ­£åœ¨è¯†åˆ«æ‹›æ ‡è¦æ±‚..."},{progress:75,message:"æ­£åœ¨åˆ†ç±»æ•´ç†..."},{progress:100,message:"æå–å®Œæˆï¼"}];let l=0;const t=setInterval(()=>{if(l<a.length){const e=a[l];Xe.value=e.progress,ea.value+=`\n[${e.progress}%] ${e.message}`,l++}else clearInterval(t),aa.value=[{id:1,category:"technical",requirement:"ç³»ç»Ÿåº”æ”¯æŒä¸å°‘äº10000ä¸ªå¹¶å‘ç”¨æˆ·åŒæ—¶åœ¨çº¿è®¿é—®",priority:"é«˜",status:"pending"},{id:2,category:"technical",requirement:"ç³»ç»Ÿå“åº”æ—¶é—´åº”ä¸è¶…è¿‡3ç§’",priority:"é«˜",status:"pending"},{id:3,category:"business",requirement:"é¡¹ç›®å®æ–½å‘¨æœŸä¸è¶…è¿‡6ä¸ªæœˆ",priority:"é«˜",status:"pending"},{id:4,category:"qualification",requirement:"æŠ•æ ‡äººåº”å…·æœ‰ISO 9001è´¨é‡ç®¡ç†ä½“ç³»è®¤è¯",priority:"ä¸­",status:"pending"},{id:5,category:"qualification",requirement:"æŠ•æ ‡äººåº”å…·æœ‰ä¿¡æ¯å®‰å…¨ç­‰çº§ä¿æŠ¤ä¸‰çº§èµ„è´¨",priority:"ä¸­",status:"pending"},{id:6,category:"business",requirement:"è´¨ä¿æœŸä¸å°‘äº2å¹´",priority:"ä¸­",status:"pending"},{id:7,category:"technical",requirement:"ç³»ç»Ÿåº”æ”¯æŒç§»åŠ¨ç«¯è®¿é—®ï¼ˆiOSå’ŒAndroidï¼‰",priority:"ä¸­",status:"pending"},{id:8,category:"other",requirement:"æŠ•æ ‡æ–‡ä»¶åº”åŒ…å«è¯¦ç»†çš„åŸ¹è®­è®¡åˆ’",priority:"ä½",status:"pending"}],e()},600)}),Ma=e=>{la.value=e},Da=async()=>{if(0!==la.value.length){oa.value=!0,ra.value=0,ia.value="";try{await Oa(),z.success("ç‚¹å¯¹ç‚¹åº”ç­”ç”Ÿæˆå®Œæˆ")}catch(e){z.error("ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{oa.value=!1}}else z.warning("è¯·é€‰æ‹©è¦ç”Ÿæˆåº”ç­”çš„è¦æ±‚")},Oa=async()=>new Promise(e=>{const a=la.value.length;let l=0;const t=setInterval(()=>{if(l<a){const e=la.value[l];ra.value=Math.round((l+1)/a*100),ia.value+=`\n[${l+1}/${a}] æ­£åœ¨ç”Ÿæˆ"${e.requirement.substring(0,20)}..."çš„åº”ç­”`;const t=aa.value.findIndex(a=>a.id===e.id);-1!==t&&(aa.value[t]={...aa.value[t],status:"generated",response:Ra(e),compliance:Math.random()>.3?"å®Œå…¨ç¬¦åˆ":"éƒ¨åˆ†ç¬¦åˆ"}),l++}else clearInterval(t),e()},800)}),Ta=async()=>{if(Ye.value.projectId&&Oe.value)if(We.value||0!==Ye.value.tenderFiles.length){oa.value=!0,ra.value=0,pa.value=null,va.value=!0,fa.value='<h1>ğŸ“„ ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£</h1><p style="color: #909399;">AIæ­£åœ¨ç”Ÿæˆå†…è”åº”ç­”ï¼Œè¯·ç¨å€™...</p>',setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100);try{const e=new FormData;We.value&&He.value?(e.append("use_hitl_technical_file","true"),e.append("project_id",Ye.value.projectId.toString())):Ye.value.tenderFiles.length>0&&Ye.value.tenderFiles[0].raw&&e.append("file",Ye.value.tenderFiles[0].raw),e.append("companyId",Oe.value.company_id.toString()),e.append("projectName",Oe.value.project_name||""),e.append("responseFrequency",Ze.value.responseFrequency),e.append("responseMode",Ze.value.responseMode),e.append("aiModel",Ze.value.aiModel);const a=await fetch("/api/process-point-to-point",{method:"POST",body:e}),l=await a.json();if(!l.success){let e="å¤„ç†å¤±è´¥";throw l.error?e="object"==typeof l.error&&l.error.message?l.error.message:"string"==typeof l.error?l.error:JSON.stringify(l.error):l.message&&(e=l.message),new Error(e)}ua.value=l.output_file,da.value=l.download_url,ca.value=l.stats,pa.value={success:!0,outputFile:l.output_file,downloadUrl:l.download_url,stats:l.stats||{},message:l.message||"ç‚¹å¯¹ç‚¹åº”ç­”ç”Ÿæˆå®Œæˆ"},await Na(l.output_file),z.success("ç‚¹å¯¹ç‚¹åº”ç­”ç”Ÿæˆå®Œæˆï¼å¯ä»¥ç¼–è¾‘äº†"),l.output_file&&await Ke(Ye.value.projectId,l.output_file,"point_to_point")}catch(e){let a="å¤„ç†å¤±è´¥ï¼Œè¯·é‡è¯•";"string"==typeof e?a=e:(null==e?void 0:e.message)?a=e.message:(null==e?void 0:e.error)?a=e.error:"object"==typeof e&&(a=JSON.stringify(e)),ma.value&&ma.value.appendContent(`<p style="color: red;">âŒ é”™è¯¯: ${a}</p>`),z.error({message:a,duration:5e3})}finally{oa.value=!1}}else z.error("è¯·å…ˆä¸Šä¼ æ‹›æ ‡æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");else z.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")},Ra=e=>({technical:"## æŠ€æœ¯å“åº”\n\næˆ‘æ–¹ç³»ç»Ÿå®Œå…¨æ»¡è¶³è¯¥æŠ€æœ¯è¦æ±‚ï¼š\n\n### æ–¹æ¡ˆè¯´æ˜\n1. é‡‡ç”¨xxxæ¶æ„è®¾è®¡ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®\n2. ç»è¿‡å‹åŠ›æµ‹è¯•ï¼Œå¯æ”¯æŒxxxå¹¶å‘ç”¨æˆ·\n3. é…ç½®xxxæœåŠ¡å™¨é›†ç¾¤ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§\n\n### æŠ€æœ¯æŒ‡æ ‡\n- å¹¶å‘å¤„ç†èƒ½åŠ›ï¼šæ»¡è¶³è¦æ±‚\n- å“åº”æ—¶é—´ï¼šå¹³å‡2ç§’ä»¥å†…\n- ç³»ç»Ÿå¯ç”¨æ€§ï¼š99.9%\n\n### è¯æ˜ææ–™\nè¯¦è§é™„ä»¶ã€ŠæŠ€æœ¯æ–¹æ¡ˆä¹¦ã€‹ç¬¬xxé¡µ",business:"## å•†åŠ¡å“åº”\n\næˆ‘æ–¹å®Œå…¨æ¥å—è¯¥å•†åŠ¡æ¡æ¬¾ï¼š\n\n### æ‰¿è¯ºå†…å®¹\n1. ä¸¥æ ¼æŒ‰ç…§è¦æ±‚æ‰§è¡Œ\n2. æä¾›ç›¸åº”çš„ä¿éšœæªæ–½\n3. ç¡®ä¿æŒ‰æ—¶å®Œæˆ\n\n### å…·ä½“å®‰æ’\n- é¡¹ç›®å‘¨æœŸï¼šç¬¦åˆè¦æ±‚\n- è´¨ä¿æœŸï¼šæ»¡è¶³è¦æ±‚\n- éªŒæ”¶æ ‡å‡†ï¼šæŒ‰ç…§æ‹›æ ‡æ–‡ä»¶æ‰§è¡Œ\n\n### æœåŠ¡ä¿éšœ\nè¯¦è§é™„ä»¶ã€Šå•†åŠ¡åº”ç­”ä¹¦ã€‹ç¬¬xxé¡µ",qualification:"## èµ„è´¨å“åº”\n\næˆ‘æ–¹å…·å¤‡è¯¥é¡¹èµ„è´¨è¦æ±‚ï¼š\n\n### èµ„è´¨è¯æ˜\n1. æŒæœ‰xxxè¯ä¹¦ï¼Œè¯ä¹¦ç¼–å·ï¼šxxx\n2. è¯ä¹¦æœ‰æ•ˆæœŸï¼šxxxxå¹´xxæœˆè‡³xxxxå¹´xxæœˆ\n3. è®¤è¯èŒƒå›´ï¼šè¦†ç›–æœ¬é¡¹ç›®éœ€æ±‚\n\n### ç›¸å…³ä¸šç»©\n- è¿‘ä¸‰å¹´å®Œæˆç±»ä¼¼é¡¹ç›®xxä¸ª\n- é¡¹ç›®éªŒæ”¶åˆæ ¼ç‡100%\n\n### é™„ä»¶ææ–™\nè¯¦è§é™„ä»¶ã€Šèµ„è´¨è¯æ˜æ–‡ä»¶ã€‹",other:"## å…¶ä»–è¦æ±‚å“åº”\n\næˆ‘æ–¹æ‰¿è¯ºæ»¡è¶³è¯¥è¦æ±‚ï¼š\n\n### å…·ä½“å®‰æ’\n1. åˆ¶å®šè¯¦ç»†è®¡åˆ’\n2. é…å¤‡ä¸“ä¸šäººå‘˜\n3. æä¾›å®Œæ•´æ–‡æ¡£\n\n### æ‰§è¡Œæ ‡å‡†\n- ä¸¥æ ¼æŒ‰ç…§æ‹›æ ‡æ–‡ä»¶è¦æ±‚\n- ç¡®ä¿è´¨é‡å’Œè¿›åº¦\n\n### ç›¸å…³æ–‡ä»¶\nè¯¦è§é™„ä»¶ç›¸å…³ç« èŠ‚"}[e.category]||"æˆ‘æ–¹å®Œå…¨å“åº”è¯¥è¦æ±‚ã€‚"),La=()=>{oa.value=!1,z.info("å·²åœæ­¢ç”Ÿæˆ")},Na=async e=>{try{fa.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const a=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),l=await a.json();if(!l.success||!l.html_content)throw new Error(l.error||"è½¬æ¢å¤±è´¥");fa.value=l.html_content,ma.value&&ma.value.setContent(l.html_content)}catch(a){fa.value=`\n      <h1>ğŸ“„ ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${a.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç‚¹å‡»ä¸‹æ–¹"æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"ä¸‹è½½Wordæ–‡æ¡£æŸ¥çœ‹</li>\n          <li>Wordæ–‡æ¡£ä¸­å·²åŒ…å«å†…è”å›å¤ï¼ˆç°è‰²åº•çº¹æ ‡è®°ï¼‰</li>\n        </ul>\n      </div>\n    `,z.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨ä¸‹è½½åŠŸèƒ½æŸ¥çœ‹")}},Wa=async e=>{var a,l;if(Ye.value.projectId){ya.value=!0;try{const t=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:Ye.value.projectId,document_type:"point_to_point",original_file:null==(a=pa.value)?void 0:a.outputFile})}),n=await t.json();if(!n.success)throw new Error(n.error||"ä¿å­˜å¤±è´¥");pa.value={success:!0,outputFile:n.output_file,downloadUrl:n.download_url,stats:(null==(l=pa.value)?void 0:l.stats)||{},message:"æ–‡æ¡£å·²ä¿å­˜"},n.output_file&&await Ke(Ye.value.projectId,n.output_file,"point_to_point")}catch(t){throw t}finally{ya.value=!1}}else z.error("é¡¹ç›®IDæ— æ•ˆ")},Ha=()=>{var e;pa.value?pa.value.downloadUrl?(xa.value=pa.value.outputFile,Fa.value=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Oe.value)?void 0:e.project_name)||"æ–‡æ¡£"}.docx`,ja.value=!0):z.warning("æ–‡æ¡£åœ°å€æ— æ•ˆ"):z.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},Aa=()=>{var e;if(pa.value)try{const a=pa.value.downloadUrl,l=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Oe.value)?void 0:e.project_name)||"æ–‡æ¡£"}-${Date.now()}.docx`;Q(a,l),z.success("Wordæ–‡æ¡£ä¸‹è½½æˆåŠŸ")}catch(a){z.error("æ–‡æ¡£ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}else z.warning("æš‚æ— æ–‡æ¡£å¯ä¸‹è½½")},Ba=async()=>{var e;(null==(e=pa.value)?void 0:e.outputFile)?Ye.value.projectId?await Ke(Ye.value.projectId,pa.value.outputFile,"point_to_point"):z.error("é¡¹ç›®IDæ— æ•ˆ"):z.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},Ga=()=>{var e;const a=aa.value.filter(e=>e.response).map((e,a)=>`${a+1}. ã€${Ja(e.category)}ã€‘${e.requirement}\n\n${e.response}\n\nç¬¦åˆæ€§ï¼š${e.compliance}\n\n---\n`).join("\n"),l=new Blob([`# ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£\n\n${a}`],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(l),n=document.createElement("a");n.href=t,n.download=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Oe.value)?void 0:e.project_name)||"export"}-${Date.now()}.txt`,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t),z.success("å¯¼å‡ºæˆåŠŸ")},Ja=e=>({technical:"æŠ€æœ¯è¦æ±‚",business:"å•†åŠ¡è¦æ±‚",qualification:"èµ„è´¨è¦æ±‚",other:"å…¶ä»–è¦æ±‚"}[e]||e),Ka=e=>({technical:"primary",business:"success",qualification:"warning",other:"info"}[e]||""),Ya=e=>({pending:"å¾…ç”Ÿæˆ",generated:"å·²ç”Ÿæˆ",reviewed:"å·²å®¡æ ¸"}[e]||e),Za=e=>({pending:"info",generated:"success",reviewed:"primary"}[e]||""),Qa=e=>{if(!e)return"-";let a=e;try{a=decodeURIComponent(e)}catch{}const l=a.split("/");return l[l.length-1]||"-"},Xa=async()=>{wa.value=!0;try{const e=await fetch("/api/point-to-point/files"),a=await e.json();if(!a.success)throw new Error(a.error||"åŠ è½½å¤±è´¥");_a.value=a.data||[],z.success(`åŠ è½½äº† ${_a.value.length} ä¸ªå†å²æ–‡ä»¶`)}catch(e){z.error(e.message||"åŠ è½½å†å²æ–‡ä»¶å¤±è´¥")}finally{wa.value=!1}},el=e=>{const a=["B","KB","MB","GB"];let l=e,t=0;for(;l>=1024&&t<a.length-1;)l/=1024,t++;return`${l.toFixed(1)} ${a[t]}`},al=e=>{try{return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{return e}},ll=()=>{var e;ga.value&&(xa.value=ga.value.outputFile,Fa.value=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Oe.value)?void 0:e.project_name)||"æ–‡æ¡£"}.docx`,ja.value=!0)},tl=()=>{var e;if(ga.value)try{const a=`ç‚¹å¯¹ç‚¹åº”ç­”-${(null==(e=Oe.value)?void 0:e.project_name)||"æ–‡æ¡£"}-${Date.now()}.docx`;Q(ga.value.downloadUrl,a),z.success("æ–‡æ¡£ä¸‹è½½æˆåŠŸ")}catch(a){z.error("æ–‡æ¡£ä¸‹è½½å¤±è´¥ï¼Œè¯·é‡è¯•")}},nl=()=>{ga.value=null,z.info('è¯·é…ç½®å‚æ•°åç‚¹å‡»"ç›´æ¥ç”ŸæˆWordæ–‡æ¡£"æŒ‰é’®é‡æ–°ç”Ÿæˆ')},sl=async()=>{var e;if(null==(e=ga.value)?void 0:e.outputFile)try{va.value=!0,pa.value={success:!0,outputFile:ga.value.outputFile,downloadUrl:ga.value.downloadUrl||"",stats:ga.value.stats||{},message:ga.value.message||"å†å²ç‚¹å¯¹ç‚¹åº”ç­”æ–‡ä»¶"},await Na(ga.value.outputFile),z.success("å†å²æ–‡ä»¶å·²åŠ è½½åˆ°ç¼–è¾‘å™¨"),setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(a){z.error("æ‰“å¼€å†å²æ–‡ä»¶å¤±è´¥: "+a.message)}else z.error("å†å²æ–‡ä»¶ä¿¡æ¯æ— æ•ˆ")};return t(ba,e=>{e.includes("history")&&0===_a.value.length&&!wa.value&&Xa()}),n(async()=>{await Re();const e=await Ne({onClear:()=>{Ye.value.tenderFiles=[],aa.value=[],la.value=[],ga.value=null,pa.value=null,va.value=!1,fa.value="",We.value&&Je()},onDocumentsLoaded:$a});e&&(Ye.value.projectId=e)}),(e,a)=>{const l=O,t=D,n=p,H=ee,A=y,Z=X,Re=c,Le=ae,Ne=b,Ke=M,ua=w,da=_,ca=le,ya=oe,$a=j,Pa=ne,Oa=se,Ra=te,Na=G,ol=K,rl=q,il=ie,ul=re,dl=S,cl=ue,pl=L;return o(),s("div",de,[r(Le,{class:"project-section",shadow:"never"},{header:d(()=>[...a[15]||(a[15]=[h("div",{class:"card-header"},[h("span",null,"Step 1: é€‰æ‹©é¡¹ç›®")],-1)])]),default:d(()=>[r(Re,{model:Ye.value,"label-width":"100px"},{default:d(()=>[r(Z,{gutter:20},{default:d(()=>[r(H,{span:12},{default:d(()=>[r(n,{label:"é¡¹ç›®"},{default:d(()=>[r(t,{modelValue:Ye.value.projectId,"onUpdate:modelValue":a[0]||(a[0]=e=>Ye.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:Ua,style:{width:"100%"}},{default:d(()=>[(o(!0),s(v,null,m(f(P),e=>(o(),i(l,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),r(H,{span:12},{default:d(()=>[r(n,{label:"å…¬å¸"},{default:d(()=>{var e;return[r(A,{value:(null==(e=f(Oe))?void 0:e.company_name)||"-",disabled:""},null,8,["value"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),Ye.value.projectId?(o(),i(Le,{key:0,class:"upload-section",shadow:"never"},{header:d(()=>[h("div",ce,[a[17]||(a[17]=h("span",null,"Step 2: é€‰æ‹©æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",-1)),f(Te).technicalFile&&!f(We)?(o(),i(Ne,{key:0,type:"primary",size:"small",onClick:a[1]||(a[1]=e=>f(Ge)(f(Te),"technicalFile"))},{default:d(()=>[...a[16]||(a[16]=[g(" ä½¿ç”¨æŠ€æœ¯éœ€æ±‚æ–‡ä»¶ ",-1)])]),_:1})):u("",!0)])]),default:d(()=>[f(We)?(o(),i(f(B),{key:0,"file-info":f(He),label:"æŠ€æœ¯éœ€æ±‚æ–‡ä»¶:",onCancel:f(Je)},null,8,["file-info","onCancel"])):u("",!0),f(We)?u("",!0):(o(),i(f(R),{key:1,modelValue:Ye.value.tenderFiles,"onUpdate:modelValue":a[2]||(a[2]=e=>Ye.value.tenderFiles=e),"http-request":Sa,accept:".pdf,.doc,.docx",limit:5,"max-size":50,drag:"","tip-text":"ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",onSuccess:Ea},null,8,["modelValue"])),r(Ke,null,{default:d(()=>[...a[18]||(a[18]=[g("å¤„ç†é…ç½®",-1)])]),_:1}),r(Re,{model:Ze.value,"label-width":"100px",class:"config-form"},{default:d(()=>[r(Z,{gutter:20},{default:d(()=>[r(H,{span:12},{default:d(()=>[r(n,{label:"æŠ•æ ‡è§’è‰²"},{default:d(()=>[r(da,{modelValue:Ze.value.bidRole,"onUpdate:modelValue":a[3]||(a[3]=e=>Ze.value.bidRole=e)},{default:d(()=>[r(ua,{label:"primary"},{default:d(()=>[...a[19]||(a[19]=[g("åº”æ ‡",-1)])]),_:1}),r(ua,{label:"secondary"},{default:d(()=>[...a[20]||(a[20]=[g("é™ªæ ‡",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),r(H,{span:12},{default:d(()=>[r(n,{label:"åº”ç­”é¢‘ç‡"},{default:d(()=>[r(t,{modelValue:Ze.value.responseFrequency,"onUpdate:modelValue":a[4]||(a[4]=e=>Ze.value.responseFrequency=e),style:{width:"100%"}},{default:d(()=>[r(l,{label:"æ¯æ®µåº”ç­”",value:"every_paragraph"}),r(l,{label:"æ¯é¡µåº”ç­”",value:"every_page"}),r(l,{label:"æ¯ç« èŠ‚åº”ç­”",value:"every_section"}),r(l,{label:"æ–‡æ¡£æœ«å°¾ç»Ÿä¸€åº”ç­”",value:"end_of_document"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),r(Z,{gutter:20},{default:d(()=>[r(H,{span:12},{default:d(()=>[r(n,{label:"åº”ç­”æ–¹å¼"},{default:d(()=>[r(da,{modelValue:Ze.value.responseMode,"onUpdate:modelValue":a[5]||(a[5]=e=>Ze.value.responseMode=e)},{default:d(()=>[r(ua,{label:"simple"},{default:d(()=>[...a[21]||(a[21]=[g("ç®€å•æ¨¡æ¿åº”ç­”",-1)])]),_:1}),r(ua,{label:"ai"},{default:d(()=>[...a[22]||(a[22]=[g("AIæ™ºèƒ½åº”ç­”",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),"ai"===Ze.value.responseMode?(o(),i(H,{key:0,span:12},{default:d(()=>[r(n,{label:"AIæ¨¡å‹"},{default:d(()=>[r(t,{modelValue:Ze.value.aiModel,"onUpdate:modelValue":a[6]||(a[6]=e=>Ze.value.aiModel=e),style:{width:"100%"}},{default:d(()=>[r(l,{label:"å§‹çš‡-GPT4oè¿·ä½ ç‰ˆï¼ˆå¿«é€Ÿé«˜æ•ˆï¼‰",value:"shihuang-gpt4o-mini"}),r(l,{label:"å§‹çš‡-GPT4ä¸“ä¸šç‰ˆï¼ˆæ·±åº¦åˆ†æï¼‰",value:"shihuang-gpt4"}),r(l,{label:"GPT-4O Miniï¼ˆæ¨èï¼‰",value:"gpt-4o-mini"}),r(l,{label:"GPT-4Oï¼ˆé«˜è´¨é‡ï¼‰",value:"gpt-4o"})]),_:1},8,["modelValue"])]),_:1})]),_:1})):u("",!0)]),_:1})]),_:1},8,["model"]),h("div",pe,[r(Ne,{type:"primary",size:"large",disabled:!Ca.value,loading:Qe.value,onClick:za},{default:d(()=>[...a[23]||(a[23]=[g(" æå–æ‹›æ ‡è¦æ±‚ ",-1)])]),_:1},8,["disabled","loading"]),r(Ne,{type:"success",size:"large",disabled:!Ca.value,loading:oa.value,onClick:Ta},{default:d(()=>[...a[24]||(a[24]=[g(" ç›´æ¥ç”ŸæˆWordæ–‡æ¡£ ",-1)])]),_:1},8,["disabled","loading"])])]),_:1})):u("",!0),Qe.value?(o(),i(Le,{key:1,class:"extracting-section",shadow:"never"},{header:d(()=>[h("div",ve,[a[25]||(a[25]=h("span",null,"æ­£åœ¨æå–æ‹›æ ‡è¦æ±‚...",-1)),r(ca,{percentage:Xe.value,status:100===Xe.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:d(()=>[r(f(T),{content:ea.value,"is-streaming":Qe.value},null,8,["content","is-streaming"])]),_:1})):u("",!0),va.value?(o(),i(Le,{key:2,class:"editor-section",shadow:"never"},{default:d(()=>[r(f(W),{ref_key:"editorRef",ref:ma,modelValue:fa.value,"onUpdate:modelValue":a[7]||(a[7]=e=>fa.value=e),title:"ç‚¹å¯¹ç‚¹åº”ç­”æ–‡æ¡£",streaming:oa.value,height:700,onSave:Wa,onPreview:Ha,onExport:Aa},null,8,["modelValue","streaming"])]),_:1})):u("",!0),va.value&&pa.value?(o(),i(ol,{key:3,modelValue:ha.value,"onUpdate:modelValue":a[8]||(a[8]=e=>ha.value=e),class:"result-collapse"},{default:d(()=>[r(Na,{name:"result",title:"ğŸ“„ æŸ¥çœ‹åŸå§‹ç”Ÿæˆç»“æœ"},{default:d(()=>[r(Le,{class:"result-section",shadow:"never"},{header:d(()=>[h("div",me,[a[31]||(a[31]=h("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),h("div",fe,[r(Ne,{type:"primary",size:"large",icon:f(F),onClick:Ha},{default:d(()=>[...a[26]||(a[26]=[g(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),r(Ne,{type:"success",size:"large",icon:f(k),onClick:Aa},{default:d(()=>[...a[27]||(a[27]=[g(" ä¸‹è½½Wordæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),f(Be)?(o(),i(ya,{key:1,type:"success",size:"large"},{default:d(()=>[...a[29]||(a[29]=[g(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(o(),i(Ne,{key:0,type:"info",size:"large",icon:f(V),loading:f(Ae),onClick:Ba},{default:d(()=>[...a[28]||(a[28]=[g(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),r(Ne,{type:"primary",size:"large",icon:f(I),onClick:Ta},{default:d(()=>[...a[30]||(a[30]=[g(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:d(()=>[h("div",ye,[r($a,{type:"success",title:pa.value.message,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["title"]),pa.value.stats&&Object.keys(pa.value.stats).length>0?(o(),i(f(J),{key:0,title:"å¤„ç†ç»Ÿè®¡",stats:pa.value.stats},null,8,["stats"])):u("",!0),h("div",he,[a[32]||(a[32]=h("h4",null,"ç”Ÿæˆæ–‡ä»¶",-1)),r(Ra,{column:2,border:""},{default:d(()=>[r(Pa,{label:"æ–‡ä»¶å"},{default:d(()=>[g(x(Qa(pa.value.outputFile)),1)]),_:1}),r(Pa,{label:"ä¸‹è½½åœ°å€"},{default:d(()=>[r(Oa,{href:pa.value.downloadUrl,type:"primary"},{default:d(()=>[g(x(Qa(pa.value.downloadUrl)),1)]),_:1},8,["href"])]),_:1})]),_:1})])])]),_:1})]),_:1})]),_:1},8,["modelValue"])):u("",!0),aa.value.length>0?(o(),i(Le,{key:4,class:"requirements-section",shadow:"never"},{header:d(()=>[h("div",ge,[h("span",null,"æ‹›æ ‡è¦æ±‚åˆ—è¡¨ (å…± "+x(aa.value.length)+" æ¡)",1),h("div",_e,[r(A,{modelValue:ta.value,"onUpdate:modelValue":a[9]||(a[9]=e=>ta.value=e),placeholder:"æœç´¢è¦æ±‚...",clearable:"",style:{width:"200px"}},{prefix:d(()=>[r(rl,null,{default:d(()=>[r(f(C))]),_:1})]),_:1},8,["modelValue"]),r(t,{modelValue:na.value,"onUpdate:modelValue":a[10]||(a[10]=e=>na.value=e),placeholder:"ç­›é€‰åˆ†ç±»",clearable:"",style:{width:"150px"}},{default:d(()=>[r(l,{label:"å…¨éƒ¨",value:""}),r(l,{label:"æŠ€æœ¯è¦æ±‚",value:"technical"}),r(l,{label:"å•†åŠ¡è¦æ±‚",value:"business"}),r(l,{label:"èµ„è´¨è¦æ±‚",value:"qualification"}),r(l,{label:"å…¶ä»–è¦æ±‚",value:"other"})]),_:1},8,["modelValue"]),r(Ne,{type:"primary",disabled:0===la.value.length,loading:oa.value,onClick:Da},{default:d(()=>[g(" ç”Ÿæˆåº”ç­” ("+x(la.value.length)+") ",1)]),_:1},8,["disabled","loading"])])])]),default:d(()=>[r(ul,{data:sa.value,border:"",onSelectionChange:Ma,"max-height":"500"},{default:d(()=>[r(il,{type:"selection",width:"55"}),r(il,{type:"index",label:"åºå·",width:"60"}),r(il,{prop:"category",label:"åˆ†ç±»",width:"100"},{default:d(({row:e})=>[r(ya,{type:Ka(e.category),size:"small"},{default:d(()=>[g(x(Ja(e.category)),1)]),_:2},1032,["type"])]),_:1}),r(il,{prop:"requirement",label:"æ‹›æ ‡è¦æ±‚","min-width":"300"},{default:d(({row:e})=>[h("div",we,x(e.requirement),1)]),_:1}),r(il,{prop:"priority",label:"ä¼˜å…ˆçº§",width:"100"},{default:d(({row:e})=>{return[r(ya,{type:(a=e.priority,{"é«˜":"danger","ä¸­":"warning","ä½":"info"}[a]||""),size:"small"},{default:d(()=>[g(x(e.priority),1)]),_:2},1032,["type"])];var a}),_:1}),r(il,{prop:"status",label:"åº”ç­”çŠ¶æ€",width:"100"},{default:d(({row:e})=>[r(ya,{type:Za(e.status),size:"small"},{default:d(()=>[g(x(Ya(e.status)),1)]),_:2},1032,["type"])]),_:1}),r(il,{label:"æ“ä½œ",width:"100",fixed:"right"},{default:d(({row:e})=>[e.response?(o(),i(Ne,{key:0,type:"primary",size:"small",text:"",onClick:a=>{return l=e,qa.value=l,void(Ia.value=!0);var l}},{default:d(()=>[...a[33]||(a[33]=[g(" æŸ¥çœ‹ ",-1)])]),_:1},8,["onClick"])):u("",!0)]),_:1})]),_:1},8,["data"])]),_:1})):u("",!0),oa.value?(o(),i(Le,{key:5,class:"generation-output",shadow:"never"},{header:d(()=>[h("div",be,[a[34]||(a[34]=h("span",null,"AIæ­£åœ¨ç”Ÿæˆç‚¹å¯¹ç‚¹åº”ç­”...",-1)),r(ca,{percentage:ra.value,status:100===ra.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:d(()=>[r(f(T),{content:ia.value,"is-streaming":oa.value,onStop:La},null,8,["content","is-streaming"])]),_:1})):u("",!0),ka.value?(o(),i(Le,{key:6,class:"responses-section",shadow:"never"},{header:d(()=>[h("div",je,[a[36]||(a[36]=h("span",null,"ç‚¹å¯¹ç‚¹åº”ç­”ç»“æœ",-1)),h("div",xe,[r(Ne,{type:"success",icon:f(k),onClick:Ga},{default:d(()=>[...a[35]||(a[35]=[g(" å¯¼å‡ºåº”ç­”æ–‡æ¡£ ",-1)])]),_:1},8,["icon"])])])]),default:d(()=>[r(ol,{modelValue:Va.value,"onUpdate:modelValue":a[11]||(a[11]=e=>Va.value=e),accordion:""},{default:d(()=>[(o(!0),s(v,null,m(aa.value.filter(e=>e.response),e=>(o(),i(Na,{key:e.id,name:e.id},{title:d(()=>[h("div",Fe,[r(ya,{type:Ka(e.category),size:"small"},{default:d(()=>[g(x(Ja(e.category)),1)]),_:2},1032,["type"]),h("span",ke,x(e.requirement),1),r(ya,{type:Za(e.status),size:"small"},{default:d(()=>[g(x(Ya(e.status)),1)]),_:2},1032,["type"])])]),default:d(()=>[h("div",Ve,[h("div",Ie,[a[37]||(a[37]=h("h4",null,"æ‹›æ ‡è¦æ±‚",-1)),h("div",qe,x(e.requirement),1)]),h("div",Ce,[a[38]||(a[38]=h("h4",null,"æˆ‘æ–¹åº”ç­”",-1)),r(f(T),{content:e.response||"","is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),e.compliance?(o(),s("div",Se,[a[39]||(a[39]=h("h4",null,"ç¬¦åˆæ€§è¯´æ˜",-1)),r(ya,{type:"å®Œå…¨ç¬¦åˆ"===e.compliance?"success":"warning",size:"large"},{default:d(()=>[g(x(e.compliance),1)]),_:2},1032,["type"])])):u("",!0)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1})):u("",!0),r(dl,{modelValue:Ia.value,"onUpdate:modelValue":a[12]||(a[12]=e=>Ia.value=e),title:"åº”ç­”è¯¦æƒ…",width:"800px","destroy-on-close":""},{default:d(()=>[qa.value?(o(),s("div",Ue,[h("div",Ee,[a[40]||(a[40]=h("h4",null,"æ‹›æ ‡è¦æ±‚",-1)),h("div",$e,x(qa.value.requirement),1)]),h("div",ze,[a[41]||(a[41]=h("h4",null,"æˆ‘æ–¹åº”ç­”",-1)),r(f(T),{content:qa.value.response||"","is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),qa.value.compliance?(o(),s("div",Pe,[a[42]||(a[42]=h("h4",null,"ç¬¦åˆæ€§",-1)),r(ya,{type:"å®Œå…¨ç¬¦åˆ"===qa.value.compliance?"success":"warning"},{default:d(()=>[g(x(qa.value.compliance),1)]),_:1},8,["type"])])):u("",!0)])):u("",!0)]),_:1},8,["modelValue"]),ga.value&&!va.value?(o(),i(f(Y),{key:7,title:"ğŸ“„ è¯¥é¡¹ç›®å·²æœ‰ç‚¹å¯¹ç‚¹åº”ç­”æ–‡ä»¶","current-file":ga.value,"history-files":[],"show-editor-open":!0,"show-stats":!0,"current-file-message":"æ£€æµ‹åˆ°è¯¥é¡¹ç›®çš„å†å²ç‚¹å¯¹ç‚¹åº”ç­”æ–‡ä»¶",onOpenInEditor:sl,onPreview:ll,onDownload:tl,onRegenerate:nl},null,8,["current-file"])):u("",!0),r(ol,{modelValue:ba.value,"onUpdate:modelValue":a[13]||(a[13]=e=>ba.value=e),class:"history-collapse"},{default:d(()=>[r(Na,{name:"history"},{title:d(()=>[h("div",Me,[h("span",null,"ğŸ“‚ æŸ¥çœ‹æ‰€æœ‰å†å²å¤„ç†æ–‡ä»¶ ("+x(_a.value.length)+")",1),ba.value?(o(),i(Ne,{key:0,type:"primary",size:"small",loading:wa.value,onClick:$(Xa,["stop"]),style:{"margin-left":"16px"}},{default:d(()=>[...a[43]||(a[43]=[g(" åˆ·æ–°åˆ—è¡¨ ",-1)])]),_:1},8,["loading"])):u("",!0)])]),default:d(()=>[r(Le,{shadow:"never",style:{border:"none"}},{default:d(()=>[U((o(),i(ul,{data:_a.value,border:"",stripe:"","max-height":"400"},{default:d(()=>[r(il,{type:"index",label:"åºå·",width:"60"}),r(il,{prop:"filename",label:"æ–‡ä»¶å","min-width":"300"},{default:d(({row:e})=>[h("div",De,[r(rl,null,{default:d(()=>[r(f(E))]),_:1}),h("span",null,x(e.filename),1)])]),_:1}),r(il,{prop:"size",label:"æ–‡ä»¶å¤§å°",width:"120"},{default:d(({row:e})=>[g(x(el(e.size)),1)]),_:1}),r(il,{prop:"process_time",label:"å¤„ç†æ—¶é—´",width:"180"},{default:d(({row:e})=>[g(x(al(e.process_time)),1)]),_:1}),r(il,{label:"æ“ä½œ",width:"200",fixed:"right"},{default:d(({row:e})=>[r(Ne,{type:"primary",size:"small",onClick:a=>{var l;(l=e).file_path?(xa.value=l.file_path,Fa.value=l.filename,ja.value=!0):z.warning("æ— æ³•è·å–æ–‡ä»¶ä¿¡æ¯")}},{default:d(()=>[...a[44]||(a[44]=[g(" é¢„è§ˆ ",-1)])]),_:1},8,["onClick"]),r(Ne,{type:"success",size:"small",onClick:a=>f(Q)(e)},{default:d(()=>[...a[45]||(a[45]=[g(" ä¸‹è½½ ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[pl,wa.value]]),wa.value||0!==_a.value.length?u("",!0):(o(),i(cl,{key:0,description:"æš‚æ— å†å²æ–‡ä»¶","image-size":100}))]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(f(N),{modelValue:ja.value,"onUpdate:modelValue":a[14]||(a[14]=e=>ja.value=e),"file-url":xa.value,"file-name":Fa.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-e19f70e4"]]);export{Oe as default};
