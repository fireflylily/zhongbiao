import{c as e,Y as t,b as a,j as l}from"./vendor-element-plus-CEQaQHNc.js";import{m as o}from"./vendor-editor-CGvuleas.js";import{d as s,r as n,a as r,w as u,L as i,M as d,N as m,f as v,P as c,Q as p,c as f,I as y,q as _}from"./vendor-vue-DnBj6vzG.js";/* empty css                                                                        */import{_ as h}from"./index.js";const w={"element-loading-text":"正在加载文档...",class:"preview-container"},j={key:1,class:"editor-preview-wrapper"},C=h(s({__name:"DocumentPreview",props:{modelValue:{type:Boolean,default:!1},fileUrl:{default:""},fileName:{default:"文档预览"},htmlContent:{default:""}},emits:["update:modelValue"],setup(s,{emit:h}){const C=s,V=h,b=n(!1),g=n(""),x=n(""),U=n(null),N=r({get:()=>C.modelValue,set:e=>V("update:modelValue",e)}),P=r(()=>`文档预览 - ${C.fileName||"未命名文档"}`),T=()=>{U.value&&x.value&&setTimeout(()=>{"function"==typeof U.value.setContent&&U.value.setContent(x.value)},300)},k=()=>{N.value=!1};return u(()=>C.modelValue,async e=>{e&&(C.fileUrl||C.htmlContent)?(await _(),(async()=>{if(C.htmlContent)x.value=C.htmlContent;else if(C.fileUrl){b.value=!0,g.value="";try{const e=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:C.fileUrl})}),t=await e.json();if(!t.success||!t.html_content)throw new Error(t.error||"Word转HTML失败");x.value=t.html_content}catch(e){g.value=`文档预览失败: ${e.message||"未知错误"}`,l.error("文档预览失败，请检查文件是否正确或尝试下载后查看")}finally{b.value=!1}}else g.value="文档地址不能为空"})()):(g.value="",x.value="")}),(l,s)=>{const n=e,r=a,u=t;return d(),i(r,{modelValue:N.value,"onUpdate:modelValue":s[0]||(s[0]=e=>N.value=e),title:P.value,width:"90%","before-close":k,"destroy-on-close":"",class:"document-preview-dialog"},{default:m(()=>[v((d(),c("div",w,[g.value?(d(),i(n,{key:0,type:"error",title:g.value,closable:!1,"show-icon":"",style:{"margin-bottom":"20px"}},null,8,["title"])):p("",!0),!g.value&&x.value?(d(),c("div",j,[f(y(o),{ref_key:"editorRef",ref:U,document:{readOnly:!0},onCreated:T},null,512)])):p("",!0)])),[[u,b.value]])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-62c282b6"]]);export{C as D};
