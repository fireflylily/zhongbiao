import{aK as e,av as l,aw as a,be as t,aL as o,aN as s,aY as n,aR as u,aM as i,aS as r,bM as d,bJ as c,bk as p,bl as v,aU as m,bK as f,aQ as _,a$ as y,b0 as h,aW as g,cW as w,b3 as j,aX as b,b4 as k,cX as x,b7 as F,bi as I,bh as S,bb as E,bt as P,b6 as V,aZ as C}from"./index.js";import{E as O}from"./el-tree-CQ1wVezD.js";/* empty css                    */import"./el-text-CfqiFw0F.js";/* empty css                                                                          *//* empty css               *//* empty css                             */import{E as T}from"./el-divider-BW0DbTKo.js";import{E as D,a as $}from"./el-select-JVjgICbv.js";import"./DocumentPreview.vue_vue_type_style_index_0_scoped_056f7814_lang-Cvhffcax.js";import{S as U}from"./SSEStreamViewer-B3MWJYrC.js";import{D as M}from"./DocumentUploader-BNXqMCtP.js";import{D as q}from"./DocumentPreview-B3F3GS6M.js";import{R as z}from"./RichTextEditor-DlF8zAiW.js";import{u as H,a as N,H as R,S as W,b as L,E as A,c as J,d as G}from"./helpers-CxsogxTd.js";import{t as K}from"./tender-B2_G1CPt.js";import{a as X,E as Y}from"./index-QjymKf1u.js";import{E as Q}from"./index--HjUvM4F.js";import{a as Z,E as B}from"./index-DQuz_84T.js";import{E as ee}from"./index-CiTGQxVM.js";import{E as le}from"./index-DwbH8caQ.js";import"./toNumber-CM6xia4s.js";import"./_baseIteratee-chHnNCKt.js";import"./imageCompressor-CTkRt5bg.js";import"./index-Ck60z3mc.js";import"./cloneDeep-BA-8E20e.js";/* empty css                   */import"./directive-BQ8mY-Bz.js";import"./index-CtMmaQjp.js";import"./project-D1NKtbTH.js";/* empty css                */import"./index-CzUw8qg0.js";import"./index-Da2rArSZ.js";import"./index-D28500cA.js";import"./index-YEioaD_d.js";import"./flatMap-BtkQY1kY.js";import"./map-Dt0HIbty.js";import"./_baseEach-B8o-eFGg.js";import"./raf-p9A-23_P.js";const ae={class:"tech-proposal"},te={class:"card-header"},oe={class:"action-controls"},se={class:"card-header"},ne={class:"card-header"},ue={class:"requirement-categories"},ie={class:"category-title"},re={class:"category-content"},de={key:0,class:"category-summary"},ce={key:1,class:"category-keywords"},pe={key:2,class:"category-points"},ve={class:"card-header"},me={class:"ç« èŠ‚ç»“æ„"},fe={class:"tree-node"},_e={class:"node-title"},ye={key:2,class:"node-desc"},he={class:"card-header"},ge={class:"header-actions"},we={class:"result-content"},je={class:"output-files"},be={class:"file-buttons"},ke=C(e({__name:"TechProposal",setup(e){const{projects:C,selectedProject:ke,currentDocuments:xe,loadProjects:Fe,handleProjectChange:Ie,restoreProjectFromStore:Se}=H(),{useHitlFile:Ee,hitlFileInfo:Pe,syncing:Ve,synced:Ce,loadFromHITL:Oe,cancelHitlFile:Te,syncToHitl:De}=N({onFileLoaded:()=>{ze.value.tenderFiles=[]}}),$e=l([]),Ue=l(!1),Me=async()=>{},qe=async e=>{try{if(!e.downloadUrl)return void V.error("ä¸‹è½½åœ°å€æ— æ•ˆ");const l=e.filename||e.downloadUrl.split("/").pop()||"æŠ€æœ¯æ–¹æ¡ˆ.docx";G(e.downloadUrl,l),V.success("æ–‡ä»¶ä¸‹è½½ä¸­...")}catch(l){V.error(l.message||"ä¸‹è½½æ–‡ä»¶å¤±è´¥")}},ze=l({projectId:null,tenderFiles:[]}),He=l({outputPrefix:"æŠ€æœ¯æ–¹æ¡ˆ",aiModel:"gpt-4o-mini",additionalOutputs:["includeAnalysis","includeMapping","includeSummary"]}),Ne=l(!1),Re=l(0),We=l(""),Le=l(null),Ae=l(!0),Je=l(null),Ge=l(!0),Ke=l(null),Xe=l(null),Ye=l(!1),Qe=l(""),Ze=l(""),Be=l(!1),el=l(null),ll=l(""),al=l(!1),tl=l(!1),ol=a(()=>{var e;return(null==(e=Je.value)?void 0:e.chapters)?Je.value.chapters:[]}),sl=a(()=>ze.value.projectId&&(Ee.value||ze.value.tenderFiles.length>0)),nl=async e=>{var l;const{file:a,onSuccess:t,onError:o}=e;if(!ze.value.projectId){return o(new Error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")),void V.error("è¯·å…ˆé€‰æ‹©é¡¹ç›®")}if(!(null==(l=ke.value)?void 0:l.company_id)){return o(new Error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")),void V.error("é¡¹ç›®æ²¡æœ‰å…³è”å…¬å¸")}try{const e=new FormData;e.append("file",a),e.append("company_id",ke.value.company_id.toString()),e.append("project_id",ze.value.projectId.toString());const l=await K.parseDocumentStructure(e);if(!l.success)throw new Error(l.message||"ä¸Šä¼ å¤±è´¥");t(l.data),V.success("æŠ€æœ¯éœ€æ±‚æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")}catch(s){o(s),V.error(s.message||"æ–‡æ¡£ä¸Šä¼ å¤±è´¥")}},ul=()=>{V.success("æ–‡æ¡£ä¸Šä¼ æˆåŠŸ")},il=async()=>{await Ie(ze.value.projectId,{onClear:()=>{ze.value.tenderFiles=[],Le.value=null,Je.value=null,Ke.value=null,Xe.value=null,We.value="",Be.value=!1,ll.value="",Ee.value&&Te()},onDocumentsLoaded:e=>{e.technicalFile&&Oe(e,"technicalFile"),e.techProposalFile&&(Xe.value=e.techProposalFile,V.success("å·²åŠ è½½å†å²æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶"))}})},rl=async()=>{var e;if(sl.value){Ne.value=!0,Re.value=0,We.value="",Le.value=null,Je.value=null,Ke.value=null;try{const l=new FormData;if(Ee.value&&Pe.value)l.append("use_hitl_technical_file","true"),l.append("project_id",ze.value.projectId.toString());else{if(!(null==(e=ze.value.tenderFiles[0])?void 0:e.raw))throw new Error("è¯·ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£æˆ–ä½¿ç”¨æŠ€æœ¯æ–‡ä»¶");l.append("tender_file",ze.value.tenderFiles[0].raw)}l.append("outputPrefix",He.value.outputPrefix),l.append("companyId",ke.value.company_id.toString()),l.append("projectName",ke.value.project_name||""),l.append("projectId",ze.value.projectId.toString()),l.append("includeAnalysis",He.value.additionalOutputs.includes("includeAnalysis")?"true":"false"),l.append("includeMapping",He.value.additionalOutputs.includes("includeMapping")?"true":"false"),l.append("includeSummary",He.value.additionalOutputs.includes("includeSummary")?"true":"false"),await dl(l),V.success("æŠ€æœ¯æ–¹æ¡ˆç”Ÿæˆå®Œæˆ")}catch(l){V.error(l.message||"ç”Ÿæˆå¤±è´¥ï¼Œè¯·é‡è¯•")}finally{Ne.value=!1}}else V.warning("è¯·é€‰æ‹©é¡¹ç›®å¹¶ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£")},dl=async e=>{var l,a,t;const o=await fetch("/api/generate-proposal-stream-v2",{method:"POST",body:e});if(!o.ok)throw new Error(`HTTP ${o.status}: ${o.statusText}`);const s=null==(l=o.body)?void 0:l.getReader();if(!s)throw new Error("æ— æ³•è¯»å–å“åº”æµ");const n=new TextDecoder;let u="";const i={};let r="";for(;;){const{done:e,value:l}=await s.read();if(e)break;u+=n.decode(l,{stream:!0});const o=u.split("\n");u=o.pop()||"";for(const s of o)if(s.startsWith("data: "))try{const e=JSON.parse(s.slice(6));if(void 0!==e.progress&&(Re.value=e.progress),e.message&&(We.value+=e.message+"\n"),"analysis_completed"===e.stage&&e.analysis_result&&(Le.value=e.analysis_result),"outline_completed"===e.stage&&e.outline_data&&(Je.value=e.outline_data),"content_generation"===e.stage)if("chapter_start"===e.event)r=e.chapter_number||"",i[r]="",We.value+=`\n\n## ${e.chapter_number} ${e.chapter_title}\n\n`;else if("content_chunk"===e.event){const l=e.chapter_number||r;l&&(i[l]=(i[l]||"")+(e.content||""),cl(i))}else"chapter_end"===e.event&&(We.value+=`\nâœ“ ${e.chapter_title||"ç« èŠ‚"} ç”Ÿæˆå®Œæˆ\n`);if("completed"===e.stage&&e.success&&(Ke.value=e,Xe.value={outputFile:e.output_file,downloadUrl:null==(a=e.output_files)?void 0:a.proposal,stats:{requirements_count:e.requirements_count,sections_count:e.sections_count,matches_count:e.matches_count},message:"æŠ€æœ¯æ–¹æ¡ˆå·²ç”Ÿæˆ"},Be.value=!0,e.output_file&&ze.value.projectId&&await De(ze.value.projectId,e.output_file,"tech_proposal")),"error"===e.stage)throw We.value+=`\nâŒ é”™è¯¯: ${e.error||e.message}\n`,new Error(e.error||e.message||"ç”Ÿæˆå¤±è´¥")}catch(d){if(!(null==(t=d.message)?void 0:t.includes("JSON")))throw d}}},cl=e=>{let l="";for(const[a,t]of Object.entries(e))l+=`<h2>${a}</h2>\n`,l+=`<div>${t.replace(/\n/g,"<br>")}</div>\n`;ll.value=l},pl=()=>{Ne.value=!1,V.info("å·²åœæ­¢ç”Ÿæˆ")},vl=e=>{var l,a;if(!(null==(a=null==(l=Ke.value)?void 0:l.output_files)?void 0:a[e]))return void V.warning("æ–‡ä»¶ä¸å­˜åœ¨");const t=Ke.value.output_files[e],o=t.split("/").pop()||`æŠ€æœ¯æ–¹æ¡ˆ_${e}.docx`;G(t,o),V.success("ä¸‹è½½å·²å¼€å§‹")},ml=()=>{var e,l,a;(null==(l=null==(e=Ke.value)?void 0:e.output_files)?void 0:l.proposal)?(Qe.value=Ke.value.output_files.proposal,Ze.value=`æŠ€æœ¯æ–¹æ¡ˆ-${(null==(a=ke.value)?void 0:a.project_name)||"æ–‡æ¡£"}.docx`,Ye.value=!0):V.warning("æš‚æ— æ–‡æ¡£å¯é¢„è§ˆ")},fl=e=>{Qe.value=e.file_path||e.outputFile,Ze.value=e.filename||"æŠ€æœ¯æ–¹æ¡ˆ.docx",Ye.value=!0},_l=async()=>{var e;(null==(e=Ke.value)?void 0:e.output_file)?ze.value.projectId?await De(ze.value.projectId,Ke.value.output_file,"tech_proposal"):V.error("é¡¹ç›®IDæ— æ•ˆ"):V.warning("æ²¡æœ‰å¯åŒæ­¥çš„æ–‡ä»¶")},yl=()=>{Xe.value=null,Ke.value=null,Le.value=null,Je.value=null,Be.value=!1,ll.value="",V.info("è¯·é…ç½®å‚æ•°åé‡æ–°ç”Ÿæˆ")},hl=async e=>{var l;if(null==(l=Ke.value)?void 0:l.output_file)try{tl.value=!0;const l=await fetch("/api/editor/save-html-to-word",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html_content:e,project_id:ze.value.projectId,document_type:"tech_proposal",original_file:Ke.value.output_file})}),a=await l.json();if(!a.success)throw new Error(a.error||"ä¿å­˜å¤±è´¥");V.success("æŠ€æœ¯æ–¹æ¡ˆå†…å®¹å·²ä¿å­˜"),a.output_file&&(Ke.value.output_file=a.output_file,a.download_url&&Ke.value.output_files&&(Ke.value.output_files.proposal=a.download_url)),a.output_file&&ze.value.projectId&&await De(ze.value.projectId,a.output_file,"tech_proposal")}catch(a){throw a}finally{tl.value=!1}else V.warning("æ²¡æœ‰å¯ä¿å­˜çš„æ–‡ä»¶")},gl=async()=>{var e;if(null==(e=Xe.value)?void 0:e.outputFile)try{Be.value=!0,await(async e=>{try{al.value=!0,ll.value='<p style="color: #409EFF;">æ­£åœ¨è½¬æ¢Wordæ–‡æ¡£ä¸ºå¯ç¼–è¾‘æ ¼å¼...</p>';const l=await fetch("/api/editor/convert-word-to-html",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({file_path:e})}),a=await l.json();if(!a.success||!a.html_content)throw new Error(a.error||"è½¬æ¢å¤±è´¥");ll.value=a.html_content,el.value&&el.value.setContent(a.html_content)}catch(l){ll.value=`\n      <h1>ğŸ“„ æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£</h1>\n      <div style="padding: 20px; background: #FFF3E0; border-left: 4px solid #FF9800; margin: 16px 0;">\n        <p><strong>âš ï¸ æç¤ºï¼š</strong>Wordæ–‡æ¡£è½¬æ¢å¤±è´¥</p>\n        <p>åŸå› ï¼š${l.message}</p>\n        <p>æ‚¨å¯ä»¥ï¼š</p>\n        <ul>\n          <li>ç›´æ¥åœ¨æ­¤ç¼–è¾‘å™¨ä¸­è¾“å…¥å†…å®¹</li>\n          <li>æˆ–ç‚¹å‡»ä¸‹æ–¹"é¢„è§ˆWord"æˆ–"ä¸‹è½½"æŒ‰é’®æŸ¥çœ‹åŸå§‹æ–‡æ¡£</li>\n        </ul>\n      </div>\n      <p>å¼€å§‹ç¼–è¾‘æ‚¨çš„å†…å®¹...</p>\n    `,V.warning("Wordè½¬æ¢HTMLå¤±è´¥ï¼Œè¯·ä½¿ç”¨é¢„è§ˆæˆ–ä¸‹è½½åŠŸèƒ½")}finally{al.value=!1}})(Xe.value.outputFile),V.success("å†å²æ–‡ä»¶å·²åŠ è½½åˆ°ç¼–è¾‘å™¨"),setTimeout(()=>{var e;null==(e=document.querySelector(".editor-section"))||e.scrollIntoView({behavior:"smooth",block:"start"})},100)}catch(l){V.error("æ‰“å¼€å†å²æ–‡ä»¶å¤±è´¥: "+l.message)}else V.error("å†å²æ–‡ä»¶ä¿¡æ¯æ— æ•ˆ")};return t(async()=>{await Fe();const e=await Se({onClear:()=>{ze.value.tenderFiles=[],Le.value=null,Je.value=null,Ke.value=null,Xe.value=null,Ee.value&&Te()},onDocumentsLoaded:e=>{e.technicalFile&&Oe(e,"technicalFile"),e.techProposalFile&&(Xe.value=e.techProposalFile)}});e&&(ze.value.projectId=e)}),(e,l)=>{const a=$,t=D,V=c,H=Y,N=f,G=X,K=d,Fe=Q,Ie=h,Se=T,De=B,dl=Z,cl=g,wl=ee,jl=le,bl=A,kl=L,xl=O;return s(),o("div",ae,[n(Fe,{class:"project-section",shadow:"never"},{header:r(()=>[...l[15]||(l[15]=[_("div",{class:"card-header"},[_("span",null,"Step 1: é€‰æ‹©é¡¹ç›®")],-1)])]),default:r(()=>[n(K,{model:ze.value,"label-width":"100px"},{default:r(()=>[n(G,{gutter:20},{default:r(()=>[n(H,{span:12},{default:r(()=>[n(V,{label:"é¡¹ç›®"},{default:r(()=>[n(t,{modelValue:ze.value.projectId,"onUpdate:modelValue":l[0]||(l[0]=e=>ze.value.projectId=e),placeholder:"è¯·é€‰æ‹©é¡¹ç›®",filterable:"",onChange:il,style:{width:"100%"}},{default:r(()=>[(s(!0),o(p,null,v(m(C),e=>(s(),u(a,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(H,{span:12},{default:r(()=>[n(V,{label:"å…¬å¸"},{default:r(()=>{var e;return[n(N,{value:(null==(e=m(ke))?void 0:e.company_name)||"-",disabled:""},null,8,["value"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),ze.value.projectId?(s(),u(Fe,{key:0,class:"upload-section",shadow:"never"},{header:r(()=>[_("div",te,[l[17]||(l[17]=_("span",null,"Step 2: ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",-1)),m(xe).technicalFile&&!m(Ee)?(s(),u(Ie,{key:0,type:"primary",size:"small",onClick:l[1]||(l[1]=e=>m(Oe)(m(xe),"technicalFile"))},{default:r(()=>[...l[16]||(l[16]=[y(" ä½¿ç”¨æŠ€æœ¯éœ€æ±‚æ–‡ä»¶ ",-1)])]),_:1})):i("",!0)])]),default:r(()=>[m(Ee)?(s(),u(m(R),{key:0,"file-info":m(Pe),label:"æŠ€æœ¯éœ€æ±‚æ–‡ä»¶:",onCancel:m(Te)},null,8,["file-info","onCancel"])):i("",!0),m(Ee)?i("",!0):(s(),u(m(M),{key:1,modelValue:ze.value.tenderFiles,"onUpdate:modelValue":l[2]||(l[2]=e=>ze.value.tenderFiles=e),"http-request":nl,accept:".pdf,.doc,.docx",limit:1,"max-size":50,drag:"","tip-text":"ä¸Šä¼ æŠ€æœ¯éœ€æ±‚æ–‡æ¡£",onSuccess:ul},null,8,["modelValue"])),n(Se,null,{default:r(()=>[...l[18]||(l[18]=[y("ç”Ÿæˆé€‰é¡¹",-1)])]),_:1}),n(K,{model:He.value,"label-width":"140px",class:"config-form"},{default:r(()=>[n(G,{gutter:20},{default:r(()=>[n(H,{span:12},{default:r(()=>[n(V,{label:"è¾“å‡ºæ–‡ä»¶å‰ç¼€"},{default:r(()=>[n(N,{modelValue:He.value.outputPrefix,"onUpdate:modelValue":l[3]||(l[3]=e=>He.value.outputPrefix=e),placeholder:"æŠ€æœ¯æ–¹æ¡ˆ"},null,8,["modelValue"])]),_:1})]),_:1}),n(H,{span:12},{default:r(()=>[n(V,{label:"AIæ¨¡å‹"},{default:r(()=>[n(t,{modelValue:He.value.aiModel,"onUpdate:modelValue":l[4]||(l[4]=e=>He.value.aiModel=e),style:{width:"100%"}},{default:r(()=>[n(a,{label:"GPT-4O Miniï¼ˆæ¨èï¼‰",value:"gpt-4o-mini"}),n(a,{label:"GPT-4Oï¼ˆé«˜è´¨é‡ï¼‰",value:"gpt-4o"}),n(a,{label:"å§‹çš‡-GPT4oè¿·ä½ ç‰ˆ",value:"shihuang-gpt4o-mini"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),n(V,{label:"é™„åŠ è¾“å‡º"},{default:r(()=>[n(dl,{modelValue:He.value.additionalOutputs,"onUpdate:modelValue":l[5]||(l[5]=e=>He.value.additionalOutputs=e)},{default:r(()=>[n(De,{label:"includeAnalysis"},{default:r(()=>[...l[19]||(l[19]=[y("éœ€æ±‚åˆ†ææŠ¥å‘Š",-1)])]),_:1}),n(De,{label:"includeMapping"},{default:r(()=>[...l[20]||(l[20]=[y("éœ€æ±‚åŒ¹é…è¡¨",-1)])]),_:1}),n(De,{label:"includeSummary"},{default:r(()=>[...l[21]||(l[21]=[y("ç”Ÿæˆæ€»ç»“æŠ¥å‘Š",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"]),_("div",oe,[n(Ie,{type:"primary",size:"large",disabled:!sl.value,loading:Ne.value,onClick:rl},{default:r(()=>[n(cl,null,{default:r(()=>[n(m(w))]),_:1}),l[22]||(l[22]=y(" ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1},8,["disabled","loading"])])]),_:1})):i("",!0),Ne.value?(s(),u(Fe,{key:1,class:"generation-output",shadow:"never"},{header:r(()=>[_("div",se,[l[23]||(l[23]=_("span",null,"AIæ­£åœ¨ç”ŸæˆæŠ€æœ¯æ–¹æ¡ˆ...",-1)),n(wl,{percentage:Re.value,status:100===Re.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:r(()=>[n(m(U),{content:We.value,"is-streaming":Ne.value,onStop:pl},null,8,["content","is-streaming"])]),_:1})):i("",!0),Le.value?(s(),u(Fe,{key:2,class:"analysis-section",shadow:"never"},{header:r(()=>[_("div",ne,[l[24]||(l[24]=_("span",null,"éœ€æ±‚åˆ†æç»“æœ",-1)),n(Ie,{size:"small",onClick:l[6]||(l[6]=e=>Ae.value=!Ae.value)},{default:r(()=>[y(b(Ae.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:r(()=>[j(_("div",null,[n(m(W),{title:"æ–‡æ¡£æ‘˜è¦",stats:Le.value.document_summary||{},"stat-items":[{key:"total_requirements",label:"æ€»éœ€æ±‚æ•°",suffix:"é¡¹"},{key:"mandatory_count",label:"å¼ºåˆ¶éœ€æ±‚",suffix:"é¡¹"},{key:"optional_count",label:"å¯é€‰éœ€æ±‚",suffix:"é¡¹"}]},null,8,["stats"]),_("div",ue,[l[27]||(l[27]=_("h4",null,"éœ€æ±‚åˆ†ç±»",-1)),n(kl,{accordion:""},{default:r(()=>[(s(!0),o(p,null,v(Le.value.requirement_categories,(e,a)=>(s(),u(bl,{key:a,name:a},{title:r(()=>{return[_("div",ie,[_("span",null,b(e.category),1),n(jl,{type:(l=e.priority,{"é«˜":"danger",high:"danger","ä¸­":"warning",medium:"warning","ä½":"info",low:"info"}[l]||"info"),size:"small"},{default:r(()=>[y(b(e.priority),1)]),_:2},1032,["type"]),n(jl,{type:"info",size:"small"},{default:r(()=>[y(b(e.requirements_count||0)+"é¡¹ ",1)]),_:2},1024)])];var l}),default:r(()=>[_("div",re,[e.summary?(s(),o("p",de,b(e.summary),1)):i("",!0),e.keywords&&e.keywords.length>0?(s(),o("div",ce,[l[25]||(l[25]=_("strong",null,"å…³é”®è¯ï¼š",-1)),(s(!0),o(p,null,v(e.keywords,e=>(s(),u(jl,{key:e,size:"small",style:{"margin-right":"8px"}},{default:r(()=>[y(b(e),1)]),_:2},1024))),128))])):i("",!0),e.key_points&&e.key_points.length>0?(s(),o("div",pe,[l[26]||(l[26]=_("strong",null,"è¦ç‚¹ï¼š",-1)),_("ul",null,[(s(!0),o(p,null,v(e.key_points,(e,l)=>(s(),o("li",{key:l},b(e),1))),128))])])):i("",!0)])]),_:2},1032,["name"]))),128))]),_:1})])],512),[[k,Ae.value]])]),_:1})):i("",!0),Je.value?(s(),u(Fe,{key:3,class:"outline-section",shadow:"never"},{header:r(()=>[_("div",ve,[l[28]||(l[28]=_("span",null,"æŠ€æœ¯æ–¹æ¡ˆå¤§çº²",-1)),n(Ie,{size:"small",onClick:l[7]||(l[7]=e=>Ge.value=!Ge.value)},{default:r(()=>[y(b(Ge.value?"æ”¶èµ·":"å±•å¼€"),1)]),_:1})])]),default:r(()=>[j(_("div",null,[n(m(W),{title:"å¤§çº²æ¦‚è§ˆ",stats:Je.value,"stat-items":[{key:"total_chapters",label:"æ€»ç« èŠ‚æ•°",suffix:"ç« "},{key:"estimated_pages",label:"é¢„è®¡é¡µæ•°",suffix:"é¡µ"}],span:12},null,8,["stats"]),_("div",me,[l[29]||(l[29]=_("h4",null,"ç« èŠ‚ç»“æ„",-1)),n(xl,{data:ol.value,props:{label:"title",children:"subsections"},"default-expand-all":"","node-key":"chapter_number"},{default:r(({node:e,data:l})=>[_("span",fe,[1===l.level?(s(),u(cl,{key:0},{default:r(()=>[n(m(x))]),_:1})):(s(),u(cl,{key:1},{default:r(()=>[n(m(F))]),_:1})),_("span",_e,b(l.chapter_number)+" "+b(l.title),1),l.description?(s(),o("span",ye,b(l.description),1)):i("",!0)])]),_:1},8,["data"])])],512),[[k,Ge.value]])]),_:1})):i("",!0),Be.value?(s(),u(Fe,{key:4,class:"editor-section",shadow:"never"},{default:r(()=>[n(m(z),{ref_key:"editorRef",ref:el,modelValue:ll.value,"onUpdate:modelValue":l[8]||(l[8]=e=>ll.value=e),title:"æŠ€æœ¯æ–¹æ¡ˆæ–‡æ¡£",loading:al.value,saving:tl.value,onSave:hl},null,8,["modelValue","loading","saving"])]),_:1})):i("",!0),Ke.value?(s(),u(Fe,{key:5,class:"result-section",shadow:"never"},{header:r(()=>[_("div",he,[l[35]||(l[35]=_("span",null,"âœ… ç”Ÿæˆç»“æœ",-1)),_("div",ge,[n(Ie,{type:"primary",icon:m(S),onClick:ml},{default:r(()=>[...l[30]||(l[30]=[y(" é¢„è§ˆæ–‡æ¡£ ",-1)])]),_:1},8,["icon"]),n(Ie,{type:"success",icon:m(I),onClick:l[9]||(l[9]=e=>vl("proposal"))},{default:r(()=>[...l[31]||(l[31]=[y(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1)])]),_:1},8,["icon"]),m(Ce)?(s(),u(jl,{key:1,type:"success",size:"large"},{default:r(()=>[...l[33]||(l[33]=[y(" å·²åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1})):(s(),u(Ie,{key:0,type:"info",icon:m(E),loading:m(Ve),onClick:_l},{default:r(()=>[...l[32]||(l[32]=[y(" åŒæ­¥åˆ°æŠ•æ ‡é¡¹ç›® ",-1)])]),_:1},8,["icon","loading"])),n(Ie,{type:"primary",icon:m(P),onClick:rl},{default:r(()=>[...l[34]||(l[34]=[y(" é‡æ–°ç”Ÿæˆ ",-1)])]),_:1},8,["icon"])])])]),default:r(()=>{var e,a,t,o;return[_("div",we,[n(m(W),{title:"ç”Ÿæˆç»Ÿè®¡",stats:Ke.value,"stat-items":[{key:"requirements_count",label:"éœ€æ±‚æ•°é‡",suffix:"é¡¹"},{key:"sections_count",label:"ç« èŠ‚æ•°é‡",suffix:"ç« "},{key:"matches_count",label:"åŒ¹é…æ•°é‡",suffix:"é¡¹"}]},null,8,["stats"]),_("div",je,[l[40]||(l[40]=_("h4",null,"è¾“å‡ºæ–‡ä»¶",-1)),_("div",be,[(null==(e=Ke.value.output_files)?void 0:e.proposal)?(s(),u(Ie,{key:0,type:"success",onClick:l[10]||(l[10]=e=>vl("proposal"))},{default:r(()=>[n(cl,null,{default:r(()=>[n(m(I))]),_:1}),l[36]||(l[36]=y(" ä¸‹è½½æŠ€æœ¯æ–¹æ¡ˆ ",-1))]),_:1})):i("",!0),(null==(a=Ke.value.output_files)?void 0:a.analysis)?(s(),u(Ie,{key:1,type:"primary",onClick:l[11]||(l[11]=e=>vl("analysis"))},{default:r(()=>[n(cl,null,{default:r(()=>[n(m(I))]),_:1}),l[37]||(l[37]=y(" ä¸‹è½½éœ€æ±‚åˆ†æ ",-1))]),_:1})):i("",!0),(null==(t=Ke.value.output_files)?void 0:t.mapping)?(s(),u(Ie,{key:2,type:"info",onClick:l[12]||(l[12]=e=>vl("mapping"))},{default:r(()=>[n(cl,null,{default:r(()=>[n(m(I))]),_:1}),l[38]||(l[38]=y(" ä¸‹è½½åŒ¹é…è¡¨ ",-1))]),_:1})):i("",!0),(null==(o=Ke.value.output_files)?void 0:o.summary)?(s(),u(Ie,{key:3,type:"warning",onClick:l[13]||(l[13]=e=>vl("summary"))},{default:r(()=>[n(cl,null,{default:r(()=>[n(m(I))]),_:1}),l[39]||(l[39]=y(" ä¸‹è½½ç”ŸæˆæŠ¥å‘Š ",-1))]),_:1})):i("",!0)])])])]}),_:1})):i("",!0),ze.value.projectId?(s(),u(m(J),{key:6,title:"è¯¥é¡¹ç›®çš„æŠ€æœ¯æ–¹æ¡ˆæ–‡ä»¶","current-file":Xe.value,"history-files":$e.value,loading:Ue.value,"show-stats":!1,"show-editor-open":!0,onPreview:fl,onDownload:qe,onRegenerate:yl,onRefresh:Me,onOpenInEditor:gl},null,8,["current-file","history-files","loading"])):i("",!0),n(m(q),{modelValue:Ye.value,"onUpdate:modelValue":l[14]||(l[14]=e=>Ye.value=e),"file-url":Qe.value,"file-name":Ze.value},null,8,["modelValue","file-url","file-name"])])}}}),[["__scopeId","data-v-fad9643c"]]);export{ke as default};
