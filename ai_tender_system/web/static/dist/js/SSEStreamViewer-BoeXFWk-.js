import{D as x,N as E,Q as T,a as M,ag as V,ah as h,$ as L,a1 as R,k as d}from"./element-plus-IkZgpaz4.js";import{bT as N,bt as U,bu as $,dM as H,bA as D,bU as p,bV as r,c2 as j,c8 as y,c3 as u,c0 as s,bY as k,bv as c,b$ as m,c5 as f,bH as I}from"./vendor-CdA3MjAt.js";/* empty css                                                                          */import{_ as O}from"./index.js";const z=["innerHTML"],A={key:0,class:"streaming-indicator"},Q={key:0,class:"stream-actions"},Y=N({__name:"SSEStreamViewer",props:{content:{},isStreaming:{type:Boolean,default:!1},enableMarkdown:{type:Boolean,default:!0},autoScroll:{type:Boolean,default:!0}},emits:["stop","regenerate"],setup(n,{emit:g}){const t=n,b=g,l=U(null),w=$(()=>{if(!t.content)return"";if(t.enableMarkdown)try{return H.parse(t.content)}catch(o){return console.error("Markdown 解析失败:",o),t.content}return t.content.replace(/\n/g,"<br>")});D(()=>t.content,async()=>{t.autoScroll&&t.isStreaming&&(await I(),v())});const v=()=>{l.value&&(l.value.scrollTop=l.value.scrollHeight)},S=async()=>{try{await navigator.clipboard.writeText(t.content),d.success("内容已复制到剪贴板")}catch(o){console.error("复制失败:",o),d.error("复制失败，请手动复制")}},C=()=>{try{const o=new Blob([t.content],{type:"text/plain;charset=utf-8"}),e=URL.createObjectURL(o),a=document.createElement("a");a.href=e,a.download=`ai-content-${Date.now()}.txt`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(e),d.success("文档下载成功")}catch(o){console.error("下载失败:",o),d.error("下载失败，请重试")}};return(o,e)=>{const a=x,_=T,i=M;return r(),p("div",{class:j(["sse-stream-viewer",{"is-loading":n.isStreaming}])},[y(_,{class:"stream-content",shadow:"never"},{default:s(()=>[k("div",{ref_key:"contentRef",ref:l,class:"content-wrapper",innerHTML:w.value},null,8,z),n.isStreaming?(r(),p("div",A,[y(a,{class:"is-loading"},{default:s(()=>[y(c(E))]),_:1}),e[2]||(e[2]=k("span",null,"正在生成中...",-1))])):u("",!0)]),_:1}),n.content?(r(),p("div",Q,[n.isStreaming?(r(),m(i,{key:0,type:"warning",icon:c(V),onClick:e[0]||(e[0]=B=>b("stop"))},{default:s(()=>[...e[3]||(e[3]=[f(" 停止生成 ",-1)])]),_:1},8,["icon"])):(r(),m(i,{key:1,type:"primary",icon:c(h),onClick:S},{default:s(()=>[...e[4]||(e[4]=[f(" 复制内容 ",-1)])]),_:1},8,["icon"])),!n.isStreaming&&n.content?(r(),m(i,{key:2,type:"success",icon:c(L),onClick:C},{default:s(()=>[...e[5]||(e[5]=[f(" 下载文档 ",-1)])]),_:1},8,["icon"])):u("",!0),!n.isStreaming&&n.content?(r(),m(i,{key:3,icon:c(R),onClick:e[1]||(e[1]=B=>b("regenerate"))},{default:s(()=>[...e[6]||(e[6]=[f(" 重新生成 ",-1)])]),_:1},8,["icon"])):u("",!0)])):u("",!0)],2)}}}),K=O(Y,[["__scopeId","data-v-cba4d568"]]);export{K as S};
