import{ax as e,T as a,a2 as l,aV as s,_ as t,c2 as o,A as i,au as n,u as r,c3 as u,c4 as c,b9 as d,c5 as p,e as v,a5 as m,bB as f,b5 as _,c6 as y,bs as g,aa as b,J as h,c7 as k,c8 as w,aI as x,aK as S,w as z,c9 as C,ca as I,l as V,cb as $,cc as E,cd as O,ce as j,cf as N,aB as T,U as A,a4 as B,b7 as P,M as R,P as U,N as q,O as L,aN as M,d as Y,h as D,p as F,aR as X,q as W}from"./index.js";/* empty css               *//* empty css                *//* empty css                *//* empty css                    *//* empty css                                                        */import{u as K,E as Q,a as G}from"./el-tab-pane-CDDyJbHC.js";/* empty css                             *//* empty css                     */import{d as H,E as J,a as Z}from"./el-select-BJBcYONu.js";/* empty css                                                                            */import{bx as ee,am as ae,bU as le,an as se,cj as te,ao as oe,c8 as ie,ap as ne,aW as re,aq as ue,ar as ce,as as de,ax as pe,aR as ve,aw as me,aS as fe,aB as _e,ay as ye,av as ge,au as be,aO as he,aU as ke,az as we,aD as xe,aC as Se,aT as ze,aF as Ce,bI as Ie,bR as Ve,aP as $e,bJ as Ee,bX as Oe,ch as je,bB as Ne,c3 as Te,bP as Ae,bO as Be,aX as Pe,at as Re,aV as Ue,aA as qe}from"./editor-DIU3HkCl.js";import{c as Le}from"./company-CHa0NuIL.js";import{E as Me}from"./index-CNRcJ6ka.js";import{E as Ye}from"./index-DUONv1q7.js";import{E as De}from"./index-E3rjqy71.js";import{E as Fe,a as Xe}from"./index-CBo-fVzc.js";import{E as We}from"./index-BEtJVLvu.js";import{E as Ke}from"./strings-BtUgbwSu.js";import{E as Qe}from"./index-CyT3SlO3.js";import{E as Ge}from"./index-8o1yQINi.js";function He(e,a,l){var s=!0,t=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return ee(l)&&(s="leading"in l?!!l.leading:s,t="trailing"in l?!!l.trailing:t),H(e,a,{leading:s,maxWait:a,trailing:t})}const Je=a({urlList:{type:l(Array),default:()=>s([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:Boolean,teleported:Boolean,closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:l(String)}}),Ze={close:()=>!0,error:e=>e instanceof Event,switch:a=>e(a),rotate:a=>e(a)},ea=ae({name:"ElImageViewer"});const aa=z(t(ae({...ea,props:Je,emits:Ze,setup(e,{expose:a,emit:l}){var s;const t=e,z={CONTAIN:{name:"contain",icon:le(i)},ORIGINAL:{name:"original",icon:le(o)}};let C,I="";const{t:V}=n(),$=r("image-viewer"),{nextZIndex:E}=u(),O=se(),j=se(),N=te(),T=oe(()=>{const{scale:e,minScale:a,maxScale:l}=t;return c(e,a,l)}),A=se(!0),B=se(!1),P=se(t.initialIndex),R=ie(z.CONTAIN),U=se({scale:T.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),q=se(null!=(s=t.zIndex)?s:E()),L=oe(()=>{const{urlList:e}=t;return e.length<=1}),M=oe(()=>0===P.value),Y=oe(()=>P.value===t.urlList.length-1),D=oe(()=>t.urlList[P.value]),F=oe(()=>[$.e("btn"),$.e("prev"),$.is("disabled",!t.infinite&&M.value)]),X=oe(()=>[$.e("btn"),$.e("next"),$.is("disabled",!t.infinite&&Y.value)]),W=oe(()=>{const{scale:e,deg:a,offsetX:l,offsetY:s,enableTransition:t}=U.value;let o=l/e,i=s/e;const n=a*Math.PI/180,r=Math.cos(n),u=Math.sin(n);o=o*r+i*u,i=i*r-l/e*u;const c={transform:`scale(${e}) rotate(${a}deg) translate(${o}px, ${i}px)`,transition:t?"transform .3s":""};return R.value.name===z.CONTAIN.name&&(c.maxWidth=c.maxHeight="100%"),c}),K=oe(()=>`${P.value+1} / ${t.urlList.length}`);function Q(){N.stop(),null==C||C(),document.body.style.overflow=I,l("close")}function G(){A.value=!1}function H(e){B.value=!0,A.value=!1,l("error",e),e.target.alt=V("el.image.error")}function J(e){if(A.value||0!==e.button||!O.value)return;U.value.enableTransition=!1;const{offsetX:a,offsetY:l}=U.value,s=e.pageX,t=e.pageY,o=He(e=>{U.value={...U.value,offsetX:a+e.pageX-s,offsetY:l+e.pageY-t}}),i=d(document,"mousemove",o);d(document,"mouseup",()=>{i()}),e.preventDefault()}function Z(){U.value={scale:T.value,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ee(){if(A.value||B.value)return;const e=w(z),a=Object.values(z),l=R.value.name,s=(a.findIndex(e=>e.name===l)+1)%e.length;R.value=z[e[s]],Z()}function ae(e){B.value=!1;const a=t.urlList.length;P.value=(e+a)%a}function Ie(){M.value&&!t.infinite||ae(P.value-1)}function Ve(){Y.value&&!t.infinite||ae(P.value+1)}function $e(e,a={}){if(A.value||B.value)return;const{minScale:s,maxScale:o}=t,{zoomRate:i,rotateDeg:n,enableTransition:r}={zoomRate:t.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":U.value.scale>s&&(U.value.scale=Number.parseFloat((U.value.scale/i).toFixed(3)));break;case"zoomIn":U.value.scale<o&&(U.value.scale=Number.parseFloat((U.value.scale*i).toFixed(3)));break;case"clockwise":U.value.deg+=n,l("rotate",U.value.deg);break;case"anticlockwise":U.value.deg-=n,l("rotate",U.value.deg)}U.value.enableTransition=r}function Ee(e){var a;"pointer"===(null==(a=e.detail)?void 0:a.focusReason)&&e.preventDefault()}function Oe(){t.closeOnPressEscape&&Q()}function je(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}return ne(()=>T.value,e=>{U.value.scale=e}),ne(D,()=>{Ce(()=>{const e=j.value;(null==e?void 0:e.complete)||(A.value=!0)})}),ne(P,e=>{Z(),l("switch",e)}),re(()=>{!function(){const e=He(e=>{switch(x(e)){case S.esc:t.closeOnPressEscape&&Q();break;case S.space:ee();break;case S.left:Ie();break;case S.up:$e("zoomIn");break;case S.right:Ve();break;case S.down:$e("zoomOut")}}),a=He(e=>{$e((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:t.zoomRate,enableTransition:!1})});N.run(()=>{d(document,"keydown",e),d(document,"wheel",a)})}(),C=d("wheel",je,{passive:!1}),I=document.body.style.overflow,document.body.style.overflow="hidden"}),a({setActiveItem:ae}),(e,a)=>(ce(),ue(ye(k),{to:"body",disabled:!e.teleported},{default:de(()=>[pe(ve,{name:"viewer-fade",appear:""},{default:de(()=>[me("div",{ref_key:"wrapper",ref:O,tabindex:-1,class:_e(ye($).e("wrapper")),style:fe({zIndex:q.value})},[pe(ye(p),{loop:"",trapped:"","focus-trap-el":O.value,"focus-start-el":"container",onFocusoutPrevented:Ee,onReleaseRequested:Oe},{default:de(()=>[me("div",{class:_e(ye($).e("mask")),onClick:ke(a=>e.hideOnClickModal&&Q(),["self"])},null,10,["onClick"]),ge(" CLOSE "),me("span",{class:_e([ye($).e("btn"),ye($).e("close")]),onClick:Q},[pe(ye(v),null,{default:de(()=>[pe(ye(m))]),_:1})],2),ge(" ARROW "),ye(L)?ge("v-if",!0):(ce(),be(we,{key:0},[me("span",{class:_e(ye(F)),onClick:Ie},[pe(ye(v),null,{default:de(()=>[pe(ye(f))]),_:1})],2),me("span",{class:_e(ye(X)),onClick:Ve},[pe(ye(v),null,{default:de(()=>[pe(ye(_))]),_:1})],2)],64)),e.$slots.progress||e.showProgress?(ce(),be("div",{key:1,class:_e([ye($).e("btn"),ye($).e("progress")])},[he(e.$slots,"progress",{activeIndex:P.value,total:e.urlList.length},()=>[xe(Se(ye(K)),1)])],2)):ge("v-if",!0),ge(" ACTIONS "),me("div",{class:_e([ye($).e("btn"),ye($).e("actions")])},[me("div",{class:_e(ye($).e("actions__inner"))},[he(e.$slots,"toolbar",{actions:$e,prev:Ie,next:Ve,reset:ee,activeIndex:P.value,setActiveItem:ae},()=>[pe(ye(v),{onClick:e=>$e("zoomOut")},{default:de(()=>[pe(ye(y))]),_:1},8,["onClick"]),pe(ye(v),{onClick:e=>$e("zoomIn")},{default:de(()=>[pe(ye(g))]),_:1},8,["onClick"]),me("i",{class:_e(ye($).e("actions__divider"))},null,2),pe(ye(v),{onClick:ee},{default:de(()=>[(ce(),ue(ze(ye(R).icon)))]),_:1}),me("i",{class:_e(ye($).e("actions__divider"))},null,2),pe(ye(v),{onClick:e=>$e("anticlockwise")},{default:de(()=>[pe(ye(b))]),_:1},8,["onClick"]),pe(ye(v),{onClick:e=>$e("clockwise")},{default:de(()=>[pe(ye(h))]),_:1},8,["onClick"])])],2)],2),ge(" CANVAS "),me("div",{class:_e(ye($).e("canvas"))},[B.value&&e.$slots["viewer-error"]?he(e.$slots,"viewer-error",{key:0,activeIndex:P.value,src:ye(D)}):(ce(),be("img",{ref_key:"imgRef",ref:j,key:ye(D),src:ye(D),style:fe(ye(W)),class:_e(ye($).e("img")),crossorigin:e.crossorigin,onLoad:G,onError:H,onMousedown:J},null,46,["src","crossorigin"]))],2),he(e.$slots,"default")]),_:3},8,["focus-trap-el"])],6)]),_:3})]),_:3},8,["disabled"]))}}),[["__file","image-viewer.vue"]])),la=a({hideOnClickModal:Boolean,src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:Boolean,scrollContainer:{type:l([String,Object])},previewSrcList:{type:l(Array),default:()=>s([])},previewTeleported:Boolean,zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2},scale:{type:Number,default:1},minScale:{type:Number,default:.2},maxScale:{type:Number,default:7},showProgress:Boolean,crossorigin:{type:l(String)}}),sa={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:a=>e(a),close:()=>!0,show:()=>!0},ta=ae({name:"ElImage",inheritAttrs:!1});const oa=z(t(ae({...ta,props:la,emits:sa,setup(e,{expose:a,emit:l}){const s=e,{t:t}=n(),o=r("image"),i=Ie(),u=oe(()=>C(Object.entries(i).filter(([e])=>/^(data-|on[A-Z])/i.test(e)||["id","style"].includes(e)))),c=I({excludeListeners:!0,excludeKeys:oe(()=>Object.keys(u.value))}),d=se(),p=se(!1),v=se(!0),m=se(!1),f=se(),_=se(),y=V&&"loading"in HTMLImageElement.prototype;let g;const b=oe(()=>[o.e("inner"),k.value&&o.e("preview"),v.value&&o.is("loading")]),h=oe(()=>{const{fit:e}=s;return V&&e?{objectFit:e}:{}}),k=oe(()=>{const{previewSrcList:e}=s;return Ve(e)&&e.length>0}),w=oe(()=>{const{previewSrcList:e,initialIndex:a}=s;let l=a;return a>e.length-1&&(l=0),l}),x=oe(()=>"eager"!==s.loading&&(!y&&"lazy"===s.loading||s.lazy)),S=()=>{V&&(v.value=!0,p.value=!1,d.value=s.src)};function z(e){v.value=!1,p.value=!1,l("load",e)}function T(e){v.value=!1,p.value=!0,l("error",e)}const A=N(function(e){e&&(S(),P())},200,!0);async function B(){var e;if(!V)return;await Ce();const{scrollContainer:a}=s;if($(a))_.value=a;else if(Ne(a)&&""!==a)_.value=null!=(e=document.querySelector(a))?e:void 0;else if(f.value){const e=E(f.value);_.value=O(e)?void 0:e}const{stop:l}=j(f,([e])=>{A(e.isIntersecting)},{root:_});g=l}function P(){V&&A&&(null==g||g(),_.value=void 0,g=void 0)}function R(){k.value&&(m.value=!0,l("show"))}function U(){m.value=!1,l("close")}function q(e){l("switch",e)}return ne(()=>s.src,()=>{x.value?(v.value=!0,p.value=!1,P(),B()):S()}),re(()=>{x.value?B():S()}),a({showPreview:R}),(e,a)=>(ce(),be("div",$e({ref_key:"container",ref:f},ye(u),{class:[ye(o).b(),e.$attrs.class]}),[p.value?he(e.$slots,"error",{key:0},()=>[me("div",{class:_e(ye(o).e("error"))},Se(ye(t)("el.image.error")),3)]):(ce(),be(we,{key:1},[void 0!==d.value?(ce(),be("img",$e({key:0},ye(c),{src:d.value,loading:e.loading,style:ye(h),class:ye(b),crossorigin:e.crossorigin,onClick:R,onLoad:z,onError:T}),null,16,["src","loading","crossorigin"])):ge("v-if",!0),v.value?(ce(),be("div",{key:1,class:_e(ye(o).e("wrapper"))},[he(e.$slots,"placeholder",{},()=>[me("div",{class:_e(ye(o).e("placeholder"))},null,2)])],2)):ge("v-if",!0)],64)),ye(k)?(ce(),be(we,{key:2},[m.value?(ce(),ue(ye(aa),{key:0,"z-index":e.zIndex,"initial-index":ye(w),infinite:e.infinite,"zoom-rate":e.zoomRate,"min-scale":e.minScale,"max-scale":e.maxScale,"show-progress":e.showProgress,"url-list":e.previewSrcList,scale:e.scale,crossorigin:e.crossorigin,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:U,onSwitch:q},Ee({toolbar:de(a=>[he(e.$slots,"toolbar",Oe(je(a)))]),default:de(()=>[e.$slots.viewer?(ce(),be("div",{key:0},[he(e.$slots,"viewer")])):ge("v-if",!0)]),_:2},[e.$slots.progress?{name:"progress",fn:de(a=>[he(e.$slots,"progress",Oe(je(a)))])}:void 0,e.$slots["viewer-error"]?{name:"viewer-error",fn:de(a=>[he(e.$slots,"viewer-error",Oe(je(a)))])}:void 0]),1032,["z-index","initial-index","infinite","zoom-rate","min-scale","max-scale","show-progress","url-list","scale","crossorigin","hide-on-click-modal","teleported","close-on-press-escape"])):ge("v-if",!0)],64)):ge("v-if",!0)],16))}}),[["__file","image.vue"]])),ia=a({space:{type:[Number,String],default:""},active:{type:Number,default:0},direction:{type:String,default:"horizontal",values:["horizontal","vertical"]},alignCenter:{type:Boolean},simple:{type:Boolean},finishStatus:{type:String,values:["wait","process","finish","error","success"],default:"finish"},processStatus:{type:String,values:["wait","process","finish","error","success"],default:"process"}}),na={[T]:(a,l)=>[a,l].every(e)},ra="ElSteps",ua=ae({name:"ElSteps"});var ca=t(ae({...ua,props:ia,emits:na,setup(e,{emit:a}){const l=e,s=r("steps"),{children:t,addChild:o,removeChild:i,ChildrenSorter:n}=K(Te(),"ElStep");return ne(t,()=>{t.value.forEach((e,a)=>{e.setIndex(a)})}),Ae(ra,{props:l,steps:t,addStep:o,removeStep:i}),ne(()=>l.active,(e,l)=>{a(T,e,l)}),(e,a)=>(ce(),be("div",{class:_e([ye(s).b(),ye(s).m(e.simple?"simple":e.direction)])},[he(e.$slots,"default"),pe(ye(n))],2))}}),[["__file","steps.vue"]]);const da=a({title:{type:String,default:""},icon:{type:A},description:{type:String,default:""},status:{type:String,values:["","wait","process","finish","error","success"],default:""}}),pa=ae({name:"ElStep"});var va=t(ae({...pa,props:da,setup(a){const l=a,s=r("step"),t=se(-1),o=se({}),i=se(""),n=Be(ra),u=Te();re(()=>{ne([()=>n.props.active,()=>n.props.processStatus,()=>n.props.finishStatus],([e])=>{w(e)},{immediate:!0})});const c=oe(()=>l.status||i.value),d=oe(()=>{const e=n.steps.value[t.value-1];return e?e.internalStatus.value:"wait"}),p=oe(()=>n.props.alignCenter),f=oe(()=>"vertical"===n.props.direction),_=oe(()=>n.props.simple),y=oe(()=>n.steps.value.length),g=oe(()=>{var e;return(null==(e=n.steps.value[y.value-1])?void 0:e.uid)===u.uid}),b=oe(()=>_.value?"":n.props.space),h=oe(()=>[s.b(),s.is(_.value?"simple":n.props.direction),s.is("flex",g.value&&!b.value&&!p.value),s.is("center",p.value&&!f.value&&!_.value)]),k=oe(()=>{const a={flexBasis:e(b.value)?`${b.value}px`:b.value?b.value:100/(y.value-(p.value?0:1))+"%"};return f.value||g.value&&(a.maxWidth=100/y.value+"%"),a}),w=e=>{e>t.value?i.value=n.props.finishStatus:e===t.value&&"error"!==d.value?i.value=n.props.processStatus:i.value="wait";const a=n.steps.value[t.value-1];a&&a.calcProgress(i.value)},x={uid:u.uid,getVnode:()=>u.vnode,currentStatus:c,internalStatus:i,setIndex:e=>{t.value=e},calcProgress:e=>{const a="wait"===e,l={transitionDelay:`${a?"-":""}${150*t.value}ms`},s=e===n.props.processStatus||a?0:100;l.borderWidth=s&&!_.value?"1px":0,l["vertical"===n.props.direction?"height":"width"]=`${s}%`,o.value=l}};return n.addStep(x),Pe(()=>{n.removeStep(x)}),(e,a)=>(ce(),be("div",{style:fe(ye(k)),class:_e(ye(h))},[ge(" icon & line "),me("div",{class:_e([ye(s).e("head"),ye(s).is(ye(c))])},[ye(_)?ge("v-if",!0):(ce(),be("div",{key:0,class:_e(ye(s).e("line"))},[me("i",{class:_e(ye(s).e("line-inner")),style:fe(o.value)},null,6)],2)),me("div",{class:_e([ye(s).e("icon"),ye(s).is(e.icon||e.$slots.icon?"icon":"text")])},[he(e.$slots,"icon",{},()=>[e.icon?(ce(),ue(ye(v),{key:0,class:_e(ye(s).e("icon-inner"))},{default:de(()=>[(ce(),ue(ze(e.icon)))]),_:1},8,["class"])):"success"===ye(c)?(ce(),ue(ye(v),{key:1,class:_e([ye(s).e("icon-inner"),ye(s).is("status")])},{default:de(()=>[pe(ye(B))]),_:1},8,["class"])):"error"===ye(c)?(ce(),ue(ye(v),{key:2,class:_e([ye(s).e("icon-inner"),ye(s).is("status")])},{default:de(()=>[pe(ye(m))]),_:1},8,["class"])):ye(_)?ge("v-if",!0):(ce(),be("div",{key:3,class:_e(ye(s).e("icon-inner"))},Se(t.value+1),3))])],2)],2),ge(" title & description "),me("div",{class:_e(ye(s).e("main"))},[me("div",{class:_e([ye(s).e("title"),ye(s).is(ye(c))])},[he(e.$slots,"title",{},()=>[xe(Se(e.title),1)])],2),ye(_)?(ce(),be("div",{key:0,class:_e(ye(s).e("arrow"))},null,2)):(ce(),be("div",{key:1,class:_e([ye(s).e("description"),ye(s).is(ye(c))])},[he(e.$slots,"description",{},()=>[xe(Se(e.description),1)])],2))],2)],6))}}),[["__file","item.vue"]]);const ma=z(ca,{Step:va}),fa=P(va),_a={class:"step-content"},ya={class:"model-select"},ga={class:"step-content"},ba={class:"extraction-progress"},ha={class:"progress-text"},ka={class:"step-content preview-content"},wa={key:0,class:"no-images"},xa=["onClick"],Sa={class:"image-error"},za={class:"image-info"},Ca={class:"extraction-stats"},Ia={class:"dialog-footer"},Va=W(ae({__name:"CompanyInfoExtractorDialog",props:{modelValue:{type:Boolean},companyId:{}},emits:["update:modelValue","success"],setup(e,{emit:a}){const l=e,s=a,t=oe({get:()=>l.modelValue,set:e=>s("update:modelValue",e)}),o=oe(()=>!l.companyId),i=oe(()=>o.value?"从标书创建公司":"从标书提取信息"),n=se(0),r=se([]),u=se(null),c=se("gpt-4o-mini"),d=se(!1),p=se(!1),f=se(0),_=se(""),y=se(""),g=se([]),b=se("basic"),h=se({company_info:{},authorized_person:{},financial_info:{},qualification_images:[]}),k=[{key:"company_name",label:"公司名称"},{key:"social_credit_code",label:"统一社会信用代码",placeholder:"18位代码"},{key:"legal_representative",label:"法定代表人"},{key:"legal_representative_position",label:"法定代表人职务"},{key:"registered_capital",label:"注册资本",placeholder:"如：1000万元"},{key:"establish_date",label:"成立日期",placeholder:"YYYY-MM-DD"},{key:"company_type",label:"公司类型"},{key:"registered_address",label:"注册地址"},{key:"office_address",label:"办公地址"},{key:"fixed_phone",label:"联系电话"},{key:"email",label:"电子邮箱"},{key:"employee_count",label:"员工人数"}],w=[{key:"name",label:"被授权人姓名"},{key:"id_number",label:"身份证号",placeholder:"18位身份证号"},{key:"gender",label:"性别",placeholder:"男/女"},{key:"position",label:"职位"},{key:"title",label:"职称"},{key:"phone",label:"联系电话"}],x=[{key:"business_license",name:"营业执照"},{key:"legal_id_front",name:"法人身份证正面"},{key:"legal_id_back",name:"法人身份证反面"},{key:"auth_id_front",name:"被授权人身份证正面"},{key:"auth_id_back",name:"被授权人身份证反面"},{key:"iso9001",name:"ISO9001认证"},{key:"iso14001",name:"ISO14001认证"},{key:"iso20000",name:"ISO20000认证"},{key:"iso27001",name:"ISO27001认证"},{key:"cmmi",name:"CMMI认证"},{key:"itss",name:"ITSS认证"},{key:"value_added_telecom_permit",name:"增值电信许可证"},{key:"level_protection",name:"等级保护认证"},{key:"software_copyright",name:"软件著作权"},{key:"patent_certificate",name:"专利证书"},{key:"high_tech_enterprise",name:"高新技术企业证书"},{key:"audit_report",name:"审计报告"},{key:"bank_account_permit",name:"开户许可证"},{key:"unknown",name:"其他/未识别"}],{success:S,error:z}=R(),C=oe(()=>Object.values(h.value.company_info).filter(e=>e).length),I=oe(()=>h.value.qualification_images.filter(e=>e.confirmed).length),V=e=>{u.value=e.raw,r.value=[e]},$=()=>{u.value=null,r.value=[]},E=e=>`data:${e.content_type};base64,${e.image_data}`,O=()=>{n.value>0&&(n.value=0,f.value=0,g.value=[],_.value="")},j=async()=>{var e;if(u.value){d.value=!0,n.value=1,f.value=0,g.value=[],_.value="",y.value="正在上传文档...";try{N("正在上传文档...","loading"),f.value=10;const a=new FormData;a.append("file",u.value),a.append("model",c.value),T("success"),N("文档上传成功","success"),f.value=30,N("正在解析文档结构...","loading"),y.value="正在AI提取...",f.value=40;const l=await Le.extractFromTender(a);if(T("success"),f.value=80,!l.success)throw new Error(l.error||"提取失败");N("公司信息提取完成","success"),N(`识别到 ${(null==(e=l.qualification_images)?void 0:e.length)||0} 张资质图片`,"success"),f.value=100,_.value="success",y.value="提取完成!",h.value={company_info:l.company_info||{},authorized_person:l.authorized_person||{},financial_info:l.financial_info||{},qualification_images:(l.qualification_images||[]).map(e=>({...e,confirmed:e.confidence>=.6}))},setTimeout(()=>{n.value=2},800)}catch(a){_.value="exception",y.value="提取失败",N(`错误: ${a.message}`,"error"),z("提取失败",a.message)}finally{d.value=!1}}},N=(e,a)=>{g.value.push({message:e,status:a})},T=e=>{const a=g.value[g.value.length-1];a&&"loading"===a.status&&(a.status=e)},A=async()=>{p.value=!0;try{const a={company_name:h.value.company_info.company_name,social_credit_code:h.value.company_info.social_credit_code,legal_representative:h.value.company_info.legal_representative,legal_representative_position:h.value.company_info.legal_representative_position,legal_representative_gender:h.value.company_info.legal_representative_gender,registered_capital:h.value.company_info.registered_capital,establish_date:h.value.company_info.establish_date,company_type:h.value.company_info.company_type,registered_address:h.value.company_info.registered_address,office_address:h.value.company_info.office_address,fixed_phone:h.value.company_info.fixed_phone,email:h.value.company_info.email,employee_count:h.value.company_info.employee_count,authorized_person_name:h.value.authorized_person.name,authorized_person_id:h.value.authorized_person.id_number,authorized_person_gender:h.value.authorized_person.gender,authorized_person_position:h.value.authorized_person.position,authorized_person_title:h.value.authorized_person.title,bank_name:h.value.financial_info.bank_name,bank_account:h.value.financial_info.bank_account};let i;if(o.value){if(!a.company_name)return z("保存失败","公司名称不能为空"),void(p.value=!1);const e=await Le.createCompany({name:a.company_name});if(!e.success||!e.data)throw new Error(e.error||"创建公司失败");i=e.data.company_id,await Le.updateCompany(i,a)}else i=l.companyId,await Le.updateCompany(i,a);const n=h.value.qualification_images.filter(e=>e.confirmed);if(n.length>0)for(const l of n)try{const e=atob(l.image_data),a=new Array(e.length);for(let l=0;l<e.length;l++)a[l]=e.charCodeAt(l);const s=new Uint8Array(a),t=new Blob([s],{type:l.content_type}),o=new File([t],l.original_filename,{type:l.content_type});await Le.uploadQualification(i,l.guessed_type,o,{})}catch(e){}S("保存成功",o.value?"公司信息已创建":"公司信息已更新"),s("success",i),t.value=!1}catch(a){z("保存失败",a.message)}finally{p.value=!1}},P=()=>{n.value=0,r.value=[],u.value=null,f.value=0,g.value=[],_.value="",h.value={company_info:{},authorized_person:{},financial_info:{},qualification_images:[]},b.value="basic",t.value=!1};return ne(t,e=>{e&&(n.value=0,r.value=[],u.value=null,f.value=0,g.value=[])}),(e,a)=>{const l=fa,s=ma,S=Me,z=Z,N=J,T=Ye,R=v,W=De,K=L,H=q,ee=Xe,ae=Fe,le=U,se=G,te=M,oe=We,ie=oa,ne=Ge,re=Qe,ve=Q,fe=Ke,he=Y,ke=D;return ce(),ue(ke,{modelValue:t.value,"onUpdate:modelValue":a[4]||(a[4]=e=>t.value=e),title:i.value,width:"900px","close-on-click-modal":!1,"destroy-on-close":"",onClose:P},{footer:de(()=>[me("div",Ia,[pe(he,{onClick:P},{default:de(()=>[...a[11]||(a[11]=[xe("取消",-1)])]),_:1}),n.value>0&&n.value<2?(ce(),ue(he,{key:0,onClick:O,disabled:d.value},{default:de(()=>[...a[12]||(a[12]=[xe(" 上一步 ",-1)])]),_:1},8,["disabled"])):ge("",!0),0===n.value?(ce(),ue(he,{key:1,type:"primary",onClick:j,disabled:!u.value},{default:de(()=>[...a[13]||(a[13]=[xe(" 开始提取 ",-1)])]),_:1},8,["disabled"])):ge("",!0),2===n.value?(ce(),ue(he,{key:2,type:"primary",onClick:A,loading:p.value},{default:de(()=>[xe(Se(o.value?"创建公司":"保存信息"),1)]),_:1},8,["loading"])):ge("",!0)])]),default:de(()=>[pe(s,{active:n.value,"finish-status":"success",class:"extractor-steps"},{default:de(()=>[pe(l,{title:"上传文档"}),pe(l,{title:"AI提取"}),pe(l,{title:"预览确认"})]),_:1},8,["active"]),Re(me("div",_a,[pe(S,{ref:"uploadRef",drag:"","auto-upload":!1,limit:1,accept:".docx,.doc","on-change":V,"on-remove":$,"file-list":r.value,class:"upload-area"},{tip:de(()=>[...a[5]||(a[5]=[me("div",{class:"el-upload__tip"}," 支持 .docx/.doc 格式的投标文件，系统将自动提取公司信息和资质图片 ",-1)])]),default:de(()=>[a[6]||(a[6]=me("i",{class:"bi bi-file-earmark-word upload-icon"},null,-1)),a[7]||(a[7]=me("div",{class:"el-upload__text"},[xe(" 拖拽历史标书到此处，或 "),me("em",null,"点击选择文件")],-1))]),_:1},8,["file-list"]),me("div",ya,[a[8]||(a[8]=me("span",{class:"label"},"AI模型：",-1)),pe(N,{modelValue:c.value,"onUpdate:modelValue":a[0]||(a[0]=e=>c.value=e),size:"small",style:{width:"200px"}},{default:de(()=>[pe(z,{label:"GPT-4o-mini (快速)",value:"gpt-4o-mini"}),pe(z,{label:"DeepSeek-V3 (推荐)",value:"yuanjing-deepseek-v3"}),pe(z,{label:"Qwen3-235B (最强)",value:"yuanjing-qwen3-235b"})]),_:1},8,["modelValue"])])],512),[[Ue,0===n.value]]),Re(me("div",ga,[me("div",ba,[pe(T,{percentage:f.value,status:_.value,"stroke-width":16,"text-inside":!0},null,8,["percentage","status"]),me("div",ha,Se(y.value),1),pe(W,{height:"180px",class:"extraction-log"},{default:de(()=>[(ce(!0),be(we,null,qe(g.value,(e,a)=>(ce(),be("div",{key:a,class:"log-item"},["success"===e.status?(ce(),ue(R,{key:0,color:"#67c23a"},{default:de(()=>[pe(ye(B))]),_:1})):"loading"===e.status?(ce(),ue(R,{key:1,class:"is-loading",color:"#409eff"},{default:de(()=>[pe(ye(F))]),_:1})):(ce(),ue(R,{key:2,color:"#f56c6c"},{default:de(()=>[pe(ye(m))]),_:1})),me("span",null,Se(e.message),1)]))),128))]),_:1})])],512),[[Ue,1===n.value]]),Re(me("div",ka,[pe(ve,{modelValue:b.value,"onUpdate:modelValue":a[3]||(a[3]=e=>b.value=e),class:"preview-tabs"},{default:de(()=>[pe(se,{label:"基本信息",name:"basic"},{default:de(()=>[pe(W,{height:"400px"},{default:de(()=>[pe(le,{model:h.value.company_info,"label-width":"140px",class:"preview-form"},{default:de(()=>[pe(ae,{gutter:20},{default:de(()=>[(ce(),be(we,null,qe(k,e=>pe(ee,{span:12,key:e.key},{default:de(()=>[pe(H,{label:e.label},{default:de(()=>[pe(K,{modelValue:h.value.company_info[e.key],"onUpdate:modelValue":a=>h.value.company_info[e.key]=a,placeholder:e.placeholder||`请输入${e.label}`,clearable:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])]),_:2},1024)),64))]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),pe(se,{label:"被授权人",name:"personnel"},{default:de(()=>[pe(le,{model:h.value.authorized_person,"label-width":"140px",class:"preview-form"},{default:de(()=>[pe(ae,{gutter:20},{default:de(()=>[(ce(),be(we,null,qe(w,e=>pe(ee,{span:12,key:e.key},{default:de(()=>[pe(H,{label:e.label},{default:de(()=>[pe(K,{modelValue:h.value.authorized_person[e.key],"onUpdate:modelValue":a=>h.value.authorized_person[e.key]=a,placeholder:e.placeholder||`请输入${e.label}`,clearable:""},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])]),_:2},1024)),64))]),_:1})]),_:1},8,["model"])]),_:1}),pe(se,{label:"财务信息",name:"financial"},{default:de(()=>[pe(le,{model:h.value.financial_info,"label-width":"140px",class:"preview-form"},{default:de(()=>[pe(ae,{gutter:20},{default:de(()=>[pe(ee,{span:12},{default:de(()=>[pe(H,{label:"开户银行"},{default:de(()=>[pe(K,{modelValue:h.value.financial_info.bank_name,"onUpdate:modelValue":a[1]||(a[1]=e=>h.value.financial_info.bank_name=e),placeholder:"请输入开户银行",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),pe(ee,{span:12},{default:de(()=>[pe(H,{label:"银行账号"},{default:de(()=>[pe(K,{modelValue:h.value.financial_info.bank_account,"onUpdate:modelValue":a[2]||(a[2]=e=>h.value.financial_info.bank_account=e),placeholder:"请输入银行账号",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),pe(se,{name:"qualifications"},{label:de(()=>[me("span",null,[a[9]||(a[9]=xe(" 资质文件 ",-1)),I.value>0?(ce(),ue(te,{key:0,value:I.value,type:"success",class:"badge-margin"},null,8,["value"])):ge("",!0)])]),default:de(()=>[pe(W,{height:"400px"},{default:de(()=>[0===h.value.qualification_images.length?(ce(),be("div",wa,[pe(oe,{description:"未从文档中提取到图片"})])):(ce(),ue(ae,{key:1,gutter:16,class:"image-grid"},{default:de(()=>[(ce(!0),be(we,null,qe(h.value.qualification_images,(e,l)=>(ce(),ue(ee,{span:8,key:l},{default:de(()=>[pe(re,{class:_e(["image-card",{"is-confirmed":e.confirmed}]),shadow:"hover"},{default:de(()=>[me("div",{class:"image-preview",onClick:e=>{}},[pe(ie,{src:E(e),fit:"contain","preview-src-list":[E(e)],"preview-teleported":!0},{error:de(()=>[me("div",Sa,[pe(R,null,{default:de(()=>[pe(ye(X))]),_:1})])]),_:1},8,["src","preview-src-list"])],8,xa),me("div",za,[pe(N,{modelValue:e.guessed_type,"onUpdate:modelValue":a=>e.guessed_type=a,size:"small",placeholder:"选择资质类型",onChange:a=>(e=>{"unknown"!==e.guessed_type&&(e.confirmed=!0)})(e)},{default:de(()=>[(ce(),be(we,null,qe(x,e=>pe(z,{key:e.key,label:e.name,value:e.key},null,8,["label","value"])),64))]),_:1},8,["modelValue","onUpdate:modelValue","onChange"]),pe(ne,{modelValue:e.confirmed,"onUpdate:modelValue":a=>e.confirmed=a,size:"small"},{default:de(()=>[...a[10]||(a[10]=[xe(" 导入此图片 ",-1)])]),_:1},8,["modelValue","onUpdate:modelValue"])])]),_:2},1032,["class"])]),_:2},1024))),128))]),_:1}))]),_:1})]),_:1})]),_:1},8,["modelValue"]),me("div",Ca,[pe(fe,{type:"info"},{default:de(()=>[xe(" 基本信息: "+Se(C.value)+"/"+Se(k.length)+" 字段 ",1)]),_:1}),pe(fe,{type:"info"},{default:de(()=>[xe(" 资质图片: "+Se(I.value)+"/"+Se(h.value.qualification_images.length)+" 张 ",1)]),_:1})])],512),[[Ue,2===n.value]])]),_:1},8,["modelValue","title"])}}}),[["__scopeId","data-v-9884c4c3"]]);export{Va as C};
