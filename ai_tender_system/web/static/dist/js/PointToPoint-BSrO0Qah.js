import{_ as e}from"./_plugin-vue_export-helper-BZqs1yfm.js";import"./DocumentPreview.vue_vue_type_style_index_0_scoped_c8a3e4c1_lang-CvTZjc9R.js";import{E as a,a as l}from"./el-collapse-item-CDndSUQr.js";import{a as t,E as s}from"./el-table-column-Jg32dLxM.js";import"./el-checkbox-D7AoGZX-.js";/* empty css                   */import"./el-scrollbar-CxZt4BCk.js";/* empty css               *//* empty css                */import{E as n,a as r}from"./el-form-item-B_TvUsZB.js";import{E as i,a as o}from"./el-col-DR3qk7qZ.js";/* empty css                 */import{E as u,a as d}from"./el-select-bIavA1Zf.js";import{d as c,r as p,x as m,L as v,c as g,g as y,B as f,a0 as h,w as x,aA as _,o as w,a6 as b,aB as j,E as q,e as k,F as V,k as $,l as I,t as E,H as C,b9 as S,b6 as z}from"./index.js";/* empty css                 */import{S as U}from"./SSEStreamViewer-BJRR3Exz.js";import{D as L}from"./DocumentUploader-BqXA_oX2.js";import"./el-alert-CXP7XODY.js";import{t as F}from"./tender-OU9NbYj0.js";import{E as A}from"./index-ELBiC1Q4.js";import{E as P}from"./index-TEIk0rR2.js";import{E as D}from"./index-DzZX4pf4.js";import{E as O}from"./index-_IbxD8AI.js";import"./castArray-pal66jBx.js";import"./index-Dc6VZPfZ.js";import"./_baseClone-DZAH0W8r.js";import"./omit-Czoq2i9Z.js";import"./raf-Bx50Y2cR.js";import"./strings-DTuDRpJG.js";import"./index-IN6Zpv5z.js";import"./refs-Cw5r5QN8.js";const R={class:"point-to-point"},B={class:"action-controls"},M={class:"card-header"},G={class:"card-header"},H={class:"header-actions"},N={class:"requirement-text"},Q={class:"card-header"},T={class:"card-header"},Z={class:"header-actions"},J={class:"collapse-title"},K={class:"requirement-preview"},W={class:"response-content"},X={class:"response-item"},Y={class:"requirement-detail"},ee={class:"response-item"},ae={key:0,class:"response-item"},le={key:0,class:"response-dialog"},te={class:"dialog-section"},se={class:"requirement-detail"},ne={class:"dialog-section"},re={key:0,class:"dialog-section"},ie=e(c({__name:"PointToPoint",setup(e){const c=p({projectId:null,tenderFiles:[]}),ie=p([]),oe=m(()=>ie.value.find(e=>e.id===c.value.projectId)),ue=p(!1),de=p(0),ce=p(""),pe=p([]),me=p([]),ve=p(""),ge=p(""),ye=m(()=>{let e=pe.value;return ve.value&&(e=e.filter(e=>e.requirement.toLowerCase().includes(ve.value.toLowerCase()))),ge.value&&(e=e.filter(e=>e.category===ge.value)),e}),fe=p(!1),he=p(0),xe=p(""),_e=m(()=>pe.value.some(e=>e.response)),we=p([]),be=p(!1),je=p(null),qe=m(()=>c.value.projectId&&c.value.tenderFiles.length>0),ke=()=>{c.value.tenderFiles=[],pe.value=[],me.value=[]},Ve=()=>{_.success("文档上传成功")},$e=async()=>{ue.value=!0,de.value=0,ce.value="",pe.value=[];try{await Ie(),_.success("招标要求提取完成")}catch(e){_.error("提取失败，请重试")}finally{ue.value=!1}},Ie=async()=>new Promise(e=>{const a=[{progress:25,message:"正在解析招标文档..."},{progress:50,message:"正在识别招标要求..."},{progress:75,message:"正在分类整理..."},{progress:100,message:"提取完成！"}];let l=0;const t=setInterval(()=>{if(l<a.length){const e=a[l];de.value=e.progress,ce.value+=`\n[${e.progress}%] ${e.message}`,l++}else clearInterval(t),pe.value=[{id:1,category:"technical",requirement:"系统应支持不少于10000个并发用户同时在线访问",priority:"高",status:"pending"},{id:2,category:"technical",requirement:"系统响应时间应不超过3秒",priority:"高",status:"pending"},{id:3,category:"business",requirement:"项目实施周期不超过6个月",priority:"高",status:"pending"},{id:4,category:"qualification",requirement:"投标人应具有ISO 9001质量管理体系认证",priority:"中",status:"pending"},{id:5,category:"qualification",requirement:"投标人应具有信息安全等级保护三级资质",priority:"中",status:"pending"},{id:6,category:"business",requirement:"质保期不少于2年",priority:"中",status:"pending"},{id:7,category:"technical",requirement:"系统应支持移动端访问（iOS和Android）",priority:"中",status:"pending"},{id:8,category:"other",requirement:"投标文件应包含详细的培训计划",priority:"低",status:"pending"}],e()},600)}),Ee=e=>{me.value=e},Ce=async()=>{if(0!==me.value.length){fe.value=!0,he.value=0,xe.value="";try{await Se(),_.success("点对点应答生成完成")}catch(e){_.error("生成失败，请重试")}finally{fe.value=!1}}else _.warning("请选择要生成应答的要求")},Se=async()=>new Promise(e=>{const a=me.value.length;let l=0;const t=setInterval(()=>{if(l<a){const e=me.value[l];he.value=Math.round((l+1)/a*100),xe.value+=`\n[${l+1}/${a}] 正在生成"${e.requirement.substring(0,20)}..."的应答`;const t=pe.value.findIndex(a=>a.id===e.id);-1!==t&&(pe.value[t]={...pe.value[t],status:"generated",response:ze(e),compliance:Math.random()>.3?"完全符合":"部分符合"}),l++}else clearInterval(t),e()},800)}),ze=e=>({technical:"## 技术响应\n\n我方系统完全满足该技术要求：\n\n### 方案说明\n1. 采用xxx架构设计，支持高并发访问\n2. 经过压力测试，可支持xxx并发用户\n3. 配置xxx服务器集群，确保系统稳定性\n\n### 技术指标\n- 并发处理能力：满足要求\n- 响应时间：平均2秒以内\n- 系统可用性：99.9%\n\n### 证明材料\n详见附件《技术方案书》第xx页",business:"## 商务响应\n\n我方完全接受该商务条款：\n\n### 承诺内容\n1. 严格按照要求执行\n2. 提供相应的保障措施\n3. 确保按时完成\n\n### 具体安排\n- 项目周期：符合要求\n- 质保期：满足要求\n- 验收标准：按照招标文件执行\n\n### 服务保障\n详见附件《商务应答书》第xx页",qualification:"## 资质响应\n\n我方具备该项资质要求：\n\n### 资质证明\n1. 持有xxx证书，证书编号：xxx\n2. 证书有效期：xxxx年xx月至xxxx年xx月\n3. 认证范围：覆盖本项目需求\n\n### 相关业绩\n- 近三年完成类似项目xx个\n- 项目验收合格率100%\n\n### 附件材料\n详见附件《资质证明文件》",other:"## 其他要求响应\n\n我方承诺满足该要求：\n\n### 具体安排\n1. 制定详细计划\n2. 配备专业人员\n3. 提供完整文档\n\n### 执行标准\n- 严格按照招标文件要求\n- 确保质量和进度\n\n### 相关文件\n详见附件相关章节"}[e.category]||"我方完全响应该要求。"),Ue=()=>{fe.value=!1,_.info("已停止生成")},Le=()=>{var e;const a=pe.value.filter(e=>e.response).map((e,a)=>`${a+1}. 【${Fe(e.category)}】${e.requirement}\n\n${e.response}\n\n符合性：${e.compliance}\n\n---\n`).join("\n"),l=new Blob([`# 点对点应答文档\n\n${a}`],{type:"text/plain;charset=utf-8"}),t=URL.createObjectURL(l),s=document.createElement("a");s.href=t,s.download=`点对点应答-${(null==(e=oe.value)?void 0:e.project_name)||"export"}-${Date.now()}.txt`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(t),_.success("导出成功")},Fe=e=>({technical:"技术要求",business:"商务要求",qualification:"资质要求",other:"其他要求"}[e]||e),Ae=e=>({technical:"primary",business:"success",qualification:"warning",other:"info"}[e]||""),Pe=e=>({pending:"待生成",generated:"已生成",reviewed:"已审核"}[e]||e),De=e=>({pending:"info",generated:"success",reviewed:"primary"}[e]||"");return v(()=>{(async()=>{var e;try{const a=await F.getProjects({page:1,page_size:100});ie.value=(null==(e=a.data)?void 0:e.items)||[]}catch(a){_.error("加载项目列表失败")}})()}),(e,p)=>{const m=d,v=u,_=r,F=o,Ie=q,Se=i,ze=n,Oe=A,Re=I,Be=D,Me=C,Ge=t,He=O,Ne=s,Qe=l,Te=a,Ze=P;return w(),g("div",R,[y(Oe,{class:"project-section",shadow:"never"},{header:x(()=>[...p[6]||(p[6]=[k("div",{class:"card-header"},[k("span",null,"Step 1: 选择项目")],-1)])]),default:x(()=>[y(ze,{model:c.value,"label-width":"100px"},{default:x(()=>[y(Se,{gutter:20},{default:x(()=>[y(F,{span:12},{default:x(()=>[y(_,{label:"项目"},{default:x(()=>[y(v,{modelValue:c.value.projectId,"onUpdate:modelValue":p[0]||(p[0]=e=>c.value.projectId=e),placeholder:"请选择项目",filterable:"",onChange:ke,style:{width:"100%"}},{default:x(()=>[(w(!0),g(b,null,j(ie.value,e=>(w(),f(m,{key:e.id,label:`${e.project_name} (${e.project_number||"-"})`,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),y(F,{span:12},{default:x(()=>[y(_,{label:"公司"},{default:x(()=>{var e;return[y(Ie,{value:(null==(e=oe.value)?void 0:e.company_name)||"-",disabled:""},null,8,["value"])]}),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),c.value.projectId?(w(),f(Oe,{key:0,class:"upload-section",shadow:"never"},{header:x(()=>[...p[7]||(p[7]=[k("div",{class:"card-header"},[k("span",null,"Step 2: 上传招标文档")],-1)])]),default:x(()=>[y(V(L),{modelValue:c.value.tenderFiles,"onUpdate:modelValue":p[1]||(p[1]=e=>c.value.tenderFiles=e),"upload-url":`/api/tender-projects/${c.value.projectId}/upload-tender`,accept:".pdf,.doc,.docx",limit:5,"max-size":50,drag:"","tip-text":"上传招标文档，AI将自动提取所有要求并生成点对点应答",onSuccess:Ve},null,8,["modelValue","upload-url"]),k("div",B,[y(Re,{type:"primary",size:"large",disabled:!qe.value,loading:ue.value,onClick:$e},{default:x(()=>[...p[8]||(p[8]=[$(" 提取招标要求 ",-1)])]),_:1},8,["disabled","loading"])])]),_:1})):h("",!0),ue.value?(w(),f(Oe,{key:1,class:"extracting-section",shadow:"never"},{header:x(()=>[k("div",M,[p[9]||(p[9]=k("span",null,"正在提取招标要求...",-1)),y(Be,{percentage:de.value,status:100===de.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:x(()=>[y(V(U),{content:ce.value,"is-streaming":ue.value},null,8,["content","is-streaming"])]),_:1})):h("",!0),pe.value.length>0?(w(),f(Oe,{key:2,class:"requirements-section",shadow:"never"},{header:x(()=>[k("div",G,[k("span",null,"招标要求列表 (共 "+E(pe.value.length)+" 条)",1),k("div",H,[y(Ie,{modelValue:ve.value,"onUpdate:modelValue":p[2]||(p[2]=e=>ve.value=e),placeholder:"搜索要求...",clearable:"",style:{width:"200px"}},{prefix:x(()=>[y(Me,null,{default:x(()=>[y(V(S))]),_:1})]),_:1},8,["modelValue"]),y(v,{modelValue:ge.value,"onUpdate:modelValue":p[3]||(p[3]=e=>ge.value=e),placeholder:"筛选分类",clearable:"",style:{width:"150px"}},{default:x(()=>[y(m,{label:"全部",value:""}),y(m,{label:"技术要求",value:"technical"}),y(m,{label:"商务要求",value:"business"}),y(m,{label:"资质要求",value:"qualification"}),y(m,{label:"其他要求",value:"other"})]),_:1},8,["modelValue"]),y(Re,{type:"primary",disabled:0===me.value.length,loading:fe.value,onClick:Ce},{default:x(()=>[$(" 生成应答 ("+E(me.value.length)+") ",1)]),_:1},8,["disabled","loading"])])])]),default:x(()=>[y(Ne,{data:ye.value,border:"",onSelectionChange:Ee,"max-height":"500"},{default:x(()=>[y(Ge,{type:"selection",width:"55"}),y(Ge,{type:"index",label:"序号",width:"60"}),y(Ge,{prop:"category",label:"分类",width:"100"},{default:x(({row:e})=>[y(He,{type:Ae(e.category),size:"small"},{default:x(()=>[$(E(Fe(e.category)),1)]),_:2},1032,["type"])]),_:1}),y(Ge,{prop:"requirement",label:"招标要求","min-width":"300"},{default:x(({row:e})=>[k("div",N,E(e.requirement),1)]),_:1}),y(Ge,{prop:"priority",label:"优先级",width:"100"},{default:x(({row:e})=>{return[y(He,{type:(a=e.priority,{"高":"danger","中":"warning","低":"info"}[a]||""),size:"small"},{default:x(()=>[$(E(e.priority),1)]),_:2},1032,["type"])];var a}),_:1}),y(Ge,{prop:"status",label:"应答状态",width:"100"},{default:x(({row:e})=>[y(He,{type:De(e.status),size:"small"},{default:x(()=>[$(E(Pe(e.status)),1)]),_:2},1032,["type"])]),_:1}),y(Ge,{label:"操作",width:"100",fixed:"right"},{default:x(({row:e})=>[e.response?(w(),f(Re,{key:0,type:"primary",size:"small",text:"",onClick:a=>{return l=e,je.value=l,void(be.value=!0);var l}},{default:x(()=>[...p[10]||(p[10]=[$(" 查看 ",-1)])]),_:1},8,["onClick"])):h("",!0)]),_:1})]),_:1},8,["data"])]),_:1})):h("",!0),fe.value?(w(),f(Oe,{key:3,class:"generation-output",shadow:"never"},{header:x(()=>[k("div",Q,[p[11]||(p[11]=k("span",null,"AI正在生成点对点应答...",-1)),y(Be,{percentage:he.value,status:100===he.value?"success":void 0,style:{width:"300px"}},null,8,["percentage","status"])])]),default:x(()=>[y(V(U),{content:xe.value,"is-streaming":fe.value,onStop:Ue},null,8,["content","is-streaming"])]),_:1})):h("",!0),_e.value?(w(),f(Oe,{key:4,class:"responses-section",shadow:"never"},{header:x(()=>[k("div",T,[p[13]||(p[13]=k("span",null,"点对点应答结果",-1)),k("div",Z,[y(Re,{type:"success",icon:V(z),onClick:Le},{default:x(()=>[...p[12]||(p[12]=[$(" 导出应答文档 ",-1)])]),_:1},8,["icon"])])])]),default:x(()=>[y(Te,{modelValue:we.value,"onUpdate:modelValue":p[4]||(p[4]=e=>we.value=e),accordion:""},{default:x(()=>[(w(!0),g(b,null,j(pe.value.filter(e=>e.response),e=>(w(),f(Qe,{key:e.id,name:e.id},{title:x(()=>[k("div",J,[y(He,{type:Ae(e.category),size:"small"},{default:x(()=>[$(E(Fe(e.category)),1)]),_:2},1032,["type"]),k("span",K,E(e.requirement),1),y(He,{type:De(e.status),size:"small"},{default:x(()=>[$(E(Pe(e.status)),1)]),_:2},1032,["type"])])]),default:x(()=>[k("div",W,[k("div",X,[p[14]||(p[14]=k("h4",null,"招标要求",-1)),k("div",Y,E(e.requirement),1)]),k("div",ee,[p[15]||(p[15]=k("h4",null,"我方应答",-1)),y(V(U),{content:e.response||"","is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),e.compliance?(w(),g("div",ae,[p[16]||(p[16]=k("h4",null,"符合性说明",-1)),y(He,{type:"完全符合"===e.compliance?"success":"warning",size:"large"},{default:x(()=>[$(E(e.compliance),1)]),_:2},1032,["type"])])):h("",!0)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1})):h("",!0),y(Ze,{modelValue:be.value,"onUpdate:modelValue":p[5]||(p[5]=e=>be.value=e),title:"应答详情",width:"800px","destroy-on-close":""},{default:x(()=>[je.value?(w(),g("div",le,[k("div",te,[p[17]||(p[17]=k("h4",null,"招标要求",-1)),k("div",se,E(je.value.requirement),1)]),k("div",ne,[p[18]||(p[18]=k("h4",null,"我方应答",-1)),y(V(U),{content:je.value.response||"","is-streaming":!1,"enable-markdown":!0},null,8,["content"])]),je.value.compliance?(w(),g("div",re,[p[19]||(p[19]=k("h4",null,"符合性",-1)),y(He,{type:"完全符合"===je.value.compliance?"success":"warning"},{default:x(()=>[$(E(je.value.compliance),1)]),_:1},8,["type"])])):h("",!0)])):h("",!0)]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-1605b256"]]);export{ie as default};
