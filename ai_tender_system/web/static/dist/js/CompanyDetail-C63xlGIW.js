import{d as e,G as a,D as l,e as t,h as i,a1 as o,p as n,n as s,U as u,a as d,C as r,o as c,V as p,M as _,b as m,I as f,g as v,H as y,L as g,R as h,Q as b}from"./vendor-element-plus-CEQaQHNc.js";import{d as k,r as V,w,P as z,M as x,c as q,I as C,N as I,H as U,a as D,L as E,O as j,_ as $,R as M,Q as P,F,V as R,W as S,b as T,b4 as O,b7 as N}from"./vendor-vue-DnBj6vzG.js";import{L as Q}from"./Loading-fOFG7xAl.js";/* empty css                                                                          */import{eH as L,eI as B,dB as G,er as J,dD as A,es as H,dn as Y,eD as K,eJ as W,eK as X,eL as Z,eM as ee,eE as ae,eN as le,eO as te}from"./vendor-other-CxXkF0Pk.js";import"./vendor-editor-CGvuleas.js";/* empty css                                                                        */import"./vendor-dayjs-CeOjnJlt.js";import{a as ie,_ as oe}from"./index.js";import{c as ne}from"./company-DX6fQVXW.js";import{C as se}from"./Card-CKMHDauo.js";import{D as ue}from"./DocumentUploader-DdyoMp6a.js";import"./vendor-echarts-C00rBISf.js";import"./vendor-axios-BG7aBJwU.js";import"./imageCompressor-CTkRt5bg.js";const de={class:"basic-info-tab"},re=oe(k({__name:"BasicInfoTab",props:{companyId:{},companyData:{}},emits:["update"],setup(c,{emit:p}){const _=c,m=p,{success:f,error:v}=ie(),y=V(),g=V(!1),h=V({company_name:"",establish_date:"",legal_representative:"",legal_representative_position:"",legal_representative_gender:"",legal_representative_age:void 0,social_credit_code:"",registered_capital:"",company_type:"",registered_address:"",fixed_phone:"",fax:"",postal_code:"",email:"",business_scope:"",description:""}),b={company_name:[{required:!0,message:"请输入企业名称",trigger:"blur"}],email:[{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],postal_code:[{pattern:/^\d{6}$/,message:"邮政编码必须是6位数字",trigger:"blur"}]};w(()=>_.companyData,e=>{e&&(h.value={company_name:e.company_name||"",establish_date:e.establish_date||"",legal_representative:e.legal_representative||"",legal_representative_position:e.legal_representative_position||"",legal_representative_gender:e.legal_representative_gender||"",legal_representative_age:e.legal_representative_age||void 0,social_credit_code:e.social_credit_code||"",registered_capital:e.registered_capital||"",company_type:e.company_type||"",registered_address:e.registered_address||"",fixed_phone:e.fixed_phone||"",fax:e.fax||"",postal_code:e.postal_code||"",email:e.email||"",business_scope:e.business_scope||"",description:e.description||""})},{immediate:!0,deep:!0});const k=async()=>{y.value&&await y.value.validate(async e=>{if(e){g.value=!0;try{(await ne.updateCompany(_.companyId,{companyName:h.value.company_name,establishDate:h.value.establish_date,legalRepresentative:h.value.legal_representative,legalRepresentativePosition:h.value.legal_representative_position,legalRepresentativeGender:h.value.legal_representative_gender,legalRepresentativeAge:h.value.legal_representative_age,socialCreditCode:h.value.social_credit_code,registeredCapital:h.value.registered_capital,companyType:h.value.company_type,registeredAddress:h.value.registered_address,fixedPhone:h.value.fixed_phone,fax:h.value.fax,postalCode:h.value.postal_code,email:h.value.email,businessScope:h.value.business_scope,companyDescription:h.value.description})).success&&(f("保存成功","基础信息已更新"),m("update"))}catch(a){v("保存失败",a instanceof Error?a.message:"未知错误")}finally{g.value=!1}}})};return(c,p)=>{const _=i,m=t,f=l,v=o,V=a,w=s,D=n,E=u,j=r,$=d,M=e;return x(),z("div",de,[q(C(se),{title:"基础信息"},{default:I(()=>[q(M,{ref_key:"formRef",ref:y,model:h.value,rules:b,"label-width":"140px",class:"basic-form"},{default:I(()=>[q(V,{gutter:20},{default:I(()=>[q(f,{span:12},{default:I(()=>[q(m,{label:"企业名称",prop:"company_name"},{default:I(()=>[q(_,{modelValue:h.value.company_name,"onUpdate:modelValue":p[0]||(p[0]=e=>h.value.company_name=e),placeholder:"请输入企业名称"},null,8,["modelValue"])]),_:1})]),_:1}),q(f,{span:12},{default:I(()=>[q(m,{label:"成立日期",prop:"establish_date"},{default:I(()=>[q(v,{modelValue:h.value.establish_date,"onUpdate:modelValue":p[1]||(p[1]=e=>h.value.establish_date=e),type:"date",placeholder:"选择日期",style:{width:"100%"},"value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,{gutter:20},{default:I(()=>[q(f,{span:12},{default:I(()=>[q(m,{label:"法定代表人",prop:"legal_representative"},{default:I(()=>[q(_,{modelValue:h.value.legal_representative,"onUpdate:modelValue":p[2]||(p[2]=e=>h.value.legal_representative=e),placeholder:"请输入法定代表人"},null,8,["modelValue"])]),_:1})]),_:1}),q(f,{span:12},{default:I(()=>[q(m,{label:"法定代表人职务",prop:"legal_representative_position"},{default:I(()=>[q(_,{modelValue:h.value.legal_representative_position,"onUpdate:modelValue":p[3]||(p[3]=e=>h.value.legal_representative_position=e),placeholder:"请输入职务"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,{gutter:20},{default:I(()=>[q(f,{span:12},{default:I(()=>[q(m,{label:"法定代表人性别",prop:"legal_representative_gender"},{default:I(()=>[q(D,{modelValue:h.value.legal_representative_gender,"onUpdate:modelValue":p[4]||(p[4]=e=>h.value.legal_representative_gender=e),placeholder:"请选择性别",style:{width:"100%"}},{default:I(()=>[q(w,{label:"男",value:"男"}),q(w,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),q(f,{span:12},{default:I(()=>[q(m,{label:"法定代表人年龄",prop:"legal_representative_age"},{default:I(()=>[q(E,{modelValue:h.value.legal_representative_age,"onUpdate:modelValue":p[5]||(p[5]=e=>h.value.legal_representative_age=e),min:18,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,{gutter:20},{default:I(()=>[q(f,{span:12},{default:I(()=>[q(m,{label:"统一社会信用代码",prop:"social_credit_code"},{default:I(()=>[q(_,{modelValue:h.value.social_credit_code,"onUpdate:modelValue":p[6]||(p[6]=e=>h.value.social_credit_code=e),placeholder:"请输入统一社会信用代码"},null,8,["modelValue"])]),_:1})]),_:1}),q(f,{span:12},{default:I(()=>[q(m,{label:"注册资本",prop:"registered_capital"},{default:I(()=>[q(_,{modelValue:h.value.registered_capital,"onUpdate:modelValue":p[7]||(p[7]=e=>h.value.registered_capital=e),placeholder:"如：1000万元"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,{gutter:20},{default:I(()=>[q(f,{span:12},{default:I(()=>[q(m,{label:"企业类型",prop:"company_type"},{default:I(()=>[q(_,{modelValue:h.value.company_type,"onUpdate:modelValue":p[8]||(p[8]=e=>h.value.company_type=e),placeholder:"如：有限责任公司"},null,8,["modelValue"])]),_:1})]),_:1}),q(f,{span:12},{default:I(()=>[q(m,{label:"注册地址",prop:"registered_address"},{default:I(()=>[q(_,{modelValue:h.value.registered_address,"onUpdate:modelValue":p[9]||(p[9]=e=>h.value.registered_address=e),placeholder:"请输入注册地址"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,{gutter:20},{default:I(()=>[q(f,{span:12},{default:I(()=>[q(m,{label:"联系电话",prop:"fixed_phone"},{default:I(()=>[q(_,{modelValue:h.value.fixed_phone,"onUpdate:modelValue":p[10]||(p[10]=e=>h.value.fixed_phone=e),placeholder:"请输入联系电话"},null,8,["modelValue"])]),_:1})]),_:1}),q(f,{span:12},{default:I(()=>[q(m,{label:"传真",prop:"fax"},{default:I(()=>[q(_,{modelValue:h.value.fax,"onUpdate:modelValue":p[11]||(p[11]=e=>h.value.fax=e),placeholder:"请输入传真"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,{gutter:20},{default:I(()=>[q(f,{span:12},{default:I(()=>[q(m,{label:"邮政编码",prop:"postal_code"},{default:I(()=>[q(_,{modelValue:h.value.postal_code,"onUpdate:modelValue":p[12]||(p[12]=e=>h.value.postal_code=e),placeholder:"请输入邮政编码",maxlength:"6"},null,8,["modelValue"])]),_:1})]),_:1}),q(f,{span:12},{default:I(()=>[q(m,{label:"电子邮箱",prop:"email"},{default:I(()=>[q(_,{modelValue:h.value.email,"onUpdate:modelValue":p[13]||(p[13]=e=>h.value.email=e),placeholder:"请输入电子邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,null,{default:I(()=>[q(f,{span:24},{default:I(()=>[q(m,{label:"经营范围",prop:"business_scope"},{default:I(()=>[q(_,{modelValue:h.value.business_scope,"onUpdate:modelValue":p[14]||(p[14]=e=>h.value.business_scope=e),type:"textarea",rows:5,placeholder:"请输入经营范围"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,null,{default:I(()=>[q(f,{span:24},{default:I(()=>[q(m,{label:"企业简介",prop:"description"},{default:I(()=>[q(_,{modelValue:h.value.description,"onUpdate:modelValue":p[15]||(p[15]=e=>h.value.description=e),type:"textarea",rows:5,placeholder:"请输入企业简介"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(V,null,{default:I(()=>[q(f,{span:24},{default:I(()=>[q(m,null,{default:I(()=>[q($,{type:"primary",loading:g.value,onClick:k},{default:I(()=>[q(j,null,{default:I(()=>[q(C(L))]),_:1}),p[16]||(p[16]=U(" 保存基础信息 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),[["__scopeId","data-v-cf1705e1"]]),ce={class:"card-header"},pe={class:"qual-info"},_e={class:"qual-name"},me={class:"badges"},fe={key:0,class:"file-status"},ve={key:0,class:"single-file"},ye={class:"file-item"},ge={class:"file-details"},he={class:"file-name"},be={class:"file-meta"},ke={class:"file-actions"},Ve={key:1,class:"multiple-files"},we={class:"file-details"},ze={class:"file-name"},xe={class:"file-meta"},qe={class:"file-actions"},Ce={key:1,class:"no-file"},Ie={class:"card-footer"},Ue={class:"upload-section"},De={class:"upload-tips"},Ee=oe(k({__name:"QualificationCard",props:{qualification:{},fileInfo:{},isCustom:{type:Boolean},onUpload:{type:Function}},emits:["upload","download","delete","remove-custom"],setup(e,{emit:a}){const l=e,t=a,i=V(),o=D(()=>!!l.fileInfo&&(l.fileInfo.allow_multiple_files?l.fileInfo.files&&l.fileInfo.files.length>0:!!l.fileInfo.original_filename)),n=D(()=>{var e,a;return(null==(e=l.fileInfo)?void 0:e.allow_multiple_files)&&(null==(a=l.fileInfo)?void 0:a.files)}),s=D(()=>"financial_audit_report"===l.qualification.key?".pdf,.xls,.xlsx,.jpg,.jpeg,.png":".pdf,.jpg,.jpeg,.png"),u=D(()=>{const e=l.qualification.key;return"business_license"===e?"license":e.includes("id")||"legal_id_front"===e||"legal_id_back"===e?"id_card":e.includes("seal")?"seal":e.includes("iso")||e.includes("cmmi")||e.includes("certificate")||e.includes("qualification")||e.includes("认证")?"qualification":"default"}),m=async e=>{const{file:a,onSuccess:i,onError:o}=e;try{l.onUpload?await l.onUpload(a):t("upload",a),i({success:!0})}catch(n){o(n)}},f=()=>{t("download",l.qualification.key)},v=()=>{t("delete",l.qualification.key)},y=e=>{if(!e)return"0 B";const a=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,a)*100)/100+" "+["B","KB","MB","GB"][a]},g=e=>{if(!e)return"";return new Date(e).toLocaleString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})};return(a,h)=>{const b=r,k=c,V=d,w=p,D=_;return x(),E(D,{class:S(["qualification-card",{required:e.qualification.required,"has-file":o.value}])},{default:I(()=>[j("div",ce,[j("div",pe,[q(b,{class:"qual-icon",size:20},{default:I(()=>[(x(),E($(e.qualification.icon)))]),_:1}),j("span",_e,M(e.qualification.name),1)]),j("div",me,[e.qualification.required?(x(),E(k,{key:0,type:"warning",size:"small"},{default:I(()=>[...h[1]||(h[1]=[U("必需",-1)])]),_:1})):P("",!0),e.qualification.allowMultiple?(x(),E(k,{key:1,type:"info",size:"small"},{default:I(()=>[q(b,null,{default:I(()=>[q(C(B))]),_:1}),h[2]||(h[2]=U(" 多文件 ",-1))]),_:1})):P("",!0)])]),o.value?(x(),z("div",fe,[n.value?(x(),z("div",Ve,[(x(!0),z(F,null,R(e.fileInfo.files,e=>(x(),z("div",{key:e.qualification_id,class:"file-item"},[q(b,{class:"file-icon"},{default:I(()=>[q(C(G))]),_:1}),j("div",we,[j("div",ze,M(e.original_filename),1),j("div",xe,[j("span",null,M(y(e.file_size)),1),h[4]||(h[4]=j("span",{class:"divider"},"•",-1)),j("span",null,M(g(e.upload_time)),1)])]),j("div",qe,[q(V,{text:"",type:"primary",size:"small",onClick:a=>{return i=e.qualification_id,void t("download",l.qualification.key,i);var i}},{default:I(()=>[q(b,null,{default:I(()=>[q(C(J))]),_:1})]),_:1},8,["onClick"]),q(V,{text:"",type:"danger",size:"small",onClick:a=>{return i=e.qualification_id,void t("delete",l.qualification.key,i);var i}},{default:I(()=>[q(b,null,{default:I(()=>[q(C(A))]),_:1})]),_:1},8,["onClick"])])]))),128))])):(x(),z("div",ve,[j("div",ye,[q(b,{class:"file-icon"},{default:I(()=>[q(C(G))]),_:1}),j("div",ge,[j("div",he,M(e.fileInfo.original_filename),1),j("div",be,[j("span",null,M(y(e.fileInfo.file_size)),1),h[3]||(h[3]=j("span",{class:"divider"},"•",-1)),j("span",null,M(g(e.fileInfo.upload_time)),1)])]),j("div",ke,[q(V,{text:"",type:"primary",size:"small",onClick:f},{default:I(()=>[q(b,null,{default:I(()=>[q(C(J))]),_:1})]),_:1}),q(V,{text:"",type:"danger",size:"small",onClick:v},{default:I(()=>[q(b,null,{default:I(()=>[q(C(A))]),_:1})]),_:1})])])]))])):(x(),z("div",Ce,[q(w,{type:"info",size:"small"},{default:I(()=>[...h[5]||(h[5]=[U("未上传文件",-1)])]),_:1})])),j("div",Ie,[j("div",Ue,[q(C(ue),{ref_key:"uploaderRef",ref:i,accept:s.value,multiple:e.qualification.allowMultiple,"show-file-list":!1,"http-request":m,"max-size":20,"auto-compress-image":!0,"image-type":u.value},{trigger:I(()=>[q(V,{type:"primary",size:"small"},{default:I(()=>[q(b,null,{default:I(()=>[q(C(H))]),_:1}),U(" "+M(e.qualification.allowMultiple?"批量上传":"上传文件"),1)]),_:1})]),_:1},8,["accept","multiple","image-type"]),e.isCustom?(x(),E(V,{key:0,type:"danger",size:"small",onClick:h[0]||(h[0]=e=>a.$emit("remove-custom"))},{default:I(()=>[q(b,null,{default:I(()=>[q(C(A))]),_:1}),h[6]||(h[6]=U(" 移除 ",-1))]),_:1})):P("",!0)]),j("div",De,[q(w,{type:"info",size:"small"},{default:I(()=>[...h[7]||(h[7]=[U(" 支持JPG、PNG、PDF格式 ",-1),j("span",{class:"pdf-tip"},"（PDF将自动转换为图片）",-1)])]),_:1})])])]),_:1},8,["class"])}}}),[["__scopeId","data-v-1923de96"]]),je={class:"qualification-tab"},$e={key:1},Me={class:"qualification-category"},Pe={class:"category-title text-secondary"},Fe=oe(k({__name:"QualificationTab",props:{companyId:{},companyData:{}},emits:["update"],setup(o,{emit:n}){const s=o,u=n,{success:c,error:p}=ie(),_=V(!1),f=V({}),v=V([]),y=V(!1),g=V({name:""}),h=[{key:"basic",name:"基本证件资质",color:"primary"},{key:"iso",name:"ISO体系认证",color:"success"},{key:"credit",name:"信用资质证明",color:"info"},{key:"industry",name:"行业专业资质",color:"danger"}],b=[{key:"business_license",name:"营业执照",icon:"Document",category:"basic",required:!0},{key:"legal_id_front",name:"法人身份证(正面)",icon:"CreditCard",category:"basic",required:!0},{key:"legal_id_back",name:"法人身份证(反面)",icon:"CreditCard",category:"basic",required:!0},{key:"bank_account_permit",name:"银行开户许可证",icon:"CreditCard",category:"basic"},{key:"tax_registration",name:"税务登记证",icon:"DocumentChecked",category:"basic"},{key:"iso9001",name:"ISO 9001质量管理体系认证",icon:"Medal",category:"iso"},{key:"iso14001",name:"ISO 14001环境管理体系认证",icon:"Medal",category:"iso"},{key:"iso27001",name:"ISO 27001信息安全管理体系认证",icon:"Lock",category:"iso"},{key:"iso20000",name:"ISO 20000 IT服务管理体系认证",icon:"Monitor",category:"iso"},{key:"dishonest_executor",name:"失信被执行人名单（信用中国）",icon:"WarningFilled",category:"credit"},{key:"tax_violation_check",name:"重大税收违法案件当事人名单（信用中国）",icon:"WarningFilled",category:"credit"},{key:"gov_procurement_creditchina",name:"政府采购严重违法失信（信用中国）",icon:"Flag",category:"credit"},{key:"gov_procurement_ccgp",name:"政府采购严重违法失信行为信息记录（政府采购网）",icon:"CircleCheck",category:"credit"},{key:"basic_telecom_permit",name:"基础电信业务许可证",icon:"PhoneFilled",category:"industry"},{key:"value_added_telecom_permit",name:"增值电信业务许可证",icon:"PhoneFilled",category:"industry"},{key:"software_copyright",name:"软件著作权登记证书",icon:"Document",category:"industry",allowMultiple:!0},{key:"patent_certificate",name:"专利证书",icon:"TrophyBase",category:"industry",allowMultiple:!0},{key:"high_tech",name:"高新技术企业证书",icon:"Star",category:"industry"},{key:"software_enterprise",name:"软件企业认定证书",icon:"Monitor",category:"industry"},{key:"cmmi",name:"CMMI成熟度等级证书",icon:"Trophy",category:"industry"}],k=async()=>{_.value=!0;try{const e=await ne.getCompanyQualifications(s.companyId);e.success&&e.data&&(f.value=e.data)}catch(e){p("加载失败",e instanceof Error?e.message:"未知错误")}finally{_.value=!1}},w=e=>a=>(async(e,a)=>{const l=b.find(a=>a.key===e)||v.value.find(a=>a.key===e);try{const t=await ne.uploadQualification(s.companyId,e,a,{});if(!t.success)throw new Error(t.message||"上传失败");c("上传成功",`${(null==l?void 0:l.name)||"资质文件"}上传成功`),await k(),u("update")}catch(t){const e=t instanceof Error?t.message:"未知错误";throw p("上传失败",e),t}})(e,a),D=async(e,a)=>{try{a?await ne.downloadQualification(a,""):window.open(`/api/companies/${s.companyId}/qualifications/${e}/download`)}catch(l){p("下载失败",l instanceof Error?l.message:"未知错误")}},$=async(e,a)=>{try{if(!confirm("确定要删除此资质文件吗？"))return;if(a)await ne.deleteQualification(a);else{if(!(await fetch(`/api/companies/${s.companyId}/qualifications/${e}`,{method:"DELETE"})).ok)throw new Error("删除失败")}c("删除成功","资质文件已删除"),await k(),u("update")}catch(l){p("删除失败",l instanceof Error?l.message:"未知错误")}},O=()=>{g.value.name="",y.value=!0},N=()=>{if(!g.value.name.trim())return void p("错误","请输入资质名称");const e=`custom_${Date.now()}`;v.value.push({key:e,name:g.value.name.trim(),icon:"Document",category:"custom"}),y.value=!1,c("添加成功","自定义资质已添加")};return T(()=>{k()}),(o,n)=>{const s=r,u=l,p=a,k=d,V=i,T=t,L=e,B=m;return x(),z("div",je,[q(C(se),{title:"资质信息管理"},{default:I(()=>[_.value?(x(),E(C(Q),{key:0,text:"加载资质信息..."})):(x(),z("div",$e,[(x(),z(F,null,R(h,e=>j("div",{key:e.key,class:"qualification-category"},[j("h6",{class:S(["category-title",`text-${e.color}`])},[q(s,null,{default:I(()=>[q(C(K))]),_:1}),U(" "+M(e.name),1)],2),q(p,{gutter:16},{default:I(()=>{return[(x(!0),z(F,null,R((a=e.key,b.filter(e=>e.category===a)),e=>(x(),E(u,{key:e.key,span:12},{default:I(()=>[q(Ee,{qualification:e,"file-info":f.value[e.key],"on-upload":w(e.key),onDownload:D,onDelete:$},null,8,["qualification","file-info","on-upload"])]),_:2},1024))),128))];var a}),_:2},1024)])),64)),j("div",Me,[j("h6",Pe,[q(s,null,{default:I(()=>[q(C(Y))]),_:1}),n[3]||(n[3]=U(" 自定义资质 ",-1))]),q(k,{type:"primary",onClick:O},{default:I(()=>[q(s,null,{default:I(()=>[q(C(Y))]),_:1}),n[4]||(n[4]=U(" 添加自定义资质 ",-1))]),_:1}),v.value.length>0?(x(),E(p,{key:0,gutter:16,class:"mt-3"},{default:I(()=>[(x(!0),z(F,null,R(v.value,(e,a)=>(x(),E(u,{key:e.key,span:12},{default:I(()=>[q(Ee,{qualification:e,"file-info":f.value[e.key],"is-custom":!0,"on-upload":w(e.key),onDownload:D,onDelete:$,onRemoveCustom:e=>(e=>{confirm("确定要移除此自定义资质吗？")&&(v.value.splice(e,1),c("移除成功","自定义资质已移除"))})(a)},null,8,["qualification","file-info","on-upload","onRemoveCustom"])]),_:2},1024))),128))]),_:1})):P("",!0)])]))]),_:1}),q(B,{modelValue:y.value,"onUpdate:modelValue":n[2]||(n[2]=e=>y.value=e),title:"添加自定义资质",width:"400px"},{footer:I(()=>[q(k,{onClick:n[1]||(n[1]=e=>y.value=!1)},{default:I(()=>[...n[5]||(n[5]=[U("取消",-1)])]),_:1}),q(k,{type:"primary",onClick:N},{default:I(()=>[...n[6]||(n[6]=[U("确定",-1)])]),_:1})]),default:I(()=>[q(L,{model:g.value,"label-width":"100px"},{default:I(()=>[q(T,{label:"资质名称"},{default:I(()=>[q(V,{modelValue:g.value.name,"onUpdate:modelValue":n[0]||(n[0]=e=>g.value.name=e),placeholder:"请输入资质名称",maxlength:"50"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}}),[["__scopeId","data-v-d0a8e1b6"]]),Re={class:"personnel-tab"},Se={class:"attachments-grid"},Te={class:"attachment-item"},Oe={class:"attachment-header"},Ne={key:0,class:"file-info"},Qe={class:"file-name"},Le={class:"file-actions"},Be={key:1,class:"no-file"},Ge={class:"attachment-item"},Je={class:"attachment-header"},Ae={key:0,class:"file-info"},He={class:"file-name"},Ye={class:"file-actions"},Ke={key:1,class:"no-file"},We={class:"attachment-item"},Xe={class:"attachment-header"},Ze={key:0,class:"file-info"},ea={class:"file-name"},aa={class:"file-actions"},la={key:1,class:"no-file"},ta={class:"attachment-item"},ia={class:"attachment-header"},oa={key:0,class:"file-info"},na={class:"file-name"},sa={class:"file-actions"},ua={key:1,class:"no-file"},da=oe(k({__name:"PersonnelTab",props:{companyId:{},companyData:{}},emits:["update"],setup(o,{emit:c}){const p=o,_=c,{success:m,error:f}=ie(),v=V(),y=V(!1),g=V({authorized_person_name:"",authorized_person_id:"",authorized_person_gender:"",authorized_person_age:void 0,authorized_person_position:"",authorized_person_title:""}),h=V({id_card_front:null,id_card_back:null,manager_resume:null,social_security:null}),b={authorized_person_id:[{pattern:/^[1-9]\d{5}(18|19|20)\d{2}(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])\d{3}[\dXx]$/,message:"请输入正确的身份证号",trigger:"blur"}]};w(()=>p.companyData,e=>{e&&(g.value={authorized_person_name:e.authorized_person_name||"",authorized_person_id:e.authorized_person_id||"",authorized_person_gender:e.authorized_person_gender||"",authorized_person_age:e.authorized_person_age||void 0,authorized_person_position:e.authorized_person_position||"",authorized_person_title:e.authorized_person_title||""})},{immediate:!0,deep:!0});const k=async()=>{v.value&&await v.value.validate(async e=>{if(e){y.value=!0;try{(await ne.updateCompany(p.companyId,{authorizedPersonName:g.value.authorized_person_name,authorizedPersonId:g.value.authorized_person_id,authorizedPersonGender:g.value.authorized_person_gender,authorizedPersonAge:g.value.authorized_person_age,authorizedPersonPosition:g.value.authorized_person_position,authorizedPersonTitle:g.value.authorized_person_title})).success&&(m("保存成功","被授权人信息已更新"),_("update"))}catch(a){f("保存失败",a instanceof Error?a.message:"未知错误")}finally{y.value=!1}}})},D=e=>async a=>{const{file:l,onSuccess:t,onError:i}=a;try{const a=await ne.uploadQualification(p.companyId,e,l,{});if(!a.success)throw new Error(a.error||"上传失败");m("上传成功","附件上传成功"),P(),_("update"),t(a)}catch(o){const e=o instanceof Error?o.message:"未知错误";f("上传失败",e),i(o)}},E=e=>{window.open(`/api/companies/${p.companyId}/qualifications/${e}/download`)},$=async e=>{if(confirm("确定要删除此附件吗？"))try{if(!(await fetch(`/api/companies/${p.companyId}/qualifications/${e}`,{method:"DELETE"})).ok)throw new Error("删除失败");m("删除成功","附件已删除"),P(),_("update")}catch(a){f("删除失败",a instanceof Error?a.message:"未知错误")}},P=async()=>{try{const e=await ne.getCompanyQualifications(p.companyId);if(e.success&&e.data){const a=e.data;h.value={id_card_front:a.id_card_front?{name:a.id_card_front.original_filename}:null,id_card_back:a.id_card_back?{name:a.id_card_back.original_filename}:null,manager_resume:a.manager_resume?{name:a.manager_resume.original_filename}:null,social_security:a.social_security?{name:a.social_security.original_filename}:null}}}catch(e){}};return T(()=>{P()}),(o,c)=>{const p=i,_=t,m=l,f=a,V=s,w=n,P=u,F=r,R=d,S=e;return x(),z("div",Re,[q(C(se),{title:"被授权人基本信息"},{default:I(()=>[q(S,{ref_key:"formRef",ref:v,model:g.value,rules:b,"label-width":"140px",class:"personnel-form"},{default:I(()=>[q(f,{gutter:20},{default:I(()=>[q(m,{span:12},{default:I(()=>[q(_,{label:"姓名",prop:"authorized_person_name"},{default:I(()=>[q(p,{modelValue:g.value.authorized_person_name,"onUpdate:modelValue":c[0]||(c[0]=e=>g.value.authorized_person_name=e),placeholder:"请输入被授权人姓名"},null,8,["modelValue"])]),_:1})]),_:1}),q(m,{span:12},{default:I(()=>[q(_,{label:"身份证号",prop:"authorized_person_id"},{default:I(()=>[q(p,{modelValue:g.value.authorized_person_id,"onUpdate:modelValue":c[1]||(c[1]=e=>g.value.authorized_person_id=e),placeholder:"请输入身份证号",maxlength:"18"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(f,{gutter:20},{default:I(()=>[q(m,{span:12},{default:I(()=>[q(_,{label:"性别",prop:"authorized_person_gender"},{default:I(()=>[q(w,{modelValue:g.value.authorized_person_gender,"onUpdate:modelValue":c[2]||(c[2]=e=>g.value.authorized_person_gender=e),placeholder:"请选择性别",style:{width:"100%"}},{default:I(()=>[q(V,{label:"男",value:"男"}),q(V,{label:"女",value:"女"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),q(m,{span:12},{default:I(()=>[q(_,{label:"年龄",prop:"authorized_person_age"},{default:I(()=>[q(P,{modelValue:g.value.authorized_person_age,"onUpdate:modelValue":c[3]||(c[3]=e=>g.value.authorized_person_age=e),min:18,max:100,style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(f,{gutter:20},{default:I(()=>[q(m,{span:12},{default:I(()=>[q(_,{label:"职位",prop:"authorized_person_position"},{default:I(()=>[q(p,{modelValue:g.value.authorized_person_position,"onUpdate:modelValue":c[4]||(c[4]=e=>g.value.authorized_person_position=e),placeholder:"请输入职位"},null,8,["modelValue"])]),_:1})]),_:1}),q(m,{span:12},{default:I(()=>[q(_,{label:"职称",prop:"authorized_person_title"},{default:I(()=>[q(p,{modelValue:g.value.authorized_person_title,"onUpdate:modelValue":c[5]||(c[5]=e=>g.value.authorized_person_title=e),placeholder:"请输入职称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),q(f,null,{default:I(()=>[q(m,{span:24},{default:I(()=>[q(_,null,{default:I(()=>[q(R,{type:"primary",loading:y.value,onClick:k},{default:I(()=>[q(F,null,{default:I(()=>[q(C(L))]),_:1}),c[14]||(c[14]=U(" 保存被授权人信息 ",-1))]),_:1},8,["loading"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),q(C(se),{title:"相关附件",class:"mt-4"},{default:I(()=>[j("div",Se,[j("div",Te,[j("div",Oe,[q(F,{class:"icon"},{default:I(()=>[q(C(W))]),_:1}),c[15]||(c[15]=j("span",{class:"title"},"被授权人身份证（正面）",-1))]),h.value.id_card_front?(x(),z("div",Ne,[q(F,{class:"file-icon"},{default:I(()=>[q(C(G))]),_:1}),j("span",Qe,M(h.value.id_card_front.name),1),j("div",Le,[q(R,{text:"",type:"primary",size:"small",onClick:c[6]||(c[6]=e=>E("id_card_front"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(J))]),_:1})]),_:1}),q(R,{text:"",type:"danger",size:"small",onClick:c[7]||(c[7]=e=>$("id_card_front"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(A))]),_:1})]),_:1})])])):(x(),z("div",Be,"未上传")),q(C(ue),{accept:".jpg,.jpeg,.png,.pdf","show-file-list":!1,"http-request":D("id_card_front"),"auto-compress-image":!0,"image-type":"id_card","max-size":10},{trigger:I(()=>[q(R,{size:"small"},{default:I(()=>[q(F,null,{default:I(()=>[q(C(H))]),_:1}),c[16]||(c[16]=U(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])]),j("div",Ge,[j("div",Je,[q(F,{class:"icon"},{default:I(()=>[q(C(W))]),_:1}),c[17]||(c[17]=j("span",{class:"title"},"被授权人身份证（反面）",-1))]),h.value.id_card_back?(x(),z("div",Ae,[q(F,{class:"file-icon"},{default:I(()=>[q(C(G))]),_:1}),j("span",He,M(h.value.id_card_back.name),1),j("div",Ye,[q(R,{text:"",type:"primary",size:"small",onClick:c[8]||(c[8]=e=>E("id_card_back"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(J))]),_:1})]),_:1}),q(R,{text:"",type:"danger",size:"small",onClick:c[9]||(c[9]=e=>$("id_card_back"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(A))]),_:1})]),_:1})])])):(x(),z("div",Ke,"未上传")),q(C(ue),{accept:".jpg,.jpeg,.png,.pdf","show-file-list":!1,"http-request":D("id_card_back"),"auto-compress-image":!0,"image-type":"id_card","max-size":10},{trigger:I(()=>[q(R,{size:"small"},{default:I(()=>[q(F,null,{default:I(()=>[q(C(H))]),_:1}),c[18]||(c[18]=U(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])]),j("div",We,[j("div",Xe,[q(F,{class:"icon"},{default:I(()=>[q(C(X))]),_:1}),c[19]||(c[19]=j("span",{class:"title"},"项目经理简历",-1))]),h.value.manager_resume?(x(),z("div",Ze,[q(F,{class:"file-icon"},{default:I(()=>[q(C(G))]),_:1}),j("span",ea,M(h.value.manager_resume.name),1),j("div",aa,[q(R,{text:"",type:"primary",size:"small",onClick:c[10]||(c[10]=e=>E("manager_resume"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(J))]),_:1})]),_:1}),q(R,{text:"",type:"danger",size:"small",onClick:c[11]||(c[11]=e=>$("manager_resume"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(A))]),_:1})]),_:1})])])):(x(),z("div",la,"未上传")),q(C(ue),{accept:".pdf,.doc,.docx","show-file-list":!1,"http-request":D("manager_resume"),"auto-compress-image":!1,"max-size":20},{trigger:I(()=>[q(R,{size:"small"},{default:I(()=>[q(F,null,{default:I(()=>[q(C(H))]),_:1}),c[20]||(c[20]=U(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])]),j("div",ta,[j("div",ia,[q(F,{class:"icon"},{default:I(()=>[q(C(Z))]),_:1}),c[21]||(c[21]=j("span",{class:"title"},"社保证明",-1))]),h.value.social_security?(x(),z("div",oa,[q(F,{class:"file-icon"},{default:I(()=>[q(C(G))]),_:1}),j("span",na,M(h.value.social_security.name),1),j("div",sa,[q(R,{text:"",type:"primary",size:"small",onClick:c[12]||(c[12]=e=>E("social_security"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(J))]),_:1})]),_:1}),q(R,{text:"",type:"danger",size:"small",onClick:c[13]||(c[13]=e=>$("social_security"))},{default:I(()=>[q(F,null,{default:I(()=>[q(C(A))]),_:1})]),_:1})])])):(x(),z("div",ua,"未上传")),q(C(ue),{accept:".pdf,.jpg,.jpeg,.png","show-file-list":!1,"http-request":D("social_security"),"auto-compress-image":!0,"image-type":"default","max-size":20},{trigger:I(()=>[q(R,{size:"small"},{default:I(()=>[q(F,null,{default:I(()=>[q(C(H))]),_:1}),c[22]||(c[22]=U(" 上传文件 ",-1))]),_:1})]),_:1},8,["http-request"])])])]),_:1})])}}}),[["__scopeId","data-v-0b3ffc62"]]),ra={class:"financial-tab"},ca={class:"shareholders-section"},pa={class:"section-header"},_a={class:"save-section"},ma=oe(k({__name:"FinancialTab",props:{companyId:{},companyData:{}},emits:["update"],setup(o,{emit:u}){const c=o,p=u,{success:_,error:h}=ie(),b=V(),k=V(),D=V(),$=V(),M=V(!1),P=V(!1),S=V([{key:"audit_report",name:"财务审计报告",icon:G,required:!1,allowMultiple:!0},{key:"taxpayer_certificate",name:"纳税人资格证明",icon:ee,required:!1,allowMultiple:!1}]),O=V({}),N=V({bank_name:"",bank_account:""}),Q=V({actual_controller:"",controlling_shareholder:""}),B=V({managing_unit_name:"",managed_unit_name:""}),J=V([]),A=V(-1),H=V(-1),K=V(!1),W=V(-1),X=V({name:"",type:"",ratio:""}),Z={name:[{required:!0,message:"请输入股东名称",trigger:"blur"}],type:[{required:!0,message:"请选择类型",trigger:"change"}],ratio:[{required:!0,message:"请输入出资比例",trigger:"blur"}]};w(()=>c.companyData,e=>{if(e){N.value={bank_name:e.bank_name||"",bank_account:e.bank_account||""},Q.value={actual_controller:e.actual_controller||"",controlling_shareholder:e.controlling_shareholder||""},B.value={managing_unit_name:e.managing_unit_name||"",managed_unit_name:e.managed_unit_name||""};try{const a=e.shareholders_info;a?(J.value="string"==typeof a?JSON.parse(a):a,A.value=J.value.findIndex(e=>!0===e.is_controlling),H.value=J.value.findIndex(e=>!0===e.is_actual_controller)):(J.value=[],A.value=-1,H.value=-1)}catch(a){J.value=[],A.value=-1,H.value=-1}}},{immediate:!0,deep:!0});const ae=()=>{W.value=-1,X.value={name:"",type:"",ratio:""},K.value=!0},le=()=>{J.value.forEach(e=>{e.is_controlling=!1}),-1!==A.value&&(J.value[A.value].is_controlling=!0)},te=()=>{J.value.forEach(e=>{e.is_actual_controller=!1}),-1!==H.value&&(J.value[H.value].is_actual_controller=!0)},oe=async()=>{$.value&&await $.value.validate(e=>{if(e){if(-1===W.value)J.value.push({...X.value,is_controlling:!1,is_actual_controller:!1}),_("添加成功","股东已添加，请点击保存按钮保存更改");else{const e=J.value[W.value];J.value[W.value]={...X.value,is_controlling:e.is_controlling||!1,is_actual_controller:e.is_actual_controller||!1},_("编辑成功","股东信息已更新，请点击保存按钮保存更改")}K.value=!1}})},ue=async()=>{try{P.value=!0;const e=await ne.getCompanyQualifications(c.companyId);e.success&&(O.value=e.data||{})}catch(e){}finally{P.value=!1}},de=async(e,a)=>{try{let l;l=a?`/api/qualifications/${a}/download`:`/api/companies/${c.companyId}/qualifications/${e}/download`,window.open(l,"_blank")}catch(l){h("下载失败",l instanceof Error?l.message:"未知错误")}},re=async(e,a)=>{try{if(!confirm("确定要删除此资质文件吗？"))return;if(a)await ne.deleteQualification(a);else{if(!(await fetch(`/api/companies/${c.companyId}/qualifications/${e}`,{method:"DELETE",credentials:"include"})).ok)throw new Error("删除失败")}_("删除成功","资质文件已删除"),await ue(),p("update")}catch(l){h("删除失败",l instanceof Error?l.message:"未知错误")}},ce=async()=>{M.value=!0;try{(await ne.updateCompany(c.companyId,{bank_name:N.value.bank_name,bank_account:N.value.bank_account,actual_controller:Q.value.actual_controller,controlling_shareholder:Q.value.controlling_shareholder,shareholders_info:JSON.stringify(J.value),managing_unit_name:B.value.managing_unit_name,managed_unit_name:B.value.managed_unit_name})).success&&(_("保存成功","财务信息已更新"),p("update"))}catch(e){h("保存失败",e instanceof Error?e.message:"未知错误")}finally{M.value=!1}};return T(()=>{ue()}),(o,u)=>{const V=l,w=a,P=i,T=t,G=e,ee=r,ie=d,ne=f,pe=v,_e=y,me=g,fe=s,ve=n,ye=m;return x(),z("div",ra,[q(C(se),{title:"财务资质文件",class:"mb-4"},{default:I(()=>[q(w,{gutter:20},{default:I(()=>[(x(!0),z(F,null,R(S.value,e=>(x(),E(V,{key:e.key,span:12},{default:I(()=>[q(Ee,{qualification:e,"file-info":O.value[e.key],onUpload:a=>(async(e,a)=>{try{const l=S.value.find(a=>a.key===e);let t=null;if(null==l?void 0:l.allowMultiple){if(t=prompt(`请输入 "${a.name}" 的年份:\n例如：2023、2024`),null===t)return;if(!t.trim())return void h("上传失败","年份不能为空")}const i=new FormData;i.append(`qualifications[${e}]`,a),i.append("qualification_names",JSON.stringify({[e]:(null==l?void 0:l.name)||e})),t&&i.append("file_versions",JSON.stringify({[e]:t.trim()}));const o=await fetch(`/api/companies/${c.companyId}/qualifications/upload`,{method:"POST",body:i,credentials:"include",headers:{}});if(!o.ok){const e=o.headers.get("content-type");if(e&&e.includes("application/json")){const e=await o.json();throw new Error(e.error||`服务器错误: ${o.status}`)}throw new Error(`上传失败: 服务器返回错误 ${o.status}`)}const n=await o.json();if(!n.success)throw new Error(n.error||"上传失败");_("上传成功",`${(null==l?void 0:l.name)||"资质文件"}上传成功`),await ue(),p("update")}catch(l){h("上传失败",l instanceof Error?l.message:"未知错误")}})(e.key,a),onDownload:de,onDelete:re},null,8,["qualification","file-info","onUpload"])]),_:2},1024))),128))]),_:1})]),_:1}),q(C(se),{title:"银行账户信息"},{default:I(()=>[q(G,{ref_key:"bankFormRef",ref:b,model:N.value,"label-width":"140px",class:"bank-form"},{default:I(()=>[q(w,{gutter:20},{default:I(()=>[q(V,{span:12},{default:I(()=>[q(T,{label:"开户行全称"},{default:I(()=>[q(P,{modelValue:N.value.bank_name,"onUpdate:modelValue":u[0]||(u[0]=e=>N.value.bank_name=e),placeholder:"请输入开户行全称"},null,8,["modelValue"])]),_:1})]),_:1}),q(V,{span:12},{default:I(()=>[q(T,{label:"银行账号"},{default:I(()=>[q(P,{modelValue:N.value.bank_account,"onUpdate:modelValue":u[1]||(u[1]=e=>N.value.bank_account=e),placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),q(C(se),{title:"股权结构信息",class:"mt-4"},{default:I(()=>[q(G,{ref_key:"equityFormRef",ref:k,model:Q.value,"label-width":"140px",class:"equity-form"},{default:I(()=>[q(w,{gutter:20},{default:I(()=>[q(V,{span:12},{default:I(()=>[q(T,{label:"实际控制人"},{default:I(()=>[q(P,{modelValue:Q.value.actual_controller,"onUpdate:modelValue":u[2]||(u[2]=e=>Q.value.actual_controller=e),placeholder:"请输入实际控制人"},null,8,["modelValue"])]),_:1})]),_:1}),q(V,{span:12},{default:I(()=>[q(T,{label:"控股股东"},{default:I(()=>[q(P,{modelValue:Q.value.controlling_shareholder,"onUpdate:modelValue":u[3]||(u[3]=e=>Q.value.controlling_shareholder=e),placeholder:"请输入控股股东"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]),j("div",ca,[j("div",pa,[u[14]||(u[14]=j("h6",null,"股东/投资人列表",-1)),q(ie,{type:"primary",size:"small",onClick:ae},{default:I(()=>[q(ee,null,{default:I(()=>[q(C(Y))]),_:1}),u[13]||(u[13]=U(" 添加股东 ",-1))]),_:1})]),J.value.length>0?(x(),E(_e,{key:0,data:J.value,stripe:""},{default:I(()=>[q(ne,{prop:"name",label:"股东名称","min-width":"150"}),q(ne,{prop:"type",label:"类型",width:"100"}),q(ne,{prop:"ratio",label:"出资比例",width:"120"}),q(ne,{label:"控股股东",width:"100",align:"center"},{default:I(({$index:e})=>[q(pe,{modelValue:A.value,"onUpdate:modelValue":u[4]||(u[4]=e=>A.value=e),label:e,onChange:le},{default:I(()=>[...u[15]||(u[15]=[j("span",null,null,-1)])]),_:1},8,["modelValue","label"])]),_:1}),q(ne,{label:"实际控制人",width:"110",align:"center"},{default:I(({$index:e})=>[q(pe,{modelValue:H.value,"onUpdate:modelValue":u[5]||(u[5]=e=>H.value=e),label:e,onChange:te},{default:I(()=>[...u[16]||(u[16]=[j("span",null,null,-1)])]),_:1},8,["modelValue","label"])]),_:1}),q(ne,{label:"操作",width:"150"},{default:I(({row:e,$index:a})=>[q(ie,{text:"",type:"primary",size:"small",onClick:e=>(e=>{W.value=e;const a=J.value[e];X.value={name:a.name,type:a.type,ratio:a.ratio},K.value=!0})(a)},{default:I(()=>[...u[17]||(u[17]=[U(" 编辑 ",-1)])]),_:1},8,["onClick"]),q(ie,{text:"",type:"danger",size:"small",onClick:e=>{return l=a,void(confirm("确定要删除此股东吗？")&&(l===A.value&&(A.value=-1),l===H.value&&(H.value=-1),J.value.splice(l,1),l<A.value&&A.value--,l<H.value&&H.value--,_("删除成功","股东已删除，请点击保存按钮保存更改")));var l}},{default:I(()=>[...u[18]||(u[18]=[U(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(x(),E(me,{key:1,description:"暂无股东信息","image-size":100}))])]),_:1}),q(C(se),{title:"管理关系信息",class:"mt-4"},{default:I(()=>[q(G,{ref_key:"managementFormRef",ref:D,model:B.value,"label-width":"140px",class:"management-form"},{default:I(()=>[q(w,{gutter:20},{default:I(()=>[q(V,{span:12},{default:I(()=>[q(T,{label:"管理单位名称"},{default:I(()=>[q(P,{modelValue:B.value.managing_unit_name,"onUpdate:modelValue":u[6]||(u[6]=e=>B.value.managing_unit_name=e),placeholder:"如有管理单位请输入"},null,8,["modelValue"])]),_:1})]),_:1}),q(V,{span:12},{default:I(()=>[q(T,{label:"被管理单位名称"},{default:I(()=>[q(P,{modelValue:B.value.managed_unit_name,"onUpdate:modelValue":u[7]||(u[7]=e=>B.value.managed_unit_name=e),placeholder:"如有被管理单位请输入"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),j("div",_a,[q(ie,{type:"primary",size:"large",loading:M.value,onClick:ce},{default:I(()=>[q(ee,null,{default:I(()=>[q(C(L))]),_:1}),u[19]||(u[19]=U(" 保存财务信息 ",-1))]),_:1},8,["loading"])]),q(ye,{modelValue:K.value,"onUpdate:modelValue":u[12]||(u[12]=e=>K.value=e),title:-1===W.value?"添加股东":"编辑股东",width:"500px"},{footer:I(()=>[q(ie,{onClick:u[11]||(u[11]=e=>K.value=!1)},{default:I(()=>[...u[20]||(u[20]=[U("取消",-1)])]),_:1}),q(ie,{type:"primary",onClick:oe},{default:I(()=>[...u[21]||(u[21]=[U("确定",-1)])]),_:1})]),default:I(()=>[q(G,{ref_key:"shareholderFormRef",ref:$,model:X.value,rules:Z,"label-width":"100px"},{default:I(()=>[q(T,{label:"股东名称",prop:"name"},{default:I(()=>[q(P,{modelValue:X.value.name,"onUpdate:modelValue":u[8]||(u[8]=e=>X.value.name=e),placeholder:"请输入股东名称"},null,8,["modelValue"])]),_:1}),q(T,{label:"类型",prop:"type"},{default:I(()=>[q(ve,{modelValue:X.value.type,"onUpdate:modelValue":u[9]||(u[9]=e=>X.value.type=e),placeholder:"请选择类型",style:{width:"100%"}},{default:I(()=>[q(fe,{label:"企业",value:"企业"}),q(fe,{label:"自然人",value:"自然人"})]),_:1},8,["modelValue"])]),_:1}),q(T,{label:"出资比例",prop:"ratio"},{default:I(()=>[q(P,{modelValue:X.value.ratio,"onUpdate:modelValue":u[10]||(u[10]=e=>X.value.ratio=e),placeholder:"如：30%"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-5b1f60f2"]]),fa={class:"company-detail"},va={class:"detail-header"},ya={class:"header-title"},ga={key:1,class:"detail-content"},ha={class:"tab-label"},ba={class:"tab-label"},ka={class:"tab-label"},Va={class:"tab-label"},wa=oe(k({__name:"CompanyDetail",setup(e){const a=O(),l=N(),{error:t}=ie(),i=V(!1),o=V("basic"),n=V(0),s=V({}),u={technology:"科技",manufacturing:"制造业",finance:"金融",education:"教育",healthcare:"医疗",retail:"零售",construction:"建筑",other:"其他"},p=async()=>{i.value=!0;try{const e=await ne.getCompany(n.value);e.success&&e.data?s.value=e.data:(t("加载失败","无法获取企业信息"),f())}catch(e){t("加载失败",e instanceof Error?e.message:"未知错误"),f()}finally{i.value=!1}},_=e=>{},m=async()=>{await p()},f=()=>{l.push("/knowledge/company-library")};return T(()=>{const e=a.params.id;if(e){if(n.value=parseInt(e,10),isNaN(n.value))return t("参数错误","无效的企业ID"),void f();p()}else t("参数错误","缺少企业ID"),f()}),(e,a)=>{const l=d,t=c,p=r,v=h,y=b;return x(),z("div",fa,[j("div",va,[q(l,{onClick:f,icon:"ArrowLeft"},{default:I(()=>[...a[1]||(a[1]=[U("返回列表",-1)])]),_:1}),j("div",ya,[j("h2",null,M(s.value.company_name||"企业详情"),1),s.value.industry_type?(x(),E(t,{key:0,type:"info"},{default:I(()=>{return[U(M((e=s.value.industry_type,u[e]||e)),1)];var e}),_:1})):P("",!0)])]),i.value?(x(),E(C(Q),{key:0,text:"加载企业信息中..."})):(x(),z("div",ga,[q(y,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=e=>o.value=e),class:"company-tabs",onTabChange:_},{default:I(()=>[q(v,{name:"basic"},{label:I(()=>[j("span",ha,[q(p,null,{default:I(()=>[q(C(ae))]),_:1}),a[2]||(a[2]=U(" 基础信息 ",-1))])]),default:I(()=>[q(re,{"company-id":n.value,"company-data":s.value,onUpdate:m},null,8,["company-id","company-data"])]),_:1}),q(v,{name:"qualification"},{label:I(()=>[j("span",ba,[q(p,null,{default:I(()=>[q(C(le))]),_:1}),a[3]||(a[3]=U(" 资质信息 ",-1))])]),default:I(()=>[q(Fe,{"company-id":n.value,"company-data":s.value,onUpdate:m},null,8,["company-id","company-data"])]),_:1}),q(v,{name:"personnel"},{label:I(()=>[j("span",ka,[q(p,null,{default:I(()=>[q(C(X))]),_:1}),a[4]||(a[4]=U(" 被授权人信息 ",-1))])]),default:I(()=>[q(da,{"company-id":n.value,"company-data":s.value,onUpdate:m},null,8,["company-id","company-data"])]),_:1}),q(v,{name:"financial"},{label:I(()=>[j("span",Va,[q(p,null,{default:I(()=>[q(C(te))]),_:1}),a[5]||(a[5]=U(" 财务信息 ",-1))])]),default:I(()=>[q(ma,{"company-id":n.value,"company-data":s.value,onUpdate:m},null,8,["company-id","company-data"])]),_:1})]),_:1},8,["modelValue"])]))])}}}),[["__scopeId","data-v-8d9df7e4"]]);export{wa as default};
