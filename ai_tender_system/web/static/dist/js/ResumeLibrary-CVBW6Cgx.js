import{D as ye,aw as ge,Q as we,a5 as Ve,aE as ke,d as Ce,f as he,i as Ee,af as xe,q as Ue,o as Re,a as Le,ap as De,J as Fe,K as ze,p as $e,au as je,a0 as Ie,z as Te,I as Be,G as Se,g as Ne,h as Oe,Y as Ge,b as Me,c as Pe,R as Ye,a8 as qe}from"./element-plus-IkZgpaz4.js";import{bT as Ae,gi as Xe,bt as c,bu as S,bG as Je,bU as Ke,bV as F,bY as i,c8 as e,c0 as a,bv as y,c6 as w,b$ as N,c5 as p}from"./vendor-CdA3MjAt.js";import{L as Qe}from"./Loading-CmykbBZp.js";import{E as We}from"./Empty-BNVBwC0L.js";/* empty css                                                                          */import{C as He}from"./Card-BYP2BB2j.js";import"./umo-editor-BmhDOXHm.js";/* empty css                                                                        */import{a as Ze,_ as el}from"./index.js";import{k as z,f as X}from"./formatters-D7k9w9WL.js";import{v as ll,a as al}from"./validators-DLLuJPij.js";import"./onnxruntime-DkHy2lK3.js";import"./mermaid-e-fO57px.js";import"./echarts-Cqw1j_Z-.js";const tl={class:"resume-library"},ol={class:"stats-bar"},sl={class:"stat-content"},nl={class:"stat-icon"},ul={class:"stat-info"},rl={class:"stat-value"},dl={class:"stat-content"},il={class:"stat-icon"},pl={class:"stat-info"},vl={class:"stat-value"},ml={class:"stat-content"},fl={class:"stat-icon"},_l={class:"stat-info"},cl={class:"stat-value"},bl={class:"filter-section"},yl=Ae({__name:"ResumeLibrary",setup(gl){const O=Xe(),{success:$,error:g}=Ze(),j=c(!1),C=c([]),u=c({keyword:"",educationLevel:"",position:"",status:""}),h=c(!1),I=c(!1),x=c(),s=c({name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""}),J={name:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:50,message:"姓名长度在 2 到 50 个字符",trigger:"blur"}],phone:[{validator:al,trigger:"blur"}],email:[{validator:ll,trigger:"blur"}]},E=c(!1),T=c(!1),K=c(),U=c([]),V=c(null),G=S(()=>{let t=[...C.value];if(u.value.keyword){const l=u.value.keyword.toLowerCase();t=t.filter(n=>{var b,f,m,r;return((b=n.name)==null?void 0:b.toLowerCase().includes(l))||((f=n.current_position)==null?void 0:f.toLowerCase().includes(l))||((m=n.skills)==null?void 0:m.toLowerCase().includes(l))||((r=n.major)==null?void 0:r.toLowerCase().includes(l))})}if(u.value.educationLevel&&(t=t.filter(l=>l.education_level===u.value.educationLevel)),u.value.position){const l=u.value.position.toLowerCase();t=t.filter(n=>{var b;return(b=n.current_position)==null?void 0:b.toLowerCase().includes(l)})}return u.value.status&&(t=t.filter(l=>l.status===u.value.status)),t}),Q=S(()=>C.value.filter(t=>t.status==="active").length),W=S(()=>{const t=C.value.filter(n=>n.work_years&&n.work_years>0);return t.length===0?0:(t.reduce((n,b)=>n+(b.work_years||0),0)/t.length).toFixed(1)}),R=async()=>{j.value=!0;try{const t=await z.getResumes();if(t.success&&t.data){const l=t.data.resumes||t.data;C.value=l.map(n=>({...n,created_at:n.created_at?X(n.created_at):"-",updated_at:n.updated_at?X(n.updated_at):"-"}))}}catch(t){console.error("加载简历列表失败:",t),g("加载失败",t instanceof Error?t.message:"未知错误")}finally{j.value=!1}},L=()=>{},H=()=>{u.value.keyword="",u.value.educationLevel="",u.value.position="",u.value.status=""},Z=t=>t?t==="博士"?"danger":t==="硕士"?"warning":t==="本科"?"success":"info":"info",ee=t=>{switch(t){case"active":return"success";case"inactive":return"warning";case"archived":return"info";default:return"info"}},le=t=>{switch(t){case"active":return"活跃";case"inactive":return"离职";case"archived":return"已归档";default:return"-"}},ae=()=>{h.value=!0},te=async()=>{x.value&&await x.value.validate(async t=>{if(t){I.value=!0;try{const l=await z.createResume({name:s.value.name,gender:s.value.gender||void 0,phone:s.value.phone||void 0,email:s.value.email||void 0,education_level:s.value.education_level||void 0,degree:s.value.degree||void 0,university:s.value.university||void 0,major:s.value.major||void 0,current_position:s.value.current_position||void 0,professional_title:s.value.professional_title||void 0,work_years:s.value.work_years,current_company:s.value.current_company||void 0,introduction:s.value.introduction||void 0,status:"active"});l.success?($("创建成功","简历创建成功"),h.value=!1,await R()):g("创建失败",l.error||"未知错误")}catch(l){console.error("创建简历失败:",l),g("创建失败",l instanceof Error?l.message:"未知错误")}finally{I.value=!1}}})},oe=()=>{E.value=!0},se=t=>{if(console.log("文件变化:",t),t.raw){if(t.raw.size>10485760){g("文件过大","文件大小不能超过10MB"),U.value=[],V.value=null;return}V.value=t.raw}},ne=()=>{V.value=null},ue=async()=>{if(!V.value){g("请选择文件","请先选择要上传的简历文件");return}T.value=!0;try{const t=await z.parseResumeFile(V.value,!0);t.success?($("导入成功","简历已自动解析并创建"),E.value=!1,await R()):g("导入失败",t.error||"解析失败")}catch(t){console.error("智能导入失败:",t),g("导入失败",t instanceof Error?t.message:"未知错误")}finally{T.value=!1}},re=()=>{U.value=[],V.value=null},de=()=>{var t;s.value={name:"",gender:"",phone:"",email:"",education_level:"",degree:"",university:"",major:"",current_position:"",professional_title:"",work_years:void 0,current_company:"",introduction:""},(t=x.value)==null||t.resetFields()},ie=t=>{O.push(`/knowledge/resume/${t.resume_id}`)},pe=t=>{O.push(`/knowledge/resume/${t.resume_id}`)},ve=async t=>{try{if(!confirm(`确定要删除简历 "${t.name}" 吗？此操作不可恢复。`))return;const l=await z.deleteResume(t.resume_id);l.success?($("删除成功",`已删除简历: ${t.name}`),await R()):g("删除失败",l.error||"未知错误")}catch(l){console.error("删除简历失败:",l),g("删除失败",l instanceof Error?l.message:"未知错误")}};return Je(()=>{R()}),(t,l)=>{const n=ye,b=we,f=Le,m=Ee,r=he,d=Re,D=Ue,M=Ce,v=ze,P=$e,me=Fe,B=Te,_=Se,Y=Oe,fe=Ne,k=Be,_e=Ge,q=Me,ce=Pe,be=Ye;return F(),Ke("div",tl,[i("div",ol,[e(b,{class:"stat-card"},{default:a(()=>[i("div",sl,[i("div",nl,[e(n,{size:32,color:"#409eff"},{default:a(()=>[e(y(ge))]),_:1})]),i("div",ul,[l[22]||(l[22]=i("div",{class:"stat-label"},"总简历数",-1)),i("div",rl,w(C.value.length),1)])])]),_:1}),e(b,{class:"stat-card"},{default:a(()=>[i("div",dl,[i("div",il,[e(n,{size:32,color:"#67c23a"},{default:a(()=>[e(y(Ve))]),_:1})]),i("div",pl,[l[23]||(l[23]=i("div",{class:"stat-label"},"活跃简历",-1)),i("div",vl,w(Q.value),1)])])]),_:1}),e(b,{class:"stat-card"},{default:a(()=>[i("div",ml,[i("div",fl,[e(n,{size:32,color:"#e6a23c"},{default:a(()=>[e(y(ke))]),_:1})]),i("div",_l,[l[24]||(l[24]=i("div",{class:"stat-label"},"平均工龄",-1)),i("div",cl,w(W.value)+"年",1)])])]),_:1})]),e(y(He),{title:"简历列表"},{actions:a(()=>[e(f,{type:"primary",onClick:ae},{default:a(()=>[e(n,null,{default:a(()=>[e(y(je))]),_:1}),l[25]||(l[25]=p(" 新建简历 ",-1))]),_:1}),e(f,{type:"success",onClick:oe},{default:a(()=>[e(n,null,{default:a(()=>[e(y(Ie))]),_:1}),l[26]||(l[26]=p(" 智能导入 ",-1))]),_:1})]),default:a(()=>[i("div",bl,[e(M,{inline:!0,model:u.value},{default:a(()=>[e(r,{label:"搜索"},{default:a(()=>[e(m,{modelValue:u.value.keyword,"onUpdate:modelValue":l[0]||(l[0]=o=>u.value.keyword=o),placeholder:"搜索姓名、职位、技能...",clearable:"",style:{width:"300px"},onInput:L},{prefix:a(()=>[e(n,null,{default:a(()=>[e(y(xe))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"学历"},{default:a(()=>[e(D,{modelValue:u.value.educationLevel,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value.educationLevel=o),placeholder:"全部学历",clearable:"",style:{width:"120px"},onChange:L},{default:a(()=>[e(d,{label:"全部学历",value:""}),e(d,{label:"博士",value:"博士"}),e(d,{label:"硕士",value:"硕士"}),e(d,{label:"本科",value:"本科"}),e(d,{label:"大专",value:"大专"}),e(d,{label:"高中",value:"高中"})]),_:1},8,["modelValue"])]),_:1}),e(r,{label:"职位"},{default:a(()=>[e(m,{modelValue:u.value.position,"onUpdate:modelValue":l[2]||(l[2]=o=>u.value.position=o),placeholder:"职位关键词",clearable:"",style:{width:"150px"},onInput:L},null,8,["modelValue"])]),_:1}),e(r,{label:"状态"},{default:a(()=>[e(D,{modelValue:u.value.status,"onUpdate:modelValue":l[3]||(l[3]=o=>u.value.status=o),placeholder:"全部状态",clearable:"",style:{width:"120px"},onChange:L},{default:a(()=>[e(d,{label:"全部状态",value:""}),e(d,{label:"活跃",value:"active"}),e(d,{label:"离职",value:"inactive"}),e(d,{label:"已归档",value:"archived"})]),_:1},8,["modelValue"])]),_:1}),e(r,null,{default:a(()=>[e(f,{onClick:H},{default:a(()=>[e(n,null,{default:a(()=>[e(y(De))]),_:1}),l[27]||(l[27]=p(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),j.value?(F(),N(y(Qe),{key:0,text:"加载中..."})):G.value.length?(F(),N(me,{key:2,data:G.value,stripe:"",style:{width:"100%"}},{default:a(()=>[e(v,{prop:"resume_id",label:"ID",width:"70",fixed:""}),e(v,{prop:"name",label:"姓名",width:"100",fixed:""}),e(v,{prop:"gender",label:"性别",width:"60",align:"center"},{default:a(({row:o})=>[p(w(o.gender||"-"),1)]),_:1}),e(v,{prop:"education_level",label:"学历",width:"80"},{default:a(({row:o})=>[e(P,{type:Z(o.education_level),size:"small"},{default:a(()=>[p(w(o.education_level||"-"),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"university",label:"毕业院校",width:"140","show-overflow-tooltip":""}),e(v,{prop:"major",label:"专业",width:"120","show-overflow-tooltip":""}),e(v,{prop:"current_position",label:"当前职位",width:"140","show-overflow-tooltip":""}),e(v,{prop:"professional_title",label:"职称",width:"100"}),e(v,{prop:"work_years",label:"工作年限",width:"90",align:"center"},{default:a(({row:o})=>[p(w(o.work_years?`${o.work_years}年`:"-"),1)]),_:1}),e(v,{prop:"current_company",label:"当前单位",width:"160","show-overflow-tooltip":""}),e(v,{prop:"phone",label:"联系电话",width:"120"}),e(v,{prop:"email",label:"邮箱",width:"180","show-overflow-tooltip":""}),e(v,{prop:"status",label:"状态",width:"80",align:"center"},{default:a(({row:o})=>[e(P,{type:ee(o.status),size:"small"},{default:a(()=>[p(w(le(o.status)),1)]),_:2},1032,["type"])]),_:1}),e(v,{prop:"created_at",label:"创建时间",width:"160","show-overflow-tooltip":""}),e(v,{label:"操作",width:"220",fixed:"right"},{default:a(({row:o})=>[e(f,{text:"",type:"primary",size:"small",onClick:A=>ie(o)},{default:a(()=>[...l[28]||(l[28]=[p(" 查看详情 ",-1)])]),_:1},8,["onClick"]),e(f,{text:"",type:"warning",size:"small",onClick:A=>pe(o)},{default:a(()=>[...l[29]||(l[29]=[p(" 编辑 ",-1)])]),_:1},8,["onClick"]),e(f,{text:"",type:"danger",size:"small",onClick:A=>ve(o)},{default:a(()=>[...l[30]||(l[30]=[p(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])):(F(),N(y(We),{key:1,type:"no-data",description:"暂无简历数据"}))]),_:1}),e(q,{modelValue:h.value,"onUpdate:modelValue":l[18]||(l[18]=o=>h.value=o),title:"新建简历",width:"700px",onClose:de},{footer:a(()=>[e(f,{onClick:l[17]||(l[17]=o=>h.value=!1)},{default:a(()=>[...l[36]||(l[36]=[p("取消",-1)])]),_:1}),e(f,{type:"primary",loading:I.value,onClick:te},{default:a(()=>[...l[37]||(l[37]=[p(" 确定 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[e(M,{ref_key:"createFormRef",ref:x,model:s.value,rules:J,"label-width":"120px"},{default:a(()=>[e(B,{"content-position":"left"},{default:a(()=>[...l[31]||(l[31]=[p("基本信息",-1)])]),_:1}),e(k,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[e(r,{label:"姓名",prop:"name"},{default:a(()=>[e(m,{modelValue:s.value.name,"onUpdate:modelValue":l[4]||(l[4]=o=>s.value.name=o),placeholder:"请输入姓名"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:a(()=>[e(r,{label:"性别",prop:"gender"},{default:a(()=>[e(fe,{modelValue:s.value.gender,"onUpdate:modelValue":l[5]||(l[5]=o=>s.value.gender=o)},{default:a(()=>[e(Y,{label:"男"},{default:a(()=>[...l[32]||(l[32]=[p("男",-1)])]),_:1}),e(Y,{label:"女"},{default:a(()=>[...l[33]||(l[33]=[p("女",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[e(r,{label:"联系电话",prop:"phone"},{default:a(()=>[e(m,{modelValue:s.value.phone,"onUpdate:modelValue":l[6]||(l[6]=o=>s.value.phone=o),placeholder:"请输入手机号"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:a(()=>[e(r,{label:"邮箱",prop:"email"},{default:a(()=>[e(m,{modelValue:s.value.email,"onUpdate:modelValue":l[7]||(l[7]=o=>s.value.email=o),placeholder:"请输入邮箱"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(B,{"content-position":"left"},{default:a(()=>[...l[34]||(l[34]=[p("教育信息",-1)])]),_:1}),e(k,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[e(r,{label:"学历",prop:"education_level"},{default:a(()=>[e(D,{modelValue:s.value.education_level,"onUpdate:modelValue":l[8]||(l[8]=o=>s.value.education_level=o),placeholder:"请选择学历",style:{width:"100%"}},{default:a(()=>[e(d,{label:"博士",value:"博士"}),e(d,{label:"硕士",value:"硕士"}),e(d,{label:"本科",value:"本科"}),e(d,{label:"大专",value:"大专"}),e(d,{label:"高中",value:"高中"}),e(d,{label:"中专",value:"中专"}),e(d,{label:"其他",value:"其他"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:a(()=>[e(r,{label:"学位",prop:"degree"},{default:a(()=>[e(D,{modelValue:s.value.degree,"onUpdate:modelValue":l[9]||(l[9]=o=>s.value.degree=o),placeholder:"请选择学位",style:{width:"100%"}},{default:a(()=>[e(d,{label:"博士学位",value:"博士"}),e(d,{label:"硕士学位",value:"硕士"}),e(d,{label:"学士学位",value:"学士"}),e(d,{label:"无学位",value:"无"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[e(r,{label:"毕业院校",prop:"university"},{default:a(()=>[e(m,{modelValue:s.value.university,"onUpdate:modelValue":l[10]||(l[10]=o=>s.value.university=o),placeholder:"请输入毕业院校"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:a(()=>[e(r,{label:"专业",prop:"major"},{default:a(()=>[e(m,{modelValue:s.value.major,"onUpdate:modelValue":l[11]||(l[11]=o=>s.value.major=o),placeholder:"请输入专业"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(B,{"content-position":"left"},{default:a(()=>[...l[35]||(l[35]=[p("工作信息",-1)])]),_:1}),e(k,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[e(r,{label:"当前职位",prop:"current_position"},{default:a(()=>[e(m,{modelValue:s.value.current_position,"onUpdate:modelValue":l[12]||(l[12]=o=>s.value.current_position=o),placeholder:"如：项目经理"},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:a(()=>[e(r,{label:"职称",prop:"professional_title"},{default:a(()=>[e(m,{modelValue:s.value.professional_title,"onUpdate:modelValue":l[13]||(l[13]=o=>s.value.professional_title=o),placeholder:"如：高级工程师"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(k,{gutter:20},{default:a(()=>[e(_,{span:12},{default:a(()=>[e(r,{label:"工作年限",prop:"work_years"},{default:a(()=>[e(_e,{modelValue:s.value.work_years,"onUpdate:modelValue":l[14]||(l[14]=o=>s.value.work_years=o),min:0,max:50,placeholder:"年",style:{width:"100%"}},null,8,["modelValue"])]),_:1})]),_:1}),e(_,{span:12},{default:a(()=>[e(r,{label:"当前单位",prop:"current_company"},{default:a(()=>[e(m,{modelValue:s.value.current_company,"onUpdate:modelValue":l[15]||(l[15]=o=>s.value.current_company=o),placeholder:"请输入当前工作单位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(r,{label:"个人简介",prop:"introduction"},{default:a(()=>[e(m,{modelValue:s.value.introduction,"onUpdate:modelValue":l[16]||(l[16]=o=>s.value.introduction=o),type:"textarea",rows:3,placeholder:"请简要介绍个人经历、专长等"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"]),e(q,{modelValue:E.value,"onUpdate:modelValue":l[21]||(l[21]=o=>E.value=o),title:"智能导入简历",width:"500px",onClose:re},{footer:a(()=>[e(f,{onClick:l[20]||(l[20]=o=>E.value=!1)},{default:a(()=>[...l[40]||(l[40]=[p("取消",-1)])]),_:1}),e(f,{type:"primary",loading:T.value,onClick:ue},{default:a(()=>[...l[41]||(l[41]=[p(" 开始解析 ",-1)])]),_:1},8,["loading"])]),default:a(()=>[e(ce,{title:"智能解析",type:"info",description:"上传PDF/DOC/DOCX格式的简历文件，系统将自动提取信息并创建简历记录",closable:!1,style:{"margin-bottom":"20px"}}),e(be,{ref_key:"uploadRef",ref:K,"file-list":U.value,"onUpdate:fileList":l[19]||(l[19]=o=>U.value=o),"auto-upload":!1,limit:1,accept:".pdf,.doc,.docx",drag:"","on-change":se,"on-remove":ne},{tip:a(()=>[...l[38]||(l[38]=[i("div",{class:"el-upload__tip"}," 支持PDF、DOC、DOCX格式，文件大小不超过10MB ",-1)])]),default:a(()=>[e(n,{class:"el-icon--upload"},{default:a(()=>[e(y(qe))]),_:1}),l[39]||(l[39]=i("div",{class:"el-upload__text"},[p(" 拖拽文件到这里 或 "),i("em",null,"点击上传")],-1))]),_:1},8,["file-list"])]),_:1},8,["modelValue"])])}}}),jl=el(yl,[["__scopeId","data-v-d80ddb3a"]]);export{jl as default};
