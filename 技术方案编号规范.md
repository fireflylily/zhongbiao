# 技术方案编号规范说明

## ❌ 旧版本问题（已解决）

### 编号冲突示例

**旧版本**同时使用相似的编号格式，导致混淆：

```
一、数据服务需求
  (一) 运营商三要素验证

    我方具备以下能力：
    (1) 与三大运营商直连        ← ⚠️ 看起来像章节编号
    (2) 验证准确率99.5%          ← ⚠️ 容易误以为是 (二) 的兄弟章节
    (3) 响应时间≤300ms

  (二) 在网状态查询             ← ❓ 读者困惑：(1)(2)(3)是什么？
```

**问题分析：**
- 章节编号使用：`(一)、(二)、(三)`
- 内容列举也使用：`(1)、(2)、(3)`
- 二者在视觉上非常相似，容易让读者误以为是平级的章节标题

---

## ✅ 新版本规范（2025-12-18起生效）

### 编号体系清晰分离

| 用途 | 格式 | 示例 | 说明 |
|------|------|------|------|
| **1级章节** | 一、二、三、四、五... | 一、数据服务需求 | 汉字编号 |
| **2级章节** | (一)、(二)、(三)、(四)... | (一) 运营商三要素验证 | 带括号的汉字编号 |
| **3级章节** | 1、2、3、4、5... | 1、接口设计 | 阿拉伯数字编号 |
| **内容列举** | ① ② ③ ④ ⑤ | ① 与三大运营商直连 | **带圈数字**（新规范） |
| **次要列举** | 第一点、第二点、第三点 | 第一点：数据准确性 | 文字描述 |

### 修正后效果

**新版本**使用不同的编号格式，一目了然：

```
一、数据服务需求
  (一) 运营商三要素验证

    我方具备以下能力：
    ① 与三大运营商直连        ✓ 清晰！这是列举项
    ② 验证准确率99.5%          ✓ 完全不会混淆
    ③ 响应时间≤300ms

  (二) 在网状态查询             ✓ 章节结构清晰明确

    系统支持以下查询功能：
    ① 实时在网状态查询        ✓ 列举项一目了然
    ② 在网时长精确到月
    ③ 停机/销号状态识别
```

---

## 📊 完整示例对比

### 示例1：数据服务需求章节

**旧版本（有混淆）：**
```
一、数据服务需求
  (一) 运营商三要素验证
    我方具备以下能力：
    (1) 与移动、联通、电信三家运营商建立直连通道
    (2) 验证准确率≥99.5%，响应时间≤300ms
    (3) 支持批量验证，日处理能力达500万次

  (二) 在网状态查询              ← ❓ 用户可能认为(1)(2)(3)是章节
    系统提供在网状态实时查询功能...
```

**新版本（清晰明确）：**
```
一、数据服务需求
  (一) 运营商三要素验证
    我方具备以下能力：
    ① 与移动、联通、电信三家运营商建立直连通道
    ② 验证准确率≥99.5%，响应时间≤300ms
    ③ 支持批量验证，日处理能力达500万次

  (二) 在网状态查询              ✓ 结构清晰，不会误解
    系统提供在网状态实时查询功能...
```

### 示例2：复杂嵌套结构

```
一、性能与可用性
  (一) 支持1000并发请求

    系统采用以下架构保障高并发：
    ① 负载均衡集群架构
       第一点：前端采用Nginx负载均衡
       第二点：后端部署5节点集群
       第三点：支持动态扩容

    ② 分布式缓存加速
       - Redis集群缓存热点数据
       - 缓存命中率≥95%

    ③ 异步消息队列削峰

  (二) 接口响应时间≤500ms

    性能优化措施包括：
    ① 数据库查询优化（索引优化、SQL调优）
    ② CDN加速静态资源
    ③ 接口返回数据压缩

    实测性能数据：
    ① 平均响应时间：280ms
    ② P95响应时间：420ms
    ③ P99响应时间：480ms
```

---

## 🎯 编号规范要点

### 1. 章节编号（固定格式）

**严格遵守以下编号格式：**

| 级别 | 格式 | 错误示例 | 正确示例 |
|------|------|----------|----------|
| 1级 | 一、二、三... | ❌ 1、第一章、Chapter 1 | ✅ 一、 |
| 2级 | (一)、(二)、(三)... | ❌ 1.1、1-1、①、(1) | ✅ (一)、 |
| 3级 | 1、2、3... | ❌ 1.1.1、a、⑴ | ✅ 1、 |

### 2. 内容列举（新规范）

**优先使用带圈数字：**
- ✅ 推荐：① ② ③ ④ ⑤ ⑥ ⑦ ⑧ ⑨ ⑩
- ✅ 备选：第一点、第二点、第三点
- ❌ 禁止：(1)、(2)、(3) ← 与章节编号 (一)、(二) 容易混淆
- ❌ 禁止：1)、2)、3)  ← 不规范
- ❌ 禁止：a)、b)、c)  ← 不符合中文习惯

**带圈数字 Unicode 字符表：**
```
① U+2460
② U+2461
③ U+2462
④ U+2463
⑤ U+2464
⑥ U+2465
⑦ U+2466
⑧ U+2467
⑨ U+2468
⑩ U+2469
```

### 3. 特殊情况处理

**当列举项超过10个时：**
```
① 项目1
② 项目2
...
⑨ 项目9
⑩ 项目10
⑪ 项目11（使用扩展带圈数字）
⑫ 项目12
...
或改用：
第11点：项目11
第12点：项目12
```

**需要二级列举时：**
```
① 主要功能
   第一点：用户管理
   第二点：权限控制
   第三点：日志审计

② 性能指标
   - 并发数：1000+
   - 响应时间：≤500ms
   - 可用性：≥99.9%
```

---

## 🔧 技术实现

### 修改的文件

1. **`ai_tender_system/modules/outline_generator/proposal_assembler.py`**
   - 修改位置：`_build_basic_prompt()` 方法（Line 1005）
   - 修改位置：`_build_advanced_prompt()` 方法（Line 1056, 1060）

### 修改内容

**基础模式提示词（Line 1005）：**
```python
# 旧版本
5. 如需列举要点，使用"（1）、（2）"或"第一、第二"等中文表述

# 新版本
5. 如需列举要点，使用带圈数字"① ② ③ ④ ⑤"或"第一点、第二点"等表述，避免使用(1)(2)(3)
```

**高级模式提示词（Line 1056, 1060）：**
```python
# 旧版本
- 中间段落: 分(1)、(2)、(3)列举具体解决方案或能力证明
- 列举时使用"(1)"、"(2)"或"第一、"、"第二、"

# 新版本
- 中间段落: 分 ① ② ③ 列举具体解决方案或能力证明
- 列举时使用带圈数字"① ② ③ ④ ⑤"或"第一点、第二点"，避免使用(1)(2)(3)以免与章节编号混淆
```

---

## 📝 Word文档格式兼容性

### 带圈数字在Word中的显示

带圈数字 ① ② ③ 在Microsoft Word中完美支持：
- ✅ Word 2010及以上版本原生支持
- ✅ 使用宋体、微软雅黑等常用中文字体正常显示
- ✅ 可正常复制粘贴
- ✅ PDF导出保持原样

### 字体建议

| 字体 | 带圈数字支持 | 推荐度 |
|------|-------------|--------|
| 宋体 | ✅ 完美支持 | ⭐⭐⭐⭐⭐ |
| 微软雅黑 | ✅ 完美支持 | ⭐⭐⭐⭐⭐ |
| 黑体 | ✅ 完美支持 | ⭐⭐⭐⭐ |
| 仿宋 | ✅ 支持 | ⭐⭐⭐ |
| Arial | ⚠️ 部分支持 | ⭐⭐ |

---

## 🎓 最佳实践建议

### 1. 章节层级不宜过深
```
✅ 推荐（3级以内）：
一、
  (一)
    1、

❌ 不推荐（4级及以上）：
一、
  (一)
    1、
      ① ← 这里应该是内容列举，而非章节
```

### 2. 列举项数量建议
- ✅ 理想：3-5个列举项
- ⚠️ 可接受：6-8个列举项
- ❌ 避免：超过10个列举项（考虑分组或子章节）

### 3. 混合使用示例
```
一、技术方案总体设计
  (一) 系统架构

    系统采用三层架构：
    ① 表现层：Vue3前端框架
    ② 业务层：Python Flask微服务
    ③ 数据层：PostgreSQL数据库

    架构设计遵循以下原则：
    第一点：高内聚低耦合
    第二点：服务独立部署
    第三点：水平扩展能力
```

---

## 📌 版本历史

| 版本 | 日期 | 变更内容 | 影响范围 |
|------|------|----------|----------|
| 1.0 | 2025-01-15 | 初始版本，使用 (1)(2)(3) 列举 | 全部文档 |
| 2.0 | 2025-12-18 | 改用 ① ② ③ 避免编号混淆 | 新生成文档 |

---

## 🔗 相关文档

- 技术方案生成流程图：`技术方案生成流程图.md`
- 提示词配置文件：`ai_tender_system/prompts/outline_generation.json`
- 方案组装器代码：`ai_tender_system/modules/outline_generator/proposal_assembler.py`

---

**更新时间**: 2025-12-18
**生效日期**: 2025-12-18
**适用版本**: v2.0.0+
