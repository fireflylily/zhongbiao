<!-- 点对点应答页面内容 -->
<div class="row">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-upload"></i> 文档上传处理</h5>
            </div>
            <div class="card-body">
                <form id="uploadForm" enctype="multipart/form-data">
                    <div class="upload-area" id="uploadArea">
                        <i class="bi bi-cloud-upload text-primary" style="font-size: 3rem;"></i>
                        <h4 class="mt-3">拖拽文档到这里或点击选择</h4>
                        <p class="text-muted">支持 .docx 和 .doc 格式，最大 50MB</p>
                        <input type="file" class="d-none" id="fileInput" name="file" accept=".docx,.doc">
                        <button type="button" class="btn btn-primary" onclick="document.getElementById('fileInput').click();">
                            <i class="bi bi-folder2-open"></i> 选择文件
                        </button>
                    </div>
                    
                    <div id="fileInfo" class="mt-3" style="display: none;">
                        <div class="alert alert-info">
                            <i class="bi bi-file-earmark-text"></i>
                            <span id="fileName"></span>
                            <span id="fileSize" class="text-muted ms-2"></span>
                        </div>
                    </div>
                    
                    <div class="mt-3 text-center">
                        <button type="submit" class="btn btn-success btn-lg me-3" id="processBtn" disabled>
                            <i class="bi bi-play-circle"></i> 开始处理
                        </button>
                        <button type="button" class="btn btn-primary btn-lg" onclick="StateManager.navigateToPage('tech_proposal.html')">
                            <i class="bi bi-arrow-right"></i> 下一步：技术方案
                        </button>
                    </div>
                </form>
                
                <!-- 进度条 -->
                <div class="progress mt-3" id="progressBar">
                    <div class="progress-bar progress-bar-striped progress-bar-animated" 
                         role="progressbar" style="width: 0%"></div>
                </div>
                
                <!-- 结果区域 -->
                <div id="resultArea" class="mt-4" style="display: none;">
                    <div class="alert alert-success">
                        <h5><i class="bi bi-check-circle"></i> 处理完成！</h5>
                        <p id="resultMessage"></p>
                        <div class="mt-3">
                            <button id="downloadBtn" class="btn btn-primary me-2">
                                <i class="bi bi-download"></i> 下载处理后的文档
                            </button>
                            <button id="previewBtn" class="btn btn-success me-2">
                                <i class="bi bi-eye"></i> 预览文档
                            </button>
                            <button id="viewFilesBtn" class="btn btn-outline-info">
                                <i class="bi bi-file-earmark-text"></i> 查看所有文件
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 错误区域 -->
                <div id="errorArea" class="mt-4" style="display: none;">
                    <div class="alert alert-danger">
                        <h5><i class="bi bi-exclamation-triangle"></i> 处理失败</h5>
                        <p id="errorMessage"></p>
                        <div class="mt-3">
                            <button type="button" class="btn btn-outline-primary" id="retryBtn">
                                <i class="bi bi-arrow-clockwise"></i> 重试
                            </button>
                            <button type="button" class="btn btn-outline-secondary" id="resetBtn">
                                <i class="bi bi-arrow-counterclockwise"></i> 重新选择文件
                            </button>
                        </div>
                    </div>
                </div>
                
            </div>
        </div>
    </div>
</div>

<!-- 功能特点 -->
<div class="row mb-5">
    <div class="col-md-4 mb-3">
        <div class="card feature-card">
            <div class="card-body text-center">
                <i class="bi bi-lightning-charge text-warning" style="font-size: 2rem;"></i>
                <h5 class="card-title mt-3">智能识别</h5>
                <p class="card-text text-muted">自动识别文档中的需求条目，减少遗漏</p>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="card feature-card">
            <div class="card-body text-center">
                <i class="bi bi-cpu text-primary" style="font-size: 2rem;"></i>
                <h5 class="card-title mt-3">AI生成</h5>
                <p class="card-text text-muted">使用先进AI模型生成专业技术应答</p>
            </div>
        </div>
    </div>
    <div class="col-md-4 mb-3">
        <div class="card feature-card">
            <div class="card-body text-center">
                <i class="bi bi-palette text-success" style="font-size: 2rem;"></i>
                <h5 class="card-title mt-3">格式美化</h5>
                <p class="card-text text-muted">自动设置字体、颜色、底纹和行距</p>
            </div>
        </div>
    </div>
</div>

<!-- 使用说明 -->
<div class="row mt-5">
    <div class="col-12">
        <div class="card">
            <div class="card-header">
                <h5><i class="bi bi-question-circle"></i> 使用说明</h5>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h6>📋 支持的文档格式</h6>
                        <ul>
                            <li>Microsoft Word 文档 (.docx)</li>
                            <li>Microsoft Word 97-2003 文档 (.doc)</li>
                            <li>文档大小限制：50MB</li>
                        </ul>
                        
                        <h6>🎯 处理功能</h6>
                        <ul>
                            <li>自动识别采购需求条目</li>
                            <li>生成"应答：满足。"格式的专业应答</li>
                            <li>保持原文档格式和字体</li>
                            <li>应答内容：黑色字体，灰色底纹，1.5倍行距</li>
                        </ul>
                    </div>
                    <div class="col-md-6">
                        <h6>🔧 API配置</h6>
                        <ul>
                            <li>配置始皇API密钥以获得更专业的AI应答</li>
                            <li>不配置API密钥将使用内置应答模板</li>
                            <li>建议使用GPT-4o-mini模型获得最佳效果</li>
                        </ul>
                        
                        <h6>⚠️ 注意事项</h6>
                        <ul>
                            <li>处理时间视文档大小和复杂度而定</li>
                            <li>请确保网络连接稳定</li>
                            <li>建议备份原始文档</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>