<template>
  <div class="demo-container">
    <!-- é¡µé¢å¤´éƒ¨ -->
    <el-card class="header-card">
      <div class="header-content">
        <div>
          <h1>ğŸ§° å·¥å…·å‡½æ•°æ¼”ç¤ºä¸­å¿ƒ</h1>
          <p class="subtitle">
            å±•ç¤ºé¡¹ç›®ä¸­æ‰€æœ‰å·¥å…·å‡½æ•°å’Œç»„åˆå¼å‡½æ•°çš„å®é™…åº”ç”¨ç¤ºä¾‹
          </p>
        </div>
        <el-tag type="primary" size="large">v2.0.0</el-tag>
      </div>
    </el-card>

    <!-- Tabå¯¼èˆª -->
    <el-card class="demo-tabs-card">
      <el-tabs v-model="activeTab" type="border-card" @tab-click="handleTabClick">
        <!-- æ ¼å¼åŒ–å·¥å…· -->
        <el-tab-pane name="format">
          <template #label>
            <span class="tab-label">
              <el-icon><Calendar /></el-icon>
              æ ¼å¼åŒ–å·¥å…·
            </span>
          </template>
          <format-demo />
        </el-tab-pane>

        <!-- éªŒè¯å·¥å…· -->
        <el-tab-pane name="validation">
          <template #label>
            <span class="tab-label">
              <el-icon><CircleCheck /></el-icon>
              éªŒè¯å·¥å…·
            </span>
          </template>
          <validation-demo />
        </el-tab-pane>

        <!-- è¾…åŠ©å‡½æ•° -->
        <el-tab-pane name="helpers">
          <template #label>
            <span class="tab-label">
              <el-icon><Tools /></el-icon>
              è¾…åŠ©å‡½æ•°
            </span>
          </template>
          <helpers-demo />
        </el-tab-pane>

        <!-- ç»„åˆå¼å‡½æ•° -->
        <el-tab-pane name="composables">
          <template #label>
            <span class="tab-label">
              <el-icon><Connection /></el-icon>
              ç»„åˆå¼å‡½æ•°
            </span>
          </template>
          <composables-demo />
        </el-tab-pane>

        <!-- ä½¿ç”¨æŒ‡å— -->
        <el-tab-pane name="guide">
          <template #label>
            <span class="tab-label">
              <el-icon><Document /></el-icon>
              ä½¿ç”¨æŒ‡å—
            </span>
          </template>
          <usage-guide />
        </el-tab-pane>
      </el-tabs>
    </el-card>

    <!-- é¡µè„šä¿¡æ¯ -->
    <el-card class="footer-card">
      <div class="footer-content">
        <div>
          <el-icon><InfoFilled /></el-icon>
          <span>è¿™äº›å·¥å…·å‡½æ•°å’Œç»„åˆå¼å‡½æ•°å·²åœ¨æ•´ä¸ªé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œç¡®ä¿ä»£ç çš„ä¸€è‡´æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚</span>
        </div>
        <el-link type="primary" href="https://github.com" target="_blank">
          æŸ¥çœ‹æºç 
          <el-icon><Right /></el-icon>
        </el-link>
      </div>
    </el-card>
  </div>
</template>

<script setup lang="ts">
import { ref } from 'vue'
import {
  Calendar,
  CircleCheck,
  Tools,
  Connection,
  Document,
  InfoFilled,
  Right
} from '@element-plus/icons-vue'
import FormatDemo from './FormatDemo.vue'
import ValidationDemo from './ValidationDemo.vue'
import HelpersDemo from './HelpersDemo.vue'
import ComposablesDemo from './ComposablesDemo.vue'

const activeTab = ref('format')

function handleTabClick() {
  // Tabåˆ‡æ¢æ—¶å¯ä»¥æ·»åŠ åŸ‹ç‚¹ç­‰é€»è¾‘
  console.log('å½“å‰Tab:', activeTab.value)
}
</script>

<script lang="ts">
// ä½¿ç”¨æŒ‡å—ç»„ä»¶
import { defineComponent, h } from 'vue'
import { ElCard, ElDescriptions, ElDescriptionsItem, ElAlert, ElDivider } from 'element-plus'

const UsageGuide = defineComponent({
  name: 'UsageGuide',
  setup() {
    return () =>
      h('div', { class: 'usage-guide' }, [
        h(
          ElCard,
          { class: 'guide-card' },
          {
            default: () => [
              h('h2', 'ğŸ“š å·¥å…·å‡½æ•°åº“ä½¿ç”¨æŒ‡å—'),
              h(ElDivider),

              // å¿«é€Ÿå¼€å§‹
              h('h3', 'ğŸš€ å¿«é€Ÿå¼€å§‹'),
              h(
                ElAlert,
                {
                  type: 'success',
                  title: 'å¯¼å…¥æ–¹å¼',
                  closable: false
                },
                {
                  default: () =>
                    h('pre', { style: { marginTop: '8px' } }, [
                      h(
                        'code',
                        "import { formatDate, isEmail, debounce, storage } from '@/utils'"
                      )
                    ])
                }
              ),

              h(ElDivider),

              // æ¨¡å—è¯´æ˜
              h('h3', 'ğŸ“¦ æ¨¡å—è¯´æ˜'),
              h(
                ElDescriptions,
                { column: 1, border: true },
                {
                  default: () => [
                    h(
                      ElDescriptionsItem,
                      { label: 'format.ts' },
                      { default: () => 'æ ¼å¼åŒ–å·¥å…·ï¼šæ—¥æœŸã€æ•°å­—ã€è´§å¸ã€æ–‡ä»¶å¤§å°ã€éšç§ä¿¡æ¯ç­‰' }
                    ),
                    h(
                      ElDescriptionsItem,
                      { label: 'validation.ts' },
                      {
                        default: () =>
                          'éªŒè¯å·¥å…·ï¼šé‚®ç®±ã€æ‰‹æœºã€èº«ä»½è¯ã€URLéªŒè¯ï¼Œä»¥åŠElement Plusè¡¨å•è§„åˆ™'
                      }
                    ),
                    h(
                      ElDescriptionsItem,
                      { label: 'constants.ts' },
                      { default: () => 'å¸¸é‡å®šä¹‰ï¼šHTTPçŠ¶æ€ç ã€æ–‡ä»¶ç±»å‹ã€ä¸šåŠ¡çŠ¶æ€ã€UIé…ç½®ç­‰' }
                    ),
                    h(
                      ElDescriptionsItem,
                      { label: 'helpers.ts' },
                      {
                        default: () =>
                          'è¾…åŠ©å‡½æ•°ï¼šé˜²æŠ–èŠ‚æµã€æ·±æ‹·è´ã€æ•°ç»„å¤„ç†ã€æ ‘å½¢æ•°æ®ã€æœ¬åœ°å­˜å‚¨ç­‰'
                      }
                    )
                  ]
                }
              ),

              h(ElDivider),

              // ç»„åˆå¼å‡½æ•°
              h('h3', 'ğŸ”Œ ç»„åˆå¼å‡½æ•° (Composables)'),
              h(
                ElDescriptions,
                { column: 1, border: true },
                {
                  default: () => [
                    h(
                      ElDescriptionsItem,
                      { label: 'useNotification' },
                      { default: () => 'æ¶ˆæ¯é€šçŸ¥ï¼šsuccess, warning, error, info, confirm' }
                    ),
                    h(
                      ElDescriptionsItem,
                      { label: 'useAsync' },
                      { default: () => 'å¼‚æ­¥å¤„ç†ï¼šloadingçŠ¶æ€ã€é”™è¯¯å¤„ç†ã€è¯·æ±‚å–æ¶ˆ' }
                    ),
                    h(
                      ElDescriptionsItem,
                      { label: 'useFileUpload' },
                      { default: () => 'æ–‡ä»¶ä¸Šä¼ ï¼šæ–‡ä»¶é€‰æ‹©ã€ä¸Šä¼ è¿›åº¦ã€æ‹–æ‹½ä¸Šä¼ ' }
                    ),
                    h(
                      ElDescriptionsItem,
                      { label: 'useForm' },
                      { default: () => 'è¡¨å•å¤„ç†ï¼šè¡¨å•éªŒè¯ã€é”™è¯¯æç¤º' }
                    ),
                    h(
                      ElDescriptionsItem,
                      { label: 'useSSE' },
                      { default: () => 'SSEæµå¤„ç†ï¼šå®æ—¶æ•°æ®æµã€è‡ªåŠ¨é‡è¿' }
                    )
                  ]
                }
              ),

              h(ElDivider),

              // æœ€ä½³å®è·µ
              h('h3', 'ğŸ’¡ æœ€ä½³å®è·µ'),
              h('ul', { class: 'best-practices' }, [
                h('li', 'âœ… ç»Ÿä¸€ä½¿ç”¨å·¥å…·å‡½æ•°ï¼Œé¿å…é‡å¤ç¼–å†™ç›¸åŒé€»è¾‘'),
                h('li', 'âœ… åœ¨ç»„ä»¶ä¸­ä¼˜å…ˆä½¿ç”¨ç»„åˆå¼å‡½æ•°å°è£…å¯å¤ç”¨é€»è¾‘'),
                h('li', 'âœ… ä½¿ç”¨TypeScriptç±»å‹æç¤ºï¼Œæé«˜å¼€å‘æ•ˆç‡'),
                h('li', 'âœ… å‚è€ƒæœ¬æ¼”ç¤ºé¡µé¢äº†è§£å„å‡½æ•°çš„å…·ä½“ç”¨æ³•'),
                h('li', 'âœ… é‡åˆ°æ–°éœ€æ±‚æ—¶ï¼Œå…ˆæ£€æŸ¥æ˜¯å¦å·²æœ‰ç›¸åº”å·¥å…·å‡½æ•°')
              ]),

              h(ElDivider),

              // ä»£ç ç¤ºä¾‹
              h('h3', 'ğŸ“ ä»£ç ç¤ºä¾‹'),
              h(
                'div',
                { class: 'code-examples' },
                h('pre', { class: 'code-block' }, [
                  h('code', [
                    '// 1. æ ¼å¼åŒ–æ—¥æœŸ\n',
                    "const dateStr = formatDate(new Date(), 'YYYY-MM-DD HH:mm:ss')\n\n",
                    '// 2. éªŒè¯é‚®ç®±\n',
                    "if (isEmail(email)) { /* ... */ }\n\n",
                    '// 3. é˜²æŠ–æœç´¢\n',
                    'const debouncedSearch = debounce(search, 500)\n\n',
                    '// 4. æœ¬åœ°å­˜å‚¨\n',
                    "storage.set('userInfo', { name: 'Alice' })\n",
                    "const userInfo = storage.get('userInfo')\n\n",
                    '// 5. ä½¿ç”¨ç»„åˆå¼å‡½æ•°\n',
                    'const { success } = useNotification()\n',
                    "success('æ“ä½œæˆåŠŸï¼')"
                  ])
                ])
              ),

              h(ElDivider),

              // æ€§èƒ½ä¼˜åŒ–å»ºè®®
              h('h3', 'âš¡ æ€§èƒ½ä¼˜åŒ–å»ºè®®'),
              h(
                ElAlert,
                { type: 'warning', title: 'æ³¨æ„äº‹é¡¹', closable: false },
                {
                  default: () =>
                    h('ul', { style: { marginTop: '8px', marginBottom: 0 } }, [
                      h('li', 'é˜²æŠ–/èŠ‚æµå‡½æ•°å»ºè®®åœ¨ç»„ä»¶å¤–éƒ¨å®šä¹‰ï¼Œé¿å…é‡å¤åˆ›å»º'),
                      h('li', 'deepCloneé€‚ç”¨äºå°å¯¹è±¡ï¼Œå¤§æ•°æ®é‡å»ºè®®ä½¿ç”¨å…¶ä»–æ–¹æ¡ˆ'),
                      h('li', 'æœ¬åœ°å­˜å‚¨æœ‰å®¹é‡é™åˆ¶ï¼ˆé€šå¸¸5-10MBï¼‰ï¼Œæ³¨æ„æ•°æ®å¤§å°'),
                      h('li', 'å¼‚æ­¥æ“ä½œè®°å¾—å¤„ç†é”™è¯¯å’ŒloadingçŠ¶æ€')
                    ])
                }
              )
            ]
          }
        )
      ])
  }
})

export default {
  components: { UsageGuide }
}
</script>

<style scoped lang="scss">
.demo-container {
  padding: 20px;
  max-width: 1400px;
  margin: 0 auto;
}

.header-card {
  margin-bottom: 20px;

  .header-content {
    display: flex;
    justify-content: space-between;
    align-items: center;

    h1 {
      margin: 0 0 8px 0;
      font-size: 28px;
      color: #303133;
    }

    .subtitle {
      margin: 0;
      font-size: 14px;
      color: #909399;
    }
  }
}

.demo-tabs-card {
  margin-bottom: 20px;
}

.tab-label {
  display: flex;
  align-items: center;
  gap: 6px;
  font-size: 14px;
}

.footer-card {
  .footer-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-size: 14px;
    color: #606266;

    > div {
      display: flex;
      align-items: center;
      gap: 8px;
    }
  }
}

// ä½¿ç”¨æŒ‡å—æ ·å¼
:deep(.usage-guide) {
  .guide-card {
    h2 {
      font-size: 24px;
      color: #303133;
      margin-top: 0;
    }

    h3 {
      font-size: 18px;
      color: #409eff;
      margin-top: 24px;
      margin-bottom: 16px;
    }

    .best-practices {
      list-style: none;
      padding: 0;
      margin: 0;

      li {
        padding: 8px 0;
        color: #606266;
        border-bottom: 1px solid #f0f0f0;

        &:last-child {
          border-bottom: none;
        }
      }
    }

    .code-examples {
      .code-block {
        background: #f5f7fa;
        padding: 16px;
        border-radius: 8px;
        overflow-x: auto;

        code {
          font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
          font-size: 13px;
          line-height: 1.6;
          color: #303133;
        }
      }
    }
  }
}

:deep(.el-tabs__content) {
  padding: 0;
}

:deep(.el-tabs--border-card) {
  border: none;
  box-shadow: none;
}

:deep(.el-tabs__header) {
  background-color: #f5f7fa;
  border-bottom: 2px solid #e4e7ed;
}
</style>
