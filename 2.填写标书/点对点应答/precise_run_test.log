2025-09-06 10:47:59,010 - INFO - 🚀 开始测试精确run修改法
2025-09-06 10:47:59,010 - INFO - ================================================================================
2025-09-06 10:47:59,035 - INFO - 创建复杂测试文档: precise_run_test_input.docx
2025-09-06 10:47:59,036 - INFO - 
============================================================
2025-09-06 10:47:59,036 - INFO - 📊 文档结构分析: 原始文档结构
2025-09-06 10:47:59,036 - INFO - ============================================================
2025-09-06 10:47:59,036 - INFO - 
🔍 处理前文档: precise_run_test_input.docx
2025-09-06 10:47:59,043 - INFO -   段落 #1: 测试项目：（项目名称） 的处理效果
2025-09-06 10:47:59,043 - INFO -     Run数量: 3
2025-09-06 10:47:59,043 - INFO -       Run 1: '测试项目：' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,043 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,043 - INFO -       Run 3: ' 的处理效果' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,044 - INFO -   段落 #2: 竞争性磋商公告（采购编号），签字代表授权
2025-09-06 10:47:59,044 - INFO -     Run数量: 5
2025-09-06 10:47:59,044 - INFO -       Run 1: '竞争性磋商公告' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,044 - INFO -       Run 2: '（' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,044 - INFO -       Run 3: '采购编号' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,044 - INFO -       Run 4: '）' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,044 - INFO -       Run 5: '，签字代表授权' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,045 - INFO -   段落 #3: 根据贵方为（项目名称）项目，供应商（供应商名称）提交文件
2025-09-06 10:47:59,045 - INFO -     Run数量: 7
2025-09-06 10:47:59,045 - INFO -       Run 1: '根据贵方为' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,045 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,045 - INFO -       Run 3: '项目，供应商' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,045 - INFO -       Run 4: '（' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,045 - INFO -       Run 5: '供应商名称' [斜体=True, 粗体=True, 下划线=None]
2025-09-06 10:47:59,045 - INFO -       Run 6: '）' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,045 - INFO -       Run 7: '提交文件' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,045 - INFO - 
🔍 处理后文档: precise_run_test_input.docx
2025-09-06 10:47:59,053 - INFO -   段落 #1: 测试项目：（项目名称） 的处理效果
2025-09-06 10:47:59,053 - INFO -     Run数量: 3
2025-09-06 10:47:59,053 - INFO -       Run 1: '测试项目：' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,053 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,053 - INFO -       Run 3: ' 的处理效果' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,053 - INFO -   段落 #2: 竞争性磋商公告（采购编号），签字代表授权
2025-09-06 10:47:59,053 - INFO -     Run数量: 5
2025-09-06 10:47:59,053 - INFO -       Run 1: '竞争性磋商公告' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,053 - INFO -       Run 2: '（' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,053 - INFO -       Run 3: '采购编号' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,054 - INFO -       Run 4: '）' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,054 - INFO -       Run 5: '，签字代表授权' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,054 - INFO -   段落 #3: 根据贵方为（项目名称）项目，供应商（供应商名称）提交文件
2025-09-06 10:47:59,054 - INFO -     Run数量: 7
2025-09-06 10:47:59,054 - INFO -       Run 1: '根据贵方为' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,054 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,054 - INFO -       Run 3: '项目，供应商' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,054 - INFO -       Run 4: '（' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,054 - INFO -       Run 5: '供应商名称' [斜体=True, 粗体=True, 下划线=None]
2025-09-06 10:47:59,055 - INFO -       Run 6: '）' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,055 - INFO -       Run 7: '提交文件' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,060 - INFO - 开始处理商务应答文档
2025-09-06 10:47:59,061 - INFO - 输入文件: precise_run_test_input.docx
2025-09-06 10:47:59,061 - INFO - 输出文件: precise_run_test_output.docx
2025-09-06 10:47:59,061 - INFO - 公司名称: N/A
2025-09-06 10:47:59,061 - INFO - 项目名称: 智能办公系统采购项目
2025-09-06 10:47:59,061 - INFO - 招标编号: 64525343
2025-09-06 10:47:59,061 - INFO - 第1步：处理投标人名称
2025-09-06 10:47:59,061 - INFO - 开始MCP投标人名称处理: precise_run_test_input.docx
2025-09-06 10:47:59,061 - INFO - 使用公司名称: 
2025-09-06 10:47:59,068 - INFO - 处理段落 #0: '测试项目：（项目名称） 的处理效果...'
2025-09-06 10:47:59,068 - INFO - 匹配到规则 #29: 括号内容替换 - 项目名称
2025-09-06 10:47:59,068 - INFO - 匹配文本: '（项目名称）'
2025-09-06 10:47:59,068 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:47:59,069 - INFO - 处理段落 #1: '竞争性磋商公告（采购编号），签字代表授权...'
2025-09-06 10:47:59,069 - INFO - 匹配到规则 #31: 括号内容替换 - 采购编号
2025-09-06 10:47:59,069 - INFO - 匹配文本: '（采购编号）'
2025-09-06 10:47:59,069 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:47:59,070 - INFO - 处理段落 #2: '根据贵方为（项目名称）项目，供应商（供应商名称）提交文件...'
2025-09-06 10:47:59,070 - INFO - 匹配到规则 #8: 括号内容替换 - 供应商名称
2025-09-06 10:47:59,070 - INFO - 匹配文本: '（供应商名称）'
2025-09-06 10:47:59,070 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:47:59,070 - INFO - 匹配到规则 #29: 括号内容替换 - 项目名称
2025-09-06 10:47:59,070 - INFO - 匹配文本: '（项目名称）'
2025-09-06 10:47:59,070 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:47:59,070 - INFO - 匹配到规则 #30: 上下文中的项目名称替换 - 为（xxx）项目格式
2025-09-06 10:47:59,070 - INFO - 匹配文本: '为（项目名称）项目'
2025-09-06 10:47:59,070 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:47:59,088 - INFO - MCP投标人名称处理完成，保存到: precise_run_test_output.docx
2025-09-06 10:47:59,088 - INFO - 处理统计: 总计0次, 替换内容0次, 空格填写0次
2025-09-06 10:47:59,088 - INFO - 第2步：处理其他公司信息字段
2025-09-06 10:47:59,096 - INFO - 开始处理公司信息字段，文档共有 3 个段落
2025-09-06 10:47:59,096 - INFO - 从配置文件读取tenderer: 中信银行股份有限公司
2025-09-06 10:47:59,097 - INFO - 从配置文件读取bidding_method: 竞争性磋商
2025-09-06 10:47:59,097 - INFO - 配置文件中agency字段为空或无效: 未提供
2025-09-06 10:47:59,111 - INFO - 公司信息字段处理完成，共处理 0 个字段
2025-09-06 10:47:59,111 - INFO - 
================================================================================
2025-09-06 10:47:59,111 - INFO - 📈 处理结果分析
2025-09-06 10:47:59,111 - INFO - ================================================================================
2025-09-06 10:47:59,111 - INFO - 处理成功: True
2025-09-06 10:47:59,111 - INFO - 处理统计: {'total_replacements': 0, 'replace_content_count': 0, 'fill_space_count': 0, 'patterns_found': [], 'info_fields_processed': 0}
2025-09-06 10:47:59,111 - INFO - 
============================================================
2025-09-06 10:47:59,111 - INFO - 📊 文档结构分析: 处理前后对比
2025-09-06 10:47:59,111 - INFO - ============================================================
2025-09-06 10:47:59,111 - INFO - 
🔍 处理前文档: precise_run_test_input.docx
2025-09-06 10:47:59,118 - INFO -   段落 #1: 测试项目：（项目名称） 的处理效果
2025-09-06 10:47:59,118 - INFO -     Run数量: 3
2025-09-06 10:47:59,118 - INFO -       Run 1: '测试项目：' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,119 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,119 - INFO -       Run 3: ' 的处理效果' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,119 - INFO -   段落 #2: 竞争性磋商公告（采购编号），签字代表授权
2025-09-06 10:47:59,119 - INFO -     Run数量: 5
2025-09-06 10:47:59,119 - INFO -       Run 1: '竞争性磋商公告' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,119 - INFO -       Run 2: '（' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,119 - INFO -       Run 3: '采购编号' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,119 - INFO -       Run 4: '）' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,120 - INFO -       Run 5: '，签字代表授权' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,120 - INFO -   段落 #3: 根据贵方为（项目名称）项目，供应商（供应商名称）提交文件
2025-09-06 10:47:59,120 - INFO -     Run数量: 7
2025-09-06 10:47:59,120 - INFO -       Run 1: '根据贵方为' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,120 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,120 - INFO -       Run 3: '项目，供应商' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,121 - INFO -       Run 4: '（' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,121 - INFO -       Run 5: '供应商名称' [斜体=True, 粗体=True, 下划线=None]
2025-09-06 10:47:59,121 - INFO -       Run 6: '）' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,121 - INFO -       Run 7: '提交文件' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,121 - INFO - 
🔍 处理后文档: precise_run_test_output.docx
2025-09-06 10:47:59,128 - INFO -   段落 #1: 测试项目：（项目名称） 的处理效果
2025-09-06 10:47:59,128 - INFO -     Run数量: 3
2025-09-06 10:47:59,128 - INFO -       Run 1: '测试项目：' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,128 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,128 - INFO -       Run 3: ' 的处理效果' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,129 - INFO -   段落 #2: 竞争性磋商公告（采购编号），签字代表授权
2025-09-06 10:47:59,129 - INFO -     Run数量: 5
2025-09-06 10:47:59,129 - INFO -       Run 1: '竞争性磋商公告' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,129 - INFO -       Run 2: '（' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,129 - INFO -       Run 3: '采购编号' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,129 - INFO -       Run 4: '）' [斜体=True, 粗体=True, 下划线=True]
2025-09-06 10:47:59,129 - INFO -       Run 5: '，签字代表授权' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,129 - INFO -   段落 #3: 根据贵方为（项目名称）项目，供应商（供应商名称）提交文件
2025-09-06 10:47:59,129 - INFO -     Run数量: 7
2025-09-06 10:47:59,130 - INFO -       Run 1: '根据贵方为' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,130 - INFO -       Run 2: '（项目名称）' [斜体=True, 粗体=None, 下划线=True]
2025-09-06 10:47:59,130 - INFO -       Run 3: '项目，供应商' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,130 - INFO -       Run 4: '（' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,130 - INFO -       Run 5: '供应商名称' [斜体=True, 粗体=True, 下划线=None]
2025-09-06 10:47:59,130 - INFO -       Run 6: '）' [斜体=True, 粗体=None, 下划线=None]
2025-09-06 10:47:59,130 - INFO -       Run 7: '提交文件' [斜体=None, 粗体=None, 下划线=None]
2025-09-06 10:47:59,130 - INFO - 
🎯 精确性验证:
2025-09-06 10:47:59,130 - INFO - ==================================================
2025-09-06 10:47:59,130 - INFO - 检查点:
2025-09-06 10:47:59,130 - INFO - 1. ✅ 项目名称替换是否成功且保持单run
2025-09-06 10:47:59,130 - INFO - 2. ✅ 采购编号替换是否成功且最小化run影响
2025-09-06 10:47:59,130 - INFO - 3. ✅ 其他格式是否完全保持不变
2025-09-06 10:47:59,130 - INFO - 4. ✅ 周围文字格式是否未受影响
2025-09-06 10:47:59,130 - INFO - 
🎉 精确run修改法测试完成！
2025-09-06 10:47:59,130 - INFO - 查看输出文档验证格式保持效果
