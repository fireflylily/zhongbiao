2025-09-06 11:03:31,312 - INFO - 🔧 采购编号格式保持问题修复分析
2025-09-06 11:03:31,313 - INFO - ================================================================================
2025-09-06 11:03:31,313 - INFO - 
================================================================================
2025-09-06 11:03:31,313 - INFO - 💡 采购编号格式保持改进方案
2025-09-06 11:03:31,313 - INFO - ================================================================================
2025-09-06 11:03:31,313 - INFO - 🔍 分析原始文档中的采购编号段落格式
2025-09-06 11:03:31,313 - INFO - ================================================================================
2025-09-06 11:03:31,317 - INFO - 📋 找到原始采购编号段落 #11:
2025-09-06 11:03:31,318 - INFO -   文本: 根据贵方购采购货物及服务的竞争性磋商公告（采购编号），签字代表（姓名、职务）经正式授权并代表供应交下述文件正本一份及副本       份：
2025-09-06 11:03:31,318 - INFO -   Run数量: 14
2025-09-06 11:03:31,318 - INFO -     Run 1: '根据贵方'
2025-09-06 11:03:31,318 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,318 - INFO -     Run 2: '购'
2025-09-06 11:03:31,318 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,318 - INFO -     Run 3: '采购货物及服务的'
2025-09-06 11:03:31,318 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,319 - INFO -     Run 4: '竞争性磋商公告'
2025-09-06 11:03:31,319 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,319 - INFO -     Run 5: '（' 🔗 左括号
2025-09-06 11:03:31,319 - INFO -         格式: 粗体=False, 斜体=True, 下划线=True
2025-09-06 11:03:31,319 - INFO -     Run 6: '采购'
2025-09-06 11:03:31,319 - INFO -         格式: 粗体=False, 斜体=True, 下划线=True
2025-09-06 11:03:31,319 - INFO -     Run 7: '编号）' 🔗 右括号
2025-09-06 11:03:31,319 - INFO -         格式: 粗体=False, 斜体=True, 下划线=True
2025-09-06 11:03:31,319 - INFO -     Run 8: '，签字代表'
2025-09-06 11:03:31,319 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,320 - INFO -     Run 9: '（姓名、职务'
2025-09-06 11:03:31,320 - INFO -         格式: 粗体=False, 斜体=True, 下划线=True
2025-09-06 11:03:31,320 - INFO -     Run 10: '）经正式授权并代表'
2025-09-06 11:03:31,320 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,320 - INFO -     Run 11: '供应'
2025-09-06 11:03:31,320 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,320 - INFO -     Run 12: '交下述文件正本一份及副本'
2025-09-06 11:03:31,320 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,320 - INFO -     Run 13: '       '
2025-09-06 11:03:31,320 - INFO -         格式: 粗体=False, 斜体=False, 下划线=True
2025-09-06 11:03:31,321 - INFO -     Run 14: '份：'
2025-09-06 11:03:31,321 - INFO -         格式: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,321 - INFO - 
  📊 格式分组:
2025-09-06 11:03:31,321 - INFO -     格式(粗体=False, 斜体=False, 下划线=False): 9个run
2025-09-06 11:03:31,321 - INFO -       Run 1: '根据贵方'
2025-09-06 11:03:31,321 - INFO -       Run 2: '购'
2025-09-06 11:03:31,321 - INFO -       Run 3: '采购货物及服务的'
2025-09-06 11:03:31,321 - INFO -       Run 4: '竞争性磋商公告'
2025-09-06 11:03:31,321 - INFO -       Run 8: '，签字代表'
2025-09-06 11:03:31,321 - INFO -       Run 10: '）经正式授权并代表'
2025-09-06 11:03:31,321 - INFO -       Run 11: '供应'
2025-09-06 11:03:31,321 - INFO -       Run 12: '交下述文件正本一份及副本'
2025-09-06 11:03:31,321 - INFO -       Run 14: '份：'
2025-09-06 11:03:31,321 - INFO -     格式(粗体=False, 斜体=True, 下划线=True): 4个run
2025-09-06 11:03:31,321 - INFO -       Run 5: '（'
2025-09-06 11:03:31,321 - INFO -       Run 6: '采购'
2025-09-06 11:03:31,321 - INFO -       Run 7: '编号）'
2025-09-06 11:03:31,321 - INFO -       Run 9: '（姓名、职务'
2025-09-06 11:03:31,321 - INFO -     格式(粗体=False, 斜体=False, 下划线=True): 1个run
2025-09-06 11:03:31,321 - INFO -       Run 13: '       '
2025-09-06 11:03:31,321 - INFO - 
🎯 当前问题:
2025-09-06 11:03:31,321 - INFO - 1. 采购编号跨多个run，需要跨run处理
2025-09-06 11:03:31,321 - INFO - 2. 精确跨run替换将所有run合并为1个run
2025-09-06 11:03:31,321 - INFO - 3. 虽然技术上格式一致，但丢失了原有的格式层次
2025-09-06 11:03:31,321 - INFO - 
🔧 改进方案:
2025-09-06 11:03:31,321 - INFO - 1. 增强精确跨run替换的格式智能性
2025-09-06 11:03:31,321 - INFO - 2. 在合并run时，保持更细粒度的格式区分
2025-09-06 11:03:31,321 - INFO - 3. 特别关注括号、关键词等的格式保持
2025-09-06 11:03:31,321 - INFO - 
📋 原始文档格式层次丰富，需要特殊处理:
2025-09-06 11:03:31,321 - INFO -   格式组 1: 粗体=False, 斜体=False, 下划线=False
2025-09-06 11:03:31,321 - INFO -     涉及 9 个run
2025-09-06 11:03:31,321 - INFO -   格式组 2: 粗体=False, 斜体=True, 下划线=True
2025-09-06 11:03:31,321 - INFO -     涉及 4 个run
2025-09-06 11:03:31,321 - INFO -   格式组 3: 粗体=False, 斜体=False, 下划线=True
2025-09-06 11:03:31,321 - INFO -     涉及 1 个run
2025-09-06 11:03:31,321 - INFO - 
🎯 建议的优化策略:
2025-09-06 11:03:31,321 - INFO - 1. 在_precise_cross_run_replace方法中增强格式保持逻辑
2025-09-06 11:03:31,321 - INFO - 2. 避免将所有内容合并到单一run，保持原有的格式边界
2025-09-06 11:03:31,321 - INFO - 3. 特别处理括号和关键词的格式
2025-09-06 11:03:31,321 - INFO - 
🎉 分析完成！基于分析结果来优化精确跨run替换逻辑
