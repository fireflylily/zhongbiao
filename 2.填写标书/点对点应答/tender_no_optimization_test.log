2025-09-06 10:09:36,604 - INFO - ============================================================
2025-09-06 10:09:36,604 - INFO - 开始测试项目编号处理优化
2025-09-06 10:09:36,605 - INFO - ============================================================
2025-09-06 10:09:36,632 - INFO - 创建测试文档: test_tender_no_optimization_input.docx
2025-09-06 10:09:36,642 - INFO - 测试配置:
2025-09-06 10:09:36,642 - INFO -   公司名称: 测试科技有限公司
2025-09-06 10:09:36,642 - INFO -   项目名称: 智能办公系统采购项目
2025-09-06 10:09:36,642 - INFO -   项目编号: 64525343
2025-09-06 10:09:36,642 - INFO - 开始处理商务应答文档
2025-09-06 10:09:36,642 - INFO - 输入文件: test_tender_no_optimization_input.docx
2025-09-06 10:09:36,642 - INFO - 输出文件: test_tender_no_optimization_output.docx
2025-09-06 10:09:36,642 - INFO - 公司名称: N/A
2025-09-06 10:09:36,642 - INFO - 项目名称: 智能办公系统采购项目
2025-09-06 10:09:36,642 - INFO - 招标编号: 64525343
2025-09-06 10:09:36,642 - INFO - 第1步：处理投标人名称
2025-09-06 10:09:36,642 - INFO - 开始MCP投标人名称处理: test_tender_no_optimization_input.docx
2025-09-06 10:09:36,642 - INFO - 使用公司名称: 
2025-09-06 10:09:36,650 - INFO - 处理段落 #0: '项目编号：（采购编号） 测试内容...'
2025-09-06 10:09:36,650 - INFO - 匹配到规则 #31: 括号内容替换 - 采购编号
2025-09-06 10:09:36,650 - INFO - 匹配文本: '（采购编号）'
2025-09-06 10:09:36,650 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:36,650 - INFO - 处理段落 #1: '项目编号：（采购编号） 测试内容...'
2025-09-06 10:09:36,651 - INFO - 匹配到规则 #31: 括号内容替换 - 采购编号
2025-09-06 10:09:36,651 - INFO - 匹配文本: '（采购编号）'
2025-09-06 10:09:36,651 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:36,651 - INFO - 处理段落 #2: '供应商：（供应商名称） 编号：（采购编号） 完成。...'
2025-09-06 10:09:36,651 - INFO - 匹配到规则 #8: 括号内容替换 - 供应商名称
2025-09-06 10:09:36,651 - INFO - 匹配文本: '（供应商名称）'
2025-09-06 10:09:36,651 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:36,651 - INFO - 匹配到规则 #31: 括号内容替换 - 采购编号
2025-09-06 10:09:36,651 - INFO - 匹配文本: '（采购编号）'
2025-09-06 10:09:36,651 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:36,664 - INFO - MCP投标人名称处理完成，保存到: test_tender_no_optimization_output.docx
2025-09-06 10:09:36,664 - INFO - 处理统计: 总计0次, 替换内容0次, 空格填写0次
2025-09-06 10:09:36,664 - INFO - 第2步：处理其他公司信息字段
2025-09-06 10:09:36,671 - INFO - 开始处理公司信息字段，文档共有 3 个段落
2025-09-06 10:09:36,671 - INFO - 从配置文件读取tenderer: 中信银行股份有限公司
2025-09-06 10:09:36,672 - INFO - 从配置文件读取bidding_method: 竞争性磋商
2025-09-06 10:09:36,672 - INFO - 配置文件中agency字段为空或无效: 未提供
2025-09-06 10:09:36,686 - INFO - 公司信息字段处理完成，共处理 0 个字段
2025-09-06 10:09:36,686 - INFO - ============================================================
2025-09-06 10:09:36,686 - INFO - 处理结果:
2025-09-06 10:09:36,687 - INFO -   成功状态: True
2025-09-06 10:09:36,687 - INFO -   处理统计: {'total_replacements': 0, 'replace_content_count': 0, 'fill_space_count': 0, 'patterns_found': [], 'info_fields_processed': 0}
2025-09-06 10:09:36,694 - INFO - 
分析输出文档: test_tender_no_optimization_output.docx
2025-09-06 10:09:36,695 - INFO -   段落 1: 项目编号：（采购编号） 测试内容
2025-09-06 10:09:36,695 - INFO -     Run数量: 1
2025-09-06 10:09:36,695 - INFO -       Run 1: '项目编号：（采购编号） 测试内容'
2025-09-06 10:09:36,695 - INFO -   段落 2: 项目编号：（采购编号） 测试内容
2025-09-06 10:09:36,695 - INFO -     Run数量: 3
2025-09-06 10:09:36,695 - INFO -       Run 1: '项目编号：（'
2025-09-06 10:09:36,695 - INFO -       Run 2: '采购编号'
2025-09-06 10:09:36,695 - INFO -       Run 3: '） 测试内容'
2025-09-06 10:09:36,695 - INFO -   段落 3: 供应商：（供应商名称） 编号：（采购编号） 完成。
2025-09-06 10:09:36,695 - INFO -     Run数量: 1
2025-09-06 10:09:36,696 - INFO -       Run 1: '供应商：（供应商名称） 编号：（采购编号） 完成。'
2025-09-06 10:09:36,696 - INFO - ============================================================
2025-09-06 10:09:36,696 - INFO - 测试完成！
2025-09-06 10:09:36,696 - INFO - 请查看输出文档和日志，验证:
2025-09-06 10:09:36,696 - INFO -   1. 项目编号是否正确填写
2025-09-06 10:09:36,696 - INFO -   2. 周围文字格式是否保持不变
2025-09-06 10:09:36,696 - INFO -   3. 日志中是否优先使用单run替换
2025-09-06 10:09:36,696 - INFO - ============================================================
2025-09-06 10:09:54,996 - INFO - ============================================================
2025-09-06 10:09:54,997 - INFO - 开始测试项目编号处理优化
2025-09-06 10:09:54,997 - INFO - ============================================================
2025-09-06 10:09:55,020 - INFO - 创建测试文档: test_tender_no_optimization_input.docx
2025-09-06 10:09:55,029 - INFO - 测试配置:
2025-09-06 10:09:55,029 - INFO -   公司名称: 测试科技有限公司
2025-09-06 10:09:55,029 - INFO -   项目名称: 智能办公系统采购项目
2025-09-06 10:09:55,029 - INFO -   项目编号: 64525343
2025-09-06 10:09:55,029 - INFO - 开始处理商务应答文档
2025-09-06 10:09:55,029 - INFO - 输入文件: test_tender_no_optimization_input.docx
2025-09-06 10:09:55,029 - INFO - 输出文件: test_tender_no_optimization_output.docx
2025-09-06 10:09:55,029 - INFO - 公司名称: N/A
2025-09-06 10:09:55,029 - INFO - 项目名称: 智能办公系统采购项目
2025-09-06 10:09:55,029 - INFO - 招标编号: 64525343
2025-09-06 10:09:55,029 - INFO - 第1步：处理投标人名称
2025-09-06 10:09:55,029 - INFO - 开始MCP投标人名称处理: test_tender_no_optimization_input.docx
2025-09-06 10:09:55,029 - INFO - 使用公司名称: 
2025-09-06 10:09:55,037 - INFO - 处理段落 #0: '项目编号：（采购编号） 测试内容...'
2025-09-06 10:09:55,037 - INFO - 匹配到规则 #31: 括号内容替换 - 采购编号
2025-09-06 10:09:55,037 - INFO - 匹配文本: '（采购编号）'
2025-09-06 10:09:55,037 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:55,037 - INFO - 处理段落 #1: '项目编号：（采购编号） 测试内容...'
2025-09-06 10:09:55,038 - INFO - 匹配到规则 #31: 括号内容替换 - 采购编号
2025-09-06 10:09:55,038 - INFO - 匹配文本: '（采购编号）'
2025-09-06 10:09:55,038 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:55,038 - INFO - 处理段落 #2: '供应商：（供应商名称） 编号：（采购编号） 完成。...'
2025-09-06 10:09:55,038 - INFO - 匹配到规则 #8: 括号内容替换 - 供应商名称
2025-09-06 10:09:55,038 - INFO - 匹配文本: '（供应商名称）'
2025-09-06 10:09:55,038 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:55,038 - INFO - 匹配到规则 #31: 括号内容替换 - 采购编号
2025-09-06 10:09:55,038 - INFO - 匹配文本: '（采购编号）'
2025-09-06 10:09:55,038 - INFO - 段落已包含公司名称，跳过处理
2025-09-06 10:09:55,051 - INFO - MCP投标人名称处理完成，保存到: test_tender_no_optimization_output.docx
2025-09-06 10:09:55,051 - INFO - 处理统计: 总计0次, 替换内容0次, 空格填写0次
2025-09-06 10:09:55,051 - INFO - 第2步：处理其他公司信息字段
2025-09-06 10:09:55,058 - INFO - 开始处理公司信息字段，文档共有 3 个段落
2025-09-06 10:09:55,058 - INFO - 从配置文件读取tenderer: 中信银行股份有限公司
2025-09-06 10:09:55,059 - INFO - 从配置文件读取bidding_method: 竞争性磋商
2025-09-06 10:09:55,059 - INFO - 配置文件中agency字段为空或无效: 未提供
2025-09-06 10:09:55,073 - INFO - 公司信息字段处理完成，共处理 0 个字段
2025-09-06 10:09:55,073 - INFO - 使用直接方法测试项目编号处理...
2025-09-06 10:09:55,080 - INFO - 测试段落 1: 项目编号：（采购编号） 测试内容
2025-09-06 10:09:55,080 - INFO -   Run结构: ['项目编号：（采购编号） 测试内容']
2025-09-06 10:09:55,081 - INFO - 执行项目编号括号内容替换: 测试-采购编号处理
2025-09-06 10:09:55,081 - INFO - 优先尝试单run替换: '（采购编号）' -> '（64525343）'
2025-09-06 10:09:55,081 - INFO - ✅ 项目编号单run替换成功: '（采购编号）' -> '（64525343）'
2025-09-06 10:09:55,081 - INFO -   处理结果: True
2025-09-06 10:09:55,081 - INFO -   处理后文本: 项目编号：（64525343） 测试内容
2025-09-06 10:09:55,081 - INFO -   处理后Run结构: ['项目编号：（64525343） 测试内容']
2025-09-06 10:09:55,081 - INFO - 测试段落 2: 项目编号：（采购编号） 测试内容
2025-09-06 10:09:55,081 - INFO -   Run结构: ['项目编号：（', '采购编号', '） 测试内容']
2025-09-06 10:09:55,081 - INFO - 执行项目编号括号内容替换: 测试-采购编号处理
2025-09-06 10:09:55,081 - INFO - 优先尝试单run替换: '（采购编号）' -> '（64525343）'
2025-09-06 10:09:55,081 - INFO - ⚠️ 单run替换失败，尝试跨run项目编号处理...
2025-09-06 10:09:55,082 - INFO - ⚠️ 项目编号跨run替换完成: '（采购编号）' -> '（64525343）' (可能影响周围格式)
2025-09-06 10:09:55,082 - INFO -   处理结果: True
2025-09-06 10:09:55,082 - INFO -   处理后文本: 项目编号：（64525343） 测试内容
2025-09-06 10:09:55,082 - INFO -   处理后Run结构: ['', '', '', '项目编号：（64525343） 测试内容']
2025-09-06 10:09:55,082 - INFO - 测试段落 3: 供应商：（供应商名称） 编号：（采购编号） 完成。
2025-09-06 10:09:55,083 - INFO -   Run结构: ['供应商：（供应商名称） 编号：（采购编号） 完成。']
2025-09-06 10:09:55,083 - INFO - 执行项目编号括号内容替换: 测试-采购编号处理
2025-09-06 10:09:55,083 - INFO - 优先尝试单run替换: '（采购编号）' -> '（64525343）'
2025-09-06 10:09:55,083 - INFO - ✅ 项目编号单run替换成功: '（采购编号）' -> '（64525343）'
2025-09-06 10:09:55,083 - INFO -   处理结果: True
2025-09-06 10:09:55,083 - INFO -   处理后文本: 供应商：（供应商名称） 编号：（64525343） 完成。
2025-09-06 10:09:55,083 - INFO -   处理后Run结构: ['供应商：（供应商名称） 编号：（64525343） 完成。']
2025-09-06 10:09:55,095 - INFO - 测试处理完成，保存到: test_tender_no_optimization_output.docx
2025-09-06 10:09:55,095 - INFO - ============================================================
2025-09-06 10:09:55,095 - INFO - 处理结果:
2025-09-06 10:09:55,095 - INFO -   成功状态: True
2025-09-06 10:09:55,095 - INFO -   处理统计: {'total_replacements': 0, 'replace_content_count': 0, 'fill_space_count': 0, 'patterns_found': [], 'info_fields_processed': 0}
2025-09-06 10:09:55,102 - INFO - 
分析输出文档: test_tender_no_optimization_output.docx
2025-09-06 10:09:55,102 - INFO -   段落 1: 项目编号：（64525343） 测试内容
2025-09-06 10:09:55,102 - INFO -     Run数量: 1
2025-09-06 10:09:55,102 - INFO -       Run 1: '项目编号：（64525343） 测试内容'
2025-09-06 10:09:55,103 - INFO -   段落 2: 项目编号：（64525343） 测试内容
2025-09-06 10:09:55,103 - INFO -     Run数量: 4
2025-09-06 10:09:55,103 - INFO -       Run 4: '项目编号：（64525343） 测试内容'
2025-09-06 10:09:55,103 - INFO -   段落 3: 供应商：（供应商名称） 编号：（64525343） 完成。
2025-09-06 10:09:55,103 - INFO -     Run数量: 1
2025-09-06 10:09:55,103 - INFO -       Run 1: '供应商：（供应商名称） 编号：（64525343） 完成。'
2025-09-06 10:09:55,103 - INFO - ============================================================
2025-09-06 10:09:55,103 - INFO - 测试完成！
2025-09-06 10:09:55,103 - INFO - 请查看输出文档和日志，验证:
2025-09-06 10:09:55,103 - INFO -   1. 项目编号是否正确填写
2025-09-06 10:09:55,103 - INFO -   2. 周围文字格式是否保持不变
2025-09-06 10:09:55,103 - INFO -   3. 日志中是否优先使用单run替换
2025-09-06 10:09:55,103 - INFO - ============================================================
