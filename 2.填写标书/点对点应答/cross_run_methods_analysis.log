2025-09-06 10:43:49,623 - INFO - 
================================================================================
2025-09-06 10:43:49,623 - INFO - 对比不同跨run处理方法
2025-09-06 10:43:49,623 - INFO - ================================================================================
2025-09-06 10:43:49,651 - INFO - 创建跨run测试文档: cross_run_test.docx
2025-09-06 10:43:49,651 - INFO - 
📊 原始段落状态:
2025-09-06 10:43:49,651 - INFO - 文本: 根据贵方购采购货物及服务的竞争性磋商公告（采购编号），签字代表经正式授权
2025-09-06 10:43:49,651 - INFO - Run数量: 5
2025-09-06 10:43:49,651 - INFO -   Run 1: '根据贵方购采购货物及服务的竞争性磋商公告' [斜体=None, 下划线=None]
2025-09-06 10:43:49,651 - INFO -   Run 2: '（' [斜体=True, 下划线=True]
2025-09-06 10:43:49,651 - INFO -   Run 3: '采购编号' [斜体=True, 下划线=True]
2025-09-06 10:43:49,651 - INFO -   Run 4: '）' [斜体=True, 下划线=True]
2025-09-06 10:43:49,652 - INFO -   Run 5: '，签字代表经正式授权' [斜体=None, 下划线=None]
2025-09-06 10:43:49,659 - INFO - 
🔧 方法1：精确run修改法
2025-09-06 10:43:49,659 - INFO - ========================================
2025-09-06 10:43:49,660 - INFO - 段落完整文本: 根据贵方购采购货物及服务的竞争性磋商公告（采购编号），签字代表经正式授权
2025-09-06 10:43:49,660 - INFO - 要替换: '（采购编号）' -> '（64525343）'
2025-09-06 10:43:49,660 - INFO - 目标文本位置: 20-26
2025-09-06 10:43:49,660 - INFO - 涉及的run数量: 3
2025-09-06 10:43:49,660 - INFO -   Run #2: '（' (重叠: '（')
2025-09-06 10:43:49,660 - INFO -   Run #3: '采购编号' (重叠: '采购编号')
2025-09-06 10:43:49,660 - INFO -   Run #4: '）' (重叠: '）')
2025-09-06 10:43:49,660 - INFO - ⚠️ 涉及多个run，需要精细重构...
2025-09-06 10:43:49,660 - INFO - ✅ 多run精确重构完成: '（64525343）'
2025-09-06 10:43:49,660 - INFO - 
📊 方法1处理后:
2025-09-06 10:43:49,660 - INFO - 文本: 根据贵方购采购货物及服务的竞争性磋商公告（64525343），签字代表经正式授权
2025-09-06 10:43:49,661 - INFO - Run数量: 5
2025-09-06 10:43:49,661 - INFO -   Run 1: '根据贵方购采购货物及服务的竞争性磋商公告' [斜体=None, 下划线=None]
2025-09-06 10:43:49,661 - INFO -   Run 2: '（64525343）' [斜体=True, 下划线=True]
2025-09-06 10:43:49,661 - INFO -   Run 5: '，签字代表经正式授权' [斜体=None, 下划线=None]
2025-09-06 10:43:49,681 - INFO - 
🔧 方法2：当前的安全替换方法
2025-09-06 10:43:49,681 - INFO - ========================================
2025-09-06 10:43:49,682 - INFO - ⚠️ 需要部分文本替换，但当前方法会重构整个段落
2025-09-06 10:43:49,682 - INFO - ⚠️ 整段重构完成，但可能丢失格式信息
2025-09-06 10:43:49,682 - INFO - 
📊 方法2处理后:
2025-09-06 10:43:49,682 - INFO - 文本: 根据贵方购采购货物及服务的竞争性磋商公告（64525343），签字代表经正式授权
2025-09-06 10:43:49,682 - INFO - Run数量: 6
2025-09-06 10:43:49,682 - INFO -   Run 6: '根据贵方购采购货物及服务的竞争性磋商公告（64525343），签字代表经正式授权' [斜体=None, 下划线=None]
2025-09-06 10:43:49,695 - INFO - 
🎯 方法对比总结:
2025-09-06 10:43:49,695 - INFO - ==================================================
2025-09-06 10:43:49,695 - INFO - 方法1 (精确run修改):
2025-09-06 10:43:49,695 - INFO -   ✅ 只修改涉及的run，保留无关run的格式
2025-09-06 10:43:49,695 - INFO -   ✅ 最小化格式影响
2025-09-06 10:43:49,695 - INFO -   ⚠️ 实现复杂度较高
2025-09-06 10:43:49,695 - INFO - 
方法2 (当前整段重构):
2025-09-06 10:43:49,695 - INFO -   ⚠️ 清空所有run，重新创建单一run
2025-09-06 10:43:49,695 - INFO -   ⚠️ 只保留第一个run的格式，丢失其他格式
2025-09-06 10:43:49,695 - INFO -   ✅ 实现简单，稳定性高
2025-09-06 10:43:49,695 - INFO - 
💡 为什么当前方法要重构整个段落？
2025-09-06 10:43:49,695 - INFO -   1. 简单可靠：避免复杂的run边界计算
2025-09-06 10:43:49,695 - INFO -   2. 一致性：确保替换后的文本格式统一
2025-09-06 10:43:49,695 - INFO -   3. 兼容性：处理各种复杂的跨run情况
2025-09-06 10:43:49,695 - INFO -   4. 但代价是：可能影响周围文字的格式
