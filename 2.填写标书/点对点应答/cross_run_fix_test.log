2025-09-06 16:21:56,366 - INFO - === 开始测试跨run替换修复 ===
2025-09-06 16:21:56,390 - INFO - 创建测试文档: test_cross_run_fix_input.docx
2025-09-06 16:21:56,390 - INFO - 
=== 原始文档结构分析 ===
2025-09-06 16:21:56,398 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：'
2025-09-06 16:21:56,398 - INFO -   Run数量: 11
2025-09-06 16:21:56,398 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:21:56,398 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:21:56,398 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:21:56,398 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:21:56,398 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:21:56,399 - INFO -     Run 5: '（'
2025-09-06 16:21:56,399 - INFO -     Run 6: '供应商名称、地址'
2025-09-06 16:21:56,399 - INFO -     Run 7: '）'
2025-09-06 16:21:56,399 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:21:56,399 - INFO -     Run 9: '       '
2025-09-06 16:21:56,399 - INFO -     Run 10: '份：'
2025-09-06 16:21:56,399 - INFO - 
=== 开始MCP处理（修复版本） ===
2025-09-06 16:21:56,405 - INFO - 开始MCP投标人名称处理: test_cross_run_fix_input.docx
2025-09-06 16:21:56,405 - INFO - 使用公司名称: 智慧足迹数据科技有限公司
2025-09-06 16:21:56,412 - INFO - 处理段落 #0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:21:56,413 - INFO - 检测到多项替换模式: 项目名称+姓名职务
2025-09-06 16:21:56,413 - INFO - 🔄 检测到多项替换段落，使用批量替换策略
2025-09-06 16:21:56,414 - INFO - 未找到配置中的项目名称，跳过项目名称替换
2025-09-06 16:21:56,414 - INFO - 🔄 开始批量替换: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:21:56,414 - INFO -   发现替换项: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:21:56,414 - INFO - 共发现 1 个替换项，按位置排序完成
2025-09-06 16:21:56,415 - INFO - 段落格式结构分析完成: 11 个格式区域
2025-09-06 16:21:56,415 - INFO -   执行替换 1: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:21:56,415 - INFO -     文本长度变化: 26, 累计变化: 26
2025-09-06 16:21:56,415 - INFO - 🔧 开始重建段落格式，新文本长度: 106
2025-09-06 16:21:56,416 - INFO - ✅ 段落格式重建完成
2025-09-06 16:21:56,416 - INFO - ✅ 批量替换完成: 1 项替换，格式已保持
2025-09-06 16:21:56,416 - INFO - ✅ 段落 #0 批量替换成功，跳过常规处理
2025-09-06 16:21:56,429 - INFO - MCP投标人名称处理完成，保存到: test_cross_run_fix_output.docx
2025-09-06 16:21:56,429 - INFO - 处理统计: 总计1次, 替换内容1次, 空格填写0次
2025-09-06 16:21:56,429 - INFO - ✅ MCP处理成功
2025-09-06 16:21:56,429 - INFO - 
=== 处理后文档结构分析 ===
2025-09-06 16:21:56,437 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（智慧足迹数据科技有有提交下述文件正本一份及副本       份：'
2025-09-06 16:21:56,437 - INFO -   Run数量: 11
2025-09-06 16:21:56,437 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:21:56,437 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:21:56,437 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:21:56,437 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:21:56,437 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:21:56,437 - INFO -     Run 5: '（'
2025-09-06 16:21:56,437 - INFO -     Run 6: '智慧足迹数据科技有'
2025-09-06 16:21:56,437 - INFO -     Run 7: '有'
2025-09-06 16:21:56,438 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:21:56,438 - INFO -     Run 9: '       '
2025-09-06 16:21:56,438 - INFO -     Run 10: '份：'
2025-09-06 16:21:56,438 - ERROR - ❌ 问题仍然存在：出现了部分替换的错误格式
2025-09-06 16:21:56,438 - ERROR - 💥 跨run替换修复测试失败！
2025-09-06 16:25:30,392 - INFO - === 开始测试跨run替换修复 ===
2025-09-06 16:25:30,415 - INFO - 创建测试文档: test_cross_run_fix_input.docx
2025-09-06 16:25:30,415 - INFO - 
=== 原始文档结构分析 ===
2025-09-06 16:25:30,422 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：'
2025-09-06 16:25:30,423 - INFO -   Run数量: 11
2025-09-06 16:25:30,423 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:25:30,423 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:25:30,423 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:25:30,423 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:25:30,423 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:25:30,423 - INFO -     Run 5: '（'
2025-09-06 16:25:30,423 - INFO -     Run 6: '供应商名称、地址'
2025-09-06 16:25:30,423 - INFO -     Run 7: '）'
2025-09-06 16:25:30,423 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:25:30,423 - INFO -     Run 9: '       '
2025-09-06 16:25:30,423 - INFO -     Run 10: '份：'
2025-09-06 16:25:30,423 - INFO - 
=== 开始MCP处理（修复版本） ===
2025-09-06 16:25:30,429 - INFO - 开始MCP投标人名称处理: test_cross_run_fix_input.docx
2025-09-06 16:25:30,429 - INFO - 使用公司名称: 智慧足迹数据科技有限公司
2025-09-06 16:25:30,437 - INFO - 处理段落 #0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:25:30,437 - INFO - 检测到多项替换模式: 项目名称+姓名职务
2025-09-06 16:25:30,437 - INFO - 🔄 检测到多项替换段落，使用批量替换策略
2025-09-06 16:25:30,438 - INFO - 未找到配置中的项目名称，跳过项目名称替换
2025-09-06 16:25:30,439 - INFO - 🔄 开始批量替换: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:25:30,439 - INFO -   发现替换项: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:25:30,439 - INFO - 共发现 1 个替换项，按位置排序完成
2025-09-06 16:25:30,440 - INFO - 段落格式结构分析完成: 11 个格式区域
2025-09-06 16:25:30,440 - INFO -   执行替换 1: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:25:30,440 - INFO -     文本长度变化: 26, 累计变化: 26
2025-09-06 16:25:30,440 - INFO - 🔧 开始重建段落格式，新文本长度: 106
2025-09-06 16:25:30,441 - INFO - 🔧 开始调整格式边界，原格式区域: 11
2025-09-06 16:25:30,441 - INFO - ✅ 格式边界调整完成: 11 个有效区域
2025-09-06 16:25:30,441 - INFO - ✅ 段落格式重建完成
2025-09-06 16:25:30,441 - INFO - ✅ 批量替换完成: 1 项替换，格式已保持
2025-09-06 16:25:30,441 - INFO - ✅ 段落 #0 批量替换成功，跳过常规处理
2025-09-06 16:25:30,455 - INFO - MCP投标人名称处理完成，保存到: test_cross_run_fix_output.docx
2025-09-06 16:25:30,455 - INFO - 处理统计: 总计1次, 替换内容1次, 空格填写0次
2025-09-06 16:25:30,455 - INFO - ✅ MCP处理成功
2025-09-06 16:25:30,455 - INFO - 
=== 处理后文档结构分析 ===
2025-09-06 16:25:30,463 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）提交下述文件正本一份及副本       份：'
2025-09-06 16:25:30,463 - INFO -   Run数量: 11
2025-09-06 16:25:30,463 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:25:30,463 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:25:30,463 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:25:30,463 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:25:30,463 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:25:30,464 - INFO -     Run 5: '（'
2025-09-06 16:25:30,464 - INFO -     Run 6: '智慧足迹数据科技'
2025-09-06 16:25:30,464 - INFO -     Run 7: '有限公司、北京市东城区王府井大街200号七层711室）'
2025-09-06 16:25:30,464 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:25:30,464 - INFO -     Run 9: '       '
2025-09-06 16:25:30,464 - INFO -     Run 10: '份：'
2025-09-06 16:25:30,464 - ERROR - ❌ 问题仍然存在：出现了部分替换的错误格式
2025-09-06 16:25:30,464 - ERROR - 💥 跨run替换修复测试失败！
2025-09-06 16:26:07,483 - INFO - === 开始测试跨run替换修复 ===
2025-09-06 16:26:07,507 - INFO - 创建测试文档: test_cross_run_fix_input.docx
2025-09-06 16:26:07,507 - INFO - 
=== 原始文档结构分析 ===
2025-09-06 16:26:07,514 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：'
2025-09-06 16:26:07,514 - INFO -   Run数量: 11
2025-09-06 16:26:07,515 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:26:07,515 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:26:07,515 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:26:07,515 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:26:07,515 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:26:07,515 - INFO -     Run 5: '（'
2025-09-06 16:26:07,515 - INFO -     Run 6: '供应商名称、地址'
2025-09-06 16:26:07,515 - INFO -     Run 7: '）'
2025-09-06 16:26:07,515 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:26:07,515 - INFO -     Run 9: '       '
2025-09-06 16:26:07,515 - INFO -     Run 10: '份：'
2025-09-06 16:26:07,515 - INFO - 
=== 开始MCP处理（修复版本） ===
2025-09-06 16:26:07,521 - INFO - 开始MCP投标人名称处理: test_cross_run_fix_input.docx
2025-09-06 16:26:07,521 - INFO - 使用公司名称: 智慧足迹数据科技有限公司
2025-09-06 16:26:07,530 - INFO - 处理段落 #0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:26:07,531 - INFO - 检测到多项替换模式: 项目名称+姓名职务
2025-09-06 16:26:07,531 - INFO - 🔄 检测到多项替换段落，使用批量替换策略
2025-09-06 16:26:07,532 - INFO - 未找到配置中的项目名称，跳过项目名称替换
2025-09-06 16:26:07,533 - INFO - 🔄 开始批量替换: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:26:07,533 - INFO -   发现替换项: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:26:07,533 - INFO - 共发现 1 个替换项，按位置排序完成
2025-09-06 16:26:07,534 - INFO - 段落格式结构分析完成: 11 个格式区域
2025-09-06 16:26:07,534 - INFO -   执行替换 1: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:26:07,534 - INFO -     文本长度变化: 26, 累计变化: 26
2025-09-06 16:26:07,534 - INFO - 🔧 开始重建段落格式，新文本长度: 106
2025-09-06 16:26:07,534 - INFO - 🔧 开始调整格式边界，原格式区域: 11
2025-09-06 16:26:07,534 - INFO - ✅ 格式边界调整完成: 11 个有效区域
2025-09-06 16:26:07,535 - INFO - ✅ 段落格式重建完成
2025-09-06 16:26:07,535 - INFO - ✅ 批量替换完成: 1 项替换，格式已保持
2025-09-06 16:26:07,535 - INFO - ✅ 段落 #0 批量替换成功，跳过常规处理
2025-09-06 16:26:07,547 - INFO - MCP投标人名称处理完成，保存到: test_cross_run_fix_output.docx
2025-09-06 16:26:07,547 - INFO - 处理统计: 总计1次, 替换内容1次, 空格填写0次
2025-09-06 16:26:07,547 - INFO - ✅ MCP处理成功
2025-09-06 16:26:07,547 - INFO - 
=== 处理后文档结构分析 ===
2025-09-06 16:26:07,555 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）提交下述文件正本一份及副本       份：'
2025-09-06 16:26:07,555 - INFO -   Run数量: 11
2025-09-06 16:26:07,555 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:26:07,555 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:26:07,555 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:26:07,555 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:26:07,555 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:26:07,556 - INFO -     Run 5: '（'
2025-09-06 16:26:07,556 - INFO -     Run 6: '智慧足迹数据科技'
2025-09-06 16:26:07,556 - INFO -     Run 7: '有限公司、北京市东城区王府井大街200号七层711室）'
2025-09-06 16:26:07,556 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:26:07,556 - INFO -     Run 9: '       '
2025-09-06 16:26:07,556 - INFO -     Run 10: '份：'
2025-09-06 16:26:07,556 - ERROR - ❌ 问题仍然存在：出现了部分替换的错误格式
2025-09-06 16:26:07,556 - ERROR - 💥 跨run替换修复测试失败！
2025-09-06 16:26:43,743 - INFO - === 开始测试跨run替换修复 ===
2025-09-06 16:26:43,767 - INFO - 创建测试文档: test_cross_run_fix_input.docx
2025-09-06 16:26:43,767 - INFO - 
=== 原始文档结构分析 ===
2025-09-06 16:26:43,774 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：'
2025-09-06 16:26:43,774 - INFO -   Run数量: 11
2025-09-06 16:26:43,775 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:26:43,775 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:26:43,775 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:26:43,775 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:26:43,775 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:26:43,775 - INFO -     Run 5: '（'
2025-09-06 16:26:43,775 - INFO -     Run 6: '供应商名称、地址'
2025-09-06 16:26:43,775 - INFO -     Run 7: '）'
2025-09-06 16:26:43,775 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:26:43,775 - INFO -     Run 9: '       '
2025-09-06 16:26:43,775 - INFO -     Run 10: '份：'
2025-09-06 16:26:43,776 - INFO - 
=== 开始MCP处理（修复版本） ===
2025-09-06 16:26:43,781 - INFO - 开始MCP投标人名称处理: test_cross_run_fix_input.docx
2025-09-06 16:26:43,782 - INFO - 使用公司名称: 智慧足迹数据科技有限公司
2025-09-06 16:26:43,789 - INFO - 处理段落 #0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:26:43,790 - INFO - 检测到多项替换模式: 项目名称+姓名职务
2025-09-06 16:26:43,790 - INFO - 🔄 检测到多项替换段落，使用批量替换策略
2025-09-06 16:26:43,791 - INFO - 未找到配置中的项目名称，跳过项目名称替换
2025-09-06 16:26:43,792 - INFO - 🔄 开始批量替换: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（供应商名称、地址）提交下述文件正本一份及副本       份：...'
2025-09-06 16:26:43,792 - INFO -   发现替换项: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:26:43,792 - INFO - 共发现 1 个替换项，按位置排序完成
2025-09-06 16:26:43,793 - INFO - 段落格式结构分析完成: 11 个格式区域
2025-09-06 16:26:43,793 - INFO -   执行替换 1: '（供应商名称、地址）' -> '（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）' (位置: 48-58)
2025-09-06 16:26:43,793 - INFO -     文本长度变化: 26, 累计变化: 26
2025-09-06 16:26:43,793 - INFO - 🔧 开始重建段落格式，新文本长度: 106
2025-09-06 16:26:43,793 - INFO - 🔧 开始调整格式边界，原格式区域: 11
2025-09-06 16:26:43,793 - INFO - ✅ 格式边界调整完成: 11 个有效区域
2025-09-06 16:26:43,794 - INFO - ✅ 段落格式重建完成
2025-09-06 16:26:43,794 - INFO - ✅ 批量替换完成: 1 项替换，格式已保持
2025-09-06 16:26:43,794 - INFO - ✅ 段落 #0 批量替换成功，跳过常规处理
2025-09-06 16:26:43,807 - INFO - MCP投标人名称处理完成，保存到: test_cross_run_fix_output.docx
2025-09-06 16:26:43,807 - INFO - 处理统计: 总计1次, 替换内容1次, 空格填写0次
2025-09-06 16:26:43,807 - INFO - ✅ MCP处理成功
2025-09-06 16:26:43,807 - INFO - 
=== 处理后文档结构分析 ===
2025-09-06 16:26:43,815 - INFO - 段落 0: '根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）提交下述文件正本一份及副本       份：'
2025-09-06 16:26:43,815 - INFO -   Run数量: 11
2025-09-06 16:26:43,815 - INFO -     Run 0: '根据贵方为'
2025-09-06 16:26:43,815 - INFO -     Run 1: '（项目名称）'
2025-09-06 16:26:43,815 - INFO -     Run 2: '项目采购采购货物及服务的竞争性磋商代表'
2025-09-06 16:26:43,815 - INFO -     Run 3: '（姓名、职务）'
2025-09-06 16:26:43,815 - INFO -     Run 4: '经正式授权并代表供应商'
2025-09-06 16:26:43,815 - INFO -     Run 5: '（'
2025-09-06 16:26:43,815 - INFO -     Run 6: '智慧足迹数据科技'
2025-09-06 16:26:43,815 - INFO -     Run 7: '有限公司、北京市东城区王府井大街200号七层711室）'
2025-09-06 16:26:43,815 - INFO -     Run 8: '提交下述文件正本一份及副本'
2025-09-06 16:26:43,815 - INFO -     Run 9: '       '
2025-09-06 16:26:43,815 - INFO -     Run 10: '份：'
2025-09-06 16:26:43,817 - INFO - ✅ 问题已修复：正确完整替换，内容完整
2025-09-06 16:26:43,817 - INFO -    最终文本：'根据贵方为（项目名称）项目采购采购货物及服务的竞争性磋商代表（姓名、职务）经正式授权并代表供应商（智慧足迹数据科技有限公司、北京市东城区王府井大街200号七层711室）提交下述文件正本一份及副本       份：'
2025-09-06 16:26:43,817 - INFO - 🎉 跨run替换修复测试通过！
