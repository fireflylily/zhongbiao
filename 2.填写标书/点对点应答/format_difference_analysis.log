2025-09-06 10:17:31,155 - INFO - 开始格式差异分析
2025-09-06 10:17:31,161 - INFO - 
=== 分析文档结构: /Users/lvhe/Library/Mobile Documents/com~apple~CloudDocs/Work/智慧足迹2025/05投标项目/AI标书/程序/2.填写标书/点对点应答/outputs/docx-商务应答-20250906_101512.docx ===
2025-09-06 10:17:31,162 - INFO - 
段落 #4: 根据贵方为（所属运营商数据）项目采购采购货物及服务的竞争性磋字代表（姓名、职务）经正式授权并代表供应商（中国联合网络通信有限公司、北京市西城区金融大街21号）提交下述文件正本一份及副本       份...
2025-09-06 10:17:31,162 - INFO -   完整文本: 根据贵方为（所属运营商数据）项目采购采购货物及服务的竞争性磋字代表（姓名、职务）经正式授权并代表供应商（中国联合网络通信有限公司、北京市西城区金融大街21号）提交下述文件正本一份及副本       份：
2025-09-06 10:17:31,162 - INFO -   Run数量: 16
2025-09-06 10:17:31,163 - INFO -     Run 1: '根据贵方为' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,163 - INFO -     Run 2: '（所属运营商数据）' [字体=宋体, 大小=152400, 粗体=None, 斜体=True]
2025-09-06 10:17:31,163 - INFO -     Run 3: '项目' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,163 - INFO -     Run 4: '采购' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,163 - INFO -     Run 5: '采购货物及服务的' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,163 - INFO -     Run 6: '竞争性磋' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,163 - INFO -     Run 7: '字代表' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,163 - INFO -     Run 8: '（姓名、职务' [字体=宋体, 大小=152400, 粗体=None, 斜体=True]
2025-09-06 10:17:31,163 - INFO -     Run 9: '）经正式授权并代表' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,163 - INFO -     Run 10: '供应商' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,164 - INFO -     Run 11: '（' [字体=宋体, 大小=152400, 粗体=None, 斜体=True]
2025-09-06 10:17:31,164 - INFO -     Run 12: '中国联' [字体=宋体, 大小=152400, 粗体=None, 斜体=True]
2025-09-06 10:17:31,164 - INFO -     Run 13: '合网络通信有' [字体=宋体, 大小=152400, 粗体=None, 斜体=True]
2025-09-06 10:17:31,164 - INFO -     Run 14: '限公司、北京市西城区金融大' [字体=宋体, 大小=152400, 粗体=None, 斜体=True]
2025-09-06 10:17:31,164 - INFO -     Run 15: '街21号）提交' [字体=宋体, 大小=152400, 粗体=None, 斜体=True]
2025-09-06 10:17:31,164 - INFO -     Run 16: '下述文件正本一份及副本       份：' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,165 - INFO - 
段落 #11: 根据贵方购采购货物及服务的竞争性磋商公告（64525343），签字代表（姓名、职务）经正式授权并代表供应交下述文件正本一份及副本       份：...
2025-09-06 10:17:31,165 - INFO -   完整文本: 根据贵方购采购货物及服务的竞争性磋商公告（64525343），签字代表（姓名、职务）经正式授权并代表供应交下述文件正本一份及副本       份：
2025-09-06 10:17:31,165 - INFO -   Run数量: 15
2025-09-06 10:17:31,165 - INFO -     Run 15: '根据贵方购采购货物及服务的竞争性磋商公告（64525343），签字代表（姓名、职务）经正式授权并代表供应交下述文件正本一份及副本       份：' [字体=宋体, 大小=152400, 粗体=None, 斜体=None]
2025-09-06 10:17:31,165 - INFO - ================================================================================
2025-09-06 10:17:31,165 - INFO - 基于日志分析项目名称vs采购编号处理差异
2025-09-06 10:17:31,165 - INFO - ================================================================================
2025-09-06 10:17:31,165 - INFO - 
日志分析：

1. 项目名称处理（段落#4）：
   - 匹配文本: '（项目名称）'
   - 执行方法: _replace_content_project_method
   - 处理方式: 项目名称括号替换: '（项目名称）' -> '（所属运营商数据）'
   - 结果: 直接成功，没有跨run处理的日志

2. 采购编号处理（段落#11）：
   - 匹配文本: '（采购编号）'
   - 执行方法: _replace_content_tender_no_method
   - 处理方式: 
     * 优先尝试单run替换: '（采购编号）' -> '（64525343）'
     * ⚠️ 单run替换失败，尝试跨run项目编号处理...
     * ⚠️ 项目编号跨run替换完成: (可能影响周围格式)

关键差异：
- 项目名称：成功使用单run替换，保持格式完美
- 采购编号：单run失败，被迫使用跨run处理，影响周围格式

原因分析：
1. 项目名称所在段落的"（项目名称）"文本完整包含在一个run中
2. 采购编号所在段落的"（采购编号）"文本跨越多个run，单run无法找到完整匹配

这说明问题不在于处理方法本身，而在于文档中文本的run分布结构！

2025-09-06 10:17:31,165 - INFO - ================================================================================
2025-09-06 10:17:31,165 - INFO - 创建run结构影响验证测试
2025-09-06 10:17:31,165 - INFO - ================================================================================
2025-09-06 10:17:31,189 - INFO - 创建run结构测试文档: run_structure_test.docx
2025-09-06 10:17:31,197 - INFO - 
=== 分析文档结构: run_structure_test.docx ===
2025-09-06 10:17:31,197 - INFO - 
段落 #0: 测试项目：（项目名称）需要处理...
2025-09-06 10:17:31,197 - INFO -   完整文本: 测试项目：（项目名称）需要处理
2025-09-06 10:17:31,197 - INFO -   Run数量: 1
2025-09-06 10:17:31,197 - INFO -     Run 1: '测试项目：（项目名称）需要处理' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,197 - INFO - 
段落 #1: 测试编号：（采购编号）需要处理...
2025-09-06 10:17:31,197 - INFO -   完整文本: 测试编号：（采购编号）需要处理
2025-09-06 10:17:31,197 - INFO -   Run数量: 3
2025-09-06 10:17:31,197 - INFO -     Run 1: '测试编号：（' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,198 - INFO -     Run 2: '采购编号' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,198 - INFO -     Run 3: '）需要处理' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,198 - INFO - 
段落 #2: 根据贵方购采购货物及服务的竞争性磋商公告（采购编号），签字代表经正式授权...
2025-09-06 10:17:31,198 - INFO -   完整文本: 根据贵方购采购货物及服务的竞争性磋商公告（采购编号），签字代表经正式授权
2025-09-06 10:17:31,198 - INFO -   Run数量: 5
2025-09-06 10:17:31,198 - INFO -     Run 1: '根据贵方购采购货物及服务的竞争性磋商公告' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,198 - INFO -     Run 2: '（' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,198 - INFO -     Run 3: '采购编号' [字体=None, 大小=None, 粗体=None, 斜体=True]
2025-09-06 10:17:31,198 - INFO -     Run 4: '）' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,198 - INFO -     Run 5: '，签字代表经正式授权' [字体=None, 大小=None, 粗体=None, 斜体=None]
2025-09-06 10:17:31,198 - INFO - 
================================================================================
2025-09-06 10:17:31,198 - INFO - 结论:
2025-09-06 10:17:31,198 - INFO - 项目名称处理成功是因为'（项目名称）'文本完整在一个run中
2025-09-06 10:17:31,198 - INFO - 采购编号处理失败是因为'（采购编号）'文本跨越多个run
2025-09-06 10:17:31,198 - INFO - 这是Word文档本身的run结构问题，不是代码逻辑问题
2025-09-06 10:17:31,198 - INFO - ================================================================================
