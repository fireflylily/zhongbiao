# AI 助手功能使用说明

## 功能概述

富文本编辑器已集成 **UmoEditor 内置 AI 助手**功能，可帮助用户：
- ✨ 改写内容（提升专业性）
- 📝 扩写内容（补充细节）
- 📋 总结内容（提取要点）
- 🌐 翻译内容（中英互译）
- 🎯 自定义生成（按需生成）

---

## 使用方法

### 方式1：通过工具栏使用 AI 助手

1. 在编辑器中**选中**需要处理的文本
2. 点击工具栏的 **"AI 助手"** 按钮（通常是魔法棒图标）
3. 在弹出的菜单中选择操作类型：
   - **改写（Rewrite）** - 使内容更专业规范
   - **扩写（Expand）** - 扩展为300-500字详细描述
   - **总结（Summarize）** - 提取3-5个核心要点
   - **翻译（Translate）** - 中英互译
4. AI 自动生成内容并替换选中文本

### 方式2：通过右键菜单（如果支持）

1. 选中文本
2. 右键点击
3. 选择"AI 助手"相关选项

---

## 使用场景示例

### 场景1：改写"格式自拟"内容

**原始内容**：
```
项目概述：（格式自拟）
```

**操作步骤**：
1. 选中 "（格式自拟）"
2. 点击 AI 助手 → 选择"改写"
3. 输入简要描述："生成项目概述内容"

**AI 生成结果**（示例）：
```html
<h3>项目概述</h3>
<p>本项目旨在为客户提供一套完整的智能标书管理系统解决方案。
系统采用先进的人工智能技术，结合标书编写行业最佳实践，帮助企业
大幅提升标书编写效率，降低人工成本，提高中标率。</p>

<p><strong>核心优势：</strong></p>
<ul>
  <li>智能化内容生成，快速响应招标需求</li>
  <li>规范化流程管理，确保标书质量</li>
  <li>知识库积累，持续优化改进</li>
</ul>
```

### 场景2：扩写简略内容

**原始内容**：
```
我们将提供优质服务
```

**操作步骤**：
1. 选中文本
2. 点击 AI 助手 → 选择"扩写"

**AI 生成结果**（示例）：
```html
<p>我们承诺为客户提供全方位、高品质的服务保障体系。
具体包括：</p>

<h4>1. 专业团队支持</h4>
<p>配备经验丰富的项目经理和技术团队，7×24小时响应客户需求，
确保项目顺利实施。</p>

<h4>2. 完善的培训体系</h4>
<p>提供系统化的用户培训课程，包括操作培训、管理培训和技术培训，
确保用户能够熟练使用系统。</p>

<h4>3. 持续的运维服务</h4>
<p>建立长效运维机制，定期巡检、及时响应故障、持续优化系统性能，
保障系统稳定运行。</p>
```

### 场景3：总结长文内容

**原始内容**（长篇技术方案）：
```
本系统采用微服务架构，前端使用Vue3框架，后端使用Python Flask...
（省略500字）
```

**操作步骤**：
1. 选中全部内容
2. 点击 AI 助手 → 选择"总结"

**AI 生成结果**（示例）：
```html
<h4>技术方案核心要点：</h4>
<ul>
  <li><strong>架构设计：</strong>采用微服务架构，支持高可用和弹性扩展</li>
  <li><strong>前端技术：</strong>Vue3 + Element Plus，提供现代化用户界面</li>
  <li><strong>后端技术：</strong>Python Flask + SQLAlchemy，稳定高效</li>
  <li><strong>AI能力：</strong>集成GPT大模型，实现智能内容生成</li>
  <li><strong>数据安全：</strong>多重加密机制，确保数据安全合规</li>
</ul>
```

### 场景4：自定义生成

**输入需求描述**：
```
生成实施计划表格，包含5个阶段（需求分析、设计开发、测试、上线、运维），每个阶段包含主要任务和时间
```

**操作步骤**：
1. 在文档中输入上述需求描述
2. 选中这段描述
3. 点击 AI 助手 → 选择"自定义生成"

**AI 生成结果**（示例）：
```html
<h3>项目实施计划</h3>
<table border="1">
  <thead>
    <tr>
      <th>阶段</th>
      <th>主要任务</th>
      <th>预计时间</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>第一阶段：需求分析</td>
      <td>收集需求、梳理业务流程、编写需求规格说明书</td>
      <td>2周</td>
    </tr>
    <tr>
      <td>第二阶段：设计开发</td>
      <td>系统设计、数据库设计、功能开发、单元测试</td>
      <td>8周</td>
    </tr>
    <tr>
      <td>第三阶段：测试</td>
      <td>集成测试、性能测试、安全测试、用户验收测试</td>
      <td>3周</td>
    </tr>
    <tr>
      <td>第四阶段：上线</td>
      <td>环境部署、数据迁移、用户培训、正式上线</td>
      <td>1周</td>
    </tr>
    <tr>
      <td>第五阶段：运维</td>
      <td>系统监控、故障处理、功能优化、定期巡检</td>
      <td>持续</td>
    </tr>
  </tbody>
</table>
```

---

## 技术细节

### 前端集成

在 `RichTextEditor.vue` 组件中启用 AI 助手：

```typescript
// 在 editorOptions 中添加
ai: {
  enabled: true,
  assistant: {
    enabled: true,
    onMessage: async (payload, content) => {
      // 调用后端 API /api/editor/ai-assistant
      // 返回生成的 HTML 内容
    }
  }
}
```

### 后端 API

**端点**: `POST /api/editor/ai-assistant`

**请求体**:
```json
{
  "command": "rewrite",           // 操作类型
  "input": "选中的文本内容",      // 输入文本
  "output": "html",               // 输出格式
  "lang": "zh-CN",                // 语言
  "company_id": 1,                // 公司ID
  "project_name": "项目名称"      // 项目名称
}
```

**响应体**:
```json
{
  "success": true,
  "content": "<p>AI生成的HTML内容</p>"
}
```

### 支持的 command 类型

| Command | 说明 | 示例 |
|---------|------|------|
| `rewrite` | 改写内容，提升专业性 | 原文："我们的产品很好" → AI："我们的产品具有显著的竞争优势..." |
| `expand` | 扩写内容，补充细节 | 原文："提供服务" → AI："提供7×24小时专业服务支持，包括..." |
| `summarize` | 总结内容，提取要点 | 长文 → 3-5个核心要点的列表 |
| `translate` | 翻译（中英互译） | 中文 → 英文 或 英文 → 中文 |
| `generate` / `custom` | 自定义生成 | 根据用户描述生成内容 |

---

## 注意事项

1. **选中文本后再操作** - 必须先选中需要处理的文本，再点击 AI 助手
2. **输出为 HTML 格式** - AI 生成的内容会自动转换为 HTML 标签格式
3. **可以撤销** - 如果不满意 AI 生成的内容，可以使用编辑器的撤销功能（Ctrl+Z）
4. **多次生成** - 可以对同一段文本多次使用 AI 助手，直到满意为止
5. **API 依赖** - 需要配置有效的大模型 API（默认使用 gpt-4o-mini）

---

## FAQ

### Q1: AI 助手按钮在哪里？

A: 在富文本编辑器的工具栏中，通常是一个魔法棒或星星图标。如果没有看到，请检查 UmoEditor 版本是否支持 AI 功能。

### Q2: 如何更换 AI 模型？

A: 修改后端 `api_editor_bp.py` 中的模型名称：
```python
client = create_llm_client("gpt-4o-mini")  # 改为其他模型
```

### Q3: AI 生成速度慢怎么办？

A: 可能原因：
- 网络连接较慢
- API 响应时间较长
- 可以尝试切换到更快的模型

### Q4: 如何自定义 AI 提示词？

A: 修改 `build_ai_prompts()` 函数中的提示词模板，调整生成风格和要求。

### Q5: 支持流式生成吗？

A: 当前版本使用一次性生成，后续可扩展为流式生成（打字机效果）。

---

## 更新日志

### v1.0.0 (2025-01-23)
- ✅ 集成 UmoEditor 内置 AI 助手
- ✅ 支持改写、扩写、总结、翻译
- ✅ 支持自定义生成
- ✅ 后端使用 gpt-4o-mini 模型

---

## 技术支持

如有问题或建议，请联系技术团队。
