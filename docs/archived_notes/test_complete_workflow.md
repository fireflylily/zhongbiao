# ğŸ“‹ Chromaå‘é‡åŒ–å®Œæ•´æµç¨‹æµ‹è¯•æŒ‡å—

## æµ‹è¯•ç›®æ ‡
éªŒè¯ **æ–‡æ¡£ä¸Šä¼  â†’ è‡ªåŠ¨å‘é‡åŒ– â†’ AIæœç´¢** çš„å®Œæ•´æµç¨‹

---

## ğŸ”§ å‡†å¤‡å·¥ä½œ

### 1. ç¡®è®¤æœåŠ¡è¿è¡Œ
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
curl http://localhost:8110/api/vector_search/status
```

**æœŸæœ›ç»“æœ**ï¼š
```json
{
  "success": true,
  "data": {
    "initialized": true,
    "components": {
      "embedding_service": true,
      "vector_store": true,
      "parser_manager": true
    },
    "vector_store": {
      "total_documents": 0,
      "dimension": 100,
      "backend": "Chroma"
    }
  }
}
```

### 2. å‡†å¤‡æµ‹è¯•æ–‡æ¡£
åˆ›å»º3ä¸ªæµ‹è¯•æ–‡æ¡£ï¼ˆæˆ–ä½¿ç”¨ç°æœ‰æ–‡æ¡£ï¼‰ï¼š
- `æµ‹è¯•æ–‡æ¡£1.txt` - å…³äºäº§å“åŠŸèƒ½çš„æè¿°
- `æµ‹è¯•æ–‡æ¡£2.txt` - å…³äºæŠ€æœ¯æ¶æ„çš„è¯´æ˜
- `æµ‹è¯•æ–‡æ¡£3.txt` - å…³äºä½¿ç”¨æ‰‹å†Œçš„å†…å®¹

---

## ğŸ“ æµ‹è¯•æ­¥éª¤

### æ­¥éª¤1: åˆ›å»ºæµ‹è¯•ä¼ä¸šå’Œäº§å“

1. è®¿é—® http://localhost:8110/knowledge_base
2. ç‚¹å‡»"æ·»åŠ ä¼ä¸š"
3. å¡«å†™ä¿¡æ¯ï¼š
   - ä¼ä¸šåç§°ï¼šæµ‹è¯•ä¼ä¸š
   - ä¼ä¸šä»£ç ï¼šTEST001
   - è¡Œä¸šç±»å‹ï¼šè½¯ä»¶å’Œä¿¡æ¯æŠ€æœ¯æœåŠ¡ä¸š
4. åœ¨ä¼ä¸šä¸‹åˆ›å»ºäº§å“ï¼š
   - äº§å“åç§°ï¼šæµ‹è¯•äº§å“
   - äº§å“ç±»åˆ«ï¼šè½¯ä»¶

### æ­¥éª¤2: ä¸Šä¼ æ–‡æ¡£å¹¶éªŒè¯è‡ªåŠ¨å‘é‡åŒ–

#### æ–¹æ³•1ï¼šé€šè¿‡UIä¸Šä¼ 
1. ç‚¹å‡»"æµ‹è¯•äº§å“"
2. æ‹–æ‹½æ–‡æ¡£åˆ°ä¸Šä¼ åŒºåŸŸ
3. è§‚å¯Ÿä¸Šä¼ è¿›åº¦
4. **å…³é”®éªŒè¯ç‚¹**ï¼šä¸Šä¼ å®Œæˆåï¼Œæ–‡æ¡£çŠ¶æ€åº”è¯¥æ˜¾ç¤º"å‘é‡åŒ–ä¸­"æˆ–"å·²å‘é‡åŒ–"

#### æ–¹æ³•2ï¼šé€šè¿‡APIæµ‹è¯•
```bash
# 2.1 ä¸Šä¼ æ–‡æ¡£
curl -X POST http://localhost:8110/api/knowledge_base/documents \
  -F "file=@æµ‹è¯•æ–‡æ¡£1.txt" \
  -F "product_id=1" \
  -F "company_id=1" \
  -F "document_category=tech"

# é¢„æœŸè¿”å›ï¼š
# {"success": true, "data": {"doc_id": 123}, "message": "æ–‡æ¡£ä¸Šä¼ æˆåŠŸ"}
```

```bash
# 2.2 è§¦å‘å‘é‡åŒ–
curl -X POST http://localhost:8110/api/vector_search/documents/vectorize \
  -H "Content-Type: application/json" \
  -d '{"doc_id": 123}'

# é¢„æœŸè¿”å›ï¼š
# {"success": true, "message": "æ–‡æ¡£å‘é‡åŒ–å®Œæˆ", "chunks_processed": 5}
```

```bash
# 2.3 æ£€æŸ¥å‘é‡åŒ–çŠ¶æ€
curl http://localhost:8110/api/vector_search/status

# é¢„æœŸï¼švector_store.total_documents åº”è¯¥å¢åŠ 
```

### æ­¥éª¤3: æµ‹è¯•å‘é‡æœç´¢

#### 3.1 è¯­ä¹‰æœç´¢æµ‹è¯•
```bash
curl -X POST http://localhost:8110/api/vector_search/search \
  -H "Content-Type: application/json" \
  -d '{
    "query": "äº§å“æœ‰ä»€ä¹ˆåŠŸèƒ½",
    "top_k": 5,
    "threshold": 0.3
  }'
```

**é¢„æœŸç»“æœ**ï¼š
```json
{
  "success": true,
  "data": {
    "results": [
      {
        "document_id": "doc_123_chunk_0",
        "content": "æˆ‘ä»¬çš„äº§å“ä¸»è¦æä¾›ä»¥ä¸‹åŠŸèƒ½...",
        "similarity_score": 0.85,
        "metadata": {
          "doc_id": 123,
          "company_id": 1,
          "product_id": 1
        }
      }
    ],
    "total_results": 5,
    "search_time": 0.015
  }
}
```

#### 3.2 å¸¦è¿‡æ»¤æ¡ä»¶çš„æœç´¢
```bash
curl -X POST http://localhost:8110/api/vector_search/search \
  -H "Content-Type: application/json" \
  -d '{
    "query": "æŠ€æœ¯æ¶æ„",
    "top_k": 5,
    "filters": {
      "company_id": 1,
      "product_id": 1
    }
  }'
```

#### 3.3 ç›¸ä¼¼æ–‡æ¡£æŸ¥è¯¢
```bash
curl http://localhost:8110/api/vector_search/similar/doc_123_chunk_0?top_k=5
```

---

## âœ… éªŒè¯æ¸…å•

### æ–‡æ¡£ä¸Šä¼ éªŒè¯
- [ ] æ–‡æ¡£æˆåŠŸä¸Šä¼ åˆ°æœåŠ¡å™¨
- [ ] æ•°æ®åº“ `documents` è¡¨ä¸­æœ‰è®°å½•
- [ ] æ–‡ä»¶ä¿å­˜åœ¨ `data/uploads/` ç›®å½•
- [ ] `parse_status` å­—æ®µæ›´æ–°ä¸º 'completed'

### å‘é‡åŒ–éªŒè¯
- [ ] æ–‡æ¡£è¢«æˆåŠŸè§£æå’Œåˆ†å—
- [ ] `document_chunks` è¡¨ä¸­æœ‰åˆ†å—è®°å½•
- [ ] Chromaæ•°æ®åº“ä¸­æœ‰å‘é‡è®°å½•
- [ ] `vector_status` å­—æ®µæ›´æ–°ä¸º 'completed'
- [ ] å‘é‡æ•°é‡æ­£ç¡®ï¼ˆchunksæ•°é‡ = vectoræ•°é‡ï¼‰

### æœç´¢åŠŸèƒ½éªŒè¯
- [ ] è¯­ä¹‰æœç´¢è¿”å›ç›¸å…³ç»“æœ
- [ ] ç›¸ä¼¼åº¦åˆ†æ•°åˆç†ï¼ˆ0-1ä¹‹é—´ï¼‰
- [ ] æœç´¢é€Ÿåº¦å¿«ï¼ˆ< 100msï¼‰
- [ ] å…ƒæ•°æ®è¿‡æ»¤æ­£å¸¸å·¥ä½œ
- [ ] ç›¸ä¼¼æ–‡æ¡£æŸ¥è¯¢æ­£å¸¸

---

## ğŸ› å¸¸è§é—®é¢˜æ’æŸ¥

### é—®é¢˜1: å‘é‡åŒ–å¤±è´¥
**ç—‡çŠ¶**ï¼š`vector_status` ä¸€ç›´æ˜¯ 'pending'

**æ£€æŸ¥**ï¼š
```bash
# æŸ¥çœ‹æ—¥å¿—
tail -100 ai_tender_system/data/logs/ai_tender_system.log

# æ£€æŸ¥æ–‡æ¡£è§£æçŠ¶æ€
sqlite3 ai_tender_system/data/knowledge_base.db \
  "SELECT doc_id, file_name, parse_status, vector_status FROM documents;"
```

**å¯èƒ½åŸå› **ï¼š
- æ–‡æ¡£æ ¼å¼ä¸æ”¯æŒ
- æ–‡æ¡£å†…å®¹ä¸ºç©º
- åµŒå…¥æœåŠ¡æœªåˆå§‹åŒ–

### é—®é¢˜2: æœç´¢æ— ç»“æœ
**ç—‡çŠ¶**ï¼šæœç´¢APIè¿”å›ç©ºæ•°ç»„

**æ£€æŸ¥**ï¼š
```bash
# ç¡®è®¤Chromaä¸­æœ‰æ•°æ®
curl http://localhost:8110/api/vector_search/status
# æ£€æŸ¥ vector_store.total_documents

# é™ä½ç›¸ä¼¼åº¦é˜ˆå€¼é‡è¯•
curl -X POST http://localhost:8110/api/vector_search/search \
  -H "Content-Type: application/json" \
  -d '{"query": "æµ‹è¯•", "threshold": 0.0}'
```

### é—®é¢˜3: æœç´¢é€Ÿåº¦æ…¢
**ç—‡çŠ¶**ï¼š`search_time` > 1ç§’

**å¯èƒ½åŸå› **ï¼š
- å‘é‡æ•°æ®è¿‡å¤šï¼ˆ> 100Kï¼‰
- Chromaç´¢å¼•æœªä¼˜åŒ–
- æœåŠ¡å™¨èµ„æºä¸è¶³

---

## ğŸ“Š æ€§èƒ½åŸºå‡†

### é¢„æœŸæ€§èƒ½æŒ‡æ ‡
- **æ–‡æ¡£ä¸Šä¼ **ï¼š< 1ç§’ï¼ˆ1MBæ–‡ä»¶ï¼‰
- **æ–‡æ¡£è§£æ**ï¼š< 2ç§’
- **å‘é‡åŒ–**ï¼š< 5ç§’ï¼ˆ10ä¸ªåˆ†å—ï¼‰
- **æœç´¢å»¶è¿Ÿ**ï¼š< 50msï¼ˆ1Kå‘é‡ï¼‰
- **æœç´¢å»¶è¿Ÿ**ï¼š< 200msï¼ˆ100Kå‘é‡ï¼‰

### Chroma vs SimpleVectorStore å¯¹æ¯”
| æ“ä½œ | SimpleVectorStore | ChromaVectorStore | æå‡ |
|------|------------------|------------------|------|
| æœç´¢1Kæ–‡æ¡£ | ~80ms | ~15ms | 5.3x âš¡ |
| æœç´¢10Kæ–‡æ¡£ | ~800ms | ~30ms | 26.7x âš¡âš¡ |
| å†…å­˜å ç”¨ | ~1.5GB | ~800MB | 47% ğŸ“‰ |
| æŒä¹…åŒ– | æ‰‹åŠ¨ | è‡ªåŠ¨ | âœ¨ |

---

## ğŸ¯ æˆåŠŸæ ‡å‡†

å…¨éƒ¨é€šè¿‡ä»¥ä¸‹éªŒè¯å³ä¸ºæˆåŠŸï¼š

1. âœ… æ–‡æ¡£ä¸Šä¼ æˆåŠŸç‡ 100%
2. âœ… è‡ªåŠ¨å‘é‡åŒ–æˆåŠŸç‡ 100%
3. âœ… æœç´¢è¿”å›ç›¸å…³ç»“æœ
4. âœ… æœç´¢å»¶è¿Ÿ < 100ms
5. âœ… ç›¸ä¼¼åº¦åˆ†æ•°åˆç†ï¼ˆ0.3-1.0ï¼‰
6. âœ… å…ƒæ•°æ®è¿‡æ»¤æ­£ç¡®
7. âœ… æ— é”™è¯¯æ—¥å¿—

---

## ğŸ“ æµ‹è¯•æŠ¥å‘Šæ¨¡æ¿

```markdown
## Chromaè¿ç§»æµ‹è¯•æŠ¥å‘Š

**æµ‹è¯•æ—¶é—´**ï¼š2025-09-30
**æµ‹è¯•äººå‘˜**ï¼š[ä½ çš„åå­—]
**ç³»ç»Ÿç‰ˆæœ¬**ï¼šv1.0

### æµ‹è¯•ç»“æœæ±‡æ€»
- æ–‡æ¡£ä¸Šä¼ ï¼šâœ… é€šè¿‡ / âŒ å¤±è´¥
- è‡ªåŠ¨å‘é‡åŒ–ï¼šâœ… é€šè¿‡ / âŒ å¤±è´¥
- å‘é‡æœç´¢ï¼šâœ… é€šè¿‡ / âŒ å¤±è´¥
- æ€§èƒ½è¡¨ç°ï¼šâœ… ç¬¦åˆé¢„æœŸ / âš ï¸ éœ€ä¼˜åŒ–

### è¯¦ç»†æ•°æ®
- æµ‹è¯•æ–‡æ¡£æ•°é‡ï¼š3
- å‘é‡åŒ–æˆåŠŸï¼š3/3
- å¹³å‡æœç´¢å»¶è¿Ÿï¼š15ms
- ç›¸ä¼¼åº¦åˆ†æ•°èŒƒå›´ï¼š0.65-0.92

### é—®é¢˜è®°å½•
[è®°å½•é‡åˆ°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆ]

### æ€»ç»“
[æ•´ä½“è¯„ä»·å’Œå»ºè®®]
```

---

## ğŸš€ åç»­è¡ŒåŠ¨

æµ‹è¯•é€šè¿‡åï¼š
1. æ¸…ç†æµ‹è¯•æ•°æ®
2. å‡†å¤‡ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
3. ç¼–å†™ç”¨æˆ·æ–‡æ¡£
4. åŸ¹è®­ä½¿ç”¨äººå‘˜