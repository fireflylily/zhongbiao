# Geminiè§£æå™¨é›†æˆæŒ‡å—

## ğŸ“‹ æ¦‚è¿°

Geminiè§£æå™¨å·²æˆåŠŸé›†æˆåˆ°ç°æœ‰çš„**ç›®å½•è§£æå¯¹æ¯”ç³»ç»Ÿ**ä¸­ï¼ç°åœ¨å¯ä»¥åœ¨ `http://localhost:5173/static/dist/#/abtest/parser-comparison` é¡µé¢åŒæ—¶å¯¹æ¯”6ç§è§£ææ–¹æ³•çš„æ•ˆæœã€‚

---

## âœ… å·²å®Œæˆçš„å·¥ä½œ

### 1. åç«¯é›†æˆ

#### 1.1 æ ¸å¿ƒè§£æå™¨ (`ai_tender_system/modules/tender_processing/parsers/gemini_parser.py`)
- âœ… åŸºäº `BaseStructureParser` æ¥å£å®ç°
- âœ… æ”¯æŒå¤šæ¨¡æ€æ–‡æ¡£ç†è§£ï¼ˆæ–‡æœ¬+å›¾ç‰‡ï¼‰
- âœ… ç»“æ„åŒ–JSONè¾“å‡º
- âœ… æˆæœ¬è®¡ç®—ï¼ˆåŸºäºtokenä½¿ç”¨é‡ï¼‰
- âœ… é”™è¯¯å¤„ç†å’Œé™çº§æœºåˆ¶

#### 1.2 APIé›†æˆ (`ai_tender_system/web/blueprints/api_parser_debug_bp.py`)
- âœ… åœ¨ `ParserDebugger.run_all_methods()` ä¸­æ·»åŠ Gemini
- âœ… å®ç° `_run_gemini_parser()` æ–¹æ³•
- âœ… è‡ªåŠ¨æ£€æµ‹Geminiå¯ç”¨æ€§ï¼ˆSDK + APIå¯†é’¥ï¼‰
- âœ… é›†æˆåˆ°ä¸Šä¼ ã€è·å–ã€æ ‡æ³¨ã€å¯¼å‡ºç­‰æ‰€æœ‰APIç«¯ç‚¹

#### 1.3 æ•°æ®åº“Schema (`ai_tender_system/database/add_gemini_to_parser_debug.sql`)
- âœ… æ·»åŠ  `gemini_result` åˆ—ï¼ˆJSONï¼‰
- âœ… æ·»åŠ  `gemini_elapsed` åˆ—ï¼ˆæ€§èƒ½ï¼‰
- âœ… æ·»åŠ  `gemini_chapters_count` åˆ—ï¼ˆç»Ÿè®¡ï¼‰
- âœ… æ·»åŠ  `gemini_precision/recall/f1` åˆ—ï¼ˆå‡†ç¡®ç‡ï¼‰
- âœ… æ›´æ–° `v_parser_debug_summary` è§†å›¾

### 2. å‰ç«¯é›†æˆ

#### 2.1 TypeScriptæ¥å£ (`frontend/src/api/parser-debug.ts`)
- âœ… æ›´æ–° `ParseTestResult` æ¥å£
- âœ… æ›´æ–° `HistoryTest` æ¥å£
- âœ… æ·»åŠ Geminiç±»å‹å®šä¹‰

#### 2.2 å¯¹æ¯”é¡µé¢ (`frontend/src/views/Debug/ParserComparison.vue`)
- âœ… æ·»åŠ "æ–¹æ³•6: Gemini AIè§£æå™¨"å¡ç‰‡ï¼ˆæ©™è‰² #FF6D00ï¼‰
- âœ… åœ¨å‡†ç¡®ç‡å¯¹æ¯”è¡¨æ ¼ä¸­æ·»åŠ Geminiåˆ—
- âœ… åœ¨å†å²è®°å½•è¡¨æ ¼ä¸­æ·»åŠ Gemini F1åˆ†æ•°åˆ—
- âœ… æ›´æ–°æ‰€æœ‰è¾…åŠ©å‡½æ•°ä»¥æ”¯æŒGemini

---

## ğŸš€ ä½¿ç”¨æ­¥éª¤

### æ­¥éª¤1: å®‰è£…Gemini SDKï¼ˆå¯é€‰ï¼‰

å¦‚æœè¦æµ‹è¯•Geminiè§£æå™¨ï¼Œéœ€å…ˆå®‰è£…SDKï¼š

```bash
pip install google-generativeai
```

### æ­¥éª¤2: é…ç½®APIå¯†é’¥ï¼ˆå¯é€‰ï¼‰

åœ¨é¡¹ç›®æ ¹ç›®å½•çš„ `.env` æ–‡ä»¶ä¸­æ·»åŠ ï¼š

```ini
GEMINI_API_KEY=ä½ çš„APIå¯†é’¥
```

**è·å–å¯†é’¥**: è®¿é—® https://aistudio.google.com/

### æ­¥éª¤3: è¿è¡Œæ•°æ®åº“è¿ç§»

```bash
sqlite3 ai_tender_system/data/knowledge_base.db < ai_tender_system/database/add_gemini_to_parser_debug.sql
```

### æ­¥éª¤4: å¯åŠ¨åº”ç”¨

```bash
python -m ai_tender_system.web.app
```

### æ­¥éª¤5: è®¿é—®å¯¹æ¯”é¡µé¢

æµè§ˆå™¨è®¿é—®:
```
http://localhost:5173/static/dist/#/abtest/parser-comparison
```

### æ­¥éª¤6: ä¸Šä¼ æ–‡æ¡£æµ‹è¯•

1. ç‚¹å‡»"é€‰æ‹©æ ‡ä¹¦æ–‡æ¡£(.docx)"
2. ä¸Šä¼ ä¸€ä¸ªæ‹›æ ‡æ–‡ä»¶
3. ç‚¹å‡»"å¼€å§‹è§£æå¯¹æ¯”"
4. æŸ¥çœ‹6ç§æ–¹æ³•çš„å¯¹æ¯”ç»“æœ

---

## ğŸ“Š å¯¹æ¯”ç»“æœè¯´æ˜

### æ˜¾ç¤ºçš„6ç§è§£ææ–¹æ³•

| æ–¹æ³• | é¢œè‰² | è¯´æ˜ | æˆæœ¬ |
|------|------|------|------|
| 1. è¯­ä¹‰é”šç‚¹è§£æ | ç»¿è‰² | åŸºäºç›®å½•åŒ¹é… | å…è´¹ |
| 2. æ ·å¼è¯†åˆ«(å¢å¼º) | è“è‰² | åŸºäºWordæ ·å¼ | å…è´¹ |
| 3. æ··åˆå¯å‘å¼è¯†åˆ« | æ©™è‰² | å¤šç‰¹å¾è¯„åˆ† | å…è´¹ |
| 4. Azure Form Recognizer | é’è‰² | å¾®è½¯äº‘æœåŠ¡ | ä»˜è´¹ |
| 5. Wordå¤§çº²çº§åˆ«è¯†åˆ« | ç´«è‰² | å¾®è½¯å®˜æ–¹API | å…è´¹ |
| **6. Gemini AIè§£æå™¨** | **æ©™çº¢** | **AIç†è§£** | **ä½æˆæœ¬** |

### Geminiè§£æå™¨çš„ä¼˜åŠ¿

âœ… **æ™ºèƒ½ç†è§£**: ä¸ä¾èµ–æ–‡æ¡£æ ¼å¼ï¼Œèƒ½ç†è§£è¯­ä¹‰
âœ… **å¤šæ¨¡æ€**: æ”¯æŒæ–‡æœ¬+å›¾ç‰‡æ··åˆæ–‡æ¡£
âœ… **ä½æˆæœ¬**: çº¦0.01-0.05å…ƒ/10é¡µ
âœ… **é«˜å‡†ç¡®ç‡**: å¯¹éæ ‡æ ¼å¼æ–‡æ¡£æ•ˆæœå¥½

### Geminiè§£æå™¨çš„åŠ£åŠ¿

âŒ **éœ€è¦API**: å¿…é¡»é…ç½®GEMINI_API_KEY
âŒ **é€Ÿåº¦è¾ƒæ…¢**: æ¯”å†…ç½®æ–¹æ³•æ…¢5-10ç§’
âŒ **ç½‘ç»œä¾èµ–**: éœ€è¦å¤–ç½‘è®¿é—®

---

## ğŸ§ª æµ‹è¯•å»ºè®®

### æµ‹è¯•åœºæ™¯1: æ ‡å‡†æ ¼å¼æ–‡æ¡£

**é¢„æœŸç»“æœ**:
- å†…ç½®æ–¹æ³•ï¼ˆè¯­ä¹‰é”šç‚¹/æ ·å¼è¯†åˆ«/Wordå¤§çº²ï¼‰å‡†ç¡®ç‡é«˜
- Geminiä¸å†…ç½®æ–¹æ³•ç»“æœç›¸è¿‘
- Geminié€Ÿåº¦è¾ƒæ…¢

**ç»“è®º**: æ ‡å‡†æ–‡æ¡£ä½¿ç”¨å†…ç½®æ–¹æ³•å³å¯

### æµ‹è¯•åœºæ™¯2: éæ ‡æ ¼å¼æ–‡æ¡£

**é¢„æœŸç»“æœ**:
- å†…ç½®æ–¹æ³•è¯†åˆ«ä¸å®Œæ•´æˆ–é”™è¯¯
- Geminiå‡†ç¡®ç‡æ˜æ˜¾æ›´é«˜
- Geminièƒ½è¯†åˆ«å†…ç½®æ–¹æ³•æ¼æ‰çš„ç« èŠ‚

**ç»“è®º**: éæ ‡æ–‡æ¡£æ¨èä½¿ç”¨Gemini

### æµ‹è¯•åœºæ™¯3: å¤æ‚æ··åˆå¸ƒå±€

**é¢„æœŸç»“æœ**:
- å†…ç½®æ–¹æ³•å¯èƒ½æ··ä¹±
- Geminièƒ½æ­£ç¡®ç†è§£æ–‡æ¡£ç»“æ„
- Geminiå¯¹è¡¨æ ¼ã€å›¾ç‰‡ä¸­çš„æ ‡é¢˜ä¹Ÿèƒ½è¯†åˆ«

**ç»“è®º**: å¤æ‚æ–‡æ¡£å¿…é¡»ä½¿ç”¨Gemini

---

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

### Geminiæˆæœ¬é¢„ä¼°

| æ–‡æ¡£å¤§å° | é¡µæ•° | Tokenæ¶ˆè€— | é¢„ä¼°æˆæœ¬ |
|----------|------|-----------|----------|
| å°å‹ | 10é¡µ | ~5K tokens | Â¥0.01-0.03 |
| ä¸­å‹ | 50é¡µ | ~25K tokens | Â¥0.08-0.15 |
| å¤§å‹ | 100é¡µ | ~50K tokens | Â¥0.15-0.30 |

**æ³¨**: æˆæœ¬åŸºäºGemini 2.0 Flashå®šä»·

### è§£æé€Ÿåº¦å¯¹æ¯”

| æ–¹æ³• | 10é¡µæ–‡æ¡£ | 50é¡µæ–‡æ¡£ |
|------|----------|----------|
| å†…ç½®æ–¹æ³• | 1-3ç§’ | 5-10ç§’ |
| Gemini | 8-15ç§’ | 30-60ç§’ |

---

## ğŸ” æ•…éšœæ’æŸ¥

### Q1: Geminiå¡ç‰‡æ˜¾ç¤º"ä¸å¯ç”¨"

**åŸå› **: SDKæœªå®‰è£…æˆ–APIå¯†é’¥æœªé…ç½®

**è§£å†³**:
```bash
# 1. æ£€æŸ¥SDK
pip list | grep google-generativeai

# 2. å¦‚æœæœªå®‰è£…
pip install google-generativeai

# 3. æ£€æŸ¥APIå¯†é’¥
echo $GEMINI_API_KEY  # Linux/Mac
echo %GEMINI_API_KEY%  # Windows

# 4. å¦‚æœæœªè®¾ç½®ï¼Œåœ¨.envæ–‡ä»¶æ·»åŠ 
GEMINI_API_KEY=ä½ çš„å¯†é’¥
```

### Q2: Geminiè§£æå¤±è´¥

**é”™è¯¯æç¤º**:
```
Geminiè§£æå™¨åˆå§‹åŒ–å¤±è´¥: ...
```

**æ’æŸ¥æ­¥éª¤**:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥ï¼ˆéœ€è¦è®¿é—®GoogleæœåŠ¡ï¼‰
2. æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æœ‰æ•ˆ
3. æŸ¥çœ‹åç«¯æ—¥å¿—è¯¦ç»†é”™è¯¯ä¿¡æ¯
4. ç¡®è®¤æ–‡æ¡£æ ¼å¼ï¼ˆæ”¯æŒ.docxï¼‰

### Q3: æ•°æ®åº“é”™è¯¯

**é”™è¯¯æç¤º**:
```
no such column: gemini_result
```

**è§£å†³**: è¿è¡Œæ•°æ®åº“è¿ç§»
```bash
sqlite3 ai_tender_system/data/knowledge_base.db < ai_tender_system/database/add_gemini_to_parser_debug.sql
```

---

## ğŸ“ ä»£ç ç¤ºä¾‹

### Pythonè„šæœ¬ç›´æ¥ä½¿ç”¨

```python
from ai_tender_system.modules.tender_processing.parsers.gemini_parser import GeminiParser

# åˆ›å»ºè§£æå™¨
parser = GeminiParser()

# æ£€æŸ¥å¯ç”¨æ€§
if parser.is_available():
    # è§£ææ–‡æ¡£
    result = parser.parse_structure('/path/to/document.docx')

    if result['success']:
        chapters = result['chapters']
        print(f"è¯†åˆ«åˆ° {len(chapters)} ä¸ªç« èŠ‚")

        # æˆæœ¬ä¿¡æ¯
        cost = result['metrics'].api_cost
        print(f"APIæˆæœ¬: Â¥{cost:.4f}")
    else:
        print(f"è§£æå¤±è´¥: {result['error']}")
else:
    print("Geminiä¸å¯ç”¨ï¼Œè¯·æ£€æŸ¥é…ç½®")
```

### é€šè¿‡APIä½¿ç”¨

```python
import requests

# ä¸Šä¼ æ–‡æ¡£
files = {'file': open('document.docx', 'rb')}
response = requests.post('http://localhost:5000/api/parser-debug/upload', files=files)
data = response.json()

# æŸ¥çœ‹Geminiç»“æœ
if data['success']:
    gemini_result = data['results']['gemini']
    if gemini_result['success']:
        print(f"Geminiè¯†åˆ«: {len(gemini_result['chapters'])}ä¸ªç« èŠ‚")
        print(f"è€—æ—¶: {gemini_result['performance']['elapsed_formatted']}")
    else:
        print(f"Geminiå¤±è´¥: {gemini_result['error']}")
```

---

## ğŸ¯ åç»­ä¼˜åŒ–

### çŸ­æœŸä¼˜åŒ–
- [ ] æ·»åŠ Geminiè§£æè¿›åº¦æç¤º
- [ ] æ”¯æŒè‡ªå®šä¹‰Geminiæ¨¡å‹é€‰æ‹©ï¼ˆFlash/Proï¼‰
- [ ] æ‰¹é‡æµ‹è¯•å¤šä¸ªæ–‡æ¡£

### ä¸­æœŸä¼˜åŒ–
- [ ] æ ¹æ®æµ‹è¯•æ•°æ®ä¼˜åŒ–Prompt
- [ ] æ·»åŠ Geminiç»“æœç¼“å­˜
- [ ] æ”¯æŒæ–­ç‚¹ç»­ä¼ 

### é•¿æœŸè§„åˆ’
- [ ] æ ¹æ®æ•ˆæœå†³å®šæ˜¯å¦é›†æˆåˆ°ä¸»æµç¨‹
- [ ] å»ºç«‹æ–‡æ¡£ç±»å‹-è§£æå™¨æ˜ å°„è§„åˆ™
- [ ] è‡ªåŠ¨é€‰æ‹©æœ€ä½³è§£æå™¨

---

## âœ… æ€»ç»“

Geminiè§£æå™¨å·²å®Œå…¨é›†æˆåˆ°ç°æœ‰å¯¹æ¯”ç³»ç»Ÿï¼æ‚¨ç°åœ¨å¯ä»¥ï¼š

1. âœ… åœ¨å¯¹æ¯”é¡µé¢åŒæ—¶æµ‹è¯•6ç§è§£ææ–¹æ³•
2. âœ… é€šè¿‡F1åˆ†æ•°ç­‰æŒ‡æ ‡å®¢è§‚è¯„ä¼°Geminiæ•ˆæœ
3. âœ… ä¸ºæ¯ä¸ªæ–‡æ¡£é€‰æ‹©æœ€é€‚åˆçš„è§£æå™¨
4. âœ… åœ¨ä¸»æµç¨‹å¼•å…¥å‰å……åˆ†æµ‹è¯•Gemini

**å»ºè®®è¡ŒåŠ¨**:
1. ç«‹å³è¿è¡Œæ•°æ®åº“è¿ç§»
2. æµ‹è¯•5-10ä¸ªçœŸå®æ‹›æ ‡æ–‡æ¡£
3. è®°å½•å„è§£æå™¨çš„è¡¨ç°
4. æ ¹æ®æ•ˆæœå†³å®šæ˜¯å¦åœ¨ç”Ÿäº§ç¯å¢ƒä½¿ç”¨Gemini

ç¥æµ‹è¯•é¡ºåˆ©ï¼ğŸ‰
