# ==========================================
# AI智能标书生成平台 - 生产环境配置模板
# ==========================================
#
# 使用方法:
#   1. 复制此文件为 .env
#      cp .env.production.example .env
#
#   2. 填写所有必需的配置项
#
#   3. 生成安全密钥:
#      python -c "import secrets; print(secrets.token_hex(32))"
#
# 注意:
#   - 所有以 <> 包裹的值都需要替换为实际值
#   - 生产环境务必设置 DEBUG=False
#   - SECRET_KEY 必须使用强随机密钥
#   - 不要将 .env 文件提交到 git
#
# ==========================================

# ==========================================
# 应用基础配置
# ==========================================

# 运行环境（production/development）
FLASK_ENV=production

# 调试模式（生产环境必须为False）
DEBUG=False

# Flask密钥（用于session和CSRF保护）
# 生成方法: python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=<请使用上述命令生成32字节的随机密钥>

# 应用端口（Gunicorn会绑定到此端口）
# 注意: Nginx代理应该指向此端口
PORT=8000

# ==========================================
# 数据库配置
# ==========================================

# SQLite数据库路径（生产环境使用绝对路径）
DATABASE_PATH=/var/www/ai-tender-system/ai_tender_system/data/knowledge_base.db

# ==========================================
# AI模型配置（至少配置一个）
# ==========================================

# 中国联通MaaS平台 (推荐)
# 获取地址: https://maas.ai-yuanjing.com/
ACCESS_TOKEN=<your_unicom_access_token>
UNICOM_BASE_URL=https://maas-api.ai-yuanjing.com/openapi/compatible-mode/v1

# OpenAI (可选)
# 如果使用自定义代理，需要配置以下两项
# OPENAI_API_KEY=<your_openai_api_key>
# OPENAI_BASE_URL=<your_custom_openai_endpoint>

# 始皇API (可选)
# SHIHUANG_API_KEY=<your_shihuang_api_key>
# SHIHUANG_BASE_URL=<your_shihuang_endpoint>

# ==========================================
# 文件上传配置
# ==========================================

# 最大上传文件大小（字节）
# 100MB = 104857600
MAX_CONTENT_LENGTH=104857600

# 上传文件存储目录（绝对路径）
UPLOAD_FOLDER=/var/www/ai-tender-system/ai_tender_system/data/uploads

# 输出文件存储目录（绝对路径）
OUTPUT_FOLDER=/var/www/ai-tender-system/ai_tender_system/data/outputs

# ==========================================
# 日志配置
# ==========================================

# 日志级别（DEBUG/INFO/WARNING/ERROR/CRITICAL）
LOG_LEVEL=INFO

# 日志文件路径（绝对路径）
LOG_FILE=/var/www/ai-tender-system/logs/app.log

# 日志轮转大小（字节）
# 10MB = 10485760
LOG_MAX_BYTES=10485760

# 保留日志文件数量
LOG_BACKUP_COUNT=5

# ==========================================
# 安全配置
# ==========================================

# CSRF保护（生产环境必须启用）
WTF_CSRF_ENABLED=True

# Session配置
# Session超时时间（秒）
PERMANENT_SESSION_LIFETIME=86400  # 24小时

# Session Cookie配置
SESSION_COOKIE_SECURE=True  # HTTPS环境设为True
SESSION_COOKIE_HTTPONLY=True
SESSION_COOKIE_SAMESITE=Lax

# ==========================================
# 性能配置
# ==========================================

# 向量搜索配置
# FAISS索引类型（IndexFlatL2/IndexIVFFlat）
FAISS_INDEX_TYPE=IndexFlatL2

# 向量维度（根据使用的embedding模型）
VECTOR_DIMENSION=1024

# 搜索结果数量
SEARCH_TOP_K=10

# ==========================================
# 邮件配置（可选）
# ==========================================

# 如果需要邮件通知功能，配置以下选项
# MAIL_SERVER=smtp.example.com
# MAIL_PORT=587
# MAIL_USE_TLS=True
# MAIL_USERNAME=<your_email>
# MAIL_PASSWORD=<your_email_password>
# MAIL_DEFAULT_SENDER=noreply@example.com

# ==========================================
# 监控和告警（可选）
# ==========================================

# Sentry错误监控（可选）
# SENTRY_DSN=<your_sentry_dsn>

# 钉钉告警Webhook（可选）
# DINGTALK_WEBHOOK=<your_dingtalk_webhook_url>

# ==========================================
# 备份配置
# ==========================================

# 备份目录（绝对路径）
BACKUP_DIR=/var/backups/ai-tender-system

# 备份保留天数
BACKUP_RETENTION_DAYS=7

# ==========================================
# OCR配置（扫描PDF必须）
# ==========================================

# 是否启用OCR识别扫描PDF（必须为true才能解析扫描件）
ENABLE_OCR=true

# 触发OCR的最小字符数阈值
# 当PDF页面提取的字符数少于此值时，判定为扫描页并启动OCR
OCR_MIN_CHARS_PER_PAGE=50

# 是否使用GPU加速OCR（需要CUDA环境）
OCR_USE_GPU=false

# OCR识别语言（ch=中文, en=英文, ch_en=中英文混合）
OCR_LANG=ch

# OCR分批处理页数（防止内存溢出，8GB内存建议10页/批）
OCR_BATCH_SIZE=10

# ==========================================
# 其他配置
# ==========================================

# 时区
TZ=Asia/Shanghai

# Python缓存目录
PYTHONDONTWRITEBYTECODE=1

# ==========================================
# 配置验证清单
# ==========================================
#
# 部署前请确认已正确配置:
#   [✓] SECRET_KEY - 已生成强随机密钥
#   [✓] ACCESS_TOKEN - 已配置AI模型API密钥
#   [✓] DATABASE_PATH - 已设置正确的绝对路径
#   [✓] DEBUG - 已设置为False
#   [✓] FLASK_ENV - 已设置为production
#   [✓] LOG_LEVEL - 已设置为INFO或WARNING
#   [✓] SESSION_COOKIE_SECURE - HTTPS环境设为True
#
# ==========================================
